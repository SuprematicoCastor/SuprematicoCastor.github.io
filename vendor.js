!function(e){if("object"==typeof exports&&"undefined"!=typeof module)module.exports=e();else if("function"==typeof define&&define.amd)define([],e);else{var t;t="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:this,t.PIXI=e()}}(function(){var B;return function a(o,s,u){function l(r,e){if(!s[r]){if(!o[r]){var t="function"==typeof require&&require;if(!e&&t)return t(r,!0);if(c)return c(r,!0);var n=new Error("Cannot find module '"+r+"'");throw n.code="MODULE_NOT_FOUND",n}var i=s[r]={exports:{}};o[r][0].call(i.exports,function(e){var t=o[r][1][e];return l(t||e)},i,i.exports,a,o,s,u)}return s[r].exports}for(var c="function"==typeof require&&require,e=0;e<u.length;e++)l(u[e]);return l}({1:[function(e,t,r){"use strict";"use restrict";function n(e){var t=32;return e&=-e,e&&t--,65535&e&&(t-=16),16711935&e&&(t-=8),252645135&e&&(t-=4),858993459&e&&(t-=2),1431655765&e&&(t-=1),t}r.INT_BITS=32,r.INT_MAX=2147483647,r.INT_MIN=-1<<31,r.sign=function(e){return(e>0)-(e<0)},r.abs=function(e){var t=e>>31;return(e^t)-t},r.min=function(e,t){return t^(e^t)&-(e<t)},r.max=function(e,t){return e^(e^t)&-(e<t)},r.isPow2=function(e){return!(e&e-1||!e)},r.log2=function(e){var t,r;return t=(e>65535)<<4,e>>>=t,r=(e>255)<<3,e>>>=r,t|=r,r=(e>15)<<2,e>>>=r,t|=r,r=(e>3)<<1,e>>>=r,(t|=r)|e>>1},r.log10=function(e){return e>=1e9?9:e>=1e8?8:e>=1e7?7:e>=1e6?6:e>=1e5?5:e>=1e4?4:e>=1e3?3:e>=100?2:e>=10?1:0},r.popCount=function(e){return e-=e>>>1&1431655765,16843009*((e=(858993459&e)+(e>>>2&858993459))+(e>>>4)&252645135)>>>24},r.countTrailingZeros=n,r.nextPow2=function(e){return e+=0===e,--e,e|=e>>>1,e|=e>>>2,e|=e>>>4,e|=e>>>8,(e|=e>>>16)+1},r.prevPow2=function(e){return e|=e>>>1,e|=e>>>2,e|=e>>>4,e|=e>>>8,(e|=e>>>16)-(e>>>1)},r.parity=function(e){return e^=e>>>16,e^=e>>>8,e^=e>>>4,27030>>>(e&=15)&1};var i=new Array(256);!function(e){for(var t=0;t<256;++t){var r=t,n=t,i=7;for(r>>>=1;r;r>>>=1)n<<=1,n|=1&r,--i;e[t]=n<<i&255}}(i),r.reverse=function(e){return i[255&e]<<24|i[e>>>8&255]<<16|i[e>>>16&255]<<8|i[e>>>24&255]},r.interleave2=function(e,t){return e&=65535,e=16711935&(e|e<<8),e=252645135&(e|e<<4),e=858993459&(e|e<<2),e=1431655765&(e|e<<1),t&=65535,t=16711935&(t|t<<8),t=252645135&(t|t<<4),t=858993459&(t|t<<2),t=1431655765&(t|t<<1),e|t<<1},r.deinterleave2=function(e,t){return e=e>>>t&1431655765,e=858993459&(e|e>>>1),e=252645135&(e|e>>>2),e=16711935&(e|e>>>4),(e=65535&(e|e>>>16))<<16>>16},r.interleave3=function(e,t,r){return e&=1023,e=4278190335&(e|e<<16),e=251719695&(e|e<<8),e=3272356035&(e|e<<4),e=1227133513&(e|e<<2),t&=1023,t=4278190335&(t|t<<16),t=251719695&(t|t<<8),t=3272356035&(t|t<<4),t=1227133513&(t|t<<2),e|=t<<1,r&=1023,r=4278190335&(r|r<<16),r=251719695&(r|r<<8),r=3272356035&(r|r<<4),r=1227133513&(r|r<<2),e|r<<2},r.deinterleave3=function(e,t){return e=e>>>t&1227133513,e=3272356035&(e|e>>>2),e=251719695&(e|e>>>4),e=4278190335&(e|e>>>8),(e=1023&(e|e>>>16))<<22>>22},r.nextCombination=function(e){var t=e|e-1;return t+1|(~t&-~t)-1>>>n(e)+1}},{}],2:[function(e,t,r){"use strict";function n(e,t,r){r=r||2;var n=t&&t.length,i=n?t[0]*r:e.length,a=v(e,0,i,r,!0),o=[];if(!a)return o;var s,u,l,c,h,f,d;if(n&&(a=g(e,t,a,r)),e.length>80*r){s=l=e[0],u=c=e[1];for(var p=r;p<i;p+=r)h=e[p],f=e[p+1],h<s&&(s=h),f<u&&(u=f),h>l&&(l=h),f>c&&(c=f);d=Math.max(l-s,c-u)}return m(a,o,r,s,u,d),o}function v(e,t,r,n,i){var a,o;if(i===O(e,t,r,n)>0)for(a=t;a<r;a+=n)o=R(a,e[a],e[a+1],o);else for(a=r-n;a>=t;a-=n)o=R(a,e[a],e[a+1],o);return o&&s(o,o.next)&&(P(o),o=o.next),o}function c(e,t){if(!e)return e;t||(t=e);var r,n=e;do{if(r=!1,n.steiner||!s(n,n.next)&&0!==E(n.prev,n,n.next))n=n.next;else{if(P(n),(n=t=n.prev)===n.next)return null;r=!0}}while(r||n!==t);return t}function m(e,t,r,n,i,a,o){if(e){!o&&a&&b(e,n,i,a);for(var s,u,l=e;e.prev!==e.next;)if(s=e.prev,u=e.next,a?f(e,n,i,a):h(e))t.push(s.i/r),t.push(e.i/r),t.push(u.i/r),P(e),e=u.next,l=u.next;else if((e=u)===l){o?1===o?(e=d(e,t,r),m(e,t,r,n,i,a,2)):2===o&&p(e,t,r,n,i,a):m(c(e),t,r,n,i,a,1);break}}}function h(e){var t=e.prev,r=e,n=e.next;if(E(t,r,n)>=0)return!1;for(var i=e.next.next;i!==e.prev;){if(T(t.x,t.y,r.x,r.y,n.x,n.y,i.x,i.y)&&E(i.prev,i,i.next)>=0)return!1;i=i.next}return!0}function f(e,t,r,n){var i=e.prev,a=e,o=e.next;if(E(i,a,o)>=0)return!1;for(var s=i.x<a.x?i.x<o.x?i.x:o.x:a.x<o.x?a.x:o.x,u=i.y<a.y?i.y<o.y?i.y:o.y:a.y<o.y?a.y:o.y,l=i.x>a.x?i.x>o.x?i.x:o.x:a.x>o.x?a.x:o.x,c=i.y>a.y?i.y>o.y?i.y:o.y:a.y>o.y?a.y:o.y,h=w(s,u,t,r,n),f=w(l,c,t,r,n),d=e.nextZ;d&&d.z<=f;){if(d!==e.prev&&d!==e.next&&T(i.x,i.y,a.x,a.y,o.x,o.y,d.x,d.y)&&E(d.prev,d,d.next)>=0)return!1;d=d.nextZ}for(d=e.prevZ;d&&d.z>=h;){if(d!==e.prev&&d!==e.next&&T(i.x,i.y,a.x,a.y,o.x,o.y,d.x,d.y)&&E(d.prev,d,d.next)>=0)return!1;d=d.prevZ}return!0}function d(e,t,r){var n=e;do{var i=n.prev,a=n.next.next;!s(i,a)&&o(i,n,n.next,a)&&M(i,a)&&M(a,i)&&(t.push(i.i/r),t.push(n.i/r),t.push(a.i/r),P(n),P(n.next),n=e=a),n=n.next}while(n!==e);return n}function p(e,t,r,n,i,a){var o=e;do{for(var s=o.next.next;s!==o.prev;){if(o.i!==s.i&&l(o,s)){var u=A(o,s);return o=c(o,o.next),u=c(u,u.next),m(o,t,r,n,i,a),void m(u,t,r,n,i,a)}s=s.next}o=o.next}while(o!==e)}function g(e,t,r,n){var i,a,o,s,u,l=[];for(i=0,a=t.length;i<a;i++)o=t[i]*n,s=i<a-1?t[i+1]*n:e.length,u=v(e,o,s,n,!1),u===u.next&&(u.steiner=!0),l.push(_(u));for(l.sort(y),i=0;i<l.length;i++)x(l[i],r),r=c(r,r.next);return r}function y(e,t){return e.x-t.x}function x(e,t){if(t=i(e,t)){var r=A(t,e);c(r,r.next)}}function i(e,t){var r,n=t,i=e.x,a=e.y,o=-1/0;do{if(a<=n.y&&a>=n.next.y){var s=n.x+(a-n.y)*(n.next.x-n.x)/(n.next.y-n.y);if(s<=i&&s>o){if(o=s,s===i){if(a===n.y)return n;if(a===n.next.y)return n.next}r=n.x<n.next.x?n:n.next}}n=n.next}while(n!==t);if(!r)return null;if(i===o)return r.prev;var u,l=r,c=r.x,h=r.y,f=1/0;for(n=r.next;n!==l;)i>=n.x&&n.x>=c&&T(a<h?i:o,a,c,h,a<h?o:i,a,n.x,n.y)&&((u=Math.abs(a-n.y)/(i-n.x))<f||u===f&&n.x>r.x)&&M(n,e)&&(r=n,f=u),n=n.next;return r}function b(e,t,r,n){var i=e;do{null===i.z&&(i.z=w(i.x,i.y,t,r,n)),i.prevZ=i.prev,i.nextZ=i.next,i=i.next}while(i!==e);i.prevZ.nextZ=null,i.prevZ=null,a(i)}function a(e){var t,r,n,i,a,o,s,u,l=1;do{for(r=e,e=null,a=null,o=0;r;){for(o++,n=r,s=0,t=0;t<l&&(s++,n=n.nextZ);t++);for(u=l;s>0||u>0&&n;)0===s?(i=n,n=n.nextZ,u--):0!==u&&n?r.z<=n.z?(i=r,r=r.nextZ,s--):(i=n,n=n.nextZ,u--):(i=r,r=r.nextZ,s--),a?a.nextZ=i:e=i,i.prevZ=a,a=i;r=n}a.nextZ=null,l*=2}while(o>1);return e}function w(e,t,r,n,i){return e=32767*(e-r)/i,t=32767*(t-n)/i,e=16711935&(e|e<<8),e=252645135&(e|e<<4),e=858993459&(e|e<<2),e=1431655765&(e|e<<1),t=16711935&(t|t<<8),t=252645135&(t|t<<4),t=858993459&(t|t<<2),t=1431655765&(t|t<<1),e|t<<1}function _(e){var t=e,r=e;do{t.x<r.x&&(r=t),t=t.next}while(t!==e);return r}function T(e,t,r,n,i,a,o,s){return(i-o)*(t-s)-(e-o)*(a-s)>=0&&(e-o)*(n-s)-(r-o)*(t-s)>=0&&(r-o)*(a-s)-(i-o)*(n-s)>=0}function l(e,t){return e.next.i!==t.i&&e.prev.i!==t.i&&!u(e,t)&&M(e,t)&&M(t,e)&&S(e,t)}function E(e,t,r){return(t.y-e.y)*(r.x-t.x)-(t.x-e.x)*(r.y-t.y)}function s(e,t){return e.x===t.x&&e.y===t.y}function o(e,t,r,n){return!!(s(e,t)&&s(r,n)||s(e,n)&&s(r,t))||E(e,t,r)>0!=E(e,t,n)>0&&E(r,n,e)>0!=E(r,n,t)>0}function u(e,t){var r=e;do{if(r.i!==e.i&&r.next.i!==e.i&&r.i!==t.i&&r.next.i!==t.i&&o(r,r.next,e,t))return!0;r=r.next}while(r!==e);return!1}function M(e,t){return E(e.prev,e,e.next)<0?E(e,t,e.next)>=0&&E(e,e.prev,t)>=0:E(e,t,e.prev)<0||E(e,e.next,t)<0}function S(e,t){var r=e,n=!1,i=(e.x+t.x)/2,a=(e.y+t.y)/2;do{r.y>a!=r.next.y>a&&i<(r.next.x-r.x)*(a-r.y)/(r.next.y-r.y)+r.x&&(n=!n),r=r.next}while(r!==e);return n}function A(e,t){var r=new C(e.i,e.x,e.y),n=new C(t.i,t.x,t.y),i=e.next,a=t.prev;return e.next=t,t.prev=e,r.next=i,i.prev=r,n.next=r,r.prev=n,a.next=n,n.prev=a,n}function R(e,t,r,n){var i=new C(e,t,r);return n?(i.next=n.next,i.prev=n,n.next.prev=i,n.next=i):(i.prev=i,i.next=i),i}function P(e){e.next.prev=e.prev,e.prev.next=e.next,e.prevZ&&(e.prevZ.nextZ=e.nextZ),e.nextZ&&(e.nextZ.prevZ=e.prevZ)}function C(e,t,r){this.i=e,this.x=t,this.y=r,this.prev=null,this.next=null,this.z=null,this.prevZ=null,this.nextZ=null,this.steiner=!1}function O(e,t,r,n){for(var i=0,a=t,o=r-n;a<r;a+=n)i+=(e[o]-e[a])*(e[a+1]+e[o+1]),o=a;return i}t.exports=n,n.deviation=function(e,t,r,n){var i=t&&t.length,a=i?t[0]*r:e.length,o=Math.abs(O(e,0,a,r));if(i)for(var s=0,u=t.length;s<u;s++){var l=t[s]*r,c=s<u-1?t[s+1]*r:e.length;o-=Math.abs(O(e,l,c,r))}var h=0;for(s=0;s<n.length;s+=3){var f=n[s]*r,d=n[s+1]*r,p=n[s+2]*r;h+=Math.abs((e[f]-e[p])*(e[d+1]-e[f+1])-(e[f]-e[d])*(e[p+1]-e[f+1]))}return 0===o&&0===h?0:Math.abs((h-o)/o)},n.flatten=function(e){for(var t=e[0][0].length,r={vertices:[],holes:[],dimensions:t},n=0,i=0;i<e.length;i++){for(var a=0;a<e[i].length;a++)for(var o=0;o<t;o++)r.vertices.push(e[i][a][o]);i>0&&(n+=e[i-1].length,r.holes.push(n))}return r}},{}],3:[function(e,t,r){"use strict";function l(){}function a(e,t,r){this.fn=e,this.context=t,this.once=r||!1}function n(){this._events=new l,this._eventsCount=0}var i=Object.prototype.hasOwnProperty,d="~";Object.create&&(l.prototype=Object.create(null),(new l).__proto__||(d=!1)),n.prototype.eventNames=function(){var e,t,r=[];if(0===this._eventsCount)return r;for(t in e=this._events)i.call(e,t)&&r.push(d?t.slice(1):t);return Object.getOwnPropertySymbols?r.concat(Object.getOwnPropertySymbols(e)):r},n.prototype.listeners=function(e,t){var r=d?d+e:e,n=this._events[r];if(t)return!!n;if(!n)return[];if(n.fn)return[n.fn];for(var i=0,a=n.length,o=new Array(a);i<a;i++)o[i]=n[i].fn;return o},n.prototype.emit=function(e,t,r,n,i,a){var o=d?d+e:e;if(!this._events[o])return!1;var s,u,l=this._events[o],c=arguments.length;if(l.fn){switch(l.once&&this.removeListener(e,l.fn,void 0,!0),c){case 1:return l.fn.call(l.context),!0;case 2:return l.fn.call(l.context,t),!0;case 3:return l.fn.call(l.context,t,r),!0;case 4:return l.fn.call(l.context,t,r,n),!0;case 5:return l.fn.call(l.context,t,r,n,i),!0;case 6:return l.fn.call(l.context,t,r,n,i,a),!0}for(u=1,s=new Array(c-1);u<c;u++)s[u-1]=arguments[u];l.fn.apply(l.context,s)}else{var h,f=l.length;for(u=0;u<f;u++)switch(l[u].once&&this.removeListener(e,l[u].fn,void 0,!0),c){case 1:l[u].fn.call(l[u].context);break;case 2:l[u].fn.call(l[u].context,t);break;case 3:l[u].fn.call(l[u].context,t,r);break;case 4:l[u].fn.call(l[u].context,t,r,n);break;default:if(!s)for(h=1,s=new Array(c-1);h<c;h++)s[h-1]=arguments[h];l[u].fn.apply(l[u].context,s)}}return!0},n.prototype.on=function(e,t,r){var n=new a(t,r||this),i=d?d+e:e;return this._events[i]?this._events[i].fn?this._events[i]=[this._events[i],n]:this._events[i].push(n):(this._events[i]=n,this._eventsCount++),this},n.prototype.once=function(e,t,r){var n=new a(t,r||this,!0),i=d?d+e:e;return this._events[i]?this._events[i].fn?this._events[i]=[this._events[i],n]:this._events[i].push(n):(this._events[i]=n,this._eventsCount++),this},n.prototype.removeListener=function(e,t,r,n){var i=d?d+e:e;if(!this._events[i])return this;if(!t)return 0==--this._eventsCount?this._events=new l:delete this._events[i],this;var a=this._events[i];if(a.fn)a.fn!==t||n&&!a.once||r&&a.context!==r||(0==--this._eventsCount?this._events=new l:delete this._events[i]);else{for(var o=0,s=[],u=a.length;o<u;o++)(a[o].fn!==t||n&&!a[o].once||r&&a[o].context!==r)&&s.push(a[o]);s.length?this._events[i]=1===s.length?s[0]:s:0==--this._eventsCount?this._events=new l:delete this._events[i]}return this},n.prototype.removeAllListeners=function(e){var t;return e?(t=d?d+e:e,this._events[t]&&(0==--this._eventsCount?this._events=new l:delete this._events[t])):(this._events=new l,this._eventsCount=0),this},n.prototype.off=n.prototype.removeListener,n.prototype.addListener=n.prototype.on,n.prototype.setMaxListeners=function(){return this},n.prefixed=d,n.EventEmitter=n,void 0!==t&&(t.exports=n)},{}],4:[function(e,x,t){!function(e){var n=/iPhone/i,i=/iPod/i,a=/iPad/i,o=/(?=.*\bAndroid\b)(?=.*\bMobile\b)/i,s=/Android/i,u=/(?=.*\bAndroid\b)(?=.*\bSD4930UR\b)/i,l=/(?=.*\bAndroid\b)(?=.*\b(?:KFOT|KFTT|KFJWI|KFJWA|KFSOWI|KFTHWI|KFTHWA|KFAPWI|KFAPWA|KFARWI|KFASWI|KFSAWI|KFSAWA)\b)/i,c=/Windows Phone/i,h=/(?=.*\bWindows\b)(?=.*\bARM\b)/i,f=/BlackBerry/i,d=/BB10/i,p=/Opera Mini/i,v=/(CriOS|Chrome)(?=.*\bMobile\b)/i,m=/(?=.*\bFirefox\b)(?=.*\bMobile\b)/i,g=new RegExp("(?:Nexus 7|BNTV250|Kindle Fire|Silk|GT-P1000)","i"),y=function(e,t){return e.test(t)},t=function(e){var t=e||navigator.userAgent,r=t.split("[FBAN");if(void 0!==r[1]&&(t=r[0]),r=t.split("Twitter"),void 0!==r[1]&&(t=r[0]),this.apple={phone:y(n,t),ipod:y(i,t),tablet:!y(n,t)&&y(a,t),device:y(n,t)||y(i,t)||y(a,t)},this.amazon={phone:y(u,t),tablet:!y(u,t)&&y(l,t),device:y(u,t)||y(l,t)},this.android={phone:y(u,t)||y(o,t),tablet:!y(u,t)&&!y(o,t)&&(y(l,t)||y(s,t)),device:y(u,t)||y(l,t)||y(o,t)||y(s,t)},this.windows={phone:y(c,t),tablet:y(h,t),device:y(c,t)||y(h,t)},this.other={blackberry:y(f,t),blackberry10:y(d,t),opera:y(p,t),firefox:y(m,t),chrome:y(v,t),device:y(f,t)||y(d,t)||y(p,t)||y(m,t)||y(v,t)},this.seven_inch=y(g,t),this.any=this.apple.device||this.android.device||this.windows.device||this.other.device||this.seven_inch,this.phone=this.apple.phone||this.android.phone||this.windows.phone,this.tablet=this.apple.tablet||this.android.tablet||this.windows.tablet,"undefined"==typeof window)return this},r=function(){var e=new t;return e.Class=t,e};void 0!==x&&x.exports&&"undefined"==typeof window?x.exports=t:void 0!==x&&x.exports&&"undefined"!=typeof window?x.exports=r():"function"==typeof B&&B.amd?B("isMobile",[],e.isMobile=r()):e.isMobile=r()}(this)},{}],5:[function(e,t,r){"use strict";function u(e){if(null===e||void 0===e)throw new TypeError("Object.assign cannot be called with null or undefined");return Object(e)}var l=Object.getOwnPropertySymbols,c=Object.prototype.hasOwnProperty,h=Object.prototype.propertyIsEnumerable;t.exports=function(){try{if(!Object.assign)return!1;var e=new String("abc");if(e[5]="de","5"===Object.getOwnPropertyNames(e)[0])return!1;for(var t={},r=0;r<10;r++)t["_"+String.fromCharCode(r)]=r;if("0123456789"!==Object.getOwnPropertyNames(t).map(function(e){return t[e]}).join(""))return!1;var n={};return"abcdefghijklmnopqrst".split("").forEach(function(e){n[e]=e}),"abcdefghijklmnopqrst"===Object.keys(Object.assign({},n)).join("")}catch(e){return!1}}()?Object.assign:function(e,t){for(var r,n,i=u(e),a=1;a<arguments.length;a++){r=Object(arguments[a]);for(var o in r)c.call(r,o)&&(i[o]=r[o]);if(l){n=l(r);for(var s=0;s<n.length;s++)h.call(r,n[s])&&(i[n[s]]=r[n[s]])}}return i}},{}],6:[function(e,t,r){var i=new ArrayBuffer(0),a=function(e,t,r,n){this.gl=e,this.buffer=e.createBuffer(),this.type=t||e.ARRAY_BUFFER,this.drawType=n||e.STATIC_DRAW,this.data=i,r&&this.upload(r),this._updateID=0};a.prototype.upload=function(e,t,r){r||this.bind();var n=this.gl;e=e||this.data,t=t||0,this.data.byteLength>=e.byteLength?n.bufferSubData(this.type,t,e):n.bufferData(this.type,e,this.drawType),this.data=e},a.prototype.bind=function(){this.gl.bindBuffer(this.type,this.buffer)},a.createVertexBuffer=function(e,t,r){return new a(e,e.ARRAY_BUFFER,t,r)},a.createIndexBuffer=function(e,t,r){return new a(e,e.ELEMENT_ARRAY_BUFFER,t,r)},a.create=function(e,t,r,n){return new a(e,t,r,n)},a.prototype.destroy=function(){this.gl.deleteBuffer(this.buffer)},t.exports=a},{}],7:[function(e,t,r){var o=e("./GLTexture"),s=function(e,t,r){this.gl=e,this.framebuffer=e.createFramebuffer(),this.stencil=null,this.texture=null,this.width=t||100,this.height=r||100};s.prototype.enableTexture=function(e){var t=this.gl;this.texture=e||new o(t),this.texture.bind(),this.bind(),t.framebufferTexture2D(t.FRAMEBUFFER,t.COLOR_ATTACHMENT0,t.TEXTURE_2D,this.texture.texture,0)},s.prototype.enableStencil=function(){if(!this.stencil){var e=this.gl;this.stencil=e.createRenderbuffer(),e.bindRenderbuffer(e.RENDERBUFFER,this.stencil),e.framebufferRenderbuffer(e.FRAMEBUFFER,e.DEPTH_STENCIL_ATTACHMENT,e.RENDERBUFFER,this.stencil),e.renderbufferStorage(e.RENDERBUFFER,e.DEPTH_STENCIL,this.width,this.height)}},s.prototype.clear=function(e,t,r,n){this.bind();var i=this.gl;i.clearColor(e,t,r,n),i.clear(i.COLOR_BUFFER_BIT|i.DEPTH_BUFFER_BIT)},s.prototype.bind=function(){var e=this.gl;e.bindFramebuffer(e.FRAMEBUFFER,this.framebuffer)},s.prototype.unbind=function(){var e=this.gl;e.bindFramebuffer(e.FRAMEBUFFER,null)},s.prototype.resize=function(e,t){var r=this.gl;this.width=e,this.height=t,this.texture&&this.texture.uploadData(null,e,t),this.stencil&&(r.bindRenderbuffer(r.RENDERBUFFER,this.stencil),r.renderbufferStorage(r.RENDERBUFFER,r.DEPTH_STENCIL,e,t))},s.prototype.destroy=function(){var e=this.gl;this.texture&&this.texture.destroy(),e.deleteFramebuffer(this.framebuffer),this.gl=null,this.stencil=null,this.texture=null},s.createRGBA=function(e,t,r,n){var i=o.fromData(e,null,t,r);i.enableNearestScaling(),i.enableWrapClamp();var a=new s(e,t,r);return a.enableTexture(i),a.unbind(),a},s.createFloat32=function(e,t,r,n){var i=new o.fromData(e,n,t,r);i.enableNearestScaling(),i.enableWrapClamp();var a=new s(e,t,r);return a.enableTexture(i),a.unbind(),a},t.exports=s},{"./GLTexture":9}],8:[function(e,t,r){var a=e("./shader/compileProgram"),o=e("./shader/extractAttributes"),s=e("./shader/extractUniforms"),u=e("./shader/setPrecision"),l=e("./shader/generateUniformAccessObject"),n=function(e,t,r,n,i){this.gl=e,n&&(t=u(t,n),r=u(r,n)),this.program=a(e,t,r,i),this.attributes=o(e,this.program),this.uniformData=s(e,this.program),this.uniforms=l(e,this.uniformData)};n.prototype.bind=function(){this.gl.useProgram(this.program)},n.prototype.destroy=function(){this.attributes=null,this.uniformData=null,this.uniforms=null,this.gl.deleteProgram(this.program)},t.exports=n},{"./shader/compileProgram":14,"./shader/extractAttributes":16,"./shader/extractUniforms":17,"./shader/generateUniformAccessObject":18,"./shader/setPrecision":22}],9:[function(e,t,r){var a=function(e,t,r,n,i){this.gl=e,this.texture=e.createTexture(),this.mipmap=!1,this.premultiplyAlpha=!1,this.width=t||-1,this.height=r||-1,this.format=n||e.RGBA,this.type=i||e.UNSIGNED_BYTE};a.prototype.upload=function(e){this.bind();var t=this.gl;t.pixelStorei(t.UNPACK_PREMULTIPLY_ALPHA_WEBGL,this.premultiplyAlpha);var r=e.videoWidth||e.width,n=e.videoHeight||e.height;n!==this.height||r!==this.width?t.texImage2D(t.TEXTURE_2D,0,this.format,this.format,this.type,e):t.texSubImage2D(t.TEXTURE_2D,0,0,0,this.format,this.type,e),this.width=r,this.height=n};var i=!1;a.prototype.uploadData=function(e,t,r){this.bind();var n=this.gl;if(e instanceof Float32Array){if(!i){if(!n.getExtension("OES_texture_float"))throw new Error("floating point textures not available");i=!0}this.type=n.FLOAT}else this.type=this.type||n.UNSIGNED_BYTE;n.pixelStorei(n.UNPACK_PREMULTIPLY_ALPHA_WEBGL,this.premultiplyAlpha),t!==this.width||r!==this.height?n.texImage2D(n.TEXTURE_2D,0,this.format,t,r,0,this.format,this.type,e||null):n.texSubImage2D(n.TEXTURE_2D,0,0,0,t,r,this.format,this.type,e||null),this.width=t,this.height=r},a.prototype.bind=function(e){var t=this.gl;void 0!==e&&t.activeTexture(t.TEXTURE0+e),t.bindTexture(t.TEXTURE_2D,this.texture)},a.prototype.unbind=function(){var e=this.gl;e.bindTexture(e.TEXTURE_2D,null)},a.prototype.minFilter=function(e){var t=this.gl;this.bind(),this.mipmap?t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MIN_FILTER,e?t.LINEAR_MIPMAP_LINEAR:t.NEAREST_MIPMAP_NEAREST):t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MIN_FILTER,e?t.LINEAR:t.NEAREST)},a.prototype.magFilter=function(e){var t=this.gl;this.bind(),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MAG_FILTER,e?t.LINEAR:t.NEAREST)},a.prototype.enableMipmap=function(){var e=this.gl;this.bind(),this.mipmap=!0,e.generateMipmap(e.TEXTURE_2D)},a.prototype.enableLinearScaling=function(){this.minFilter(!0),this.magFilter(!0)},a.prototype.enableNearestScaling=function(){this.minFilter(!1),this.magFilter(!1)},a.prototype.enableWrapClamp=function(){var e=this.gl;this.bind(),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_S,e.CLAMP_TO_EDGE),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_T,e.CLAMP_TO_EDGE)},a.prototype.enableWrapRepeat=function(){var e=this.gl;this.bind(),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_S,e.REPEAT),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_T,e.REPEAT)},a.prototype.enableWrapMirrorRepeat=function(){var e=this.gl;this.bind(),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_S,e.MIRRORED_REPEAT),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_T,e.MIRRORED_REPEAT)},a.prototype.destroy=function(){this.gl.deleteTexture(this.texture)},a.fromSource=function(e,t,r){var n=new a(e);return n.premultiplyAlpha=r||!1,n.upload(t),n},a.fromData=function(e,t,r,n){var i=new a(e);return i.uploadData(t,r,n),i},t.exports=a},{}],10:[function(e,t,r){function n(e,t){if(this.nativeVaoExtension=null,n.FORCE_NATIVE||(this.nativeVaoExtension=e.getExtension("OES_vertex_array_object")||e.getExtension("MOZ_OES_vertex_array_object")||e.getExtension("WEBKIT_OES_vertex_array_object")),this.nativeState=t,this.nativeVaoExtension){this.nativeVao=this.nativeVaoExtension.createVertexArrayOES();var r=e.getParameter(e.MAX_VERTEX_ATTRIBS);this.nativeState={tempAttribState:new Array(r),attribState:new Array(r)}}this.gl=e,this.attributes=[],this.indexBuffer=null,this.dirty=!1}var i=e("./setVertexAttribArrays");n.prototype.constructor=n,t.exports=n,n.FORCE_NATIVE=!1,n.prototype.bind=function(){return this.nativeVao?(this.nativeVaoExtension.bindVertexArrayOES(this.nativeVao),this.dirty&&(this.dirty=!1,this.activate())):this.activate(),this},n.prototype.unbind=function(){return this.nativeVao&&this.nativeVaoExtension.bindVertexArrayOES(null),this},n.prototype.activate=function(){for(var e=this.gl,t=null,r=0;r<this.attributes.length;r++){var n=this.attributes[r];t!==n.buffer&&(n.buffer.bind(),t=n.buffer),e.vertexAttribPointer(n.attribute.location,n.attribute.size,n.type||e.FLOAT,n.normalized||!1,n.stride||0,n.start||0)}return i(e,this.attributes,this.nativeState),this.indexBuffer&&this.indexBuffer.bind(),this},n.prototype.addAttribute=function(e,t,r,n,i,a){return this.attributes.push({buffer:e,attribute:t,location:t.location,type:r||this.gl.FLOAT,normalized:n||!1,stride:i||0,start:a||0}),this.dirty=!0,this},n.prototype.addIndex=function(e){return this.indexBuffer=e,this.dirty=!0,this},n.prototype.clear=function(){return this.nativeVao&&this.nativeVaoExtension.bindVertexArrayOES(this.nativeVao),this.attributes.length=0,this.indexBuffer=null,this},n.prototype.draw=function(e,t,r){var n=this.gl;return this.indexBuffer?n.drawElements(e,t||this.indexBuffer.data.length,n.UNSIGNED_SHORT,2*(r||0)):n.drawArrays(e,r,t||this.getSize()),this},n.prototype.destroy=function(){this.gl=null,this.indexBuffer=null,this.attributes=null,this.nativeState=null,this.nativeVao&&this.nativeVaoExtension.deleteVertexArrayOES(this.nativeVao),this.nativeVaoExtension=null,this.nativeVao=null},n.prototype.getSize=function(){var e=this.attributes[0];return e.buffer.data.length/(e.stride/4||e.attribute.size)}},{"./setVertexAttribArrays":13}],11:[function(e,t,r){var n=function(e,t){var r=e.getContext("webgl",t)||e.getContext("experimental-webgl",t);if(!r)throw new Error("This browser does not support webGL. Try using the canvas renderer");return r};t.exports=n},{}],12:[function(e,t,r){var n={createContext:e("./createContext"),setVertexAttribArrays:e("./setVertexAttribArrays"),GLBuffer:e("./GLBuffer"),GLFramebuffer:e("./GLFramebuffer"),GLShader:e("./GLShader"),GLTexture:e("./GLTexture"),VertexArrayObject:e("./VertexArrayObject"),shader:e("./shader")};void 0!==t&&t.exports&&(t.exports=n),"undefined"!=typeof window&&(window.PIXI=window.PIXI||{},window.PIXI.glCore=n)},{"./GLBuffer":6,"./GLFramebuffer":7,"./GLShader":8,"./GLTexture":9,"./VertexArrayObject":10,"./createContext":11,"./setVertexAttribArrays":13,"./shader":19}],13:[function(e,t,r){var n=function(e,t,r){var n;if(r){var i=r.tempAttribState,a=r.attribState;for(n=0;n<i.length;n++)i[n]=!1;for(n=0;n<t.length;n++)i[t[n].attribute.location]=!0;for(n=0;n<a.length;n++)a[n]!==i[n]&&(a[n]=i[n],r.attribState[n]?e.enableVertexAttribArray(n):e.disableVertexAttribArray(n))}else for(n=0;n<t.length;n++){var o=t[n];e.enableVertexAttribArray(o.attribute.location)}};t.exports=n},{}],14:[function(e,t,r){var n=function(e,t,r,n){var i=u(e,e.VERTEX_SHADER,t),a=u(e,e.FRAGMENT_SHADER,r),o=e.createProgram();if(e.attachShader(o,i),e.attachShader(o,a),n)for(var s in n)e.bindAttribLocation(o,n[s],s);return e.linkProgram(o),e.getProgramParameter(o,e.LINK_STATUS)||(console.error("Pixi.js Error: Could not initialize shader."),console.error("gl.VALIDATE_STATUS",e.getProgramParameter(o,e.VALIDATE_STATUS)),console.error("gl.getError()",e.getError()),""!==e.getProgramInfoLog(o)&&console.warn("Pixi.js Warning: gl.getProgramInfoLog()",e.getProgramInfoLog(o)),e.deleteProgram(o),o=null),e.deleteShader(i),e.deleteShader(a),o},u=function(e,t,r){var n=e.createShader(t);return e.shaderSource(n,r),e.compileShader(n),e.getShaderParameter(n,e.COMPILE_STATUS)?n:(console.log(e.getShaderInfoLog(n)),null)};t.exports=n},{}],15:[function(e,t,r){var n=function(e,t){switch(e){case"float":return 0;case"vec2":return new Float32Array(2*t);case"vec3":return new Float32Array(3*t);case"vec4":return new Float32Array(4*t);case"int":case"sampler2D":return 0;case"ivec2":return new Int32Array(2*t);case"ivec3":return new Int32Array(3*t);case"ivec4":return new Int32Array(4*t);case"bool":return!1;case"bvec2":return i(2*t);case"bvec3":return i(3*t);case"bvec4":return i(4*t);case"mat2":return new Float32Array([1,0,0,1]);case"mat3":return new Float32Array([1,0,0,0,1,0,0,0,1]);case"mat4":return new Float32Array([1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1])}},i=function(e){for(var t=new Array(e),r=0;r<t.length;r++)t[r]=!1;return t};t.exports=n},{}],16:[function(e,t,r){var s=e("./mapType"),u=e("./mapSize"),n=function(e,t){for(var r={},n=e.getProgramParameter(t,e.ACTIVE_ATTRIBUTES),i=0;i<n;i++){var a=e.getActiveAttrib(t,i),o=s(e,a.type);r[a.name]={type:o,size:u(o),location:e.getAttribLocation(t,a.name),pointer:l}}return r},l=function(e,t,r,n){gl.vertexAttribPointer(this.location,this.size,e||gl.FLOAT,t||!1,r||0,n||0)};t.exports=n},{"./mapSize":20,"./mapType":21}],17:[function(e,t,r){var u=e("./mapType"),l=e("./defaultValue"),n=function(e,t){for(var r={},n=e.getProgramParameter(t,e.ACTIVE_UNIFORMS),i=0;i<n;i++){var a=e.getActiveUniform(t,i),o=a.name.replace(/\[.*?\]/,""),s=u(e,a.type);r[o]={type:s,size:a.size,location:e.getUniformLocation(t,o),value:l(s,a.size)}}return r};t.exports=n},{"./defaultValue":15,"./mapType":21}],18:[function(e,t,r){var n=function(e,t){var r={data:{}};r.gl=e;for(var n=Object.keys(t),i=0;i<n.length;i++){var a=n[i],o=a.split("."),s=o[o.length-1],u=f(o,r),l=t[a];u.data[s]=l,u.gl=e,Object.defineProperty(u,s,{get:c(s),set:h(s,l)})}return r},c=function(e){var t=i.replace("%%",e);return new Function(t)},h=function(e,t){var r,n=a.replace(/%%/g,e);return r=1===t.size?o[t.type]:s[t.type],r&&(n+="\nthis.gl."+r+";"),new Function("value",n)},f=function(e,t){for(var r=t,n=0;n<e.length-1;n++){var i=r[e[n]]||{data:{}};r[e[n]]=i,r=i}return r},i=["return this.data.%%.value;"].join("\n"),a=["this.data.%%.value = value;","var location = this.data.%%.location;"].join("\n"),o={float:"uniform1f(location, value)",vec2:"uniform2f(location, value[0], value[1])",vec3:"uniform3f(location, value[0], value[1], value[2])",vec4:"uniform4f(location, value[0], value[1], value[2], value[3])",int:"uniform1i(location, value)",ivec2:"uniform2i(location, value[0], value[1])",ivec3:"uniform3i(location, value[0], value[1], value[2])",ivec4:"uniform4i(location, value[0], value[1], value[2], value[3])",bool:"uniform1i(location, value)",bvec2:"uniform2i(location, value[0], value[1])",bvec3:"uniform3i(location, value[0], value[1], value[2])",bvec4:"uniform4i(location, value[0], value[1], value[2], value[3])",mat2:"uniformMatrix2fv(location, false, value)",mat3:"uniformMatrix3fv(location, false, value)",mat4:"uniformMatrix4fv(location, false, value)",sampler2D:"uniform1i(location, value)"},s={float:"uniform1fv(location, value)",vec2:"uniform2fv(location, value)",vec3:"uniform3fv(location, value)",vec4:"uniform4fv(location, value)",int:"uniform1iv(location, value)",ivec2:"uniform2iv(location, value)",ivec3:"uniform3iv(location, value)",ivec4:"uniform4iv(location, value)",bool:"uniform1iv(location, value)",bvec2:"uniform2iv(location, value)",bvec3:"uniform3iv(location, value)",bvec4:"uniform4iv(location, value)",sampler2D:"uniform1iv(location, value)"};t.exports=n},{}],19:[function(e,t,r){t.exports={compileProgram:e("./compileProgram"),defaultValue:e("./defaultValue"),extractAttributes:e("./extractAttributes"),extractUniforms:e("./extractUniforms"),generateUniformAccessObject:e("./generateUniformAccessObject"),setPrecision:e("./setPrecision"),mapSize:e("./mapSize"),mapType:e("./mapType")}},{"./compileProgram":14,"./defaultValue":15,"./extractAttributes":16,"./extractUniforms":17,"./generateUniformAccessObject":18,"./mapSize":20,"./mapType":21,"./setPrecision":22}],20:[function(e,t,r){var n=function(e){return i[e]},i={float:1,vec2:2,vec3:3,vec4:4,int:1,ivec2:2,ivec3:3,ivec4:4,bool:1,bvec2:2,bvec3:3,bvec4:4,mat2:4,mat3:9,mat4:16,sampler2D:1};t.exports=n},{}],21:[function(e,t,r){var n=function(e,t){if(!a){var r=Object.keys(o);a={};for(var n=0;n<r.length;++n){var i=r[n];a[e[i]]=o[i]}}return a[t]},a=null,o={FLOAT:"float",FLOAT_VEC2:"vec2",FLOAT_VEC3:"vec3",FLOAT_VEC4:"vec4",INT:"int",INT_VEC2:"ivec2",INT_VEC3:"ivec3",INT_VEC4:"ivec4",BOOL:"bool",BOOL_VEC2:"bvec2",BOOL_VEC3:"bvec3",BOOL_VEC4:"bvec4",FLOAT_MAT2:"mat2",FLOAT_MAT3:"mat3",FLOAT_MAT4:"mat4",SAMPLER_2D:"sampler2D"};t.exports=n},{}],22:[function(e,t,r){var n=function(e,t){return"precision"!==e.substring(0,9)?"precision "+t+" float;\n"+e:e};t.exports=n},{}],23:[function(e,t,l){(function(i){function a(e,t){for(var r=0,n=e.length-1;n>=0;n--){var i=e[n];"."===i?e.splice(n,1):".."===i?(e.splice(n,1),r++):r&&(e.splice(n,1),r--)}if(t)for(;r--;r)e.unshift("..");return e}function o(e,t){if(e.filter)return e.filter(t);for(var r=[],n=0;n<e.length;n++)t(e[n],n,e)&&r.push(e[n]);return r}var t=/^(\/?|)([\s\S]*?)((?:\.{1,2}|[^\/]+?|)(\.[^.\/]*|))(?:[\/]*)$/,s=function(e){return t.exec(e).slice(1)};l.resolve=function(){for(var e="",t=!1,r=arguments.length-1;r>=-1&&!t;r--){var n=r>=0?arguments[r]:i.cwd();if("string"!=typeof n)throw new TypeError("Arguments to path.resolve must be strings");n&&(e=n+"/"+e,t="/"===n.charAt(0))}return e=a(o(e.split("/"),function(e){return!!e}),!t).join("/"),(t?"/":"")+e||"."},l.normalize=function(e){var t=l.isAbsolute(e),r="/"===n(e,-1);return e=a(o(e.split("/"),function(e){return!!e}),!t).join("/"),e||t||(e="."),e&&r&&(e+="/"),(t?"/":"")+e},l.isAbsolute=function(e){return"/"===e.charAt(0)},l.join=function(){var e=Array.prototype.slice.call(arguments,0);return l.normalize(o(e,function(e,t){if("string"!=typeof e)throw new TypeError("Arguments to path.join must be strings");return e}).join("/"))},l.relative=function(e,t){function r(e){for(var t=0;t<e.length&&""===e[t];t++);for(var r=e.length-1;r>=0&&""===e[r];r--);return t>r?[]:e.slice(t,r-t+1)}e=l.resolve(e).substr(1),t=l.resolve(t).substr(1);for(var n=r(e.split("/")),i=r(t.split("/")),a=Math.min(n.length,i.length),o=a,s=0;s<a;s++)if(n[s]!==i[s]){o=s;break}for(var u=[],s=o;s<n.length;s++)u.push("..");return u=u.concat(i.slice(o)),u.join("/")},l.sep="/",l.delimiter=":",l.dirname=function(e){var t=s(e),r=t[0],n=t[1];return r||n?(n&&(n=n.substr(0,n.length-1)),r+n):"."},l.basename=function(e,t){var r=s(e)[2];return t&&r.substr(-1*t.length)===t&&(r=r.substr(0,r.length-t.length)),r},l.extname=function(e){return s(e)[3]};var n="b"==="ab".substr(-1)?function(e,t,r){return e.substr(t,r)}:function(e,t,r){return t<0&&(t=e.length+t),e.substr(t,r)}}).call(this,e("_process"))},{_process:24}],24:[function(e,t,r){function n(){throw new Error("setTimeout has not been defined")}function i(){throw new Error("clearTimeout has not been defined")}function a(t){if(h===setTimeout)return setTimeout(t,0);if((h===n||!h)&&setTimeout)return h=setTimeout,setTimeout(t,0);try{return h(t,0)}catch(e){try{return h.call(null,t,0)}catch(e){return h.call(this,t,0)}}}function o(t){if(f===clearTimeout)return clearTimeout(t);if((f===i||!f)&&clearTimeout)return f=clearTimeout,clearTimeout(t);try{return f(t)}catch(e){try{return f.call(null,t)}catch(e){return f.call(this,t)}}}function s(){m&&p&&(m=!1,p.length?v=p.concat(v):g=-1,v.length&&u())}function u(){if(!m){var e=a(s);m=!0;for(var t=v.length;t;){for(p=v,v=[];++g<t;)p&&p[g].run();g=-1,t=v.length}p=null,m=!1,o(e)}}function l(e,t){this.fun=e,this.array=t}function c(){}var h,f,d=t.exports={};!function(){try{h="function"==typeof setTimeout?setTimeout:n}catch(e){h=n}try{f="function"==typeof clearTimeout?clearTimeout:i}catch(e){f=i}}();var p,v=[],m=!1,g=-1;d.nextTick=function(e){var t=new Array(arguments.length-1);if(arguments.length>1)for(var r=1;r<arguments.length;r++)t[r-1]=arguments[r];v.push(new l(e,t)),1!==v.length||m||a(u)},l.prototype.run=function(){this.fun.apply(null,this.array)},d.title="browser",d.browser=!0,d.env={},d.argv=[],d.version="",d.versions={},d.on=c,d.addListener=c,d.once=c,d.off=c,d.removeListener=c,d.removeAllListeners=c,d.emit=c,d.prependListener=c,d.prependOnceListener=c,d.listeners=function(e){return[]},d.binding=function(e){throw new Error("process.binding is not supported")},d.cwd=function(){return"/"},d.chdir=function(e){throw new Error("process.chdir is not supported")},d.umask=function(){return 0}},{}],25:[function(e,N,F){(function(D){!function(e){function g(e){throw new RangeError(C[e])}function i(e,t){for(var r=e.length,n=[];r--;)n[r]=t(e[r]);return n}function t(e,t){var r=e.split("@"),n="";return r.length>1&&(n=r[0]+"@",e=r[1]),e=e.replace(P,"."),n+i(e.split("."),t).join(".")}function y(e){for(var t,r,n=[],i=0,a=e.length;i<a;)t=e.charCodeAt(i++),t>=55296&&t<=56319&&i<a?(r=e.charCodeAt(i++),56320==(64512&r)?n.push(((1023&t)<<10)+(1023&r)+65536):(n.push(t),i--)):n.push(t);return n}function m(e){return i(e,function(e){var t="";return e>65535&&(e-=65536,t+=I(e>>>10&1023|55296),e=56320|1023&e),t+=I(e)}).join("")}function x(e){return e-48<10?e-22:e-65<26?e-65:e-97<26?e-97:T}function b(e,t){return e+22+75*(e<26)-((0!=t)<<5)}function w(e,t,r){var n=0;for(e=r?L(e/d):e>>1,e+=L(e/t);e>O*M>>1;n+=T)e=L(e/O);return L(n+(O+1)*e/(e+f))}function r(e){var t,r,n,i,a,o,s,u,l,c,h=[],f=e.length,d=0,p=A,v=S;for(r=e.lastIndexOf(R),r<0&&(r=0),n=0;n<r;++n)e.charCodeAt(n)>=128&&g("not-basic"),h.push(e.charCodeAt(n));for(i=r>0?r+1:0;i<f;){for(a=d,o=1,s=T;i>=f&&g("invalid-input"),u=x(e.charCodeAt(i++)),(u>=T||u>L((_-d)/o))&&g("overflow"),d+=u*o,l=s<=v?E:s>=v+M?M:s-v,!(u<l);s+=T)c=T-l,o>L(_/c)&&g("overflow"),o*=c;t=h.length+1,v=w(d-a,t,0==a),L(d/t)>_-p&&g("overflow"),p+=L(d/t),d%=t,h.splice(d++,0,p)}return m(h)}function n(e){var t,r,n,i,a,o,s,u,l,c,h,f,d,p,v,m=[];for(e=y(e),f=e.length,t=A,r=0,a=S,o=0;o<f;++o)(h=e[o])<128&&m.push(I(h));for(n=i=m.length,i&&m.push(R);n<f;){for(s=_,o=0;o<f;++o)(h=e[o])>=t&&h<s&&(s=h);for(d=n+1,s-t>L((_-r)/d)&&g("overflow"),r+=(s-t)*d,t=s,o=0;o<f;++o)if(h=e[o],h<t&&++r>_&&g("overflow"),h==t){for(u=r,l=T;c=l<=a?E:l>=a+M?M:l-a,!(u<c);l+=T)v=u-c,p=T-c,m.push(I(b(c+v%p,0))),u=L(v/p);m.push(I(b(u,0))),a=w(r,d,n==i),r=0,++n}++r,++t}return m.join("")}function a(e){return t(e,function(e){return p.test(e)?r(e.slice(4).toLowerCase()):e})}function o(e){return t(e,function(e){return v.test(e)?"xn--"+n(e):e})}var s="object"==typeof F&&F&&!F.nodeType&&F,u="object"==typeof N&&N&&!N.nodeType&&N,l="object"==typeof D&&D;l.global!==l&&l.window!==l&&l.self!==l||(e=l);var c,h,_=2147483647,T=36,E=1,M=26,f=38,d=700,S=72,A=128,R="-",p=/^xn--/,v=/[^\x20-\x7E]/,P=/[\x2E\u3002\uFF0E\uFF61]/g,C={overflow:"Overflow: input needs wider integers to process","not-basic":"Illegal input >= 0x80 (not a basic code point)","invalid-input":"Invalid input"},O=T-E,L=Math.floor,I=String.fromCharCode;if(c={version:"1.4.1",ucs2:{decode:y,encode:m},decode:r,encode:n,toASCII:o,toUnicode:a},"function"==typeof B&&"object"==typeof B.amd&&B.amd)B("punycode",function(){return c});else if(s&&u)if(N.exports==s)u.exports=c;else for(h in c)c.hasOwnProperty(h)&&(s[h]=c[h]);else e.punycode=c}(this)}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],26:[function(e,t,r){"use strict";function v(e,t){return Object.prototype.hasOwnProperty.call(e,t)}t.exports=function(e,t,r,n){t=t||"&",r=r||"=";var i={};if("string"!=typeof e||0===e.length)return i;var a=/\+/g;e=e.split(t);var o=1e3;n&&"number"==typeof n.maxKeys&&(o=n.maxKeys);var s=e.length;o>0&&s>o&&(s=o);for(var u=0;u<s;++u){var l,c,h,f,d=e[u].replace(a,"%20"),p=d.indexOf(r);p>=0?(l=d.substr(0,p),c=d.substr(p+1)):(l=d,c=""),h=decodeURIComponent(l),f=decodeURIComponent(c),v(i,h)?m(i[h])?i[h].push(f):i[h]=[i[h],f]:i[h]=f}return i};var m=Array.isArray||function(e){return"[object Array]"===Object.prototype.toString.call(e)}},{}],27:[function(e,t,r){"use strict";function a(e,t){if(e.map)return e.map(t);for(var r=[],n=0;n<e.length;n++)r.push(t(e[n],n));return r}var o=function(e){switch(typeof e){case"string":return e;case"boolean":return e?"true":"false";case"number":return isFinite(e)?e:"";default:return""}};t.exports=function(r,n,i,e){return n=n||"&",i=i||"=",null===r&&(r=void 0),"object"==typeof r?a(u(r),function(e){var t=encodeURIComponent(o(e))+i;return s(r[e])?a(r[e],function(e){return t+encodeURIComponent(o(e))}).join(n):t+encodeURIComponent(o(r[e]))}).join(n):e?encodeURIComponent(o(e))+i+encodeURIComponent(o(r)):""};var s=Array.isArray||function(e){return"[object Array]"===Object.prototype.toString.call(e)},u=Object.keys||function(e){var t=[];for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.push(r);return t}},{}],28:[function(e,t,r){"use strict";r.decode=r.parse=e("./decode"),r.encode=r.stringify=e("./encode")},{"./decode":26,"./encode":27}],29:[function(e,t,r){"use strict";function A(){this.protocol=null,this.slashes=null,this.auth=null,this.host=null,this.port=null,this.hostname=null,this.hash=null,this.search=null,this.query=null,this.pathname=null,this.path=null,this.href=null}function n(e,t,r){if(e&&N.isObject(e)&&e instanceof A)return e;var n=new A;return n.parse(e,t,r),n}function i(e){return N.isString(e)&&(e=n(e)),e instanceof A?e.format():A.prototype.format.call(e)}function a(e,t){return n(e,!1,!0).resolve(t)}function o(e,t){return e?n(e,!1,!0).resolveObject(t):t}var D=e("punycode"),N=e("./util");r.parse=n,r.resolve=a,r.resolveObject=o,r.format=i,r.Url=A;var F=/^([a-z0-9.+-]+:)/i,s=/:[0-9]*$/,B=/^(\/\/?(?!\/)[^\?\s]*)(\?[^\s]*)?$/,u=["<",">",'"',"`"," ","\r","\n","\t"],l=["{","}","|","\\","^","`"].concat(u),U=["'"].concat(l),k=["%","/","?",";","#"].concat(U),j=["/","?","#"],z=/^[+a-z0-9A-Z_-]{0,63}$/,H=/^([+a-z0-9A-Z_-]{0,63})(.*)$/,G={javascript:!0,"javascript:":!0},V={javascript:!0,"javascript:":!0},W={http:!0,https:!0,ftp:!0,gopher:!0,file:!0,"http:":!0,"https:":!0,"ftp:":!0,"gopher:":!0,"file:":!0},q=e("querystring");A.prototype.parse=function(e,t,r){if(!N.isString(e))throw new TypeError("Parameter 'url' must be a string, not "+typeof e);var n=e.indexOf("?"),i=-1!==n&&n<e.indexOf("#")?"?":"#",a=e.split(i),o=/\\/g;a[0]=a[0].replace(o,"/"),e=a.join(i);var s=e;if(s=s.trim(),!r&&1===e.split("#").length){var u=B.exec(s);if(u)return this.path=s,this.href=s,this.pathname=u[1],u[2]?(this.search=u[2],this.query=t?q.parse(this.search.substr(1)):this.search.substr(1)):t&&(this.search="",this.query={}),this}var l=F.exec(s);if(l){l=l[0];var c=l.toLowerCase();this.protocol=c,s=s.substr(l.length)}if(r||l||s.match(/^\/\/[^@\/]+@[^@\/]+/)){var h="//"===s.substr(0,2);!h||l&&V[l]||(s=s.substr(2),this.slashes=!0)}if(!V[l]&&(h||l&&!W[l])){for(var f=-1,d=0;d<j.length;d++){var p=s.indexOf(j[d]);-1!==p&&(-1===f||p<f)&&(f=p)}var v,m;m=-1===f?s.lastIndexOf("@"):s.lastIndexOf("@",f),-1!==m&&(v=s.slice(0,m),s=s.slice(m+1),this.auth=decodeURIComponent(v)),f=-1;for(var d=0;d<k.length;d++){var p=s.indexOf(k[d]);-1!==p&&(-1===f||p<f)&&(f=p)}-1===f&&(f=s.length),this.host=s.slice(0,f),s=s.slice(f),this.parseHost(),this.hostname=this.hostname||"";var g="["===this.hostname[0]&&"]"===this.hostname[this.hostname.length-1];if(!g)for(var y=this.hostname.split(/\./),d=0,x=y.length;d<x;d++){var b=y[d];if(b&&!b.match(z)){for(var w="",_=0,T=b.length;_<T;_++)b.charCodeAt(_)>127?w+="x":w+=b[_];if(!w.match(z)){var E=y.slice(0,d),M=y.slice(d+1),S=b.match(H);S&&(E.push(S[1]),M.unshift(S[2])),M.length&&(s="/"+M.join(".")+s),this.hostname=E.join(".");break}}}this.hostname.length>255?this.hostname="":this.hostname=this.hostname.toLowerCase(),g||(this.hostname=D.toASCII(this.hostname));var A=this.port?":"+this.port:"",R=this.hostname||"";this.host=R+A,this.href+=this.host,g&&(this.hostname=this.hostname.substr(1,this.hostname.length-2),"/"!==s[0]&&(s="/"+s))}if(!G[c])for(var d=0,x=U.length;d<x;d++){var P=U[d];if(-1!==s.indexOf(P)){var C=encodeURIComponent(P);C===P&&(C=escape(P)),s=s.split(P).join(C)}}var O=s.indexOf("#");-1!==O&&(this.hash=s.substr(O),s=s.slice(0,O));var L=s.indexOf("?");if(-1!==L?(this.search=s.substr(L),this.query=s.substr(L+1),t&&(this.query=q.parse(this.query)),s=s.slice(0,L)):t&&(this.search="",this.query={}),s&&(this.pathname=s),W[c]&&this.hostname&&!this.pathname&&(this.pathname="/"),this.pathname||this.search){var A=this.pathname||"",I=this.search||"";this.path=A+I}return this.href=this.format(),this},A.prototype.format=function(){var e=this.auth||"";e&&(e=encodeURIComponent(e),e=e.replace(/%3A/i,":"),e+="@");var t=this.protocol||"",r=this.pathname||"",n=this.hash||"",i=!1,a="";this.host?i=e+this.host:this.hostname&&(i=e+(-1===this.hostname.indexOf(":")?this.hostname:"["+this.hostname+"]"),this.port&&(i+=":"+this.port)),this.query&&N.isObject(this.query)&&Object.keys(this.query).length&&(a=q.stringify(this.query));var o=this.search||a&&"?"+a||"";return t&&":"!==t.substr(-1)&&(t+=":"),this.slashes||(!t||W[t])&&!1!==i?(i="//"+(i||""),r&&"/"!==r.charAt(0)&&(r="/"+r)):i||(i=""),n&&"#"!==n.charAt(0)&&(n="#"+n),o&&"?"!==o.charAt(0)&&(o="?"+o),r=r.replace(/[?#]/g,function(e){return encodeURIComponent(e)}),o=o.replace("#","%23"),t+i+r+o+n},A.prototype.resolve=function(e){return this.resolveObject(n(e,!1,!0)).format()},A.prototype.resolveObject=function(e){if(N.isString(e)){var t=new A;t.parse(e,!1,!0),e=t}for(var r=new A,n=Object.keys(this),i=0;i<n.length;i++){var a=n[i];r[a]=this[a]}if(r.hash=e.hash,""===e.href)return r.href=r.format(),r;if(e.slashes&&!e.protocol){for(var o=Object.keys(e),s=0;s<o.length;s++){var u=o[s];"protocol"!==u&&(r[u]=e[u])}return W[r.protocol]&&r.hostname&&!r.pathname&&(r.path=r.pathname="/"),r.href=r.format(),r}if(e.protocol&&e.protocol!==r.protocol){if(!W[e.protocol]){for(var l=Object.keys(e),c=0;c<l.length;c++){var h=l[c];r[h]=e[h]}return r.href=r.format(),r}if(r.protocol=e.protocol,e.host||V[e.protocol])r.pathname=e.pathname;else{for(var f=(e.pathname||"").split("/");f.length&&!(e.host=f.shift()););e.host||(e.host=""),e.hostname||(e.hostname=""),""!==f[0]&&f.unshift(""),f.length<2&&f.unshift(""),r.pathname=f.join("/")}if(r.search=e.search,r.query=e.query,r.host=e.host||"",r.auth=e.auth,r.hostname=e.hostname||e.host,r.port=e.port,r.pathname||r.search){var d=r.pathname||"",p=r.search||"";r.path=d+p}return r.slashes=r.slashes||e.slashes,r.href=r.format(),r}var v=r.pathname&&"/"===r.pathname.charAt(0),m=e.host||e.pathname&&"/"===e.pathname.charAt(0),g=m||v||r.host&&e.pathname,y=g,x=r.pathname&&r.pathname.split("/")||[],f=e.pathname&&e.pathname.split("/")||[],b=r.protocol&&!W[r.protocol];if(b&&(r.hostname="",r.port=null,r.host&&(""===x[0]?x[0]=r.host:x.unshift(r.host)),r.host="",e.protocol&&(e.hostname=null,e.port=null,e.host&&(""===f[0]?f[0]=e.host:f.unshift(e.host)),e.host=null),g=g&&(""===f[0]||""===x[0])),m)r.host=e.host||""===e.host?e.host:r.host,r.hostname=e.hostname||""===e.hostname?e.hostname:r.hostname,r.search=e.search,r.query=e.query,x=f;else if(f.length)x||(x=[]),x.pop(),x=x.concat(f),r.search=e.search,r.query=e.query;else if(!N.isNullOrUndefined(e.search)){if(b){r.hostname=r.host=x.shift();var w=!!(r.host&&r.host.indexOf("@")>0)&&r.host.split("@");w&&(r.auth=w.shift(),r.host=r.hostname=w.shift())}return r.search=e.search,r.query=e.query,N.isNull(r.pathname)&&N.isNull(r.search)||(r.path=(r.pathname?r.pathname:"")+(r.search?r.search:"")),r.href=r.format(),r}if(!x.length)return r.pathname=null,r.search?r.path="/"+r.search:r.path=null,r.href=r.format(),r;for(var _=x.slice(-1)[0],T=(r.host||e.host||x.length>1)&&("."===_||".."===_)||""===_,E=0,M=x.length;M>=0;M--)_=x[M],"."===_?x.splice(M,1):".."===_?(x.splice(M,1),E++):E&&(x.splice(M,1),E--);if(!g&&!y)for(;E--;E)x.unshift("..");!g||""===x[0]||x[0]&&"/"===x[0].charAt(0)||x.unshift(""),T&&"/"!==x.join("/").substr(-1)&&x.push("");var S=""===x[0]||x[0]&&"/"===x[0].charAt(0);if(b){r.hostname=r.host=S?"":x.length?x.shift():"";var w=!!(r.host&&r.host.indexOf("@")>0)&&r.host.split("@");w&&(r.auth=w.shift(),r.host=r.hostname=w.shift())}return g=g||r.host&&x.length,g&&!S&&x.unshift(""),x.length?r.pathname=x.join("/"):(r.pathname=null,r.path=null),N.isNull(r.pathname)&&N.isNull(r.search)||(r.path=(r.pathname?r.pathname:"")+(r.search?r.search:"")),r.auth=e.auth||r.auth,r.slashes=r.slashes||e.slashes,r.href=r.format(),r},A.prototype.parseHost=function(){var e=this.host,t=s.exec(e);t&&(t=t[0],":"!==t&&(this.port=t.substr(1)),e=e.substr(0,e.length-t.length)),e&&(this.hostname=e)}},{"./util":30,punycode:25,querystring:28}],30:[function(e,t,r){"use strict";t.exports={isString:function(e){return"string"==typeof e},isObject:function(e){return"object"==typeof e&&null!==e},isNull:function(e){return null===e},isNullOrUndefined:function(e){return null==e}}},{}],31:[function(e,t,r){"use strict";t.exports=function(e,t,r){var n,i=e.length;if(!(t>=i||0===r)){r=t+r>i?i-t:r;var a=i-r;for(n=t;n<a;++n)e[n]=e[n+r];e.length=a}}},{}],32:[function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}r.__esModule=!0;var h="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},a=e("mini-signals"),o=n(a),s=e("parse-uri"),u=n(s),l=e("./async"),c=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t.default=e,t}(l),f=e("./Resource"),d=n(f),p=/(#[\w-]+)?$/,v=function(){function n(){var r=this,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:10;i(this,n),this.baseUrl=e,this.progress=0,this.loading=!1,this.defaultQueryString="",this._beforeMiddleware=[],this._afterMiddleware=[],this._resourcesParsing=[],this._boundLoadResource=function(e,t){return r._loadResource(e,t)},this._queue=c.queue(this._boundLoadResource,t),this._queue.pause(),this.resources={},this.onProgress=new o.default,this.onError=new o.default,this.onLoad=new o.default,this.onStart=new o.default,this.onComplete=new o.default}return n.prototype.add=function(e,t,r,n){if(Array.isArray(e)){for(var i=0;i<e.length;++i)this.add(e[i]);return this}if("object"===(void 0===e?"undefined":h(e))&&(n=t||e.callback||e.onComplete,r=e,t=e.url,e=e.name||e.key||e.url),"string"!=typeof t&&(n=r,r=t,t=e),"string"!=typeof t)throw new Error("No url passed to add resource to loader.");if("function"==typeof r&&(n=r,r=null),this.loading&&(!r||!r.parentResource))throw new Error("Cannot add resources while the loader is running.");if(this.resources[e])throw new Error('Resource named "'+e+'" already exists.');if(t=this._prepareUrl(t),this.resources[e]=new d.default(e,t,r),"function"==typeof n&&this.resources[e].onAfterMiddleware.once(n),this.loading){for(var a=r.parentResource,o=[],s=0;s<a.children.length;++s)a.children[s].isComplete||o.push(a.children[s]);var u=a.progressChunk*(o.length+1),l=u/(o.length+2);a.children.push(this.resources[e]),a.progressChunk=l;for(var c=0;c<o.length;++c)o[c].progressChunk=l;this.resources[e].progressChunk=l}return this._queue.push(this.resources[e]),this},n.prototype.pre=function(e){return this._beforeMiddleware.push(e),this},n.prototype.use=function(e){return this._afterMiddleware.push(e),this},n.prototype.reset=function(){this.progress=0,this.loading=!1,this._queue.kill(),this._queue.pause();for(var e in this.resources){var t=this.resources[e];t._onLoadBinding&&t._onLoadBinding.detach(),t.isLoading&&t.abort()}return this.resources={},this},n.prototype.load=function(e){if("function"==typeof e&&this.onComplete.once(e),this.loading)return this;for(var t=100/this._queue._tasks.length,r=0;r<this._queue._tasks.length;++r)this._queue._tasks[r].data.progressChunk=t;return this.loading=!0,this.onStart.dispatch(this),this._queue.resume(),this},n.prototype._prepareUrl=function(e){var t=(0,u.default)(e,{strictMode:!0}),r=void 0;if(r=t.protocol||!t.path||0===e.indexOf("//")?e:this.baseUrl.length&&this.baseUrl.lastIndexOf("/")!==this.baseUrl.length-1&&"/"!==e.charAt(0)?this.baseUrl+"/"+e:this.baseUrl+e,this.defaultQueryString){var n=p.exec(r)[0];r=r.substr(0,r.length-n.length),-1!==r.indexOf("?")?r+="&"+this.defaultQueryString:r+="?"+this.defaultQueryString,r+=n}return r},n.prototype._loadResource=function(r,e){var n=this;r._dequeue=e,c.eachSeries(this._beforeMiddleware,function(e,t){e.call(n,r,function(){t(r.isComplete?{}:null)})},function(){r.isComplete?n._onLoad(r):(r._onLoadBinding=r.onComplete.once(n._onLoad,n),r.load())},!0)},n.prototype._onComplete=function(){this.loading=!1,this.onComplete.dispatch(this,this.resources)},n.prototype._onLoad=function(r){var n=this;r._onLoadBinding=null,this._resourcesParsing.push(r),r._dequeue(),c.eachSeries(this._afterMiddleware,function(e,t){e.call(n,r,t)},function(){r.onAfterMiddleware.dispatch(r),n.progress+=r.progressChunk,n.onProgress.dispatch(n,r),r.error?n.onError.dispatch(r.error,n,r):n.onLoad.dispatch(n,r),n._resourcesParsing.splice(n._resourcesParsing.indexOf(r),1),n._queue.idle()&&0===n._resourcesParsing.length&&(n.progress=100,n._onComplete())},!0)},n}();r.default=v},{"./Resource":33,"./async":34,"mini-signals":38,"parse-uri":39}],33:[function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(){}function s(e,t,r){t&&0===t.indexOf(".")&&(t=t.substring(1)),t&&(e[t]=r)}function u(e){return e.toString().replace("object ","")}r.__esModule=!0;var l=function(){function n(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(e,t,r){return t&&n(e.prototype,t),r&&n(e,r),e}}(),a=e("parse-uri"),c=n(a),h=e("mini-signals"),f=n(h),d=!(!window.XDomainRequest||"withCredentials"in new XMLHttpRequest),p=null,v=function(){function a(e,t,r){if(i(this,a),"string"!=typeof e||"string"!=typeof t)throw new Error("Both name and url are required for constructing a resource.");r=r||{},this._flags=0,this._setFlag(a.STATUS_FLAGS.DATA_URL,0===t.indexOf("data:")),this.name=e,this.url=t,this.extension=this._getExtension(),this.data=null,this.crossOrigin=!0===r.crossOrigin?"anonymous":r.crossOrigin,this.loadType=r.loadType||this._determineLoadType(),this.xhrType=r.xhrType,this.metadata=r.metadata||{},this.error=null,this.xhr=null,this.children=[],this.type=a.TYPE.UNKNOWN,this.progressChunk=0,this._dequeue=o,this._onLoadBinding=null,this._boundComplete=this.complete.bind(this),this._boundOnError=this._onError.bind(this),this._boundOnProgress=this._onProgress.bind(this),this._boundXhrOnError=this._xhrOnError.bind(this),this._boundXhrOnAbort=this._xhrOnAbort.bind(this),this._boundXhrOnLoad=this._xhrOnLoad.bind(this),this._boundXdrOnTimeout=this._xdrOnTimeout.bind(this),this.onStart=new f.default,this.onProgress=new f.default,this.onComplete=new f.default,this.onAfterMiddleware=new f.default}return a.setExtensionLoadType=function(e,t){s(a._loadTypeMap,e,t)},a.setExtensionXhrType=function(e,t){s(a._xhrTypeMap,e,t)},a.prototype.complete=function(){if(this.data&&this.data.removeEventListener&&(this.data.removeEventListener("error",this._boundOnError,!1),this.data.removeEventListener("load",this._boundComplete,!1),this.data.removeEventListener("progress",this._boundOnProgress,!1),this.data.removeEventListener("canplaythrough",this._boundComplete,!1)),this.xhr&&(this.xhr.removeEventListener?(this.xhr.removeEventListener("error",this._boundXhrOnError,!1),this.xhr.removeEventListener("abort",this._boundXhrOnAbort,!1),this.xhr.removeEventListener("progress",this._boundOnProgress,!1),this.xhr.removeEventListener("load",this._boundXhrOnLoad,!1)):(this.xhr.onerror=null,this.xhr.ontimeout=null,this.xhr.onprogress=null,this.xhr.onload=null)),this.isComplete)throw new Error("Complete called again for an already completed resource.");this._setFlag(a.STATUS_FLAGS.COMPLETE,!0),this._setFlag(a.STATUS_FLAGS.LOADING,!1),this.onComplete.dispatch(this)},a.prototype.abort=function(e){if(!this.error){if(this.error=new Error(e),this.xhr)this.xhr.abort();else if(this.xdr)this.xdr.abort();else if(this.data)if(this.data.src)this.data.src=a.EMPTY_GIF;else for(;this.data.firstChild;)this.data.removeChild(this.data.firstChild);this.complete()}},a.prototype.load=function(e){var t=this;if(!this.isLoading){if(this.isComplete)return void(e&&setTimeout(function(){return e(t)},1));switch(e&&this.onComplete.once(e),this._setFlag(a.STATUS_FLAGS.LOADING,!0),this.onStart.dispatch(this),!1!==this.crossOrigin&&"string"==typeof this.crossOrigin||(this.crossOrigin=this._determineCrossOrigin(this.url)),this.loadType){case a.LOAD_TYPE.IMAGE:this.type=a.TYPE.IMAGE,this._loadElement("image");break;case a.LOAD_TYPE.AUDIO:this.type=a.TYPE.AUDIO,this._loadSourceElement("audio");break;case a.LOAD_TYPE.VIDEO:this.type=a.TYPE.VIDEO,this._loadSourceElement("video");break;case a.LOAD_TYPE.XHR:default:d&&this.crossOrigin?this._loadXdr():this._loadXhr()}}},a.prototype._hasFlag=function(e){return!!(this._flags&e)},a.prototype._setFlag=function(e,t){this._flags=t?this._flags|e:this._flags&~e},a.prototype._loadElement=function(e){this.metadata.loadElement?this.data=this.metadata.loadElement:"image"===e&&void 0!==window.Image?this.data=new Image:this.data=document.createElement(e),this.crossOrigin&&(this.data.crossOrigin=this.crossOrigin),this.metadata.skipSource||(this.data.src=this.url),this.data.addEventListener("error",this._boundOnError,!1),this.data.addEventListener("load",this._boundComplete,!1),this.data.addEventListener("progress",this._boundOnProgress,!1)},a.prototype._loadSourceElement=function(e){if(this.metadata.loadElement?this.data=this.metadata.loadElement:"audio"===e&&void 0!==window.Audio?this.data=new Audio:this.data=document.createElement(e),null===this.data)return void this.abort("Unsupported element: "+e);if(!this.metadata.skipSource)if(navigator.isCocoonJS)this.data.src=Array.isArray(this.url)?this.url[0]:this.url;else if(Array.isArray(this.url))for(var t=this.metadata.mimeType,r=0;r<this.url.length;++r)this.data.appendChild(this._createSource(e,this.url[r],Array.isArray(t)?t[r]:t));else{var n=this.metadata.mimeType;this.data.appendChild(this._createSource(e,this.url,Array.isArray(n)?n[0]:n))}this.data.addEventListener("error",this._boundOnError,!1),this.data.addEventListener("load",this._boundComplete,!1),this.data.addEventListener("progress",this._boundOnProgress,!1),this.data.addEventListener("canplaythrough",this._boundComplete,!1),this.data.load()},a.prototype._loadXhr=function(){"string"!=typeof this.xhrType&&(this.xhrType=this._determineXhrType());var e=this.xhr=new XMLHttpRequest;e.open("GET",this.url,!0),this.xhrType===a.XHR_RESPONSE_TYPE.JSON||this.xhrType===a.XHR_RESPONSE_TYPE.DOCUMENT?e.responseType=a.XHR_RESPONSE_TYPE.TEXT:e.responseType=this.xhrType,e.addEventListener("error",this._boundXhrOnError,!1),e.addEventListener("abort",this._boundXhrOnAbort,!1),e.addEventListener("progress",this._boundOnProgress,!1),e.addEventListener("load",this._boundXhrOnLoad,!1),e.send()},a.prototype._loadXdr=function(){"string"!=typeof this.xhrType&&(this.xhrType=this._determineXhrType());var e=this.xhr=new XDomainRequest;e.timeout=5e3,e.onerror=this._boundXhrOnError,e.ontimeout=this._boundXdrOnTimeout,e.onprogress=this._boundOnProgress,e.onload=this._boundXhrOnLoad,e.open("GET",this.url,!0),setTimeout(function(){return e.send()},1)},a.prototype._createSource=function(e,t,r){r||(r=e+"/"+this._getExtension(t));var n=document.createElement("source");return n.src=t,n.type=r,n},a.prototype._onError=function(e){this.abort("Failed to load element using: "+e.target.nodeName)},a.prototype._onProgress=function(e){e&&e.lengthComputable&&this.onProgress.dispatch(this,e.loaded/e.total)},a.prototype._xhrOnError=function(){var e=this.xhr;this.abort(u(e)+" Request failed. Status: "+e.status+', text: "'+e.statusText+'"')},a.prototype._xhrOnAbort=function(){this.abort(u(this.xhr)+" Request was aborted by the user.")},a.prototype._xdrOnTimeout=function(){this.abort(u(this.xhr)+" Request timed out.")},a.prototype._xhrOnLoad=function(){var e=this.xhr,t="",r=void 0===e.status?200:e.status;if(""!==e.responseType&&"text"!==e.responseType&&void 0!==e.responseType||(t=e.responseText),0===r&&t.length>0?r=200:1223===r&&(r=204),2!=(r/100|0))return void this.abort("["+e.status+"] "+e.statusText+": "+e.responseURL);if(this.xhrType===a.XHR_RESPONSE_TYPE.TEXT)this.data=t,this.type=a.TYPE.TEXT;else if(this.xhrType===a.XHR_RESPONSE_TYPE.JSON)try{this.data=JSON.parse(t),this.type=a.TYPE.JSON}catch(e){return void this.abort("Error trying to parse loaded json: "+e)}else if(this.xhrType===a.XHR_RESPONSE_TYPE.DOCUMENT)try{if(window.DOMParser){var n=new DOMParser;this.data=n.parseFromString(t,"text/xml")}else{var i=document.createElement("div");i.innerHTML=t,this.data=i}this.type=a.TYPE.XML}catch(e){return void this.abort("Error trying to parse loaded xml: "+e)}else this.data=e.response||t;this.complete()},a.prototype._determineCrossOrigin=function(e,t){if(0===e.indexOf("data:"))return"";t=t||window.location,p||(p=document.createElement("a")),p.href=e,e=(0,c.default)(p.href,{strictMode:!0});var r=!e.port&&""===t.port||e.port===t.port,n=e.protocol?e.protocol+":":"";return e.host===t.hostname&&r&&n===t.protocol?"":"anonymous"},a.prototype._determineXhrType=function(){return a._xhrTypeMap[this.extension]||a.XHR_RESPONSE_TYPE.TEXT},a.prototype._determineLoadType=function(){return a._loadTypeMap[this.extension]||a.LOAD_TYPE.XHR},a.prototype._getExtension=function(){var e=this.url,t="";if(this.isDataUrl){var r=e.indexOf("/");t=e.substring(r+1,e.indexOf(";",r))}else{var n=e.indexOf("?"),i=e.indexOf("#"),a=Math.min(n>-1?n:e.length,i>-1?i:e.length);e=e.substring(0,a),t=e.substring(e.lastIndexOf(".")+1)}return t.toLowerCase()},a.prototype._getMimeFromXhrType=function(e){switch(e){case a.XHR_RESPONSE_TYPE.BUFFER:return"application/octet-binary";case a.XHR_RESPONSE_TYPE.BLOB:return"application/blob";case a.XHR_RESPONSE_TYPE.DOCUMENT:return"application/xml";case a.XHR_RESPONSE_TYPE.JSON:return"application/json";case a.XHR_RESPONSE_TYPE.DEFAULT:case a.XHR_RESPONSE_TYPE.TEXT:default:return"text/plain"}},l(a,[{key:"isDataUrl",get:function(){return this._hasFlag(a.STATUS_FLAGS.DATA_URL)}},{key:"isComplete",get:function(){return this._hasFlag(a.STATUS_FLAGS.COMPLETE)}},{key:"isLoading",get:function(){return this._hasFlag(a.STATUS_FLAGS.LOADING)}}]),a}();r.default=v,v.STATUS_FLAGS={NONE:0,DATA_URL:1,COMPLETE:2,LOADING:4},v.TYPE={UNKNOWN:0,JSON:1,XML:2,IMAGE:3,AUDIO:4,VIDEO:5,TEXT:6},v.LOAD_TYPE={XHR:1,IMAGE:2,AUDIO:3,VIDEO:4},v.XHR_RESPONSE_TYPE={DEFAULT:"text",BUFFER:"arraybuffer",BLOB:"blob",DOCUMENT:"document",JSON:"json",TEXT:"text"},v._loadTypeMap={gif:v.LOAD_TYPE.IMAGE,png:v.LOAD_TYPE.IMAGE,bmp:v.LOAD_TYPE.IMAGE,jpg:v.LOAD_TYPE.IMAGE,jpeg:v.LOAD_TYPE.IMAGE,tif:v.LOAD_TYPE.IMAGE,tiff:v.LOAD_TYPE.IMAGE,webp:v.LOAD_TYPE.IMAGE,tga:v.LOAD_TYPE.IMAGE,svg:v.LOAD_TYPE.IMAGE,"svg+xml":v.LOAD_TYPE.IMAGE,mp3:v.LOAD_TYPE.AUDIO,ogg:v.LOAD_TYPE.AUDIO,wav:v.LOAD_TYPE.AUDIO,mp4:v.LOAD_TYPE.VIDEO,webm:v.LOAD_TYPE.VIDEO},v._xhrTypeMap={xhtml:v.XHR_RESPONSE_TYPE.DOCUMENT,html:v.XHR_RESPONSE_TYPE.DOCUMENT,htm:v.XHR_RESPONSE_TYPE.DOCUMENT,xml:v.XHR_RESPONSE_TYPE.DOCUMENT,tmx:v.XHR_RESPONSE_TYPE.DOCUMENT,svg:v.XHR_RESPONSE_TYPE.DOCUMENT,tsx:v.XHR_RESPONSE_TYPE.DOCUMENT,gif:v.XHR_RESPONSE_TYPE.BLOB,png:v.XHR_RESPONSE_TYPE.BLOB,bmp:v.XHR_RESPONSE_TYPE.BLOB,jpg:v.XHR_RESPONSE_TYPE.BLOB,jpeg:v.XHR_RESPONSE_TYPE.BLOB,tif:v.XHR_RESPONSE_TYPE.BLOB,tiff:v.XHR_RESPONSE_TYPE.BLOB,webp:v.XHR_RESPONSE_TYPE.BLOB,tga:v.XHR_RESPONSE_TYPE.BLOB,json:v.XHR_RESPONSE_TYPE.JSON,text:v.XHR_RESPONSE_TYPE.TEXT,txt:v.XHR_RESPONSE_TYPE.TEXT,ttf:v.XHR_RESPONSE_TYPE.BUFFER,otf:v.XHR_RESPONSE_TYPE.BUFFER},v.EMPTY_GIF="data:image/gif;base64,R0lGODlhAQABAIAAAP///wAAACH5BAEAAAAALAAAAAABAAEAAAICRAEAOw=="},{"mini-signals":38,"parse-uri":39}],34:[function(e,t,r){"use strict";function o(){}function n(r,n,i,a){var o=0,s=r.length;!function e(t){if(t||o===s)return void(i&&i(t));a?setTimeout(function(){n(r[o++],e)},1):n(r[o++],e)}()}function s(t){return function(){if(null===t)throw new Error("Callback was already called.");var e=t;t=null,e.apply(this,arguments)}}function i(t,e){function r(e,t,r){if(null!=r&&"function"!=typeof r)throw new Error("task callback must be a function");if(a.started=!0,null==e&&a.idle())return void setTimeout(function(){return a.drain()},1);var n={data:e,callback:"function"==typeof r?r:o};t?a._tasks.unshift(n):a._tasks.push(n),setTimeout(function(){return a.process()},1)}function n(e){return function(){i-=1,e.callback.apply(e,arguments),null!=arguments[0]&&a.error(arguments[0],e.data),i<=a.concurrency-a.buffer&&a.unsaturated(),a.idle()&&a.drain(),a.process()}}if(null==e)e=1;else if(0===e)throw new Error("Concurrency must not be zero");var i=0,a={_tasks:[],concurrency:e,saturated:o,unsaturated:o,buffer:e/4,empty:o,drain:o,error:o,started:!1,paused:!1,push:function(e,t){r(e,!1,t)},kill:function(){i=0,a.drain=o,a.started=!1,a._tasks=[]},unshift:function(e,t){r(e,!0,t)},process:function(){for(;!a.paused&&i<a.concurrency&&a._tasks.length;){var e=a._tasks.shift();0===a._tasks.length&&a.empty(),i+=1,i===a.concurrency&&a.saturated(),t(e.data,s(n(e)))}},length:function(){return a._tasks.length},running:function(){return i},idle:function(){return a._tasks.length+i===0},pause:function(){!0!==a.paused&&(a.paused=!0)},resume:function(){if(!1!==a.paused){a.paused=!1;for(var e=1;e<=a.concurrency;e++)a.process()}}};return a}r.__esModule=!0,r.eachSeries=n,r.queue=i},{}],35:[function(e,t,r){"use strict";function n(e){for(var t="",r=0;r<e.length;){for(var n=[0,0,0],i=[0,0,0,0],a=0;a<n.length;++a)r<e.length?n[a]=255&e.charCodeAt(r++):n[a]=0;i[0]=n[0]>>2,i[1]=(3&n[0])<<4|n[1]>>4,i[2]=(15&n[1])<<2|n[2]>>6,i[3]=63&n[2];switch(r-(e.length-1)){case 2:i[3]=64,i[2]=64;break;case 1:i[3]=64}for(var o=0;o<i.length;++o)t+=s.charAt(i[o])}return t}r.__esModule=!0,r.encodeBinary=n;var s="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/="},{}],36:[function(e,t,r){"use strict";var n=e("./Loader").default,i=e("./Resource").default,a=e("./async"),o=e("./b64");n.Resource=i,n.async=a,n.base64=o,t.exports=n,t.exports.default=n},{"./Loader":32,"./Resource":33,"./async":34,"./b64":35}],37:[function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function i(){return function(t,r){if(!t.data)return void r();if(t.xhr&&t.xhrType===s.default.XHR_RESPONSE_TYPE.BLOB)if(window.Blob&&"string"!=typeof t.data){if(0===t.data.type.indexOf("image")){var e=function(){var e=c.createObjectURL(t.data);return t.blob=t.data,t.data=new Image,t.data.src=e,t.type=s.default.TYPE.IMAGE,t.data.onload=function(){c.revokeObjectURL(e),t.data.onload=null,r()},{v:void 0}}();if("object"===(void 0===e?"undefined":a(e)))return e.v}}else{var n=t.xhr.getResponseHeader("content-type");if(n&&0===n.indexOf("image"))return t.data=new Image,t.data.src="data:"+n+";base64,"+l.default.encodeBinary(t.xhr.responseText),t.type=s.default.TYPE.IMAGE,void(t.data.onload=function(){t.data.onload=null,r()})}r()}}r.__esModule=!0;var a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};r.blobMiddlewareFactory=i;var o=e("../../Resource"),s=n(o),u=e("../../b64"),l=n(u),c=window.URL||window.webkitURL},{"../../Resource":33,"../../b64":35}],38:[function(e,t,r){"use strict";function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function n(e,t){return e._head?(e._tail._next=t,t._prev=e._tail,e._tail=t):(e._head=t,e._tail=t),t._owner=e,t}Object.defineProperty(r,"__esModule",{value:!0});var a=function(){function n(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(e,t,r){return t&&n(e.prototype,t),r&&n(e,r),e}}(),o=function(){function n(e,t,r){void 0===t&&(t=!1),i(this,n),this._fn=e,this._once=t,this._thisArg=r,this._next=this._prev=this._owner=null}return a(n,[{key:"detach",value:function(){return null!==this._owner&&(this._owner.detach(this),!0)}}]),n}(),s=function(){function e(){i(this,e),this._head=this._tail=void 0}return a(e,[{key:"handlers",value:function(){var e=!(arguments.length<=0||void 0===arguments[0])&&arguments[0],t=this._head;if(e)return!!t;for(var r=[];t;)r.push(t),t=t._next;return r}},{key:"has",value:function(e){if(!(e instanceof o))throw new Error("MiniSignal#has(): First arg must be a MiniSignalBinding object.");return e._owner===this}},{key:"dispatch",value:function(){var e=this._head;if(!e)return!1;for(;e;)e._once&&this.detach(e),e._fn.apply(e._thisArg,arguments),e=e._next;return!0}},{key:"add",value:function(e){var t=arguments.length<=1||void 0===arguments[1]?null:arguments[1];if("function"!=typeof e)throw new Error("MiniSignal#add(): First arg must be a Function.");return n(this,new o(e,!1,t))}},{key:"once",value:function(e){var t=arguments.length<=1||void 0===arguments[1]?null:arguments[1];if("function"!=typeof e)throw new Error("MiniSignal#once(): First arg must be a Function.");return n(this,new o(e,!0,t))}},{key:"detach",value:function(e){if(!(e instanceof o))throw new Error("MiniSignal#detach(): First arg must be a MiniSignalBinding object.");return e._owner!==this?this:(e._prev&&(e._prev._next=e._next),e._next&&(e._next._prev=e._prev),e===this._head?(this._head=e._next,null===e._next&&(this._tail=null)):e===this._tail&&(this._tail=e._prev,this._tail._next=null),e._owner=null,this)}},{key:"detachAll",value:function(){var e=this._head;if(!e)return this;for(this._head=this._tail=null;e;)e._owner=null,e=e._next;return this}}]),e}();s.MiniSignalBinding=o,r.default=s,t.exports=r.default},{}],39:[function(e,t,r){"use strict";t.exports=function(e,t){t=t||{};for(var n={key:["source","protocol","authority","userInfo","user","password","host","port","relative","path","directory","file","query","anchor"],q:{name:"queryKey",parser:/(?:^|&)([^&=]*)=?([^&]*)/g},parser:{strict:/^(?:([^:\/?#]+):)?(?:\/\/((?:(([^:@]*)(?::([^:@]*))?)?@)?([^:\/?#]*)(?::(\d*))?))?((((?:[^?#\/]*\/)*)([^?#]*))(?:\?([^#]*))?(?:#(.*))?)/,loose:/^(?:(?![^:@]+:[^:@\/]*@)([^:\/?#.]+):)?(?:\/\/)?((?:(([^:@]*)(?::([^:@]*))?)?@)?([^:\/?#]*)(?::(\d*))?)(((\/(?:[^?#](?![^?#\/]*\.[^?#\/.]+(?:[?#]|$)))*\/?)?([^?#\/]*))(?:\?([^#]*))?(?:#(.*))?)/}},r=n.parser[t.strictMode?"strict":"loose"].exec(e),i={},a=14;a--;)i[n.key[a]]=r[a]||"";return i[n.q.name]={},i[n.key[12]].replace(n.q.parser,function(e,t,r){t&&(i[n.q.name][t]=r)}),i}},{}],40:[function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}r.__esModule=!0;var a=e("../core"),u=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t.default=e,t}(a),o=e("ismobilejs"),s=n(o),l=e("./accessibleTarget"),c=n(l);u.utils.mixins.delayMixin(u.DisplayObject.prototype,c.default);var h=100,f=0,d=0,p=2,v=function(){function r(e){i(this,r),!s.default.tablet&&!s.default.phone||navigator.isCocoonJS||this.createTouchHook();var t=document.createElement("div");t.style.width=h+"px",t.style.height=h+"px",t.style.position="absolute",t.style.top=f+"px",t.style.left=d+"px",t.style.zIndex=p,this.div=t,this.pool=[],this.renderId=0,this.debug=!1,this.renderer=e,this.children=[],this._onKeyDown=this._onKeyDown.bind(this),this._onMouseMove=this._onMouseMove.bind(this),this.isActive=!1,this.isMobileAccessabillity=!1,window.addEventListener("keydown",this._onKeyDown,!1)}return r.prototype.createTouchHook=function(){var e=this,t=document.createElement("button");t.style.width="1px",t.style.height="1px",t.style.position="absolute",t.style.top="-1000px",t.style.left="-1000px",t.style.zIndex=2,t.style.backgroundColor="#FF0000",t.title="HOOK DIV",t.addEventListener("focus",function(){e.isMobileAccessabillity=!0,e.activate(),document.body.removeChild(t)}),document.body.appendChild(t)},r.prototype.activate=function(){this.isActive||(this.isActive=!0,window.document.addEventListener("mousemove",this._onMouseMove,!0),window.removeEventListener("keydown",this._onKeyDown,!1),this.renderer.on("postrender",this.update,this),this.renderer.view.parentNode&&this.renderer.view.parentNode.appendChild(this.div))},r.prototype.deactivate=function(){this.isActive&&!this.isMobileAccessabillity&&(this.isActive=!1,window.document.removeEventListener("mousemove",this._onMouseMove),window.addEventListener("keydown",this._onKeyDown,!1),this.renderer.off("postrender",this.update),this.div.parentNode&&this.div.parentNode.removeChild(this.div))},r.prototype.updateAccessibleObjects=function(e){if(e.visible){e.accessible&&e.interactive&&(e._accessibleActive||this.addChild(e),e.renderId=this.renderId);for(var t=e.children,r=t.length-1;r>=0;r--)this.updateAccessibleObjects(t[r])}},r.prototype.update=function(){if(this.renderer.renderingToScreen){this.updateAccessibleObjects(this.renderer._lastObjectRendered);var e=this.renderer.view.getBoundingClientRect(),t=e.width/this.renderer.width,r=e.height/this.renderer.height,n=this.div;n.style.left=e.left+"px",n.style.top=e.top+"px",n.style.width=this.renderer.width+"px",n.style.height=this.renderer.height+"px";for(var i=0;i<this.children.length;i++){var a=this.children[i];if(a.renderId!==this.renderId)a._accessibleActive=!1,u.utils.removeItems(this.children,i,1),this.div.removeChild(a._accessibleDiv),this.pool.push(a._accessibleDiv),a._accessibleDiv=null,i--,0===this.children.length&&this.deactivate();else{n=a._accessibleDiv;var o=a.hitArea,s=a.worldTransform;a.hitArea?(n.style.left=(s.tx+o.x*s.a)*t+"px",n.style.top=(s.ty+o.y*s.d)*r+"px",n.style.width=o.width*s.a*t+"px",n.style.height=o.height*s.d*r+"px"):(o=a.getBounds(),this.capHitArea(o),n.style.left=o.x*t+"px",n.style.top=o.y*r+"px",n.style.width=o.width*t+"px",n.style.height=o.height*r+"px")}}this.renderId++}},r.prototype.capHitArea=function(e){e.x<0&&(e.width+=e.x,e.x=0),e.y<0&&(e.height+=e.y,e.y=0),e.x+e.width>this.renderer.width&&(e.width=this.renderer.width-e.x),e.y+e.height>this.renderer.height&&(e.height=this.renderer.height-e.y)},r.prototype.addChild=function(e){var t=this.pool.pop();t||(t=document.createElement("button"),t.style.width=h+"px",t.style.height=h+"px",t.style.backgroundColor=this.debug?"rgba(255,0,0,0.5)":"transparent",t.style.position="absolute",t.style.zIndex=p,t.style.borderStyle="none",t.addEventListener("click",this._onClick.bind(this)),t.addEventListener("focus",this._onFocus.bind(this)),t.addEventListener("focusout",this._onFocusOut.bind(this))),e.accessibleTitle?t.title=e.accessibleTitle:e.accessibleTitle||e.accessibleHint||(t.title="displayObject "+this.tabIndex),e.accessibleHint&&t.setAttribute("aria-label",e.accessibleHint),e._accessibleActive=!0,e._accessibleDiv=t,t.displayObject=e,this.children.push(e),this.div.appendChild(e._accessibleDiv),e._accessibleDiv.tabIndex=e.tabIndex},r.prototype._onClick=function(e){var t=this.renderer.plugins.interaction;t.dispatchEvent(e.target.displayObject,"click",t.eventData)},r.prototype._onFocus=function(e){var t=this.renderer.plugins.interaction;t.dispatchEvent(e.target.displayObject,"mouseover",t.eventData)},r.prototype._onFocusOut=function(e){var t=this.renderer.plugins.interaction;t.dispatchEvent(e.target.displayObject,"mouseout",t.eventData)},r.prototype._onKeyDown=function(e){9===e.keyCode&&this.activate()},r.prototype._onMouseMove=function(){this.deactivate()},r.prototype.destroy=function(){this.div=null;for(var e=0;e<this.children.length;e++)this.children[e].div=null;window.document.removeEventListener("mousemove",this._onMouseMove),window.removeEventListener("keydown",this._onKeyDown),this.pool=null,this.children=null,this.renderer=null},r}();r.default=v,u.WebGLRenderer.registerPlugin("accessibility",v),u.CanvasRenderer.registerPlugin("accessibility",v)},{"../core":65,"./accessibleTarget":41,ismobilejs:4}],41:[function(e,t,r){"use strict";r.__esModule=!0,r.default={accessible:!1,accessibleTitle:null,accessibleHint:null,tabIndex:0,_accessibleActive:!1,_accessibleDiv:!1}},{}],42:[function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}r.__esModule=!0;var i=e("./accessibleTarget");Object.defineProperty(r,"accessibleTarget",{enumerable:!0,get:function(){return n(i).default}});var a=e("./AccessibilityManager");Object.defineProperty(r,"AccessibilityManager",{enumerable:!0,get:function(){return n(a).default}})},{"./AccessibilityManager":40,"./accessibleTarget":41}],43:[function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}r.__esModule=!0;var i=function(){function n(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(e,t,r){return t&&n(e.prototype,t),r&&n(e,r),e}}(),s=e("./autoDetectRenderer"),a=e("./display/Container"),u=n(a),l=e("./ticker"),c=e("./settings"),h=n(c),f=e("./const"),d=function(){function a(e,t,r,n,i){o(this,a),"number"==typeof e&&(e=Object.assign({width:e,height:t||h.default.RENDER_OPTIONS.height,forceCanvas:!!n,sharedTicker:!!i},r)),this._options=e=Object.assign({autoStart:!0,sharedTicker:!1,forceCanvas:!1,sharedLoader:!1},e),this.renderer=(0,s.autoDetectRenderer)(e),this.stage=new u.default,this._ticker=null,this.ticker=e.sharedTicker?l.shared:new l.Ticker,e.autoStart&&this.start()}return a.prototype.render=function(){this.renderer.render(this.stage)},a.prototype.stop=function(){this._ticker.stop()},a.prototype.start=function(){this._ticker.start()},a.prototype.destroy=function(e){var t=this._ticker;this.ticker=null,t.destroy(),this.stage.destroy(),this.stage=null,this.renderer.destroy(e),this.renderer=null,this._options=null},i(a,[{key:"ticker",set:function(e){this._ticker&&this._ticker.remove(this.render,this),this._ticker=e,e&&e.add(this.render,this,f.UPDATE_PRIORITY.LOW)},get:function(){return this._ticker}},{key:"view",get:function(){return this.renderer.view}},{key:"screen",get:function(){return this.renderer.screen}}]),a}();r.default=d},{"./autoDetectRenderer":45,"./const":46,"./display/Container":48,"./settings":101,"./ticker":121}],44:[function(e,t,r){"use strict";function a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function s(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}function u(e,t){if(e instanceof Array){if("precision"!==e[0].substring(0,9)){var r=e.slice(0);return r.unshift("precision "+t+" float;"),r}}else if("precision"!==e.substring(0,9))return"precision "+t+" float;\n"+e;return e}r.__esModule=!0;var n=e("pixi-gl-core"),i=e("./settings"),l=function(e){return e&&e.__esModule?e:{default:e}}(i),c=function(n){function i(e,t,r){return a(this,i),o(this,n.call(this,e,u(t,l.default.PRECISION_VERTEX),u(r,l.default.PRECISION_FRAGMENT)))}return s(i,n),i}(n.GLShader);r.default=c},{"./settings":101,"pixi-gl-core":12}],45:[function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function i(e,t,r,n){var i=e&&e.forceCanvas;return void 0!==n&&(i=n),!i&&o.isWebGLSupported()?new c.default(e,t,r):new u.default(e,t,r)}r.__esModule=!0,r.autoDetectRenderer=i;var a=e("./utils"),o=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t.default=e,t}(a),s=e("./renderers/canvas/CanvasRenderer"),u=n(s),l=e("./renderers/webgl/WebGLRenderer"),c=n(l)},{"./renderers/canvas/CanvasRenderer":77,"./renderers/webgl/WebGLRenderer":84,"./utils":125}],46:[function(e,t,r){"use strict";r.__esModule=!0;r.VERSION="4.6.0",r.PI_2=2*Math.PI,r.RAD_TO_DEG=180/Math.PI,r.DEG_TO_RAD=Math.PI/180,r.RENDERER_TYPE={UNKNOWN:0,WEBGL:1,CANVAS:2},r.BLEND_MODES={NORMAL:0,ADD:1,MULTIPLY:2,SCREEN:3,OVERLAY:4,DARKEN:5,LIGHTEN:6,COLOR_DODGE:7,COLOR_BURN:8,HARD_LIGHT:9,SOFT_LIGHT:10,DIFFERENCE:11,EXCLUSION:12,HUE:13,SATURATION:14,COLOR:15,LUMINOSITY:16,NORMAL_NPM:17,ADD_NPM:18,SCREEN_NPM:19},r.DRAW_MODES={POINTS:0,LINES:1,LINE_LOOP:2,LINE_STRIP:3,TRIANGLES:4,TRIANGLE_STRIP:5,TRIANGLE_FAN:6},r.SCALE_MODES={LINEAR:0,NEAREST:1},r.WRAP_MODES={CLAMP:0,REPEAT:1,MIRRORED_REPEAT:2},r.GC_MODES={AUTO:0,MANUAL:1},r.URL_FILE_EXTENSION=/\.(\w{3,4})(?:$|\?|#)/i,r.DATA_URI=/^\s*data:(?:([\w-]+)\/([\w+.-]+))?(?:;(charset=[\w-]+|base64))?,(.*)/i,r.SVG_SIZE=/<svg[^>]*(?:\s(width|height)=('|")(\d*(?:\.\d+)?)(?:px)?('|"))[^>]*(?:\s(width|height)=('|")(\d*(?:\.\d+)?)(?:px)?('|"))[^>]*>/i,r.SHAPES={POLY:0,RECT:1,CIRC:2,ELIP:3,RREC:4},r.PRECISION={LOW:"lowp",MEDIUM:"mediump",HIGH:"highp"},r.TRANSFORM_MODE={STATIC:0,DYNAMIC:1},r.TEXT_GRADIENT={LINEAR_VERTICAL:0,LINEAR_HORIZONTAL:1},r.UPDATE_PRIORITY={INTERACTION:50,HIGH:25,NORMAL:0,LOW:-25,UTILITY:-50}},{}],47:[function(e,t,r){"use strict";function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}r.__esModule=!0;var i=e("../math"),a=function(){function e(){n(this,e),this.minX=1/0,this.minY=1/0,this.maxX=-1/0,this.maxY=-1/0,this.rect=null}return e.prototype.isEmpty=function(){return this.minX>this.maxX||this.minY>this.maxY},e.prototype.clear=function(){this.updateID++,this.minX=1/0,this.minY=1/0,this.maxX=-1/0,this.maxY=-1/0},e.prototype.getRectangle=function(e){return this.minX>this.maxX||this.minY>this.maxY?i.Rectangle.EMPTY:(e=e||new i.Rectangle(0,0,1,1),e.x=this.minX,e.y=this.minY,e.width=this.maxX-this.minX,e.height=this.maxY-this.minY,e)},e.prototype.addPoint=function(e){this.minX=Math.min(this.minX,e.x),this.maxX=Math.max(this.maxX,e.x),this.minY=Math.min(this.minY,e.y),this.maxY=Math.max(this.maxY,e.y)},e.prototype.addQuad=function(e){var t=this.minX,r=this.minY,n=this.maxX,i=this.maxY,a=e[0],o=e[1];t=a<t?a:t,r=o<r?o:r,n=a>n?a:n,i=o>i?o:i,a=e[2],o=e[3],t=a<t?a:t,r=o<r?o:r,n=a>n?a:n,i=o>i?o:i,a=e[4],o=e[5],t=a<t?a:t,r=o<r?o:r,n=a>n?a:n,i=o>i?o:i,a=e[6],o=e[7],t=a<t?a:t,r=o<r?o:r,n=a>n?a:n,i=o>i?o:i,this.minX=t,this.minY=r,this.maxX=n,this.maxY=i},e.prototype.addFrame=function(e,t,r,n,i){var a=e.worldTransform,o=a.a,s=a.b,u=a.c,l=a.d,c=a.tx,h=a.ty,f=this.minX,d=this.minY,p=this.maxX,v=this.maxY,m=o*t+u*r+c,g=s*t+l*r+h;f=m<f?m:f,d=g<d?g:d,p=m>p?m:p,v=g>v?g:v,m=o*n+u*r+c,g=s*n+l*r+h,f=m<f?m:f,d=g<d?g:d,p=m>p?m:p,v=g>v?g:v,m=o*t+u*i+c,g=s*t+l*i+h,f=m<f?m:f,d=g<d?g:d,p=m>p?m:p,v=g>v?g:v,m=o*n+u*i+c,g=s*n+l*i+h,f=m<f?m:f,d=g<d?g:d,p=m>p?m:p,v=g>v?g:v,this.minX=f,this.minY=d,this.maxX=p,this.maxY=v},e.prototype.addVertices=function(e,t,r,n){for(var i=e.worldTransform,a=i.a,o=i.b,s=i.c,u=i.d,l=i.tx,c=i.ty,h=this.minX,f=this.minY,d=this.maxX,p=this.maxY,v=r;v<n;v+=2){var m=t[v],g=t[v+1],y=a*m+s*g+l,x=u*g+o*m+c;h=y<h?y:h,f=x<f?x:f,d=y>d?y:d,p=x>p?x:p}this.minX=h,this.minY=f,this.maxX=d,this.maxY=p},e.prototype.addBounds=function(e){var t=this.minX,r=this.minY,n=this.maxX,i=this.maxY;this.minX=e.minX<t?e.minX:t,this.minY=e.minY<r?e.minY:r,this.maxX=e.maxX>n?e.maxX:n,this.maxY=e.maxY>i?e.maxY:i},e.prototype.addBoundsMask=function(e,t){var r=e.minX>t.minX?e.minX:t.minX,n=e.minY>t.minY?e.minY:t.minY,i=e.maxX<t.maxX?e.maxX:t.maxX,a=e.maxY<t.maxY?e.maxY:t.maxY;if(r<=i&&n<=a){var o=this.minX,s=this.minY,u=this.maxX,l=this.maxY;this.minX=r<o?r:o,this.minY=n<s?n:s,this.maxX=i>u?i:u,this.maxY=a>l?a:l}},e.prototype.addBoundsArea=function(e,t){var r=e.minX>t.x?e.minX:t.x,n=e.minY>t.y?e.minY:t.y,i=e.maxX<t.x+t.width?e.maxX:t.x+t.width,a=e.maxY<t.y+t.height?e.maxY:t.y+t.height;if(r<=i&&n<=a){var o=this.minX,s=this.minY,u=this.maxX,l=this.maxY;this.minX=r<o?r:o,this.minY=n<s?n:s,this.maxX=i>u?i:u,this.maxY=a>l?a:l}},e}();r.default=a},{"../math":70}],48:[function(e,t,r){"use strict";function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function o(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}r.__esModule=!0;var s=function(){function n(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(e,t,r){return t&&n(e.prototype,t),r&&n(e,r),e}}(),u=e("../utils"),i=e("./DisplayObject"),l=function(e){return e&&e.__esModule?e:{default:e}}(i),c=function(i){function t(){n(this,t);var e=a(this,i.call(this));return e.children=[],e}return o(t,i),t.prototype.onChildrenChange=function(){},t.prototype.addChild=function(e){var t=arguments.length;if(t>1)for(var r=0;r<t;r++)this.addChild(arguments[r]);else e.parent&&e.parent.removeChild(e),e.parent=this,e.transform._parentID=-1,this.children.push(e),this._boundsID++,this.onChildrenChange(this.children.length-1),e.emit("added",this);return e},t.prototype.addChildAt=function(e,t){if(t<0||t>this.children.length)throw new Error(e+"addChildAt: The index "+t+" supplied is out of bounds "+this.children.length);return e.parent&&e.parent.removeChild(e),e.parent=this,e.transform._parentID=-1,this.children.splice(t,0,e),this._boundsID++,this.onChildrenChange(t),e.emit("added",this),e},t.prototype.swapChildren=function(e,t){if(e!==t){var r=this.getChildIndex(e),n=this.getChildIndex(t);this.children[r]=t,this.children[n]=e,this.onChildrenChange(r<n?r:n)}},t.prototype.getChildIndex=function(e){var t=this.children.indexOf(e);if(-1===t)throw new Error("The supplied DisplayObject must be a child of the caller");return t},t.prototype.setChildIndex=function(e,t){if(t<0||t>=this.children.length)throw new Error("The supplied index is out of bounds");var r=this.getChildIndex(e);(0,u.removeItems)(this.children,r,1),this.children.splice(t,0,e),this.onChildrenChange(t)},t.prototype.getChildAt=function(e){if(e<0||e>=this.children.length)throw new Error("getChildAt: Index ("+e+") does not exist.");return this.children[e]},t.prototype.removeChild=function(e){var t=arguments.length;if(t>1)for(var r=0;r<t;r++)this.removeChild(arguments[r]);else{var n=this.children.indexOf(e);if(-1===n)return null;e.parent=null,e.transform._parentID=-1,(0,u.removeItems)(this.children,n,1),this._boundsID++,this.onChildrenChange(n),e.emit("removed",this)}return e},t.prototype.removeChildAt=function(e){var t=this.getChildAt(e);return t.parent=null,t.transform._parentID=-1,(0,u.removeItems)(this.children,e,1),this._boundsID++,this.onChildrenChange(e),t.emit("removed",this),t},t.prototype.removeChildren=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,t=arguments[1],r=e,n="number"==typeof t?t:this.children.length,i=n-r,a=void 0;if(i>0&&i<=n){a=this.children.splice(r,i);for(var o=0;o<a.length;++o)a[o].parent=null,a[o].transform&&(a[o].transform._parentID=-1);this._boundsID++,this.onChildrenChange(e);for(var s=0;s<a.length;++s)a[s].emit("removed",this);return a}if(0===i&&0===this.children.length)return[];throw new RangeError("removeChildren: numeric values are outside the acceptable range.")},t.prototype.updateTransform=function(){this._boundsID++,this.transform.updateTransform(this.parent.transform),this.worldAlpha=this.alpha*this.parent.worldAlpha;for(var e=0,t=this.children.length;e<t;++e){var r=this.children[e];r.visible&&r.updateTransform()}},t.prototype.calculateBounds=function(){this._bounds.clear(),this._calculateBounds();for(var e=0;e<this.children.length;e++){var t=this.children[e];t.visible&&t.renderable&&(t.calculateBounds(),t._mask?(t._mask.calculateBounds(),this._bounds.addBoundsMask(t._bounds,t._mask._bounds)):t.filterArea?this._bounds.addBoundsArea(t._bounds,t.filterArea):this._bounds.addBounds(t._bounds))}this._lastBoundsID=this._boundsID},t.prototype._calculateBounds=function(){},t.prototype.renderWebGL=function(e){if(this.visible&&!(this.worldAlpha<=0)&&this.renderable)if(this._mask||this._filters)this.renderAdvancedWebGL(e);else{this._renderWebGL(e);for(var t=0,r=this.children.length;t<r;++t)this.children[t].renderWebGL(e)}},t.prototype.renderAdvancedWebGL=function(e){e.flush();var t=this._filters,r=this._mask;if(t){this._enabledFilters||(this._enabledFilters=[]),this._enabledFilters.length=0;for(var n=0;n<t.length;n++)t[n].enabled&&this._enabledFilters.push(t[n]);this._enabledFilters.length&&e.filterManager.pushFilter(this,this._enabledFilters)}r&&e.maskManager.pushMask(this,this._mask),this._renderWebGL(e);for(var i=0,a=this.children.length;i<a;i++)this.children[i].renderWebGL(e);e.flush(),r&&e.maskManager.popMask(this,this._mask),t&&this._enabledFilters&&this._enabledFilters.length&&e.filterManager.popFilter()},t.prototype._renderWebGL=function(e){},t.prototype._renderCanvas=function(e){},t.prototype.renderCanvas=function(e){if(this.visible&&!(this.worldAlpha<=0)&&this.renderable){this._mask&&e.maskManager.pushMask(this._mask),this._renderCanvas(e);for(var t=0,r=this.children.length;t<r;++t)this.children[t].renderCanvas(e);this._mask&&e.maskManager.popMask(e)}},t.prototype.destroy=function(e){i.prototype.destroy.call(this);var t="boolean"==typeof e?e:e&&e.children,r=this.removeChildren(0,this.children.length);if(t)for(var n=0;n<r.length;++n)r[n].destroy(e)},s(t,[{key:"width",get:function(){return this.scale.x*this.getLocalBounds().width},set:function(e){var t=this.getLocalBounds().width;this.scale.x=0!==t?e/t:1,this._width=e}},{key:"height",get:function(){return this.scale.y*this.getLocalBounds().height},set:function(e){var t=this.getLocalBounds().height;this.scale.y=0!==t?e/t:1,this._height=e}}]),t}(l.default);r.default=c,c.prototype.containerUpdateTransform=c.prototype.updateTransform},{"../utils":125,"./DisplayObject":49}],49:[function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function o(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}r.__esModule=!0;var s=function(){function n(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(e,t,r){return t&&n(e.prototype,t),r&&n(e,r),e}}(),u=e("eventemitter3"),l=n(u),c=e("../const"),h=e("../settings"),f=n(h),d=e("./TransformStatic"),p=n(d),v=e("./Transform"),m=n(v),g=e("./Bounds"),y=n(g),x=e("../math"),b=function(r){function n(){i(this,n);var e=a(this,r.call(this)),t=f.default.TRANSFORM_MODE===c.TRANSFORM_MODE.STATIC?p.default:m.default;return e.tempDisplayObjectParent=null,e.transform=new t,e.alpha=1,e.visible=!0,e.renderable=!0,e.parent=null,e.worldAlpha=1,e.filterArea=null,e._filters=null,e._enabledFilters=null,e._bounds=new y.default,e._boundsID=0,e._lastBoundsID=-1,e._boundsRect=null,e._localBoundsRect=null,e._mask=null,e._destroyed=!1,e}return o(n,r),n.prototype.updateTransform=function(){this.transform.updateTransform(this.parent.transform),this.worldAlpha=this.alpha*this.parent.worldAlpha,this._bounds.updateID++},n.prototype._recursivePostUpdateTransform=function(){this.parent?(this.parent._recursivePostUpdateTransform(),this.transform.updateTransform(this.parent.transform)):this.transform.updateTransform(this._tempDisplayObjectParent.transform)},n.prototype.getBounds=function(e,t){return e||(this.parent?(this._recursivePostUpdateTransform(),this.updateTransform()):(this.parent=this._tempDisplayObjectParent,this.updateTransform(),this.parent=null)),this._boundsID!==this._lastBoundsID&&this.calculateBounds(),t||(this._boundsRect||(this._boundsRect=new x.Rectangle),t=this._boundsRect),this._bounds.getRectangle(t)},n.prototype.getLocalBounds=function(e){var t=this.transform,r=this.parent;this.parent=null,this.transform=this._tempDisplayObjectParent.transform,e||(this._localBoundsRect||(this._localBoundsRect=new x.Rectangle),e=this._localBoundsRect);var n=this.getBounds(!1,e);return this.parent=r,this.transform=t,n},n.prototype.toGlobal=function(e,t){return arguments.length>2&&void 0!==arguments[2]&&arguments[2]||(this._recursivePostUpdateTransform(),this.parent?this.displayObjectUpdateTransform():(this.parent=this._tempDisplayObjectParent,this.displayObjectUpdateTransform(),this.parent=null)),this.worldTransform.apply(e,t)},n.prototype.toLocal=function(e,t,r,n){return t&&(e=t.toGlobal(e,r,n)),n||(this._recursivePostUpdateTransform(),this.parent?this.displayObjectUpdateTransform():(this.parent=this._tempDisplayObjectParent,this.displayObjectUpdateTransform(),this.parent=null)),this.worldTransform.applyInverse(e,r)},n.prototype.renderWebGL=function(e){},n.prototype.renderCanvas=function(e){},n.prototype.setParent=function(e){if(!e||!e.addChild)throw new Error("setParent: Argument must be a Container");return e.addChild(this),e},n.prototype.setTransform=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1,i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:0,a=arguments.length>5&&void 0!==arguments[5]?arguments[5]:0,o=arguments.length>6&&void 0!==arguments[6]?arguments[6]:0,s=arguments.length>7&&void 0!==arguments[7]?arguments[7]:0,u=arguments.length>8&&void 0!==arguments[8]?arguments[8]:0;return this.position.x=e,this.position.y=t,this.scale.x=r||1,this.scale.y=n||1,this.rotation=i,this.skew.x=a,this.skew.y=o,this.pivot.x=s,this.pivot.y=u,this},n.prototype.destroy=function(){this.removeAllListeners(),this.parent&&this.parent.removeChild(this),this.transform=null,this.parent=null,this._bounds=null,this._currentBounds=null,this._mask=null,this.filterArea=null,this.interactive=!1,this.interactiveChildren=!1,this._destroyed=!0},s(n,[{key:"_tempDisplayObjectParent",get:function(){return null===this.tempDisplayObjectParent&&(this.tempDisplayObjectParent=new n),this.tempDisplayObjectParent}},{key:"x",get:function(){return this.position.x},set:function(e){this.transform.position.x=e}},{key:"y",get:function(){return this.position.y},set:function(e){this.transform.position.y=e}},{key:"worldTransform",get:function(){return this.transform.worldTransform}},{key:"localTransform",get:function(){return this.transform.localTransform}},{key:"position",get:function(){return this.transform.position},set:function(e){this.transform.position.copy(e)}},{key:"scale",get:function(){return this.transform.scale},set:function(e){this.transform.scale.copy(e)}},{key:"pivot",get:function(){return this.transform.pivot},set:function(e){this.transform.pivot.copy(e)}},{key:"skew",get:function(){return this.transform.skew},set:function(e){this.transform.skew.copy(e)}},{key:"rotation",get:function(){return this.transform.rotation},set:function(e){this.transform.rotation=e}},{key:"worldVisible",get:function(){var e=this;do{if(!e.visible)return!1;e=e.parent}while(e);return!0}},{key:"mask",get:function(){return this._mask},set:function(e){this._mask&&(this._mask.renderable=!0),this._mask=e,this._mask&&(this._mask.renderable=!1)}},{key:"filters",get:function(){return this._filters&&this._filters.slice()},set:function(e){this._filters=e&&e.slice()}}]),n}(l.default);r.default=b,b.prototype.displayObjectUpdateTransform=b.prototype.updateTransform},{"../const":46,"../math":70,"../settings":101,"./Bounds":47,"./Transform":50,"./TransformStatic":52,eventemitter3:3}],50:[function(e,t,r){"use strict";function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}r.__esModule=!0;var o=function(){function n(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(e,t,r){return t&&n(e.prototype,t),r&&n(e,r),e}}(),s=e("../math"),u=e("./TransformBase"),l=function(e){return e&&e.__esModule?e:{default:e}}(u),c=function(t){function r(){n(this,r);var e=i(this,t.call(this));return e.position=new s.Point(0,0),e.scale=new s.Point(1,1),e.skew=new s.ObservablePoint(e.updateSkew,e,0,0),e.pivot=new s.Point(0,0),e._rotation=0,e._cx=1,e._sx=0,e._cy=0,e._sy=1,e}return a(r,t),r.prototype.updateSkew=function(){this._cx=Math.cos(this._rotation+this.skew._y),this._sx=Math.sin(this._rotation+this.skew._y),this._cy=-Math.sin(this._rotation-this.skew._x),this._sy=Math.cos(this._rotation-this.skew._x)},r.prototype.updateLocalTransform=function(){var e=this.localTransform;e.a=this._cx*this.scale.x,e.b=this._sx*this.scale.x,e.c=this._cy*this.scale.y,e.d=this._sy*this.scale.y,e.tx=this.position.x-(this.pivot.x*e.a+this.pivot.y*e.c),e.ty=this.position.y-(this.pivot.x*e.b+this.pivot.y*e.d)},r.prototype.updateTransform=function(e){var t=this.localTransform;t.a=this._cx*this.scale.x,t.b=this._sx*this.scale.x,t.c=this._cy*this.scale.y,t.d=this._sy*this.scale.y,t.tx=this.position.x-(this.pivot.x*t.a+this.pivot.y*t.c),t.ty=this.position.y-(this.pivot.x*t.b+this.pivot.y*t.d);var r=e.worldTransform,n=this.worldTransform;n.a=t.a*r.a+t.b*r.c,n.b=t.a*r.b+t.b*r.d,n.c=t.c*r.a+t.d*r.c,n.d=t.c*r.b+t.d*r.d,n.tx=t.tx*r.a+t.ty*r.c+r.tx,n.ty=t.tx*r.b+t.ty*r.d+r.ty,this._worldID++},r.prototype.setFromMatrix=function(e){e.decompose(this)},o(r,[{key:"rotation",get:function(){return this._rotation},set:function(e){this._rotation=e,this.updateSkew()}}]),r}(l.default);r.default=c},{"../math":70,"./TransformBase":51}],51:[function(e,t,r){"use strict";function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}r.__esModule=!0;var i=e("../math"),a=function(){function e(){n(this,e),this.worldTransform=new i.Matrix,this.localTransform=new i.Matrix,this._worldID=0,this._parentID=0}return e.prototype.updateLocalTransform=function(){},e.prototype.updateTransform=function(e){var t=e.worldTransform,r=this.worldTransform,n=this.localTransform;r.a=n.a*t.a+n.b*t.c,r.b=n.a*t.b+n.b*t.d,r.c=n.c*t.a+n.d*t.c,r.d=n.c*t.b+n.d*t.d,r.tx=n.tx*t.a+n.ty*t.c+t.tx,r.ty=n.tx*t.b+n.ty*t.d+t.ty,this._worldID++},e}();r.default=a,a.prototype.updateWorldTransform=a.prototype.updateTransform,a.IDENTITY=new a},{"../math":70}],52:[function(e,t,r){"use strict";function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}r.__esModule=!0;var o=function(){function n(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(e,t,r){return t&&n(e.prototype,t),r&&n(e,r),e}}(),s=e("../math"),u=e("./TransformBase"),l=function(e){return e&&e.__esModule?e:{default:e}}(u),c=function(t){function r(){n(this,r);var e=i(this,t.call(this));return e.position=new s.ObservablePoint(e.onChange,e,0,0),e.scale=new s.ObservablePoint(e.onChange,e,1,1),e.pivot=new s.ObservablePoint(e.onChange,e,0,0),e.skew=new s.ObservablePoint(e.updateSkew,e,0,0),e._rotation=0,e._cx=1,e._sx=0,e._cy=0,e._sy=1,e._localID=0,e._currentLocalID=0,e}return a(r,t),r.prototype.onChange=function(){this._localID++},r.prototype.updateSkew=function(){this._cx=Math.cos(this._rotation+this.skew._y),this._sx=Math.sin(this._rotation+this.skew._y),this._cy=-Math.sin(this._rotation-this.skew._x),this._sy=Math.cos(this._rotation-this.skew._x),this._localID++},r.prototype.updateLocalTransform=function(){var e=this.localTransform;this._localID!==this._currentLocalID&&(e.a=this._cx*this.scale._x,e.b=this._sx*this.scale._x,e.c=this._cy*this.scale._y,e.d=this._sy*this.scale._y,e.tx=this.position._x-(this.pivot._x*e.a+this.pivot._y*e.c),e.ty=this.position._y-(this.pivot._x*e.b+this.pivot._y*e.d),this._currentLocalID=this._localID,this._parentID=-1)},r.prototype.updateTransform=function(e){var t=this.localTransform;if(this._localID!==this._currentLocalID&&(t.a=this._cx*this.scale._x,t.b=this._sx*this.scale._x,t.c=this._cy*this.scale._y,t.d=this._sy*this.scale._y,t.tx=this.position._x-(this.pivot._x*t.a+this.pivot._y*t.c),t.ty=this.position._y-(this.pivot._x*t.b+this.pivot._y*t.d),this._currentLocalID=this._localID,this._parentID=-1),this._parentID!==e._worldID){var r=e.worldTransform,n=this.worldTransform;n.a=t.a*r.a+t.b*r.c,n.b=t.a*r.b+t.b*r.d,n.c=t.c*r.a+t.d*r.c,n.d=t.c*r.b+t.d*r.d,n.tx=t.tx*r.a+t.ty*r.c+r.tx,n.ty=t.tx*r.b+t.ty*r.d+r.ty,this._parentID=e._worldID,this._worldID++}},r.prototype.setFromMatrix=function(e){e.decompose(this),this._localID++},o(r,[{key:"rotation",get:function(){return this._rotation},set:function(e){this._rotation=e,this.updateSkew()}}]),r}(l.default);r.default=c},{"../math":70,"./TransformBase":51}],53:[function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function s(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}r.__esModule=!0;var i=e("../display/Container"),u=n(i),l=e("../textures/RenderTexture"),c=n(l),h=e("../textures/Texture"),f=n(h),d=e("./GraphicsData"),p=n(d),v=e("../sprites/Sprite"),m=n(v),g=e("../math"),y=e("../utils"),E=e("../const"),x=e("../display/Bounds"),b=n(x),w=e("./utils/bezierCurveTo"),_=n(w),T=e("../renderers/canvas/CanvasRenderer"),M=n(T),S=void 0,A=new g.Matrix,R=new g.Point,P=new Float32Array(4),C=new Float32Array(4),O=function(i){function r(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];a(this,r);var t=o(this,i.call(this));return t.fillAlpha=1,t.lineWidth=0,t.nativeLines=e,t.lineColor=0,t.graphicsData=[],t.tint=16777215,t._prevTint=16777215,t.blendMode=E.BLEND_MODES.NORMAL,t.currentPath=null,t._webGL={},t.isMask=!1,t.boundsPadding=0,t._localBounds=new b.default,t.dirty=0,t.fastRectDirty=-1,t.clearDirty=0,t.boundsDirty=-1,t.cachedSpriteDirty=!1,t._spriteRect=null,t._fastRect=!1,t}return s(r,i),r.prototype.clone=function(){var e=new r;e.renderable=this.renderable,e.fillAlpha=this.fillAlpha,e.lineWidth=this.lineWidth,e.lineColor=this.lineColor,e.tint=this.tint,e.blendMode=this.blendMode,e.isMask=this.isMask,e.boundsPadding=this.boundsPadding,e.dirty=0,e.cachedSpriteDirty=this.cachedSpriteDirty;for(var t=0;t<this.graphicsData.length;++t)e.graphicsData.push(this.graphicsData[t].clone());return e.currentPath=e.graphicsData[e.graphicsData.length-1],e.updateLocalBounds(),e},r.prototype.lineStyle=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1;if(this.lineWidth=e,this.lineColor=t,this.lineAlpha=r,this.currentPath)if(this.currentPath.shape.points.length){var n=new g.Polygon(this.currentPath.shape.points.slice(-2));n.closed=!1,this.drawShape(n)}else this.currentPath.lineWidth=this.lineWidth,this.currentPath.lineColor=this.lineColor,this.currentPath.lineAlpha=this.lineAlpha;return this},r.prototype.moveTo=function(e,t){var r=new g.Polygon([e,t]);return r.closed=!1,this.drawShape(r),this},r.prototype.lineTo=function(e,t){return this.currentPath.shape.points.push(e,t),this.dirty++,this},r.prototype.quadraticCurveTo=function(e,t,r,n){this.currentPath?0===this.currentPath.shape.points.length&&(this.currentPath.shape.points=[0,0]):this.moveTo(0,0);var i=this.currentPath.shape.points,a=0,o=0;0===i.length&&this.moveTo(0,0);for(var s=i[i.length-2],u=i[i.length-1],l=1;l<=20;++l){var c=l/20;a=s+(e-s)*c,o=u+(t-u)*c,i.push(a+(e+(r-e)*c-a)*c,o+(t+(n-t)*c-o)*c)}return this.dirty++,this},r.prototype.bezierCurveTo=function(e,t,r,n,i,a){this.currentPath?0===this.currentPath.shape.points.length&&(this.currentPath.shape.points=[0,0]):this.moveTo(0,0);var o=this.currentPath.shape.points,s=o[o.length-2],u=o[o.length-1];return o.length-=2,(0,_.default)(s,u,e,t,r,n,i,a,o),this.dirty++,this},r.prototype.arcTo=function(e,t,r,n,i){this.currentPath?0===this.currentPath.shape.points.length&&this.currentPath.shape.points.push(e,t):this.moveTo(e,t);var a=this.currentPath.shape.points,o=a[a.length-2],s=a[a.length-1],u=s-t,l=o-e,c=n-t,h=r-e,f=Math.abs(u*h-l*c);if(f<1e-8||0===i)a[a.length-2]===e&&a[a.length-1]===t||a.push(e,t);else{var d=u*u+l*l,p=c*c+h*h,v=u*c+l*h,m=i*Math.sqrt(d)/f,g=i*Math.sqrt(p)/f,y=m*v/d,x=g*v/p,b=m*h+g*l,w=m*c+g*u,_=l*(g+y),T=u*(g+y),E=h*(m+x),M=c*(m+x),S=Math.atan2(T-w,_-b),A=Math.atan2(M-w,E-b);this.arc(b+e,w+t,i,S,A,l*c>h*u)}return this.dirty++,this},r.prototype.arc=function(e,t,r,n,i){var a=arguments.length>5&&void 0!==arguments[5]&&arguments[5];if(n===i)return this;!a&&i<=n?i+=2*Math.PI:a&&n<=i&&(n+=2*Math.PI);var o=i-n,s=40*Math.ceil(Math.abs(o)/(2*Math.PI));if(0===o)return this;var u=e+Math.cos(n)*r,l=t+Math.sin(n)*r,c=this.currentPath?this.currentPath.shape.points:null;c?c[c.length-2]===u&&c[c.length-1]===l||c.push(u,l):(this.moveTo(u,l),c=this.currentPath.shape.points);for(var h=o/(2*s),f=2*h,d=Math.cos(h),p=Math.sin(h),v=s-1,m=v%1/v,g=0;g<=v;++g){var y=g+m*g,x=h+n+f*y,b=Math.cos(x),w=-Math.sin(x);c.push((d*b+p*w)*r+e,(d*-w+p*b)*r+t)}return this.dirty++,this},r.prototype.beginFill=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;return this.filling=!0,this.fillColor=e,this.fillAlpha=t,this.currentPath&&this.currentPath.shape.points.length<=2&&(this.currentPath.fill=this.filling,this.currentPath.fillColor=this.fillColor,this.currentPath.fillAlpha=this.fillAlpha),this},r.prototype.endFill=function(){return this.filling=!1,this.fillColor=null,this.fillAlpha=1,this},r.prototype.drawRect=function(e,t,r,n){return this.drawShape(new g.Rectangle(e,t,r,n)),this},r.prototype.drawRoundedRect=function(e,t,r,n,i){return this.drawShape(new g.RoundedRectangle(e,t,r,n,i)),this},r.prototype.drawCircle=function(e,t,r){return this.drawShape(new g.Circle(e,t,r)),this},r.prototype.drawEllipse=function(e,t,r,n){return this.drawShape(new g.Ellipse(e,t,r,n)),this},r.prototype.drawPolygon=function(e){var t=e,r=!0;if(t instanceof g.Polygon&&(r=t.closed,t=t.points),!Array.isArray(t)){t=new Array(arguments.length);for(var n=0;n<t.length;++n)t[n]=arguments[n]}var i=new g.Polygon(t);return i.closed=r,this.drawShape(i),this},r.prototype.clear=function(){return(this.lineWidth||this.filling||this.graphicsData.length>0)&&(this.lineWidth=0,this.filling=!1,this.boundsDirty=-1,this.dirty++,this.clearDirty++,this.graphicsData.length=0),this.currentPath=null,this._spriteRect=null,this},r.prototype.isFastRect=function(){return 1===this.graphicsData.length&&this.graphicsData[0].shape.type===E.SHAPES.RECT&&!this.graphicsData[0].lineWidth},r.prototype._renderWebGL=function(e){this.dirty!==this.fastRectDirty&&(this.fastRectDirty=this.dirty,this._fastRect=this.isFastRect()),this._fastRect?this._renderSpriteRect(e):(e.setObjectRenderer(e.plugins.graphics),e.plugins.graphics.render(this))},r.prototype._renderSpriteRect=function(e){var t=this.graphicsData[0].shape;this._spriteRect||(this._spriteRect=new m.default(new f.default(f.default.WHITE)));var r=this._spriteRect;if(16777215===this.tint)r.tint=this.graphicsData[0].fillColor;else{var n=P,i=C;(0,y.hex2rgb)(this.graphicsData[0].fillColor,n),(0,y.hex2rgb)(this.tint,i),n[0]*=i[0],n[1]*=i[1],n[2]*=i[2],r.tint=(0,y.rgb2hex)(n)}r.alpha=this.graphicsData[0].fillAlpha,r.worldAlpha=this.worldAlpha*r.alpha,r.blendMode=this.blendMode,r._texture._frame.width=t.width,r._texture._frame.height=t.height,r.transform.worldTransform=this.transform.worldTransform,r.anchor.set(-t.x/t.width,-t.y/t.height),r._onAnchorUpdate(),r._renderWebGL(e)},r.prototype._renderCanvas=function(e){!0!==this.isMask&&e.plugins.graphics.render(this)},r.prototype._calculateBounds=function(){this.boundsDirty!==this.dirty&&(this.boundsDirty=this.dirty,this.updateLocalBounds(),this.cachedSpriteDirty=!0);var e=this._localBounds;this._bounds.addFrame(this.transform,e.minX,e.minY,e.maxX,e.maxY)},r.prototype.containsPoint=function(e){this.worldTransform.applyInverse(e,R);for(var t=this.graphicsData,r=0;r<t.length;++r){var n=t[r];if(n.fill&&(n.shape&&n.shape.contains(R.x,R.y))){if(n.holes)for(var i=0;i<n.holes.length;i++){var a=n.holes[i];if(a.contains(R.x,R.y))return!1}return!0}}return!1},r.prototype.updateLocalBounds=function(){var e=1/0,t=-1/0,r=1/0,n=-1/0;if(this.graphicsData.length)for(var i=0,a=0,o=0,s=0,u=0,l=0;l<this.graphicsData.length;l++){var c=this.graphicsData[l],h=c.type,f=c.lineWidth;if(i=c.shape,h===E.SHAPES.RECT||h===E.SHAPES.RREC)a=i.x-f/2,o=i.y-f/2,s=i.width+f,u=i.height+f,e=a<e?a:e,t=a+s>t?a+s:t,r=o<r?o:r,n=o+u>n?o+u:n;else if(h===E.SHAPES.CIRC)a=i.x,o=i.y,s=i.radius+f/2,u=i.radius+f/2,e=a-s<e?a-s:e,t=a+s>t?a+s:t,r=o-u<r?o-u:r,n=o+u>n?o+u:n;else if(h===E.SHAPES.ELIP)a=i.x,o=i.y,s=i.width+f/2,u=i.height+f/2,e=a-s<e?a-s:e,t=a+s>t?a+s:t,r=o-u<r?o-u:r,n=o+u>n?o+u:n;else for(var d=i.points,p=0,v=0,m=0,g=0,y=0,x=0,b=0,w=0,_=0;_+2<d.length;_+=2)a=d[_],o=d[_+1],p=d[_+2],v=d[_+3],m=Math.abs(p-a),g=Math.abs(v-o),u=f,(s=Math.sqrt(m*m+g*g))<1e-9||(y=(u/s*g+m)/2,x=(u/s*m+g)/2,b=(p+a)/2,w=(v+o)/2,e=b-y<e?b-y:e,t=b+y>t?b+y:t,r=w-x<r?w-x:r,n=w+x>n?w+x:n)}else e=0,t=0,r=0,n=0;var T=this.boundsPadding;this._localBounds.minX=e-T,this._localBounds.maxX=t+T,this._localBounds.minY=r-T,this._localBounds.maxY=n+T},r.prototype.drawShape=function(e){this.currentPath&&this.currentPath.shape.points.length<=2&&this.graphicsData.pop(),this.currentPath=null;var t=new p.default(this.lineWidth,this.lineColor,this.lineAlpha,this.fillColor,this.fillAlpha,this.filling,this.nativeLines,e);return this.graphicsData.push(t),t.type===E.SHAPES.POLY&&(t.shape.closed=t.shape.closed||this.filling,this.currentPath=t),this.dirty++,t},r.prototype.generateCanvasTexture=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,r=this.getLocalBounds(),n=c.default.create(r.width,r.height,e,t);S||(S=new M.default),this.transform.updateLocalTransform(),this.transform.localTransform.copy(A),A.invert(),A.tx-=r.x,A.ty-=r.y,S.render(this,n,!0,A);var i=f.default.fromCanvas(n.baseTexture._canvasRenderTarget.canvas,e,"graphics");return i.baseTexture.resolution=t,i.baseTexture.update(),i},r.prototype.closePath=function(){var e=this.currentPath;return e&&e.shape&&e.shape.close(),this},r.prototype.addHole=function(){var e=this.graphicsData.pop();return this.currentPath=this.graphicsData[this.graphicsData.length-1],this.currentPath.addHole(e.shape),this.currentPath=null,this},r.prototype.destroy=function(e){i.prototype.destroy.call(this,e);for(var t=0;t<this.graphicsData.length;++t)this.graphicsData[t].destroy();for(var r in this._webgl)for(var n=0;n<this._webgl[r].data.length;++n)this._webgl[r].data[n].destroy();this._spriteRect&&this._spriteRect.destroy(),this.graphicsData=null,this.currentPath=null,this._webgl=null,this._localBounds=null},r}(u.default);r.default=O,O._SPRITE_TEXTURE=null},{"../const":46,"../display/Bounds":47,"../display/Container":48,"../math":70,"../renderers/canvas/CanvasRenderer":77,"../sprites/Sprite":102,"../textures/RenderTexture":113,"../textures/Texture":115,"../utils":125,"./GraphicsData":54,"./utils/bezierCurveTo":56}],54:[function(e,t,r){"use strict";function l(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}r.__esModule=!0;var n=function(){function u(e,t,r,n,i,a,o,s){l(this,u),this.lineWidth=e,this.nativeLines=o,this.lineColor=t,this.lineAlpha=r,this._lineTint=t,this.fillColor=n,this.fillAlpha=i,this._fillTint=n,this.fill=a,this.holes=[],this.shape=s,this.type=s.type}return u.prototype.clone=function(){return new u(this.lineWidth,this.lineColor,this.lineAlpha,this.fillColor,this.fillAlpha,this.fill,this.nativeLines,this.shape)},u.prototype.addHole=function(e){this.holes.push(e)},u.prototype.destroy=function(){this.shape=null,this.holes=null},u}();r.default=n},{}],55:[function(e,t,r){"use strict";function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}r.__esModule=!0;var i=e("../../renderers/canvas/CanvasRenderer"),a=function(e){return e&&e.__esModule?e:{default:e}}(i),R=e("../../const"),o=function(){function t(e){n(this,t),this.renderer=e}return t.prototype.render=function(e){var t=this.renderer,r=t.context,n=e.worldAlpha,i=e.transform.worldTransform,a=t.resolution;this._prevTint!==this.tint&&(this.dirty=!0),r.setTransform(i.a*a,i.b*a,i.c*a,i.d*a,i.tx*a,i.ty*a),e.dirty&&(this.updateGraphicsTint(e),e.dirty=!1),t.setBlendMode(e.blendMode);for(var o=0;o<e.graphicsData.length;o++){var s=e.graphicsData[o],u=s.shape,l=s._fillTint,c=s._lineTint;if(r.lineWidth=s.lineWidth,s.type===R.SHAPES.POLY){r.beginPath(),this.renderPolygon(u.points,u.closed,r);for(var h=0;h<s.holes.length;h++)this.renderPolygon(s.holes[h].points,!0,r);s.fill&&(r.globalAlpha=s.fillAlpha*n,r.fillStyle="#"+("00000"+(0|l).toString(16)).substr(-6),r.fill()),s.lineWidth&&(r.globalAlpha=s.lineAlpha*n,r.strokeStyle="#"+("00000"+(0|c).toString(16)).substr(-6),r.stroke())}else if(s.type===R.SHAPES.RECT)(s.fillColor||0===s.fillColor)&&(r.globalAlpha=s.fillAlpha*n,r.fillStyle="#"+("00000"+(0|l).toString(16)).substr(-6),r.fillRect(u.x,u.y,u.width,u.height)),s.lineWidth&&(r.globalAlpha=s.lineAlpha*n,r.strokeStyle="#"+("00000"+(0|c).toString(16)).substr(-6),r.strokeRect(u.x,u.y,u.width,u.height));else if(s.type===R.SHAPES.CIRC)r.beginPath(),r.arc(u.x,u.y,u.radius,0,2*Math.PI),r.closePath(),s.fill&&(r.globalAlpha=s.fillAlpha*n,r.fillStyle="#"+("00000"+(0|l).toString(16)).substr(-6),r.fill()),s.lineWidth&&(r.globalAlpha=s.lineAlpha*n,r.strokeStyle="#"+("00000"+(0|c).toString(16)).substr(-6),r.stroke());else if(s.type===R.SHAPES.ELIP){var f=2*u.width,d=2*u.height,p=u.x-f/2,v=u.y-d/2;r.beginPath();var m=f/2*.5522848,g=d/2*.5522848,y=p+f,x=v+d,b=p+f/2,w=v+d/2;r.moveTo(p,w),r.bezierCurveTo(p,w-g,b-m,v,b,v),r.bezierCurveTo(b+m,v,y,w-g,y,w),r.bezierCurveTo(y,w+g,b+m,x,b,x),r.bezierCurveTo(b-m,x,p,w+g,p,w),r.closePath(),s.fill&&(r.globalAlpha=s.fillAlpha*n,r.fillStyle="#"+("00000"+(0|l).toString(16)).substr(-6),r.fill()),s.lineWidth&&(r.globalAlpha=s.lineAlpha*n,r.strokeStyle="#"+("00000"+(0|c).toString(16)).substr(-6),r.stroke())}else if(s.type===R.SHAPES.RREC){var _=u.x,T=u.y,E=u.width,M=u.height,S=u.radius,A=Math.min(E,M)/2|0;S=S>A?A:S,r.beginPath(),r.moveTo(_,T+S),r.lineTo(_,T+M-S),r.quadraticCurveTo(_,T+M,_+S,T+M),r.lineTo(_+E-S,T+M),r.quadraticCurveTo(_+E,T+M,_+E,T+M-S),r.lineTo(_+E,T+S),r.quadraticCurveTo(_+E,T,_+E-S,T),r.lineTo(_+S,T),r.quadraticCurveTo(_,T,_,T+S),r.closePath(),(s.fillColor||0===s.fillColor)&&(r.globalAlpha=s.fillAlpha*n,r.fillStyle="#"+("00000"+(0|l).toString(16)).substr(-6),r.fill()),s.lineWidth&&(r.globalAlpha=s.lineAlpha*n,r.strokeStyle="#"+("00000"+(0|c).toString(16)).substr(-6),r.stroke())}}},t.prototype.updateGraphicsTint=function(e){e._prevTint=e.tint;for(var t=(e.tint>>16&255)/255,r=(e.tint>>8&255)/255,n=(255&e.tint)/255,i=0;i<e.graphicsData.length;++i){var a=e.graphicsData[i],o=0|a.fillColor,s=0|a.lineColor;a._fillTint=((o>>16&255)/255*t*255<<16)+((o>>8&255)/255*r*255<<8)+(255&o)/255*n*255,a._lineTint=((s>>16&255)/255*t*255<<16)+((s>>8&255)/255*r*255<<8)+(255&s)/255*n*255}},t.prototype.renderPolygon=function(e,t,r){r.moveTo(e[0],e[1]);for(var n=1;n<e.length/2;++n)r.lineTo(e[2*n],e[2*n+1]);t&&r.closePath()},t.prototype.destroy=function(){this.renderer=null},t}();r.default=o,a.default.registerPlugin("graphics",o)},{"../../const":46,"../../renderers/canvas/CanvasRenderer":77}],56:[function(e,t,r){"use strict";function n(e,t,r,n,i,a,o,s){var u=arguments.length>8&&void 0!==arguments[8]?arguments[8]:[],l=0,c=0,h=0,f=0,d=0;u.push(e,t);for(var p=1,v=0;p<=20;++p)v=p/20,l=1-v,c=l*l,h=c*l,f=v*v,d=f*v,u.push(h*e+3*c*v*r+3*l*f*i+d*o,h*t+3*c*v*n+3*l*f*a+d*s);return u}r.__esModule=!0,r.default=n},{}],57:[function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function o(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}r.__esModule=!0;var l=e("../../utils"),c=e("../../const"),s=e("../../renderers/webgl/utils/ObjectRenderer"),u=n(s),h=e("../../renderers/webgl/WebGLRenderer"),f=n(h),d=e("./WebGLGraphicsData"),p=n(d),v=e("./shaders/PrimitiveShader"),m=n(v),g=e("./utils/buildPoly"),y=n(g),x=e("./utils/buildRectangle"),b=n(x),w=e("./utils/buildRoundedRectangle"),_=n(w),T=e("./utils/buildCircle"),E=n(T),M=function(r){function n(e){i(this,n);var t=a(this,r.call(this,e));return t.graphicsDataPool=[],t.primitiveShader=null,t.gl=e.gl,t.CONTEXT_UID=0,t}return o(n,r),n.prototype.onContextChange=function(){this.gl=this.renderer.gl,this.CONTEXT_UID=this.renderer.CONTEXT_UID,this.primitiveShader=new m.default(this.gl)},n.prototype.destroy=function(){u.default.prototype.destroy.call(this);for(var e=0;e<this.graphicsDataPool.length;++e)this.graphicsDataPool[e].destroy();this.graphicsDataPool=null},n.prototype.render=function(e){var t=this.renderer,r=t.gl,n=void 0,i=e._webGL[this.CONTEXT_UID];i&&e.dirty===i.dirty||(this.updateGraphics(e),i=e._webGL[this.CONTEXT_UID]);var a=this.primitiveShader;t.bindShader(a),t.state.setBlendMode(e.blendMode);for(var o=0,s=i.data.length;o<s;o++){n=i.data[o];var u=n.shader;t.bindShader(u),u.uniforms.translationMatrix=e.transform.worldTransform.toArray(!0),u.uniforms.tint=(0,l.hex2rgb)(e.tint),u.uniforms.alpha=e.worldAlpha,t.bindVao(n.vao),n.nativeLines?r.drawArrays(r.LINES,0,n.points.length/6):n.vao.draw(r.TRIANGLE_STRIP,n.indices.length)}},n.prototype.updateGraphics=function(e){var t=this.renderer.gl,r=e._webGL[this.CONTEXT_UID];if(r||(r=e._webGL[this.CONTEXT_UID]={lastIndex:0,data:[],gl:t,clearDirty:-1,dirty:-1}),r.dirty=e.dirty,e.clearDirty!==r.clearDirty){r.clearDirty=e.clearDirty;for(var n=0;n<r.data.length;n++)this.graphicsDataPool.push(r.data[n]);r.data.length=0,r.lastIndex=0}for(var i=void 0,a=void 0,o=r.lastIndex;o<e.graphicsData.length;o++){var s=e.graphicsData[o];i=this.getWebGLData(r,0),s.nativeLines&&s.lineWidth&&(a=this.getWebGLData(r,0,!0),r.lastIndex++),s.type===c.SHAPES.POLY&&(0,y.default)(s,i,a),s.type===c.SHAPES.RECT?(0,b.default)(s,i,a):s.type===c.SHAPES.CIRC||s.type===c.SHAPES.ELIP?(0,E.default)(s,i,a):s.type===c.SHAPES.RREC&&(0,_.default)(s,i,a),r.lastIndex++}this.renderer.bindVao(null);for(var u=0;u<r.data.length;u++)i=r.data[u],i.dirty&&i.upload()},n.prototype.getWebGLData=function(e,t,r){var n=e.data[e.data.length-1];return(!n||n.nativeLines!==r||n.points.length>32e4)&&(n=this.graphicsDataPool.pop()||new p.default(this.renderer.gl,this.primitiveShader,this.renderer.state.attribsState),n.nativeLines=r,n.reset(t),e.data.push(n)),n.dirty=!0,n},n}(u.default);r.default=M,f.default.registerPlugin("graphics",M)},{"../../const":46,"../../renderers/webgl/WebGLRenderer":84,"../../renderers/webgl/utils/ObjectRenderer":94,"../../utils":125,"./WebGLGraphicsData":58,"./shaders/PrimitiveShader":59,"./utils/buildCircle":60,"./utils/buildPoly":62,"./utils/buildRectangle":63,"./utils/buildRoundedRectangle":64}],58:[function(e,t,r){"use strict";function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}r.__esModule=!0;var n=e("pixi-gl-core"),a=function(e){return e&&e.__esModule?e:{default:e}}(n),o=function(){function n(e,t,r){i(this,n),this.gl=e,this.color=[0,0,0],this.points=[],this.indices=[],this.buffer=a.default.GLBuffer.createVertexBuffer(e),this.indexBuffer=a.default.GLBuffer.createIndexBuffer(e),this.dirty=!0,this.nativeLines=!1,this.glPoints=null,this.glIndices=null,this.shader=t,this.vao=new a.default.VertexArrayObject(e,r).addIndex(this.indexBuffer).addAttribute(this.buffer,t.attributes.aVertexPosition,e.FLOAT,!1,24,0).addAttribute(this.buffer,t.attributes.aColor,e.FLOAT,!1,24,8)}return n.prototype.reset=function(){this.points.length=0,this.indices.length=0},n.prototype.upload=function(){this.glPoints=new Float32Array(this.points),this.buffer.upload(this.glPoints),this.glIndices=new Uint16Array(this.indices),this.indexBuffer.upload(this.glIndices),this.dirty=!1},n.prototype.destroy=function(){this.color=null,this.points=null,this.indices=null,this.vao.destroy(),this.buffer.destroy(),this.indexBuffer.destroy(),this.gl=null,this.buffer=null,this.indexBuffer=null,this.glPoints=null,this.glIndices=null},n}();r.default=o},{"pixi-gl-core":12}],59:[function(e,t,r){"use strict";function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}r.__esModule=!0;var o=e("../../../Shader"),s=function(e){return e&&e.__esModule?e:{default:e}}(o),u=function(t){function r(e){return n(this,r),i(this,t.call(this,e,["attribute vec2 aVertexPosition;","attribute vec4 aColor;","uniform mat3 translationMatrix;","uniform mat3 projectionMatrix;","uniform float alpha;","uniform vec3 tint;","varying vec4 vColor;","void main(void){","   gl_Position = vec4((projectionMatrix * translationMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);","   vColor = aColor * vec4(tint * alpha, alpha);","}"].join("\n"),["varying vec4 vColor;","void main(void){","   gl_FragColor = vColor;","}"].join("\n")))}return a(r,t),r}(s.default);r.default=u},{"../../../Shader":44}],60:[function(e,t,r){"use strict";function n(e,t,r){var n=e.shape,i=n.x,a=n.y,o=void 0,s=void 0;if(e.type===_.SHAPES.CIRC?(o=n.radius,s=n.radius):(o=n.width,s=n.height),0!==o&&0!==s){var u=Math.floor(30*Math.sqrt(n.radius))||Math.floor(15*Math.sqrt(n.width+n.height)),l=2*Math.PI/u;if(e.fill){var c=(0,T.hex2rgb)(e.fillColor),h=e.fillAlpha,f=c[0]*h,d=c[1]*h,p=c[2]*h,v=t.points,m=t.indices,g=v.length/6;m.push(g);for(var y=0;y<u+1;y++)v.push(i,a,f,d,p,h),v.push(i+Math.sin(l*y)*o,a+Math.cos(l*y)*s,f,d,p,h),m.push(g++,g++);m.push(g-1)}if(e.lineWidth){var x=e.points;e.points=[];for(var b=0;b<u+1;b++)e.points.push(i+Math.sin(l*b)*o,a+Math.cos(l*b)*s);(0,w.default)(e,t,r),e.points=x}}}r.__esModule=!0,r.default=n;var i=e("./buildLine"),w=function(e){return e&&e.__esModule?e:{default:e}}(i),_=e("../../../const"),T=e("../../../utils")},{"../../../const":46,"../../../utils":125,"./buildLine":61}],61:[function(e,t,r){"use strict";function n(e,t){var r=e.points;if(0!==r.length){var n=new H.Point(r[0],r[1]),i=new H.Point(r[r.length-2],r[r.length-1]);if(n.x===i.x&&n.y===i.y){r=r.slice(),r.pop(),r.pop(),i=new H.Point(r[r.length-2],r[r.length-1]);var a=i.x+.5*(n.x-i.x),o=i.y+.5*(n.y-i.y);r.unshift(a,o),r.push(a,o)}var s=t.points,u=t.indices,l=r.length/2,c=r.length,h=s.length/6,f=e.lineWidth/2,d=(0,G.hex2rgb)(e.lineColor),p=e.lineAlpha,v=d[0]*p,m=d[1]*p,g=d[2]*p,y=r[0],x=r[1],b=r[2],w=r[3],_=0,T=0,E=-(x-w),M=y-b,S=0,A=0,R=0,P=0,C=Math.sqrt(E*E+M*M);E/=C,M/=C,E*=f,M*=f,s.push(y-E,x-M,v,m,g,p),s.push(y+E,x+M,v,m,g,p);for(var O=1;O<l-1;++O){y=r[2*(O-1)],x=r[2*(O-1)+1],b=r[2*O],w=r[2*O+1],_=r[2*(O+1)],T=r[2*(O+1)+1],E=-(x-w),M=y-b,C=Math.sqrt(E*E+M*M),E/=C,M/=C,E*=f,M*=f,S=-(w-T),A=b-_,C=Math.sqrt(S*S+A*A),S/=C,A/=C,S*=f,A*=f;var L=-M+x-(-M+w),I=-E+b-(-E+y),D=(-E+y)*(-M+w)-(-E+b)*(-M+x),N=-A+T-(-A+w),F=-S+b-(-S+_),B=(-S+_)*(-A+w)-(-S+b)*(-A+T),U=L*F-N*I;if(Math.abs(U)<.1)U+=10.1,s.push(b-E,w-M,v,m,g,p),s.push(b+E,w+M,v,m,g,p);else{var k=(I*B-F*D)/U,j=(N*D-L*B)/U;(k-b)*(k-b)+(j-w)*(j-w)>196*f*f?(R=E-S,P=M-A,C=Math.sqrt(R*R+P*P),R/=C,P/=C,R*=f,P*=f,s.push(b-R,w-P),s.push(v,m,g,p),s.push(b+R,w+P),s.push(v,m,g,p),s.push(b-R,w-P),s.push(v,m,g,p),c++):(s.push(k,j),s.push(v,m,g,p),s.push(b-(k-b),w-(j-w)),s.push(v,m,g,p))}}y=r[2*(l-2)],x=r[2*(l-2)+1],b=r[2*(l-1)],w=r[2*(l-1)+1],E=-(x-w),M=y-b,C=Math.sqrt(E*E+M*M),E/=C,M/=C,E*=f,M*=f,s.push(b-E,w-M),s.push(v,m,g,p),s.push(b+E,w+M),s.push(v,m,g,p),u.push(h);for(var z=0;z<c;++z)u.push(h++);u.push(h-1)}}function i(e,t){var r=0,n=e.points;if(0!==n.length){var i=t.points,a=n.length/2,o=(0,G.hex2rgb)(e.lineColor),s=e.lineAlpha,u=o[0]*s,l=o[1]*s,c=o[2]*s;for(r=1;r<a;r++){var h=n[2*(r-1)],f=n[2*(r-1)+1],d=n[2*r],p=n[2*r+1];i.push(h,f),i.push(u,l,c,s),i.push(d,p),i.push(u,l,c,s)}}}r.__esModule=!0,r.default=function(e,t,r){e.nativeLines?i(e,r):n(e,t)};var H=e("../../../math"),G=e("../../../utils")},{"../../../math":70,"../../../utils":125}],62:[function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function i(e,t,r){e.points=e.shape.points.slice();var n=e.points;if(e.fill&&n.length>=6){for(var i=[],a=e.holes,o=0;o<a.length;o++){var s=a[o];i.push(n.length/2),n=n.concat(s.points)}var u=t.points,l=t.indices,c=n.length/2,h=(0,w.hex2rgb)(e.fillColor),f=e.fillAlpha,d=h[0]*f,p=h[1]*f,v=h[2]*f,m=(0,_.default)(n,i,2);if(!m)return;for(var g=u.length/6,y=0;y<m.length;y+=3)l.push(m[y]+g),l.push(m[y]+g),l.push(m[y+1]+g),l.push(m[y+2]+g),l.push(m[y+2]+g);for(var x=0;x<c;x++)u.push(n[2*x],n[2*x+1],d,p,v,f)}e.lineWidth>0&&(0,b.default)(e,t,r)}r.__esModule=!0,r.default=i;var a=e("./buildLine"),b=n(a),w=e("../../../utils"),o=e("earcut"),_=n(o)},{"../../../utils":125,"./buildLine":61,earcut:2}],63:[function(e,t,r){"use strict";function n(e,t,r){var n=e.shape,i=n.x,a=n.y,o=n.width,s=n.height;if(e.fill){var u=(0,y.hex2rgb)(e.fillColor),l=e.fillAlpha,c=u[0]*l,h=u[1]*l,f=u[2]*l,d=t.points,p=t.indices,v=d.length/6;d.push(i,a),d.push(c,h,f,l),d.push(i+o,a),d.push(c,h,f,l),d.push(i,a+s),d.push(c,h,f,l),d.push(i+o,a+s),d.push(c,h,f,l),p.push(v,v,v+1,v+2,v+3,v+3)}if(e.lineWidth){var m=e.points;e.points=[i,a,i+o,a,i+o,a+s,i,a+s,i,a],(0,g.default)(e,t,r),e.points=m}}r.__esModule=!0,r.default=n;var i=e("./buildLine"),g=function(e){return e&&e.__esModule?e:{default:e}}(i),y=e("../../../utils")},{"../../../utils":125,"./buildLine":61}],64:[function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function i(e,t,r){var n=e.shape,i=n.x,a=n.y,o=n.width,s=n.height,u=n.radius,l=[];if(l.push(i,a+u),E(i,a+s-u,i,a+s,i+u,a+s,l),E(i+o-u,a+s,i+o,a+s,i+o,a+s-u,l),E(i+o,a+u,i+o,a,i+o-u,a,l),E(i+u,a,i,a,i,a+u+1e-10,l),e.fill){for(var c=(0,A.hex2rgb)(e.fillColor),h=e.fillAlpha,f=c[0]*h,d=c[1]*h,p=c[2]*h,v=t.points,m=t.indices,g=v.length/6,y=(0,M.default)(l,null,2),x=0,b=y.length;x<b;x+=3)m.push(y[x]+g),m.push(y[x]+g),m.push(y[x+1]+g),m.push(y[x+2]+g),m.push(y[x+2]+g);for(var w=0,_=l.length;w<_;w++)v.push(l[w],l[++w],f,d,p,h)}if(e.lineWidth){var T=e.points;e.points=l,(0,S.default)(e,t,r),e.points=T}}function m(e,t,r){return e+(t-e)*r}function E(e,t,r,n,i,a){for(var o=arguments.length>6&&void 0!==arguments[6]?arguments[6]:[],s=o,u=0,l=0,c=0,h=0,f=0,d=0,p=0,v=0;p<=20;++p)v=p/20,u=m(e,r,v),l=m(t,n,v),c=m(r,i,v),h=m(n,a,v),f=m(u,c,v),d=m(l,h,v),s.push(f,d);return s}r.__esModule=!0,r.default=i;var a=e("earcut"),M=n(a),o=e("./buildLine"),S=n(o),A=e("../../../utils")},{"../../../utils":125,"./buildLine":61,earcut:2}],65:[function(e,t,r){"use strict";function n(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t.default=e,t}function i(e){return e&&e.__esModule?e:{default:e}}r.__esModule=!0,r.autoDetectRenderer=r.Application=r.Filter=r.SpriteMaskFilter=r.Quad=r.RenderTarget=r.ObjectRenderer=r.WebGLManager=r.Shader=r.CanvasRenderTarget=r.TextureUvs=r.VideoBaseTexture=r.BaseRenderTexture=r.RenderTexture=r.BaseTexture=r.TextureMatrix=r.Texture=r.Spritesheet=r.CanvasGraphicsRenderer=r.GraphicsRenderer=r.GraphicsData=r.Graphics=r.TextMetrics=r.TextStyle=r.Text=r.SpriteRenderer=r.CanvasTinter=r.CanvasSpriteRenderer=r.Sprite=r.TransformBase=r.TransformStatic=r.Transform=r.Container=r.DisplayObject=r.Bounds=r.glCore=r.WebGLRenderer=r.CanvasRenderer=r.ticker=r.utils=r.settings=void 0;var a=e("./const");Object.keys(a).forEach(function(e){"default"!==e&&"__esModule"!==e&&Object.defineProperty(r,e,{enumerable:!0,get:function(){return a[e]}})});var o=e("./math");Object.keys(o).forEach(function(e){"default"!==e&&"__esModule"!==e&&Object.defineProperty(r,e,{enumerable:!0,get:function(){return o[e]}})});var s=e("pixi-gl-core");Object.defineProperty(r,"glCore",{enumerable:!0,get:function(){return i(s).default}});var u=e("./display/Bounds");Object.defineProperty(r,"Bounds",{enumerable:!0,get:function(){return i(u).default}});var l=e("./display/DisplayObject");Object.defineProperty(r,"DisplayObject",{enumerable:!0,get:function(){return i(l).default}});var c=e("./display/Container");Object.defineProperty(r,"Container",{enumerable:!0,get:function(){return i(c).default}});var h=e("./display/Transform");Object.defineProperty(r,"Transform",{enumerable:!0,get:function(){return i(h).default}});var f=e("./display/TransformStatic");Object.defineProperty(r,"TransformStatic",{enumerable:!0,get:function(){return i(f).default}});var d=e("./display/TransformBase");Object.defineProperty(r,"TransformBase",{enumerable:!0,get:function(){return i(d).default}});var p=e("./sprites/Sprite");Object.defineProperty(r,"Sprite",{enumerable:!0,get:function(){return i(p).default}});var v=e("./sprites/canvas/CanvasSpriteRenderer");Object.defineProperty(r,"CanvasSpriteRenderer",{enumerable:!0,get:function(){return i(v).default}});var m=e("./sprites/canvas/CanvasTinter");Object.defineProperty(r,"CanvasTinter",{enumerable:!0,get:function(){return i(m).default}});var g=e("./sprites/webgl/SpriteRenderer");Object.defineProperty(r,"SpriteRenderer",{enumerable:!0,get:function(){return i(g).default}});var y=e("./text/Text");Object.defineProperty(r,"Text",{enumerable:!0,get:function(){return i(y).default}});var x=e("./text/TextStyle");Object.defineProperty(r,"TextStyle",{enumerable:!0,get:function(){return i(x).default}});var b=e("./text/TextMetrics");Object.defineProperty(r,"TextMetrics",{enumerable:!0,get:function(){return i(b).default}});var w=e("./graphics/Graphics");Object.defineProperty(r,"Graphics",{enumerable:!0,get:function(){return i(w).default}});var _=e("./graphics/GraphicsData");Object.defineProperty(r,"GraphicsData",{enumerable:!0,get:function(){return i(_).default}});var T=e("./graphics/webgl/GraphicsRenderer");Object.defineProperty(r,"GraphicsRenderer",{enumerable:!0,get:function(){return i(T).default}});var E=e("./graphics/canvas/CanvasGraphicsRenderer");Object.defineProperty(r,"CanvasGraphicsRenderer",{enumerable:!0,get:function(){return i(E).default}});var M=e("./textures/Spritesheet");Object.defineProperty(r,"Spritesheet",{enumerable:!0,get:function(){return i(M).default}});var S=e("./textures/Texture");Object.defineProperty(r,"Texture",{enumerable:!0,get:function(){return i(S).default}});var A=e("./textures/TextureMatrix");Object.defineProperty(r,"TextureMatrix",{enumerable:!0,get:function(){return i(A).default}});var R=e("./textures/BaseTexture");Object.defineProperty(r,"BaseTexture",{enumerable:!0,get:function(){return i(R).default}});var P=e("./textures/RenderTexture");Object.defineProperty(r,"RenderTexture",{enumerable:!0,get:function(){return i(P).default}});var C=e("./textures/BaseRenderTexture");Object.defineProperty(r,"BaseRenderTexture",{enumerable:!0,get:function(){return i(C).default}});var O=e("./textures/VideoBaseTexture");Object.defineProperty(r,"VideoBaseTexture",{enumerable:!0,get:function(){return i(O).default}});var L=e("./textures/TextureUvs");Object.defineProperty(r,"TextureUvs",{enumerable:!0,get:function(){return i(L).default}});var I=e("./renderers/canvas/utils/CanvasRenderTarget");Object.defineProperty(r,"CanvasRenderTarget",{enumerable:!0,get:function(){return i(I).default}});var D=e("./Shader");Object.defineProperty(r,"Shader",{enumerable:!0,get:function(){return i(D).default}});var N=e("./renderers/webgl/managers/WebGLManager");Object.defineProperty(r,"WebGLManager",{enumerable:!0,get:function(){return i(N).default}});var F=e("./renderers/webgl/utils/ObjectRenderer");Object.defineProperty(r,"ObjectRenderer",{enumerable:!0,get:function(){return i(F).default}});var B=e("./renderers/webgl/utils/RenderTarget");Object.defineProperty(r,"RenderTarget",{enumerable:!0,get:function(){return i(B).default}});var U=e("./renderers/webgl/utils/Quad");Object.defineProperty(r,"Quad",{enumerable:!0,get:function(){return i(U).default}});var k=e("./renderers/webgl/filters/spriteMask/SpriteMaskFilter");Object.defineProperty(r,"SpriteMaskFilter",{enumerable:!0,get:function(){return i(k).default}});var j=e("./renderers/webgl/filters/Filter");Object.defineProperty(r,"Filter",{enumerable:!0,get:function(){return i(j).default}});var z=e("./Application");Object.defineProperty(r,"Application",{enumerable:!0,get:function(){return i(z).default}});var H=e("./autoDetectRenderer");Object.defineProperty(r,"autoDetectRenderer",{enumerable:!0,get:function(){return H.autoDetectRenderer}});var G=e("./utils"),V=n(G),W=e("./ticker"),q=n(W),X=e("./settings"),Y=i(X),Z=e("./renderers/canvas/CanvasRenderer"),J=i(Z),K=e("./renderers/webgl/WebGLRenderer"),Q=i(K);r.settings=Y.default,r.utils=V,r.ticker=q,r.CanvasRenderer=J.default,r.WebGLRenderer=Q.default},{"./Application":43,"./Shader":44,"./autoDetectRenderer":45,"./const":46,"./display/Bounds":47,"./display/Container":48,"./display/DisplayObject":49,"./display/Transform":50,"./display/TransformBase":51,"./display/TransformStatic":52,"./graphics/Graphics":53,"./graphics/GraphicsData":54,"./graphics/canvas/CanvasGraphicsRenderer":55,"./graphics/webgl/GraphicsRenderer":57,"./math":70,"./renderers/canvas/CanvasRenderer":77,"./renderers/canvas/utils/CanvasRenderTarget":79,"./renderers/webgl/WebGLRenderer":84,"./renderers/webgl/filters/Filter":86,"./renderers/webgl/filters/spriteMask/SpriteMaskFilter":89,"./renderers/webgl/managers/WebGLManager":93,"./renderers/webgl/utils/ObjectRenderer":94,"./renderers/webgl/utils/Quad":95,"./renderers/webgl/utils/RenderTarget":96,"./settings":101,"./sprites/Sprite":102,"./sprites/canvas/CanvasSpriteRenderer":103,"./sprites/canvas/CanvasTinter":104,"./sprites/webgl/SpriteRenderer":106,"./text/Text":108,"./text/TextMetrics":109,"./text/TextStyle":110,"./textures/BaseRenderTexture":111,"./textures/BaseTexture":112,"./textures/RenderTexture":113,"./textures/Spritesheet":114,"./textures/Texture":115,"./textures/TextureMatrix":116,"./textures/TextureUvs":117,"./textures/VideoBaseTexture":118,"./ticker":121,"./utils":125,"pixi-gl-core":12}],66:[function(e,t,r){"use strict";function c(e){return e<0?-1:e>0?1:0}r.__esModule=!0;var n=e("./Matrix"),h=function(e){return e&&e.__esModule?e:{default:e}}(n),f=[1,1,0,-1,-1,-1,0,1,1,1,0,-1,-1,-1,0,1],d=[0,1,1,1,0,-1,-1,-1,0,1,1,1,0,-1,-1,-1],p=[0,-1,-1,-1,0,1,1,1,0,1,1,1,0,-1,-1,-1],v=[1,1,0,-1,-1,-1,0,1,-1,-1,0,1,1,1,0,-1],m=[],g=[];!function(){for(var e=0;e<16;e++){var t=[];g.push(t);for(var r=0;r<16;r++)for(var n=c(f[e]*f[r]+p[e]*d[r]),i=c(d[e]*f[r]+v[e]*d[r]),a=c(f[e]*p[r]+p[e]*v[r]),o=c(d[e]*p[r]+v[e]*v[r]),s=0;s<16;s++)if(f[s]===n&&d[s]===i&&p[s]===a&&v[s]===o){t.push(s);break}}for(var u=0;u<16;u++){var l=new h.default;l.set(f[u],d[u],p[u],v[u],0,0),m.push(l)}}();var a={E:0,SE:1,S:2,SW:3,W:4,NW:5,N:6,NE:7,MIRROR_VERTICAL:8,MIRROR_HORIZONTAL:12,uX:function(e){return f[e]},uY:function(e){return d[e]},vX:function(e){return p[e]},vY:function(e){return v[e]},inv:function(e){return 8&e?15&e:7&-e},add:function(e,t){return g[e][t]},sub:function(e,t){return g[e][a.inv(t)]},rotate180:function(e){return 4^e},isVertical:function(e){return 2==(3&e)},byDirection:function(e,t){return 2*Math.abs(e)<=Math.abs(t)?t>=0?a.S:a.N:2*Math.abs(t)<=Math.abs(e)?e>0?a.E:a.W:t>0?e>0?a.SE:a.SW:e>0?a.NE:a.NW},matrixAppendRotationInv:function(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,i=m[a.inv(t)];i.tx=r,i.ty=n,e.append(i)}};r.default=a},{"./Matrix":67}],67:[function(e,t,r){"use strict";function s(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}r.__esModule=!0;var n=function(){function n(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(e,t,r){return t&&n(e.prototype,t),r&&n(e,r),e}}(),i=e("./Point"),a=function(e){return e&&e.__esModule?e:{default:e}}(i),o=function(){function o(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1,i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:0,a=arguments.length>5&&void 0!==arguments[5]?arguments[5]:0;s(this,o),this.a=e,this.b=t,this.c=r,this.d=n,this.tx=i,this.ty=a,this.array=null}return o.prototype.fromArray=function(e){this.a=e[0],this.b=e[1],this.c=e[3],this.d=e[4],this.tx=e[2],this.ty=e[5]},o.prototype.set=function(e,t,r,n,i,a){return this.a=e,this.b=t,this.c=r,this.d=n,this.tx=i,this.ty=a,this},o.prototype.toArray=function(e,t){this.array||(this.array=new Float32Array(9));var r=t||this.array;return e?(r[0]=this.a,r[1]=this.b,r[2]=0,r[3]=this.c,r[4]=this.d,r[5]=0,r[6]=this.tx,r[7]=this.ty,r[8]=1):(r[0]=this.a,r[1]=this.c,r[2]=this.tx,r[3]=this.b,r[4]=this.d,r[5]=this.ty,r[6]=0,r[7]=0,r[8]=1),r},o.prototype.apply=function(e,t){t=t||new a.default;var r=e.x,n=e.y;return t.x=this.a*r+this.c*n+this.tx,t.y=this.b*r+this.d*n+this.ty,t},o.prototype.applyInverse=function(e,t){t=t||new a.default;var r=1/(this.a*this.d+this.c*-this.b),n=e.x,i=e.y;return t.x=this.d*r*n+-this.c*r*i+(this.ty*this.c-this.tx*this.d)*r,t.y=this.a*r*i+-this.b*r*n+(-this.ty*this.a+this.tx*this.b)*r,t},o.prototype.translate=function(e,t){return this.tx+=e,this.ty+=t,this},o.prototype.scale=function(e,t){return this.a*=e,this.d*=t,this.c*=e,this.b*=t,this.tx*=e,this.ty*=t,this},o.prototype.rotate=function(e){var t=Math.cos(e),r=Math.sin(e),n=this.a,i=this.c,a=this.tx;return this.a=n*t-this.b*r,this.b=n*r+this.b*t,this.c=i*t-this.d*r,this.d=i*r+this.d*t,this.tx=a*t-this.ty*r,this.ty=a*r+this.ty*t,this},o.prototype.append=function(e){var t=this.a,r=this.b,n=this.c,i=this.d;return this.a=e.a*t+e.b*n,this.b=e.a*r+e.b*i,this.c=e.c*t+e.d*n,this.d=e.c*r+e.d*i,this.tx=e.tx*t+e.ty*n+this.tx,this.ty=e.tx*r+e.ty*i+this.ty,this},o.prototype.setTransform=function(e,t,r,n,i,a,o,s,u){var l=Math.sin(o),c=Math.cos(o),h=Math.cos(u),f=Math.sin(u),d=-Math.sin(s),p=Math.cos(s),v=c*i,m=l*i,g=-l*a,y=c*a;return this.a=h*v+f*g,this.b=h*m+f*y,this.c=d*v+p*g,this.d=d*m+p*y,this.tx=e+(r*v+n*g),this.ty=t+(r*m+n*y),this},o.prototype.prepend=function(e){var t=this.tx;if(1!==e.a||0!==e.b||0!==e.c||1!==e.d){var r=this.a,n=this.c;this.a=r*e.a+this.b*e.c,this.b=r*e.b+this.b*e.d,this.c=n*e.a+this.d*e.c,this.d=n*e.b+this.d*e.d}return this.tx=t*e.a+this.ty*e.c+e.tx,this.ty=t*e.b+this.ty*e.d+e.ty,this},o.prototype.decompose=function(e){var t=this.a,r=this.b,n=this.c,i=this.d,a=-Math.atan2(-n,i),o=Math.atan2(r,t);return Math.abs(a+o)<1e-5?(e.rotation=o,t<0&&i>=0&&(e.rotation+=e.rotation<=0?Math.PI:-Math.PI),e.skew.x=e.skew.y=0):(e.skew.x=a,e.skew.y=o),e.scale.x=Math.sqrt(t*t+r*r),e.scale.y=Math.sqrt(n*n+i*i),e.position.x=this.tx,e.position.y=this.ty,e},o.prototype.invert=function(){var e=this.a,t=this.b,r=this.c,n=this.d,i=this.tx,a=e*n-t*r;return this.a=n/a,this.b=-t/a,this.c=-r/a,this.d=e/a,this.tx=(r*this.ty-n*i)/a,this.ty=-(e*this.ty-t*i)/a,this},o.prototype.identity=function(){return this.a=1,this.b=0,this.c=0,this.d=1,this.tx=0,this.ty=0,this},o.prototype.clone=function(){var e=new o;return e.a=this.a,e.b=this.b,e.c=this.c,e.d=this.d,e.tx=this.tx,e.ty=this.ty,e},o.prototype.copy=function(e){return e.a=this.a,e.b=this.b,e.c=this.c,e.d=this.d,e.tx=this.tx,e.ty=this.ty,e},n(o,null,[{key:"IDENTITY",get:function(){return new o}},{key:"TEMP_MATRIX",get:function(){return new o}}]),o}();r.default=o},{"./Point":69}],68:[function(e,t,r){"use strict";function a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}r.__esModule=!0;var n=function(){function n(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(e,t,r){return t&&n(e.prototype,t),r&&n(e,r),e}}(),i=function(){function i(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0;a(this,i),this._x=r,this._y=n,this.cb=e,this.scope=t}return i.prototype.set=function(e,t){var r=e||0,n=t||(0!==t?r:0);this._x===r&&this._y===n||(this._x=r,this._y=n,this.cb.call(this.scope))},i.prototype.copy=function(e){this._x===e.x&&this._y===e.y||(this._x=e.x,this._y=e.y,this.cb.call(this.scope))},n(i,[{key:"x",get:function(){return this._x},set:function(e){this._x!==e&&(this._x=e,this.cb.call(this.scope))}},{key:"y",get:function(){return this._y},set:function(e){this._y!==e&&(this._y=e,this.cb.call(this.scope))}}]),i}();r.default=i},{}],69:[function(e,t,r){"use strict";function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}r.__esModule=!0;var i=function(){function r(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;n(this,r),this.x=e,this.y=t}return r.prototype.clone=function(){return new r(this.x,this.y)},r.prototype.copy=function(e){this.set(e.x,e.y)},r.prototype.equals=function(e){return e.x===this.x&&e.y===this.y},r.prototype.set=function(e,t){this.x=e||0,this.y=t||(0!==t?this.x:0)},r}();r.default=i},{}],70:[function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}r.__esModule=!0;var i=e("./Point");Object.defineProperty(r,"Point",{enumerable:!0,get:function(){return n(i).default}});var a=e("./ObservablePoint");Object.defineProperty(r,"ObservablePoint",{enumerable:!0,get:function(){return n(a).default}});var o=e("./Matrix");Object.defineProperty(r,"Matrix",{enumerable:!0,get:function(){return n(o).default}});var s=e("./GroupD8");Object.defineProperty(r,"GroupD8",{enumerable:!0,get:function(){return n(s).default}});var u=e("./shapes/Circle");Object.defineProperty(r,"Circle",{enumerable:!0,get:function(){return n(u).default}});var l=e("./shapes/Ellipse");Object.defineProperty(r,"Ellipse",{enumerable:!0,get:function(){return n(l).default}});var c=e("./shapes/Polygon");Object.defineProperty(r,"Polygon",{enumerable:!0,get:function(){return n(c).default}});var h=e("./shapes/Rectangle");Object.defineProperty(r,"Rectangle",{enumerable:!0,get:function(){return n(h).default}});var f=e("./shapes/RoundedRectangle");Object.defineProperty(r,"RoundedRectangle",{enumerable:!0,get:function(){return n(f).default}})},{"./GroupD8":66,"./Matrix":67,"./ObservablePoint":68,"./Point":69,"./shapes/Circle":71,"./shapes/Ellipse":72,"./shapes/Polygon":73,"./shapes/Rectangle":74,"./shapes/RoundedRectangle":75}],71:[function(e,t,r){"use strict";function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}r.__esModule=!0;var n=e("./Rectangle"),a=function(e){return e&&e.__esModule?e:{default:e}}(n),o=e("../../const"),s=function(){function n(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;i(this,n),this.x=e,this.y=t,this.radius=r,this.type=o.SHAPES.CIRC}return n.prototype.clone=function(){return new n(this.x,this.y,this.radius)},n.prototype.contains=function(e,t){if(this.radius<=0)return!1;var r=this.radius*this.radius,n=this.x-e,i=this.y-t;return n*=n,i*=i,n+i<=r},n.prototype.getBounds=function(){return new a.default(this.x-this.radius,this.y-this.radius,2*this.radius,2*this.radius)},n}();r.default=s},{"../../const":46,"./Rectangle":74}],72:[function(e,t,r){"use strict";function a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}r.__esModule=!0;var n=e("./Rectangle"),o=function(e){return e&&e.__esModule?e:{default:e}}(n),s=e("../../const"),i=function(){function i(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0;a(this,i),this.x=e,this.y=t,this.width=r,this.height=n,this.type=s.SHAPES.ELIP}return i.prototype.clone=function(){return new i(this.x,this.y,this.width,this.height)},i.prototype.contains=function(e,t){if(this.width<=0||this.height<=0)return!1;var r=(e-this.x)/this.width,n=(t-this.y)/this.height;return r*=r,n*=n,r+n<=1},i.prototype.getBounds=function(){return new o.default(this.x-this.width,this.y-this.height,this.width,this.height)},i}();r.default=i},{"../../const":46,"./Rectangle":74}],73:[function(e,t,r){"use strict";function s(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}r.__esModule=!0;var n=e("../Point"),u=function(e){return e&&e.__esModule?e:{default:e}}(n),l=e("../../const"),i=function(){function o(){for(var e=arguments.length,t=Array(e),r=0;r<e;r++)t[r]=arguments[r];if(s(this,o),Array.isArray(t[0])&&(t=t[0]),t[0]instanceof u.default){for(var n=[],i=0,a=t.length;i<a;i++)n.push(t[i].x,t[i].y);t=n}this.closed=!0,this.points=t,this.type=l.SHAPES.POLY}return o.prototype.clone=function(){return new o(this.points.slice())},o.prototype.close=function(){var e=this.points;e[0]===e[e.length-2]&&e[1]===e[e.length-1]||e.push(e[0],e[1])},o.prototype.contains=function(e,t){for(var r=!1,n=this.points.length/2,i=0,a=n-1;i<n;a=i++){var o=this.points[2*i],s=this.points[2*i+1],u=this.points[2*a],l=this.points[2*a+1];s>t!=l>t&&e<(t-s)/(l-s)*(u-o)+o&&(r=!r)}return r},o}();r.default=i},{"../../const":46,"../Point":69}],74:[function(e,t,r){"use strict";function a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}r.__esModule=!0;var n=function(){function n(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(e,t,r){return t&&n(e.prototype,t),r&&n(e,r),e}}(),o=e("../../const"),i=function(){function i(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0;a(this,i),this.x=Number(e),this.y=Number(t),this.width=Number(r),this.height=Number(n),this.type=o.SHAPES.RECT}return i.prototype.clone=function(){return new i(this.x,this.y,this.width,this.height)},i.prototype.copy=function(e){return this.x=e.x,this.y=e.y,this.width=e.width,this.height=e.height,this},i.prototype.contains=function(e,t){return!(this.width<=0||this.height<=0)&&(e>=this.x&&e<this.x+this.width&&t>=this.y&&t<this.y+this.height)},i.prototype.pad=function(e,t){e=e||0,t=t||(0!==t?e:0),this.x-=e,this.y-=t,this.width+=2*e,this.height+=2*t},i.prototype.fit=function(e){this.x<e.x&&(this.width+=this.x,this.width<0&&(this.width=0),this.x=e.x),this.y<e.y&&(this.height+=this.y,this.height<0&&(this.height=0),this.y=e.y),this.x+this.width>e.x+e.width&&(this.width=e.width-this.x,this.width<0&&(this.width=0)),this.y+this.height>e.y+e.height&&(this.height=e.height-this.y,this.height<0&&(this.height=0))},i.prototype.enlarge=function(e){var t=Math.min(this.x,e.x),r=Math.max(this.x+this.width,e.x+e.width),n=Math.min(this.y,e.y),i=Math.max(this.y+this.height,e.y+e.height);this.x=t,this.width=r-t,this.y=n,this.height=i-n},n(i,[{key:"left",get:function(){return this.x}},{key:"right",get:function(){return this.x+this.width}},{key:"top",get:function(){return this.y}},{key:"bottom",get:function(){return this.y+this.height}}],[{key:"EMPTY",get:function(){return new i(0,0,0,0)}}]),i}();r.default=i},{"../../const":46}],75:[function(e,t,r){"use strict";function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}r.__esModule=!0;var s=e("../../const"),n=function(){function a(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:20;o(this,a),this.x=e,this.y=t,this.width=r,this.height=n,this.radius=i,this.type=s.SHAPES.RREC}return a.prototype.clone=function(){return new a(this.x,this.y,this.width,this.height,this.radius)},a.prototype.contains=function(e,t){if(this.width<=0||this.height<=0)return!1;if(e>=this.x&&e<=this.x+this.width&&t>=this.y&&t<=this.y+this.height){if(t>=this.y+this.radius&&t<=this.y+this.height-this.radius||e>=this.x+this.radius&&e<=this.x+this.width-this.radius)return!0;var r=e-(this.x+this.radius),n=t-(this.y+this.radius),i=this.radius*this.radius;if(r*r+n*n<=i)return!0;if((r=e-(this.x+this.width-this.radius))*r+n*n<=i)return!0;if(n=t-(this.y+this.height-this.radius),r*r+n*n<=i)return!0;if((r=e-(this.x+this.radius))*r+n*n<=i)return!0}return!1},a}();r.default=n},{"../../const":46}],76:[function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function s(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function u(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function i(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}r.__esModule=!0;var l=function(){function n(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(e,t,r){return t&&n(e.prototype,t),r&&n(e,r),e}}(),c=e("../utils"),h=e("../math"),f=e("../const"),a=e("../settings"),d=n(a),o=e("../display/Container"),p=n(o),v=e("../textures/RenderTexture"),m=n(v),g=e("eventemitter3"),y=n(g),x=new h.Matrix,b=function(a){function o(e,t,r,n){s(this,o);var i=u(this,a.call(this));return(0,c.sayHello)(e),"number"==typeof t&&(t=Object.assign({width:t,height:r||d.default.RENDER_OPTIONS.height},n)),t=Object.assign({},d.default.RENDER_OPTIONS,t),i.options=t,i.type=f.RENDERER_TYPE.UNKNOWN,i.screen=new h.Rectangle(0,0,t.width,t.height),i.view=t.view||document.createElement("canvas"),i.resolution=t.resolution||d.default.RESOLUTION,i.transparent=t.transparent,i.autoResize=t.autoResize||!1,i.blendModes=null,i.preserveDrawingBuffer=t.preserveDrawingBuffer,i.clearBeforeRender=t.clearBeforeRender,i.roundPixels=t.roundPixels,i._backgroundColor=0,i._backgroundColorRgba=[0,0,0,0],i._backgroundColorString="#000000",i.backgroundColor=t.backgroundColor||i._backgroundColor,i._tempDisplayObjectParent=new p.default,i._lastObjectRendered=i._tempDisplayObjectParent,i}return i(o,a),o.prototype.resize=function(e,t){this.screen.width=e,this.screen.height=t,this.view.width=e*this.resolution,this.view.height=t*this.resolution,this.autoResize&&(this.view.style.width=e+"px",this.view.style.height=t+"px")},o.prototype.generateTexture=function(e,t,r){var n=e.getLocalBounds(),i=m.default.create(0|n.width,0|n.height,t,r);return x.tx=-n.x,x.ty=-n.y,this.render(e,i,!1,x,!0),i},o.prototype.destroy=function(e){e&&this.view.parentNode&&this.view.parentNode.removeChild(this.view),this.type=f.RENDERER_TYPE.UNKNOWN,this.view=null,this.screen=null,this.resolution=0,this.transparent=!1,this.autoResize=!1,this.blendModes=null,this.options=null,this.preserveDrawingBuffer=!1,this.clearBeforeRender=!1,this.roundPixels=!1,this._backgroundColor=0,this._backgroundColorRgba=null,this._backgroundColorString=null,this._tempDisplayObjectParent=null,this._lastObjectRendered=null},l(o,[{key:"width",get:function(){return this.view.width}},{key:"height",get:function(){return this.view.height}},{key:"backgroundColor",get:function(){return this._backgroundColor},set:function(e){this._backgroundColor=e,this._backgroundColorString=(0,c.hex2string)(e),(0,c.hex2rgb)(e,this._backgroundColorRgba)}}]),o}(y.default);r.default=b},{"../const":46,"../display/Container":48,"../math":70,"../settings":101,"../textures/RenderTexture":113,"../utils":125,eventemitter3:3}],77:[function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function s(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function u(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}r.__esModule=!0;var i=e("../SystemRenderer"),a=n(i),l=e("./utils/CanvasMaskManager"),c=n(l),h=e("./utils/CanvasRenderTarget"),f=n(h),d=e("./utils/mapCanvasBlendModesToPixi"),p=n(d),v=e("../../utils"),m=e("../../const"),g=e("../../settings"),y=n(g),x=function(i){function a(e,t,r){o(this,a);var n=s(this,i.call(this,"Canvas",e,t,r));return n.type=m.RENDERER_TYPE.CANVAS,n.rootContext=n.view.getContext("2d",{alpha:n.transparent}),n.context=n.rootContext,n.refresh=!0,n.maskManager=new c.default(n),n.smoothProperty="imageSmoothingEnabled",n.rootContext.imageSmoothingEnabled||(n.rootContext.webkitImageSmoothingEnabled?n.smoothProperty="webkitImageSmoothingEnabled":n.rootContext.mozImageSmoothingEnabled?n.smoothProperty="mozImageSmoothingEnabled":n.rootContext.oImageSmoothingEnabled?n.smoothProperty="oImageSmoothingEnabled":n.rootContext.msImageSmoothingEnabled&&(n.smoothProperty="msImageSmoothingEnabled")),n.initPlugins(),n.blendModes=(0,p.default)(),n._activeBlendMode=null,n.renderingToScreen=!1,n.resize(n.options.width,n.options.height),n}return u(a,i),a.prototype.render=function(e,t,r,n,i){if(this.view){this.renderingToScreen=!t,this.emit("prerender");var a=this.resolution;t?(t=t.baseTexture||t,t._canvasRenderTarget||(t._canvasRenderTarget=new f.default(t.width,t.height,t.resolution),t.source=t._canvasRenderTarget.canvas,t.valid=!0),this.context=t._canvasRenderTarget.context,this.resolution=t._canvasRenderTarget.resolution):this.context=this.rootContext;var o=this.context;if(t||(this._lastObjectRendered=e),!i){var s=e.parent,u=this._tempDisplayObjectParent.transform.worldTransform;n?(n.copy(u),this._tempDisplayObjectParent.transform._worldID=-1):u.identity(),e.parent=this._tempDisplayObjectParent,e.updateTransform(),e.parent=s}o.save(),o.setTransform(1,0,0,1,0,0),o.globalAlpha=1,this._activeBlendMode=m.BLEND_MODES.NORMAL,o.globalCompositeOperation=this.blendModes[m.BLEND_MODES.NORMAL],navigator.isCocoonJS&&this.view.screencanvas&&(o.fillStyle="black",o.clear()),(void 0!==r?r:this.clearBeforeRender)&&this.renderingToScreen&&(this.transparent?o.clearRect(0,0,this.width,this.height):(o.fillStyle=this._backgroundColorString,o.fillRect(0,0,this.width,this.height)));var l=this.context;this.context=o,e.renderCanvas(this),this.context=l,o.restore(),this.resolution=a,this.emit("postrender")}},a.prototype.clear=function(e){var t=this.context;e=e||this._backgroundColorString,!this.transparent&&e?(t.fillStyle=e,t.fillRect(0,0,this.width,this.height)):t.clearRect(0,0,this.width,this.height)},a.prototype.setBlendMode=function(e){this._activeBlendMode!==e&&(this._activeBlendMode=e,this.context.globalCompositeOperation=this.blendModes[e])},a.prototype.destroy=function(e){this.destroyPlugins(),i.prototype.destroy.call(this,e),this.context=null,this.refresh=!0,this.maskManager.destroy(),this.maskManager=null,this.smoothProperty=null},a.prototype.resize=function(e,t){i.prototype.resize.call(this,e,t),this.smoothProperty&&(this.rootContext[this.smoothProperty]=y.default.SCALE_MODE===m.SCALE_MODES.LINEAR)},a.prototype.invalidateBlendMode=function(){this._activeBlendMode=this.blendModes.indexOf(this.context.globalCompositeOperation)},a}(a.default);r.default=x,v.pluginTarget.mixin(x)},{"../../const":46,"../../settings":101,"../../utils":125,"../SystemRenderer":76,"./utils/CanvasMaskManager":78,"./utils/CanvasRenderTarget":79,"./utils/mapCanvasBlendModesToPixi":81}],78:[function(e,t,r){"use strict";function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}r.__esModule=!0;var E=e("../../../const"),i=function(){function t(e){n(this,t),this.renderer=e}return t.prototype.pushMask=function(e){var t=this.renderer;t.context.save();var r=e.alpha,n=e.transform.worldTransform,i=t.resolution;t.context.setTransform(n.a*i,n.b*i,n.c*i,n.d*i,n.tx*i,n.ty*i),e._texture||(this.renderGraphicsShape(e),t.context.clip()),e.worldAlpha=r},t.prototype.renderGraphicsShape=function(e){var t=this.renderer.context,r=e.graphicsData.length;if(0!==r){t.beginPath();for(var n=0;n<r;n++){var i=e.graphicsData[n],a=i.shape;if(i.type===E.SHAPES.POLY){var o=a.points;t.moveTo(o[0],o[1]);for(var s=1;s<o.length/2;s++)t.lineTo(o[2*s],o[2*s+1]);o[0]===o[o.length-2]&&o[1]===o[o.length-1]&&t.closePath()}else if(i.type===E.SHAPES.RECT)t.rect(a.x,a.y,a.width,a.height),t.closePath();else if(i.type===E.SHAPES.CIRC)t.arc(a.x,a.y,a.radius,0,2*Math.PI),t.closePath();else if(i.type===E.SHAPES.ELIP){var u=2*a.width,l=2*a.height,c=a.x-u/2,h=a.y-l/2,f=u/2*.5522848,d=l/2*.5522848,p=c+u,v=h+l,m=c+u/2,g=h+l/2;t.moveTo(c,g),t.bezierCurveTo(c,g-d,m-f,h,m,h),t.bezierCurveTo(m+f,h,p,g-d,p,g),t.bezierCurveTo(p,g+d,m+f,v,m,v),t.bezierCurveTo(m-f,v,c,g+d,c,g),t.closePath()}else if(i.type===E.SHAPES.RREC){var y=a.x,x=a.y,b=a.width,w=a.height,_=a.radius,T=Math.min(b,w)/2|0;_=_>T?T:_,t.moveTo(y,x+_),t.lineTo(y,x+w-_),t.quadraticCurveTo(y,x+w,y+_,x+w),t.lineTo(y+b-_,x+w),t.quadraticCurveTo(y+b,x+w,y+b,x+w-_),t.lineTo(y+b,x+_),t.quadraticCurveTo(y+b,x,y+b-_,x),t.lineTo(y+_,x),t.quadraticCurveTo(y,x,y,x+_),t.closePath()}}}},t.prototype.popMask=function(e){e.context.restore(),e.invalidateBlendMode()},t.prototype.destroy=function(){},t}();r.default=i},{"../../../const":46}],79:[function(e,t,r){"use strict";function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}r.__esModule=!0;var a=function(){function n(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(e,t,r){return t&&n(e.prototype,t),r&&n(e,r),e}}(),n=e("../../../settings"),o=function(e){return e&&e.__esModule?e:{default:e}}(n),s=function(){function n(e,t,r){i(this,n),this.canvas=document.createElement("canvas"),this.context=this.canvas.getContext("2d"),this.resolution=r||o.default.RESOLUTION,this.resize(e,t)}return n.prototype.clear=function(){this.context.setTransform(1,0,0,1,0,0),this.context.clearRect(0,0,this.canvas.width,this.canvas.height)},n.prototype.resize=function(e,t){this.canvas.width=e*this.resolution,this.canvas.height=t*this.resolution},n.prototype.destroy=function(){this.context=null,this.canvas=null},a(n,[{key:"width",get:function(){return this.canvas.width},set:function(e){this.canvas.width=e}},{key:"height",get:function(){return this.canvas.height},set:function(e){this.canvas.height=e}}]),n}();r.default=s},{"../../../settings":101}],80:[function(e,t,r){"use strict";function o(e){var t=document.createElement("canvas");t.width=6,t.height=1;var r=t.getContext("2d");return r.fillStyle=e,r.fillRect(0,0,6,1),t}function n(){if("undefined"==typeof document)return!1;var e=o("#ff00ff"),t=o("#ffff00"),r=document.createElement("canvas");r.width=6,r.height=1;var n=r.getContext("2d");n.globalCompositeOperation="multiply",n.drawImage(e,0,0),n.drawImage(t,2,0);var i=n.getImageData(2,0,1,1);if(!i)return!1;var a=i.data;return 255===a[0]&&0===a[1]&&0===a[2]}r.__esModule=!0,r.default=n},{}],81:[function(e,t,r){"use strict";function n(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];return(0,o.default)()?(e[i.BLEND_MODES.NORMAL]="source-over",e[i.BLEND_MODES.ADD]="lighter",e[i.BLEND_MODES.MULTIPLY]="multiply",e[i.BLEND_MODES.SCREEN]="screen",e[i.BLEND_MODES.OVERLAY]="overlay",e[i.BLEND_MODES.DARKEN]="darken",e[i.BLEND_MODES.LIGHTEN]="lighten",e[i.BLEND_MODES.COLOR_DODGE]="color-dodge",e[i.BLEND_MODES.COLOR_BURN]="color-burn",e[i.BLEND_MODES.HARD_LIGHT]="hard-light",e[i.BLEND_MODES.SOFT_LIGHT]="soft-light",e[i.BLEND_MODES.DIFFERENCE]="difference",e[i.BLEND_MODES.EXCLUSION]="exclusion",e[i.BLEND_MODES.HUE]="hue",e[i.BLEND_MODES.SATURATION]="saturate",e[i.BLEND_MODES.COLOR]="color",e[i.BLEND_MODES.LUMINOSITY]="luminosity"):(e[i.BLEND_MODES.NORMAL]="source-over",e[i.BLEND_MODES.ADD]="lighter",e[i.BLEND_MODES.MULTIPLY]="source-over",e[i.BLEND_MODES.SCREEN]="source-over",e[i.BLEND_MODES.OVERLAY]="source-over",e[i.BLEND_MODES.DARKEN]="source-over",e[i.BLEND_MODES.LIGHTEN]="source-over",e[i.BLEND_MODES.COLOR_DODGE]="source-over",e[i.BLEND_MODES.COLOR_BURN]="source-over",e[i.BLEND_MODES.HARD_LIGHT]="source-over",e[i.BLEND_MODES.SOFT_LIGHT]="source-over",e[i.BLEND_MODES.DIFFERENCE]="source-over",e[i.BLEND_MODES.EXCLUSION]="source-over",e[i.BLEND_MODES.HUE]="source-over",e[i.BLEND_MODES.SATURATION]="source-over",e[i.BLEND_MODES.COLOR]="source-over",e[i.BLEND_MODES.LUMINOSITY]="source-over"),e[i.BLEND_MODES.NORMAL_NPM]=e[i.BLEND_MODES.NORMAL],e[i.BLEND_MODES.ADD_NPM]=e[i.BLEND_MODES.ADD],e[i.BLEND_MODES.SCREEN_NPM]=e[i.BLEND_MODES.SCREEN],e}r.__esModule=!0,r.default=n;var i=e("../../../const"),a=e("./canUseNewCanvasBlendModes"),o=function(e){return e&&e.__esModule?e:{default:e}}(a)},{"../../../const":46,"./canUseNewCanvasBlendModes":80}],82:[function(e,t,r){"use strict";function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}r.__esModule=!0;var i=e("../../const"),a=e("../../settings"),o=function(e){return e&&e.__esModule?e:{default:e}}(a),s=function(){function t(e){n(this,t),this.renderer=e,this.count=0,this.checkCount=0,this.maxIdle=o.default.GC_MAX_IDLE,this.checkCountMax=o.default.GC_MAX_CHECK_COUNT,this.mode=o.default.GC_MODE}return t.prototype.update=function(){this.count++,this.mode!==i.GC_MODES.MANUAL&&++this.checkCount>this.checkCountMax&&(this.checkCount=0,this.run())},t.prototype.run=function(){for(var e=this.renderer.textureManager,t=e._managedTextures,r=!1,n=0;n<t.length;n++){var i=t[n];!i._glRenderTargets&&this.count-i.touched>this.maxIdle&&(e.destroyTexture(i,!0),t[n]=null,r=!0)}if(r){for(var a=0,o=0;o<t.length;o++)null!==t[o]&&(t[a++]=t[o]);t.length=a}},t.prototype.unload=function(e){var t=this.renderer.textureManager;e._texture&&e._texture._glRenderTargets&&t.destroyTexture(e._texture,!0);for(var r=e.children.length-1;r>=0;r--)this.unload(e.children[r])},t}();r.default=s},{"../../const":46,"../../settings":101}],83:[function(e,t,r){"use strict";function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}r.__esModule=!0;var u=e("pixi-gl-core"),l=e("../../const"),i=e("./utils/RenderTarget"),c=function(e){return e&&e.__esModule?e:{default:e}}(i),o=e("../../utils"),a=function(){function t(e){n(this,t),this.renderer=e,this.gl=e.gl,this._managedTextures=[]}return t.prototype.bindTexture=function(){},t.prototype.getTexture=function(){},t.prototype.updateTexture=function(e,t){var r=this.gl,n=!!e._glRenderTargets;if(!e.hasLoaded)return null;var i=this.renderer.boundTextures;if(void 0===t){t=0;for(var a=0;a<i.length;++a)if(i[a]===e){t=a;break}}i[t]=e,r.activeTexture(r.TEXTURE0+t);var o=e._glTextures[this.renderer.CONTEXT_UID];if(o)n?e._glRenderTargets[this.renderer.CONTEXT_UID].resize(e.width,e.height):o.upload(e.source);else{if(n){var s=new c.default(this.gl,e.width,e.height,e.scaleMode,e.resolution);s.resize(e.width,e.height),e._glRenderTargets[this.renderer.CONTEXT_UID]=s,o=s.texture}else o=new u.GLTexture(this.gl,null,null,null,null),o.bind(t),o.premultiplyAlpha=!0,o.upload(e.source);e._glTextures[this.renderer.CONTEXT_UID]=o,e.on("update",this.updateTexture,this),e.on("dispose",this.destroyTexture,this),this._managedTextures.push(e),e.isPowerOfTwo?(e.mipmap&&o.enableMipmap(),e.wrapMode===l.WRAP_MODES.CLAMP?o.enableWrapClamp():e.wrapMode===l.WRAP_MODES.REPEAT?o.enableWrapRepeat():o.enableWrapMirrorRepeat()):o.enableWrapClamp(),e.scaleMode===l.SCALE_MODES.NEAREST?o.enableNearestScaling():o.enableLinearScaling()}return o},t.prototype.destroyTexture=function(e,t){if(e=e.baseTexture||e,e.hasLoaded){var r=this.renderer.CONTEXT_UID,n=e._glTextures,i=e._glRenderTargets;if(n[r]&&(this.renderer.unbindTexture(e),n[r].destroy(),e.off("update",this.updateTexture,this),e.off("dispose",this.destroyTexture,this),delete n[r],!t)){var a=this._managedTextures.indexOf(e);-1!==a&&(0,o.removeItems)(this._managedTextures,a,1)}i&&i[r]&&(i[r].destroy(),delete i[r])}},t.prototype.removeAll=function(){for(var e=0;e<this._managedTextures.length;++e){var t=this._managedTextures[e];t._glTextures[this.renderer.CONTEXT_UID]&&delete t._glTextures[this.renderer.CONTEXT_UID]}},t.prototype.destroy=function(){for(var e=0;e<this._managedTextures.length;++e){var t=this._managedTextures[e];this.destroyTexture(t,!0),t.off("update",this.updateTexture,this),t.off("dispose",this.destroyTexture,this)}this._managedTextures=null},t}();r.default=a},{"../../const":46,"../../utils":125,"./utils/RenderTarget":96,"pixi-gl-core":12}],84:[function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function s(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function u(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}r.__esModule=!0;var i=e("../SystemRenderer"),l=n(i),a=e("./managers/MaskManager"),c=n(a),h=e("./managers/StencilManager"),f=n(h),d=e("./managers/FilterManager"),p=n(d),v=e("./utils/RenderTarget"),m=n(v),g=e("./utils/ObjectRenderer"),y=n(g),x=e("./TextureManager"),b=n(x),w=e("../../textures/BaseTexture"),_=n(w),T=e("./TextureGarbageCollector"),E=n(T),M=e("./WebGLState"),S=n(M),A=e("./utils/mapWebGLDrawModesToPixi"),R=n(A),P=e("./utils/validateContext"),C=n(P),O=e("../../utils"),L=e("pixi-gl-core"),I=n(L),D=e("../../const"),N=0,F=function(i){function a(e,t,r){o(this,a);var n=s(this,i.call(this,"WebGL",e,t,r));return n.legacy=n.options.legacy,n.legacy&&(I.default.VertexArrayObject.FORCE_NATIVE=!0),n.type=D.RENDERER_TYPE.WEBGL,n.handleContextLost=n.handleContextLost.bind(n),n.handleContextRestored=n.handleContextRestored.bind(n),n.view.addEventListener("webglcontextlost",n.handleContextLost,!1),n.view.addEventListener("webglcontextrestored",n.handleContextRestored,!1),n._contextOptions={alpha:n.transparent,antialias:n.options.antialias,premultipliedAlpha:n.transparent&&"notMultiplied"!==n.transparent,stencil:!0,preserveDrawingBuffer:n.options.preserveDrawingBuffer,powerPreference:n.options.powerPreference},n._backgroundColorRgba[3]=n.transparent?0:1,n.maskManager=new c.default(n),n.stencilManager=new f.default(n),n.emptyRenderer=new y.default(n),n.currentRenderer=n.emptyRenderer,n.textureManager=null,n.filterManager=null,n.initPlugins(),n.options.context&&(0,C.default)(n.options.context),n.gl=n.options.context||I.default.createContext(n.view,n._contextOptions),n.CONTEXT_UID=N++,n.state=new S.default(n.gl),n.renderingToScreen=!0,n.boundTextures=null,n._activeShader=null,n._activeVao=null,n._activeRenderTarget=null,n._initContext(),n.drawModes=(0,R.default)(n.gl),n._nextTextureLocation=0,n.setBlendMode(0),n}return u(a,i),a.prototype._initContext=function(){var e=this.gl;e.isContextLost()&&e.getExtension("WEBGL_lose_context")&&e.getExtension("WEBGL_lose_context").restoreContext();var t=e.getParameter(e.MAX_TEXTURE_IMAGE_UNITS);this._activeShader=null,this._activeVao=null,this.boundTextures=new Array(t),this.emptyTextures=new Array(t),this.textureManager=new b.default(this),this.filterManager=new p.default(this),this.textureGC=new E.default(this),this.state.resetToDefault(),this.rootRenderTarget=new m.default(e,this.width,this.height,null,this.resolution,!0),this.rootRenderTarget.clearColor=this._backgroundColorRgba,this.bindRenderTarget(this.rootRenderTarget);var r=new I.default.GLTexture.fromData(e,null,1,1),n={_glTextures:{}};n._glTextures[this.CONTEXT_UID]={};for(var i=0;i<t;i++){var a=new _.default;a._glTextures[this.CONTEXT_UID]=r,this.boundTextures[i]=n,this.emptyTextures[i]=a,this.bindTexture(null,i)}this.emit("context",e),this.resize(this.screen.width,this.screen.height)},a.prototype.render=function(e,t,r,n,i){if(this.renderingToScreen=!t,this.emit("prerender"),this.gl&&!this.gl.isContextLost()){if(this._nextTextureLocation=0,t||(this._lastObjectRendered=e),!i){var a=e.parent;e.parent=this._tempDisplayObjectParent,e.updateTransform(),e.parent=a}this.bindRenderTexture(t,n),this.currentRenderer.start(),(void 0!==r?r:this.clearBeforeRender)&&this._activeRenderTarget.clear(),e.renderWebGL(this),this.currentRenderer.flush(),this.textureGC.update(),this.emit("postrender")}},a.prototype.setObjectRenderer=function(e){this.currentRenderer!==e&&(this.currentRenderer.stop(),this.currentRenderer=e,this.currentRenderer.start())},a.prototype.flush=function(){this.setObjectRenderer(this.emptyRenderer)},a.prototype.resize=function(e,t){l.default.prototype.resize.call(this,e,t),this.rootRenderTarget.resize(e,t),this._activeRenderTarget===this.rootRenderTarget&&(this.rootRenderTarget.activate(),this._activeShader&&(this._activeShader.uniforms.projectionMatrix=this.rootRenderTarget.projectionMatrix.toArray(!0)))},a.prototype.setBlendMode=function(e){this.state.setBlendMode(e)},a.prototype.clear=function(e){this._activeRenderTarget.clear(e)},a.prototype.setTransform=function(e){this._activeRenderTarget.transform=e},a.prototype.clearRenderTexture=function(e,t){var r=e.baseTexture,n=r._glRenderTargets[this.CONTEXT_UID];return n&&n.clear(t),this},a.prototype.bindRenderTexture=function(e,t){var r=void 0;if(e){var n=e.baseTexture;n._glRenderTargets[this.CONTEXT_UID]||this.textureManager.updateTexture(n,0),this.unbindTexture(n),r=n._glRenderTargets[this.CONTEXT_UID],r.setFrame(e.frame)}else r=this.rootRenderTarget;return r.transform=t,this.bindRenderTarget(r),this},a.prototype.bindRenderTarget=function(e){return e!==this._activeRenderTarget&&(this._activeRenderTarget=e,e.activate(),this._activeShader&&(this._activeShader.uniforms.projectionMatrix=e.projectionMatrix.toArray(!0)),this.stencilManager.setMaskStack(e.stencilMaskStack)),this},a.prototype.bindShader=function(e,t){return this._activeShader!==e&&(this._activeShader=e,e.bind(),!1!==t&&(e.uniforms.projectionMatrix=this._activeRenderTarget.projectionMatrix.toArray(!0))),this},a.prototype.bindTexture=function(e,t,r){if(e=e||this.emptyTextures[t],e=e.baseTexture||e,e.touched=this.textureGC.count,r)t=t||0;else{for(var n=0;n<this.boundTextures.length;n++)if(this.boundTextures[n]===e)return n;void 0===t&&(this._nextTextureLocation++,this._nextTextureLocation%=this.boundTextures.length,t=this.boundTextures.length-this._nextTextureLocation-1)}var i=this.gl,a=e._glTextures[this.CONTEXT_UID];return a?(this.boundTextures[t]=e,i.activeTexture(i.TEXTURE0+t),i.bindTexture(i.TEXTURE_2D,a.texture)):this.textureManager.updateTexture(e,t),t},a.prototype.unbindTexture=function(e){var t=this.gl;e=e.baseTexture||e;for(var r=0;r<this.boundTextures.length;r++)this.boundTextures[r]===e&&(this.boundTextures[r]=this.emptyTextures[r],t.activeTexture(t.TEXTURE0+r),t.bindTexture(t.TEXTURE_2D,this.emptyTextures[r]._glTextures[this.CONTEXT_UID].texture));return this},a.prototype.createVao=function(){return new I.default.VertexArrayObject(this.gl,this.state.attribState)},a.prototype.bindVao=function(e){return this._activeVao===e?this:(e?e.bind():this._activeVao&&this._activeVao.unbind(),this._activeVao=e,this)},a.prototype.reset=function(){this.setObjectRenderer(this.emptyRenderer),this._activeShader=null,this._activeVao=null,this._activeRenderTarget=this.rootRenderTarget;for(var e=0;e<this.boundTextures.length;e++)this.boundTextures[e]=this.emptyTextures[e];return this.rootRenderTarget.activate(),this.state.resetToDefault(),this},a.prototype.handleContextLost=function(e){e.preventDefault()},a.prototype.handleContextRestored=function(){this.textureManager.removeAll(),this.filterManager.destroy(!0),this._initContext()},a.prototype.destroy=function(e){this.destroyPlugins(),this.view.removeEventListener("webglcontextlost",this.handleContextLost),this.view.removeEventListener("webglcontextrestored",this.handleContextRestored),this.textureManager.destroy(),i.prototype.destroy.call(this,e),this.uid=0,this.maskManager.destroy(),this.stencilManager.destroy(),this.filterManager.destroy(),this.maskManager=null,this.filterManager=null,this.textureManager=null,this.currentRenderer=null,this.handleContextLost=null,this.handleContextRestored=null,this._contextOptions=null,this.gl.useProgram(null),this.gl.getExtension("WEBGL_lose_context")&&this.gl.getExtension("WEBGL_lose_context").loseContext(),this.gl=null},a}(l.default);r.default=F,O.pluginTarget.mixin(F)},{"../../const":46,"../../textures/BaseTexture":112,"../../utils":125,"../SystemRenderer":76,"./TextureGarbageCollector":82,"./TextureManager":83,"./WebGLState":85,"./managers/FilterManager":90,"./managers/MaskManager":91,"./managers/StencilManager":92,"./utils/ObjectRenderer":94,"./utils/RenderTarget":96,"./utils/mapWebGLDrawModesToPixi":99,"./utils/validateContext":100,"pixi-gl-core":12}],85:[function(e,t,r){"use strict";function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}r.__esModule=!0;var i=e("./utils/mapWebGLBlendModesToPixi"),a=function(e){return e&&e.__esModule?e:{default:e}}(i),o=function(){function t(e){n(this,t),this.activeState=new Uint8Array(16),this.defaultState=new Uint8Array(16),this.defaultState[0]=1,this.stackIndex=0,this.stack=[],this.gl=e,this.maxAttribs=e.getParameter(e.MAX_VERTEX_ATTRIBS),this.attribState={tempAttribState:new Array(this.maxAttribs),attribState:new Array(this.maxAttribs)},this.blendModes=(0,a.default)(e),this.nativeVaoExtension=e.getExtension("OES_vertex_array_object")||e.getExtension("MOZ_OES_vertex_array_object")||e.getExtension("WEBKIT_OES_vertex_array_object")}return t.prototype.push=function(){var e=this.stack[this.stackIndex];e||(e=this.stack[this.stackIndex]=new Uint8Array(16)),++this.stackIndex;for(var t=0;t<this.activeState.length;t++)e[t]=this.activeState[t]},t.prototype.pop=function(){var e=this.stack[--this.stackIndex];this.setState(e)},t.prototype.setState=function(e){this.setBlend(e[0]),this.setDepthTest(e[1]),this.setFrontFace(e[2]),this.setCullFace(e[3]),this.setBlendMode(e[4])},t.prototype.setBlend=function(e){e=e?1:0,this.activeState[0]!==e&&(this.activeState[0]=e,this.gl[e?"enable":"disable"](this.gl.BLEND))},t.prototype.setBlendMode=function(e){if(e!==this.activeState[4]){this.activeState[4]=e;var t=this.blendModes[e];2===t.length?this.gl.blendFunc(t[0],t[1]):this.gl.blendFuncSeparate(t[0],t[1],t[2],t[3])}},t.prototype.setDepthTest=function(e){e=e?1:0,this.activeState[1]!==e&&(this.activeState[1]=e,this.gl[e?"enable":"disable"](this.gl.DEPTH_TEST))},t.prototype.setCullFace=function(e){e=e?1:0,this.activeState[3]!==e&&(this.activeState[3]=e,this.gl[e?"enable":"disable"](this.gl.CULL_FACE))},t.prototype.setFrontFace=function(e){e=e?1:0,this.activeState[2]!==e&&(this.activeState[2]=e,this.gl.frontFace(this.gl[e?"CW":"CCW"]))},t.prototype.resetAttributes=function(){for(var e=0;e<this.attribState.tempAttribState.length;e++)this.attribState.tempAttribState[e]=0;for(var t=0;t<this.attribState.attribState.length;t++)this.attribState.attribState[t]=0;for(var r=1;r<this.maxAttribs;r++)this.gl.disableVertexAttribArray(r)},t.prototype.resetToDefault=function(){this.nativeVaoExtension&&this.nativeVaoExtension.bindVertexArrayOES(null),this.resetAttributes();for(var e=0;e<this.activeState.length;++e)this.activeState[e]=32;this.gl.pixelStorei(this.gl.UNPACK_FLIP_Y_WEBGL,!1),this.setState(this.defaultState)},t}();r.default=o},{"./utils/mapWebGLBlendModesToPixi":98}],86:[function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}r.__esModule=!0;var o=function(){function n(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(e,t,r){return t&&n(e.prototype,t),r&&n(e,r),e}}(),i=e("./extractUniformsFromSrc"),s=n(i),u=e("../../../utils"),l=e("../../../const"),c=e("../../../settings"),h=n(c),f={},d=function(){function i(e,t,r){a(this,i),this.vertexSrc=e||i.defaultVertexSrc,this.fragmentSrc=t||i.defaultFragmentSrc,this._blendMode=l.BLEND_MODES.NORMAL,this.uniformData=r||(0,s.default)(this.vertexSrc,this.fragmentSrc,"projectionMatrix|uSampler"),this.uniforms={};for(var n in this.uniformData)this.uniforms[n]=this.uniformData[n].value,this.uniformData[n].type&&(this.uniformData[n].type=this.uniformData[n].type.toLowerCase());this.glShaders={},f[this.vertexSrc+this.fragmentSrc]||(f[this.vertexSrc+this.fragmentSrc]=(0,u.uid)()),this.glShaderKey=f[this.vertexSrc+this.fragmentSrc],this.padding=4,this.resolution=h.default.RESOLUTION,this.enabled=!0,this.autoFit=!0}return i.prototype.apply=function(e,t,r,n,i){e.applyFilter(this,t,r,n)},o(i,[{key:"blendMode",get:function(){return this._blendMode},set:function(e){this._blendMode=e}}],[{key:"defaultVertexSrc",get:function(){return["attribute vec2 aVertexPosition;","attribute vec2 aTextureCoord;","uniform mat3 projectionMatrix;","uniform mat3 filterMatrix;","varying vec2 vTextureCoord;","varying vec2 vFilterCoord;","void main(void){","   gl_Position = vec4((projectionMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);","   vFilterCoord = ( filterMatrix * vec3( aTextureCoord, 1.0)  ).xy;","   vTextureCoord = aTextureCoord ;","}"].join("\n")}},{key:"defaultFragmentSrc",get:function(){return["varying vec2 vTextureCoord;","varying vec2 vFilterCoord;","uniform sampler2D uSampler;","uniform sampler2D filterSampler;","void main(void){","   vec4 masky = texture2D(filterSampler, vFilterCoord);","   vec4 sample = texture2D(uSampler, vTextureCoord);","   vec4 color;","   if(mod(vFilterCoord.x, 1.0) > 0.5)","   {","     color = vec4(1.0, 0.0, 0.0, 1.0);","   }","   else","   {","     color = vec4(0.0, 1.0, 0.0, 1.0);","   }","   gl_FragColor = mix(sample, masky, 0.5);","   gl_FragColor *= sample.a;","}"].join("\n")}}]),i}();r.default=d},{"../../../const":46,"../../../settings":101,"../../../utils":125,"./extractUniformsFromSrc":87}],87:[function(e,t,r){"use strict";function n(e,t,r){var n=a(e),i=a(t);return Object.assign(n,i)}function a(e){for(var t=new RegExp("^(projectionMatrix|uSampler|filterArea|filterClamp)$"),r={},n=void 0,i=e.replace(/\s+/g," ").split(/\s*;\s*/),a=0;a<i.length;a++){var o=i[a].trim();if(o.indexOf("uniform")>-1){var s=o.split(" "),u=s[1],l=s[2],c=1;l.indexOf("[")>-1&&(n=l.split(/\[|]/),l=n[0],c*=Number(n[1])),l.match(t)||(r[l]={value:h(u,c),name:l,type:u})}}return r}r.__esModule=!0,r.default=n;var i=e("pixi-gl-core"),o=function(e){return e&&e.__esModule?e:{default:e}}(i),h=o.default.shader.defaultValue},{"pixi-gl-core":12}],88:[function(e,t,r){"use strict";function n(e,t,r){var n=e.identity();return n.translate(t.x/r.width,t.y/r.height),n.scale(r.width,r.height),n}function i(e,t,r){var n=e.identity();n.translate(t.x/r.width,t.y/r.height);var i=r.width/t.width,a=r.height/t.height;return n.scale(i,a),n}function a(e,t,r,n){var i=n._texture.orig,a=e.set(r.width,0,0,r.height,t.x,t.y),o=n.worldTransform.copy(s.Matrix.TEMP_MATRIX);return o.invert(),a.prepend(o),a.scale(1/i.width,1/i.height),a.translate(n.anchor.x,n.anchor.y),a}r.__esModule=!0,r.calculateScreenSpaceMatrix=n,r.calculateNormalizedScreenSpaceMatrix=i,r.calculateSpriteMatrix=a;var s=e("../../../math")},{"../../../math":70}],89:[function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function s(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}r.__esModule=!0;var i=e("../Filter"),u=n(i),l=e("../../../../math"),c=(e("path"),e("../../../../textures/TextureMatrix")),h=n(c),f=function(n){function i(e){a(this,i);var t=new l.Matrix,r=o(this,n.call(this,"attribute vec2 aVertexPosition;\nattribute vec2 aTextureCoord;\n\nuniform mat3 projectionMatrix;\nuniform mat3 otherMatrix;\n\nvarying vec2 vMaskCoord;\nvarying vec2 vTextureCoord;\n\nvoid main(void)\n{\n    gl_Position = vec4((projectionMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);\n\n    vTextureCoord = aTextureCoord;\n    vMaskCoord = ( otherMatrix * vec3( aTextureCoord, 1.0)  ).xy;\n}\n","varying vec2 vMaskCoord;\nvarying vec2 vTextureCoord;\n\nuniform sampler2D uSampler;\nuniform sampler2D mask;\nuniform float alpha;\nuniform vec4 maskClamp;\n\nvoid main(void)\n{\n    float clip = step(3.5,\n        step(maskClamp.x, vMaskCoord.x) +\n        step(maskClamp.y, vMaskCoord.y) +\n        step(vMaskCoord.x, maskClamp.z) +\n        step(vMaskCoord.y, maskClamp.w));\n\n    vec4 original = texture2D(uSampler, vTextureCoord);\n    vec4 masky = texture2D(mask, vMaskCoord);\n\n    original *= (masky.r * masky.a * alpha * clip);\n\n    gl_FragColor = original;\n}\n"));return e.renderable=!1,r.maskSprite=e,r.maskMatrix=t,r}return s(i,n),i.prototype.apply=function(e,t,r){var n=this.maskSprite,i=this.maskSprite.texture;i.valid&&(i.transform||(i.transform=new h.default(i,0)),i.transform.update(),this.uniforms.mask=i,this.uniforms.otherMatrix=e.calculateSpriteMatrix(this.maskMatrix,n).prepend(i.transform.mapCoord),this.uniforms.alpha=n.worldAlpha,this.uniforms.maskClamp=i.transform.uClampFrame,e.applyFilter(this,t,r))},i}(u.default);r.default=f},{"../../../../math":70,"../../../../textures/TextureMatrix":116,"../Filter":86,path:23}],90:[function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function i(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}r.__esModule=!0;var s=e("./WebGLManager"),u=n(s),l=e("../utils/RenderTarget"),c=n(l),h=e("../utils/Quad"),f=n(h),d=e("../../../math"),p=e("../../../Shader"),v=n(p),m=e("../filters/filterTransforms"),g=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t.default=e,t}(m),y=e("bit-twiddle"),x=n(y),b=function e(){o(this,e),this.renderTarget=null,this.sourceFrame=new d.Rectangle,this.destinationFrame=new d.Rectangle,this.filters=[],this.target=null,this.resolution=1},w=function(r){function n(e){o(this,n);var t=i(this,r.call(this,e));return t.gl=t.renderer.gl,t.quad=new f.default(t.gl,e.state.attribState),t.shaderCache={},t.pool={},t.filterData=null,t.managedFilters=[],t}return a(n,r),n.prototype.pushFilter=function(e,t){var r=this.renderer,n=this.filterData;if(!n){n=this.renderer._activeRenderTarget.filterStack;var i=new b;i.sourceFrame=i.destinationFrame=this.renderer._activeRenderTarget.size,i.renderTarget=r._activeRenderTarget,this.renderer._activeRenderTarget.filterData=n={index:0,stack:[i]},this.filterData=n}var a=n.stack[++n.index];a||(a=n.stack[n.index]=new b);var o=t[0].resolution,s=0|t[0].padding,u=e.filterArea||e.getBounds(!0),l=a.sourceFrame,c=a.destinationFrame;l.x=(u.x*o|0)/o,l.y=(u.y*o|0)/o,l.width=(u.width*o|0)/o,l.height=(u.height*o|0)/o,n.stack[0].renderTarget.transform||t[0].autoFit&&l.fit(n.stack[0].destinationFrame),l.pad(s),c.width=l.width,c.height=l.height;var h=this.getPotRenderTarget(r.gl,l.width,l.height,o);a.target=e,a.filters=t,a.resolution=o,a.renderTarget=h,h.setFrame(c,l),r.bindRenderTarget(h),h.clear()},n.prototype.popFilter=function(){var e=this.filterData,t=e.stack[e.index-1],r=e.stack[e.index];this.quad.map(r.renderTarget.size,r.sourceFrame).upload();var n=r.filters;if(1===n.length)n[0].apply(this,r.renderTarget,t.renderTarget,!1,r),this.freePotRenderTarget(r.renderTarget);else{var i=r.renderTarget,a=this.getPotRenderTarget(this.renderer.gl,r.sourceFrame.width,r.sourceFrame.height,r.resolution);a.setFrame(r.destinationFrame,r.sourceFrame),a.clear();var o=0;for(o=0;o<n.length-1;++o){n[o].apply(this,i,a,!0,r);var s=i;i=a,a=s}n[o].apply(this,i,t.renderTarget,!1,r),this.freePotRenderTarget(i),this.freePotRenderTarget(a)}0===--e.index&&(this.filterData=null)},n.prototype.applyFilter=function(e,t,r,n){var i=this.renderer,a=i.gl,o=e.glShaders[i.CONTEXT_UID];o||(e.glShaderKey?(o=this.shaderCache[e.glShaderKey])||(o=new v.default(this.gl,e.vertexSrc,e.fragmentSrc),e.glShaders[i.CONTEXT_UID]=this.shaderCache[e.glShaderKey]=o):o=e.glShaders[i.CONTEXT_UID]=new v.default(this.gl,e.vertexSrc,e.fragmentSrc),this.managedFilters.push(e),i.bindVao(null),this.quad.initVao(o)),i.bindVao(this.quad.vao),i.bindRenderTarget(r),n&&(a.disable(a.SCISSOR_TEST),i.clear(),a.enable(a.SCISSOR_TEST)),r===i.maskManager.scissorRenderTarget&&i.maskManager.pushScissorMask(null,i.maskManager.scissorData),i.bindShader(o);var s=this.renderer.emptyTextures[0];this.renderer.boundTextures[0]=s,this.syncUniforms(o,e),i.state.setBlendMode(e.blendMode),a.activeTexture(a.TEXTURE0),a.bindTexture(a.TEXTURE_2D,t.texture.texture),this.quad.vao.draw(this.renderer.gl.TRIANGLES,6,0),a.bindTexture(a.TEXTURE_2D,s._glTextures[this.renderer.CONTEXT_UID].texture)},n.prototype.syncUniforms=function(e,t){var r=t.uniformData,n=t.uniforms,i=1,a=void 0;if(e.uniforms.filterArea){a=this.filterData.stack[this.filterData.index];var o=e.uniforms.filterArea;o[0]=a.renderTarget.size.width,o[1]=a.renderTarget.size.height,o[2]=a.sourceFrame.x,o[3]=a.sourceFrame.y,e.uniforms.filterArea=o}if(e.uniforms.filterClamp){a=a||this.filterData.stack[this.filterData.index];var s=e.uniforms.filterClamp;s[0]=0,s[1]=0,s[2]=(a.sourceFrame.width-1)/a.renderTarget.size.width,s[3]=(a.sourceFrame.height-1)/a.renderTarget.size.height,e.uniforms.filterClamp=s}for(var u in r){var l=r[u].type;if("sampler2d"===l&&0!==n[u]){if(n[u].baseTexture)e.uniforms[u]=this.renderer.bindTexture(n[u].baseTexture,i);else{e.uniforms[u]=i;var c=this.renderer.gl;this.renderer.boundTextures[i]=this.renderer.emptyTextures[i],c.activeTexture(c.TEXTURE0+i),n[u].texture.bind()}i++}else if("mat3"===l)void 0!==n[u].a?e.uniforms[u]=n[u].toArray(!0):e.uniforms[u]=n[u];else if("vec2"===l)if(void 0!==n[u].x){var h=e.uniforms[u]||new Float32Array(2);h[0]=n[u].x,h[1]=n[u].y,e.uniforms[u]=h}else e.uniforms[u]=n[u];else"float"===l?e.uniforms.data[u].value!==r[u]&&(e.uniforms[u]=n[u]):e.uniforms[u]=n[u]}},n.prototype.getRenderTarget=function(e,t){var r=this.filterData.stack[this.filterData.index],n=this.getPotRenderTarget(this.renderer.gl,r.sourceFrame.width,r.sourceFrame.height,t||r.resolution);return n.setFrame(r.destinationFrame,r.sourceFrame),n},n.prototype.returnRenderTarget=function(e){this.freePotRenderTarget(e)},n.prototype.calculateScreenSpaceMatrix=function(e){var t=this.filterData.stack[this.filterData.index];return g.calculateScreenSpaceMatrix(e,t.sourceFrame,t.renderTarget.size)},n.prototype.calculateNormalizedScreenSpaceMatrix=function(e){var t=this.filterData.stack[this.filterData.index];return g.calculateNormalizedScreenSpaceMatrix(e,t.sourceFrame,t.renderTarget.size,t.destinationFrame)},n.prototype.calculateSpriteMatrix=function(e,t){var r=this.filterData.stack[this.filterData.index];return g.calculateSpriteMatrix(e,r.sourceFrame,r.renderTarget.size,t)},n.prototype.destroy=function(){for(var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=this.renderer,r=this.managedFilters,n=0;n<r.length;n++)e||r[n].glShaders[t.CONTEXT_UID].destroy(),delete r[n].glShaders[t.CONTEXT_UID];this.shaderCache={},e?this.pool={}:this.emptyPool()},n.prototype.getPotRenderTarget=function(e,t,r,n){t=x.default.nextPow2(t*n),r=x.default.nextPow2(r*n);var i=(65535&t)<<16|65535&r;this.pool[i]||(this.pool[i]=[]);var a=this.pool[i].pop();if(!a){var o=this.renderer.boundTextures[0];e.activeTexture(e.TEXTURE0),a=new c.default(e,t,r,null,1),e.bindTexture(e.TEXTURE_2D,o._glTextures[this.renderer.CONTEXT_UID].texture)}return a.resolution=n,a.defaultFrame.width=a.size.width=t/n,a.defaultFrame.height=a.size.height=r/n,a},n.prototype.emptyPool=function(){for(var e in this.pool){var t=this.pool[e];if(t)for(var r=0;r<t.length;r++)t[r].destroy(!0)}this.pool={}},n.prototype.freePotRenderTarget=function(e){var t=e.size.width*e.resolution,r=e.size.height*e.resolution,n=(65535&t)<<16|65535&r;this.pool[n].push(e)},n}(u.default);r.default=w},{"../../../Shader":44,"../../../math":70,"../filters/filterTransforms":88,"../utils/Quad":95,"../utils/RenderTarget":96,"./WebGLManager":93,"bit-twiddle":1}],91:[function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function o(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}r.__esModule=!0;var s=e("./WebGLManager"),u=n(s),l=e("../filters/spriteMask/SpriteMaskFilter"),c=n(l),h=function(r){function n(e){i(this,n);var t=a(this,r.call(this,e));return t.scissor=!1,t.scissorData=null,t.scissorRenderTarget=null,t.enableScissor=!0,t.alphaMaskPool=[],t.alphaMaskIndex=0,t}return o(n,r),n.prototype.pushMask=function(e,t){if(t.texture)this.pushSpriteMask(e,t);else if(this.enableScissor&&!this.scissor&&this.renderer._activeRenderTarget.root&&!this.renderer.stencilManager.stencilMaskStack.length&&t.isFastRect()){var r=t.worldTransform,n=Math.atan2(r.b,r.a);n=Math.round(n*(180/Math.PI)),n%90?this.pushStencilMask(t):this.pushScissorMask(e,t)}else this.pushStencilMask(t)},n.prototype.popMask=function(e,t){t.texture?this.popSpriteMask(e,t):this.enableScissor&&!this.renderer.stencilManager.stencilMaskStack.length?this.popScissorMask(e,t):this.popStencilMask(e,t)},n.prototype.pushSpriteMask=function(e,t){var r=this.alphaMaskPool[this.alphaMaskIndex];r||(r=this.alphaMaskPool[this.alphaMaskIndex]=[new c.default(t)]),r[0].resolution=this.renderer.resolution,r[0].maskSprite=t,e.filterArea=t.getBounds(!0),this.renderer.filterManager.pushFilter(e,r),this.alphaMaskIndex++},n.prototype.popSpriteMask=function(){this.renderer.filterManager.popFilter(),this.alphaMaskIndex--},n.prototype.pushStencilMask=function(e){this.renderer.currentRenderer.stop(),this.renderer.stencilManager.pushStencil(e)},n.prototype.popStencilMask=function(){this.renderer.currentRenderer.stop(),this.renderer.stencilManager.popStencil()},n.prototype.pushScissorMask=function(e,t){t.renderable=!0;var r=this.renderer._activeRenderTarget,n=t.getBounds();n.fit(r.size),t.renderable=!1,this.renderer.gl.enable(this.renderer.gl.SCISSOR_TEST);var i=this.renderer.resolution;this.renderer.gl.scissor(n.x*i,(r.root?r.size.height-n.y-n.height:n.y)*i,n.width*i,n.height*i),this.scissorRenderTarget=r,this.scissorData=t,this.scissor=!0},n.prototype.popScissorMask=function(){this.scissorRenderTarget=null,this.scissorData=null,this.scissor=!1;var e=this.renderer.gl;e.disable(e.SCISSOR_TEST)},n}(u.default);r.default=h},{"../filters/spriteMask/SpriteMaskFilter":89,"./WebGLManager":93}],92:[function(e,t,r){"use strict";function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function o(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}r.__esModule=!0;var n=e("./WebGLManager"),s=function(e){return e&&e.__esModule?e:{default:e}}(n),u=function(r){function n(e){i(this,n);var t=a(this,r.call(this,e));return t.stencilMaskStack=null,t}return o(n,r),n.prototype.setMaskStack=function(e){this.stencilMaskStack=e;var t=this.renderer.gl;0===e.length?t.disable(t.STENCIL_TEST):t.enable(t.STENCIL_TEST)},n.prototype.pushStencil=function(e){this.renderer.setObjectRenderer(this.renderer.plugins.graphics),this.renderer._activeRenderTarget.attachStencilBuffer();var t=this.renderer.gl,r=this.stencilMaskStack.length;0===r&&t.enable(t.STENCIL_TEST),this.stencilMaskStack.push(e),t.colorMask(!1,!1,!1,!1),t.stencilFunc(t.EQUAL,r,this._getBitwiseMask()),t.stencilOp(t.KEEP,t.KEEP,t.INCR),this.renderer.plugins.graphics.render(e),this._useCurrent()},n.prototype.popStencil=function(){this.renderer.setObjectRenderer(this.renderer.plugins.graphics);var e=this.renderer.gl,t=this.stencilMaskStack.pop();0===this.stencilMaskStack.length?(e.disable(e.STENCIL_TEST),e.clear(e.STENCIL_BUFFER_BIT),e.clearStencil(0)):(e.colorMask(!1,!1,!1,!1),e.stencilOp(e.KEEP,e.KEEP,e.DECR),this.renderer.plugins.graphics.render(t),this._useCurrent())},n.prototype._useCurrent=function(){var e=this.renderer.gl;e.colorMask(!0,!0,!0,!0),e.stencilFunc(e.EQUAL,this.stencilMaskStack.length,this._getBitwiseMask()),e.stencilOp(e.KEEP,e.KEEP,e.KEEP)},n.prototype._getBitwiseMask=function(){return(1<<this.stencilMaskStack.length)-1},n.prototype.destroy=function(){s.default.prototype.destroy.call(this),this.stencilMaskStack.stencilStack=null},n}(s.default);r.default=u},{"./WebGLManager":93}],93:[function(e,t,r){"use strict";function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}r.__esModule=!0;var i=function(){function t(e){n(this,t),this.renderer=e,this.renderer.on("context",this.onContextChange,this)}return t.prototype.onContextChange=function(){},t.prototype.destroy=function(){this.renderer.off("context",this.onContextChange,this),this.renderer=null},t}();r.default=i},{}],94:[function(e,t,r){"use strict";function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}r.__esModule=!0;var o=e("../managers/WebGLManager"),s=function(e){return e&&e.__esModule?e:{default:e}}(o),u=function(e){function t(){return n(this,t),i(this,e.apply(this,arguments))}return a(t,e),t.prototype.start=function(){},t.prototype.stop=function(){this.flush()},t.prototype.flush=function(){},t.prototype.render=function(e){},t}(s.default);r.default=u},{"../managers/WebGLManager":93}],95:[function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}r.__esModule=!0;var a=e("pixi-gl-core"),o=n(a),s=e("../../../utils/createIndicesForQuads"),u=n(s),l=function(){function n(e,t){i(this,n),this.gl=e,this.vertices=new Float32Array([-1,-1,1,-1,1,1,-1,1]),this.uvs=new Float32Array([0,0,1,0,1,1,0,1]),this.interleaved=new Float32Array(16);for(var r=0;r<4;r++)this.interleaved[4*r]=this.vertices[2*r],this.interleaved[4*r+1]=this.vertices[2*r+1],this.interleaved[4*r+2]=this.uvs[2*r],this.interleaved[4*r+3]=this.uvs[2*r+1];this.indices=(0,u.default)(1),this.vertexBuffer=o.default.GLBuffer.createVertexBuffer(e,this.interleaved,e.STATIC_DRAW),this.indexBuffer=o.default.GLBuffer.createIndexBuffer(e,this.indices,e.STATIC_DRAW),this.vao=new o.default.VertexArrayObject(e,t)}return n.prototype.initVao=function(e){this.vao.clear().addIndex(this.indexBuffer).addAttribute(this.vertexBuffer,e.attributes.aVertexPosition,this.gl.FLOAT,!1,16,0).addAttribute(this.vertexBuffer,e.attributes.aTextureCoord,this.gl.FLOAT,!1,16,8)},n.prototype.map=function(e,t){var r=0,n=0;return this.uvs[0]=r,this.uvs[1]=n,this.uvs[2]=r+t.width/e.width,this.uvs[3]=n,this.uvs[4]=r+t.width/e.width,this.uvs[5]=n+t.height/e.height,this.uvs[6]=r,this.uvs[7]=n+t.height/e.height,r=t.x,n=t.y,this.vertices[0]=r,this.vertices[1]=n,this.vertices[2]=r+t.width,this.vertices[3]=n,this.vertices[4]=r+t.width,this.vertices[5]=n+t.height,this.vertices[6]=r,this.vertices[7]=n+t.height,this},n.prototype.upload=function(){for(var e=0;e<4;e++)this.interleaved[4*e]=this.vertices[2*e],this.interleaved[4*e+1]=this.vertices[2*e+1],this.interleaved[4*e+2]=this.uvs[2*e],this.interleaved[4*e+3]=this.uvs[2*e+1];return this.vertexBuffer.upload(this.interleaved),this},n.prototype.destroy=function(){var e=this.gl;e.deleteBuffer(this.vertexBuffer),e.deleteBuffer(this.indexBuffer)},n}();r.default=l},{"../../../utils/createIndicesForQuads":123,"pixi-gl-core":12}],96:[function(e,t,r){"use strict";function s(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}r.__esModule=!0;var u=e("../../../math"),l=e("../../../const"),n=e("../../../settings"),c=function(e){return e&&e.__esModule?e:{default:e}}(n),h=e("pixi-gl-core"),i=function(){function o(e,t,r,n,i,a){s(this,o),this.gl=e,this.frameBuffer=null,this.texture=null,this.clearColor=[0,0,0,0],this.size=new u.Rectangle(0,0,1,1),this.resolution=i||c.default.RESOLUTION,this.projectionMatrix=new u.Matrix,this.transform=null,this.frame=null,this.defaultFrame=new u.Rectangle,this.destinationFrame=null,this.sourceFrame=null,this.stencilBuffer=null,this.stencilMaskStack=[],this.filterData=null,this.scaleMode=void 0!==n?n:c.default.SCALE_MODE,this.root=a,this.root?(this.frameBuffer=new h.GLFramebuffer(e,100,100),this.frameBuffer.framebuffer=null):(this.frameBuffer=h.GLFramebuffer.createRGBA(e,100,100),this.scaleMode===l.SCALE_MODES.NEAREST?this.frameBuffer.texture.enableNearestScaling():this.frameBuffer.texture.enableLinearScaling(),this.texture=this.frameBuffer.texture),this.setFrame(),this.resize(t,r)}return o.prototype.clear=function(e){var t=e||this.clearColor;this.frameBuffer.clear(t[0],t[1],t[2],t[3])},o.prototype.attachStencilBuffer=function(){this.root||this.frameBuffer.enableStencil()},o.prototype.setFrame=function(e,t){this.destinationFrame=e||this.destinationFrame||this.defaultFrame,this.sourceFrame=t||this.sourceFrame||this.destinationFrame},o.prototype.activate=function(){var e=this.gl;this.frameBuffer.bind(),this.calculateProjection(this.destinationFrame,this.sourceFrame),this.transform&&this.projectionMatrix.append(this.transform),this.destinationFrame!==this.sourceFrame?(e.enable(e.SCISSOR_TEST),e.scissor(0|this.destinationFrame.x,0|this.destinationFrame.y,this.destinationFrame.width*this.resolution|0,this.destinationFrame.height*this.resolution|0)):e.disable(e.SCISSOR_TEST),e.viewport(0|this.destinationFrame.x,0|this.destinationFrame.y,this.destinationFrame.width*this.resolution|0,this.destinationFrame.height*this.resolution|0)},o.prototype.calculateProjection=function(e,t){var r=this.projectionMatrix;t=t||e,r.identity(),this.root?(r.a=1/e.width*2,r.d=-1/e.height*2,r.tx=-1-t.x*r.a,r.ty=1-t.y*r.d):(r.a=1/e.width*2,r.d=1/e.height*2,r.tx=-1-t.x*r.a,r.ty=-1-t.y*r.d)},o.prototype.resize=function(e,t){if(e|=0,t|=0,this.size.width!==e||this.size.height!==t){this.size.width=e,this.size.height=t,this.defaultFrame.width=e,this.defaultFrame.height=t,this.frameBuffer.resize(e*this.resolution,t*this.resolution);var r=this.frame||this.size;this.calculateProjection(r)}},o.prototype.destroy=function(){this.frameBuffer.destroy(),this.frameBuffer=null,this.texture=null},o}();r.default=i},{"../../../const":46,"../../../math":70,"../../../settings":101,"pixi-gl-core":12}],97:[function(e,t,r){"use strict";function n(e,t){var r=!t;if(r){var n=document.createElement("canvas");n.width=1,n.height=1,t=s.default.createContext(n)}for(var i=t.createShader(t.FRAGMENT_SHADER);;){var a=u.replace(/%forloop%/gi,o(e));if(t.shaderSource(i,a),t.compileShader(i),t.getShaderParameter(i,t.COMPILE_STATUS))break;e=e/2|0}return r&&t.getExtension("WEBGL_lose_context")&&t.getExtension("WEBGL_lose_context").loseContext(),e}function o(e){for(var t="",r=0;r<e;++r)r>0&&(t+="\nelse "),r<e-1&&(t+="if(test == "+r+".0){}");return t}r.__esModule=!0,r.default=n;var i=e("pixi-gl-core"),s=function(e){return e&&e.__esModule?e:{default:e}}(i),u=["precision mediump float;","void main(void){","float test = 0.1;","%forloop%","gl_FragColor = vec4(0.0);","}"].join("\n")},{"pixi-gl-core":12}],98:[function(e,t,r){"use strict";function n(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];return t[i.BLEND_MODES.NORMAL]=[e.ONE,e.ONE_MINUS_SRC_ALPHA],t[i.BLEND_MODES.ADD]=[e.ONE,e.DST_ALPHA],t[i.BLEND_MODES.MULTIPLY]=[e.DST_COLOR,e.ONE_MINUS_SRC_ALPHA],t[i.BLEND_MODES.SCREEN]=[e.ONE,e.ONE_MINUS_SRC_COLOR],t[i.BLEND_MODES.OVERLAY]=[e.ONE,e.ONE_MINUS_SRC_ALPHA],t[i.BLEND_MODES.DARKEN]=[e.ONE,e.ONE_MINUS_SRC_ALPHA],t[i.BLEND_MODES.LIGHTEN]=[e.ONE,e.ONE_MINUS_SRC_ALPHA],t[i.BLEND_MODES.COLOR_DODGE]=[e.ONE,e.ONE_MINUS_SRC_ALPHA],t[i.BLEND_MODES.COLOR_BURN]=[e.ONE,e.ONE_MINUS_SRC_ALPHA],t[i.BLEND_MODES.HARD_LIGHT]=[e.ONE,e.ONE_MINUS_SRC_ALPHA],t[i.BLEND_MODES.SOFT_LIGHT]=[e.ONE,e.ONE_MINUS_SRC_ALPHA],t[i.BLEND_MODES.DIFFERENCE]=[e.ONE,e.ONE_MINUS_SRC_ALPHA],t[i.BLEND_MODES.EXCLUSION]=[e.ONE,e.ONE_MINUS_SRC_ALPHA],t[i.BLEND_MODES.HUE]=[e.ONE,e.ONE_MINUS_SRC_ALPHA],t[i.BLEND_MODES.SATURATION]=[e.ONE,e.ONE_MINUS_SRC_ALPHA],t[i.BLEND_MODES.COLOR]=[e.ONE,e.ONE_MINUS_SRC_ALPHA],t[i.BLEND_MODES.LUMINOSITY]=[e.ONE,e.ONE_MINUS_SRC_ALPHA],t[i.BLEND_MODES.NORMAL_NPM]=[e.SRC_ALPHA,e.ONE_MINUS_SRC_ALPHA,e.ONE,e.ONE_MINUS_SRC_ALPHA],t[i.BLEND_MODES.ADD_NPM]=[e.SRC_ALPHA,e.DST_ALPHA,e.ONE,e.DST_ALPHA],t[i.BLEND_MODES.SCREEN_NPM]=[e.SRC_ALPHA,e.ONE_MINUS_SRC_COLOR,e.ONE,e.ONE_MINUS_SRC_COLOR],t}r.__esModule=!0,r.default=n;var i=e("../../../const")},{"../../../const":46}],99:[function(e,t,r){"use strict";function n(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return t[i.DRAW_MODES.POINTS]=e.POINTS,t[i.DRAW_MODES.LINES]=e.LINES,t[i.DRAW_MODES.LINE_LOOP]=e.LINE_LOOP,t[i.DRAW_MODES.LINE_STRIP]=e.LINE_STRIP,t[i.DRAW_MODES.TRIANGLES]=e.TRIANGLES,t[i.DRAW_MODES.TRIANGLE_STRIP]=e.TRIANGLE_STRIP,t[i.DRAW_MODES.TRIANGLE_FAN]=e.TRIANGLE_FAN,t}r.__esModule=!0,r.default=n;var i=e("../../../const")},{"../../../const":46}],100:[function(e,t,r){"use strict";function n(e){e.getContextAttributes().stencil||console.warn("Provided WebGL context does not have a stencil buffer, masks may not render correctly")}r.__esModule=!0,r.default=n},{}],101:[function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}r.__esModule=!0;var i=e("./utils/maxRecommendedTextures"),a=n(i),o=e("./utils/canUploadSameBuffer"),s=n(o);r.default={TARGET_FPMS:.06,MIPMAP_TEXTURES:!0,RESOLUTION:1,FILTER_RESOLUTION:1,SPRITE_MAX_TEXTURES:(0,a.default)(32),SPRITE_BATCH_SIZE:4096,RETINA_PREFIX:/@([0-9\.]+)x/,RENDER_OPTIONS:{view:null,antialias:!1,forceFXAA:!1,autoResize:!1,transparent:!1,backgroundColor:0,clearBeforeRender:!0,preserveDrawingBuffer:!1,roundPixels:!1,width:800,height:600,legacy:!1},TRANSFORM_MODE:0,GC_MODE:0,GC_MAX_IDLE:3600,GC_MAX_CHECK_COUNT:600,WRAP_MODE:0,SCALE_MODE:0,PRECISION_VERTEX:"highp",PRECISION_FRAGMENT:"mediump",CAN_UPLOAD_SAME_BUFFER:(0,s.default)()}},{"./utils/canUploadSameBuffer":122,"./utils/maxRecommendedTextures":127}],102:[function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function o(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}r.__esModule=!0;var s=function(){function n(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(e,t,r){return t&&n(e.prototype,t),r&&n(e,r),e}}(),u=e("../math"),l=e("../utils"),c=e("../const"),h=e("../textures/Texture"),f=n(h),d=e("../display/Container"),p=n(d),v=new u.Point,m=function(r){function n(e){i(this,n);var t=a(this,r.call(this));return t._anchor=new u.ObservablePoint(t._onAnchorUpdate,t),t._texture=null,t._width=0,t._height=0,t._tint=null,t._tintRGB=null,t.tint=16777215,t.blendMode=c.BLEND_MODES.NORMAL,t.shader=null,t.cachedTint=16777215,t.texture=e||f.default.EMPTY,t.vertexData=new Float32Array(8),t.vertexTrimmedData=null,t._transformID=-1,t._textureID=-1,t._transformTrimmedID=-1,t._textureTrimmedID=-1,t.pluginName="sprite",t}return o(n,r),n.prototype._onTextureUpdate=function(){this._textureID=-1,this._textureTrimmedID=-1,this.cachedTint=16777215,this._width&&(this.scale.x=(0,l.sign)(this.scale.x)*this._width/this._texture.orig.width),this._height&&(this.scale.y=(0,l.sign)(this.scale.y)*this._height/this._texture.orig.height)},n.prototype._onAnchorUpdate=function(){this._transformID=-1,this._transformTrimmedID=-1},n.prototype.calculateVertices=function(){if(this._transformID!==this.transform._worldID||this._textureID!==this._texture._updateID){this._transformID=this.transform._worldID,this._textureID=this._texture._updateID;var e=this._texture,t=this.transform.worldTransform,r=t.a,n=t.b,i=t.c,a=t.d,o=t.tx,s=t.ty,u=this.vertexData,l=e.trim,c=e.orig,h=this._anchor,f=0,d=0,p=0,v=0;l?(d=l.x-h._x*c.width,f=d+l.width,v=l.y-h._y*c.height,p=v+l.height):(d=-h._x*c.width,f=d+c.width,v=-h._y*c.height,p=v+c.height),u[0]=r*d+i*v+o,u[1]=a*v+n*d+s,u[2]=r*f+i*v+o,u[3]=a*v+n*f+s,u[4]=r*f+i*p+o,u[5]=a*p+n*f+s,u[6]=r*d+i*p+o,u[7]=a*p+n*d+s}},n.prototype.calculateTrimmedVertices=function(){if(this.vertexTrimmedData){if(this._transformTrimmedID===this.transform._worldID&&this._textureTrimmedID===this._texture._updateID)return}else this.vertexTrimmedData=new Float32Array(8);this._transformTrimmedID=this.transform._worldID,this._textureTrimmedID=this._texture._updateID;var e=this._texture,t=this.vertexTrimmedData,r=e.orig,n=this._anchor,i=this.transform.worldTransform,a=i.a,o=i.b,s=i.c,u=i.d,l=i.tx,c=i.ty,h=-n._x*r.width,f=h+r.width,d=-n._y*r.height,p=d+r.height;t[0]=a*h+s*d+l,t[1]=u*d+o*h+c,t[2]=a*f+s*d+l,t[3]=u*d+o*f+c,t[4]=a*f+s*p+l,t[5]=u*p+o*f+c,t[6]=a*h+s*p+l,t[7]=u*p+o*h+c},n.prototype._renderWebGL=function(e){this.calculateVertices(),e.setObjectRenderer(e.plugins[this.pluginName]),e.plugins[this.pluginName].render(this)},n.prototype._renderCanvas=function(e){e.plugins[this.pluginName].render(this)},n.prototype._calculateBounds=function(){var e=this._texture.trim,t=this._texture.orig;!e||e.width===t.width&&e.height===t.height?(this.calculateVertices(),this._bounds.addQuad(this.vertexData)):(this.calculateTrimmedVertices(),this._bounds.addQuad(this.vertexTrimmedData))},n.prototype.getLocalBounds=function(e){return 0===this.children.length?(this._bounds.minX=this._texture.orig.width*-this._anchor._x,this._bounds.minY=this._texture.orig.height*-this._anchor._y,this._bounds.maxX=this._texture.orig.width*(1-this._anchor._x),this._bounds.maxY=this._texture.orig.height*(1-this._anchor._y),e||(this._localBoundsRect||(this._localBoundsRect=new u.Rectangle),e=this._localBoundsRect),this._bounds.getRectangle(e)):r.prototype.getLocalBounds.call(this,e)},n.prototype.containsPoint=function(e){this.worldTransform.applyInverse(e,v);var t=this._texture.orig.width,r=this._texture.orig.height,n=-t*this.anchor.x,i=0;return v.x>=n&&v.x<n+t&&(i=-r*this.anchor.y,v.y>=i&&v.y<i+r)},n.prototype.destroy=function(e){if(r.prototype.destroy.call(this,e),this._anchor=null,"boolean"==typeof e?e:e&&e.texture){var t="boolean"==typeof e?e:e&&e.baseTexture;this._texture.destroy(!!t)}this._texture=null,this.shader=null},n.from=function(e){return new n(f.default.from(e))},n.fromFrame=function(e){var t=l.TextureCache[e];if(!t)throw new Error('The frameId "'+e+'" does not exist in the texture cache');return new n(t)},n.fromImage=function(e,t,r){return new n(f.default.fromImage(e,t,r))},s(n,[{key:"width",get:function(){return Math.abs(this.scale.x)*this._texture.orig.width},set:function(e){var t=(0,l.sign)(this.scale.x)||1;this.scale.x=t*e/this._texture.orig.width,this._width=e}},{key:"height",get:function(){return Math.abs(this.scale.y)*this._texture.orig.height},set:function(e){var t=(0,l.sign)(this.scale.y)||1;this.scale.y=t*e/this._texture.orig.height,this._height=e}},{key:"anchor",get:function(){return this._anchor},set:function(e){this._anchor.copy(e)}},{key:"tint",get:function(){return this._tint},set:function(e){this._tint=e,this._tintRGB=(e>>16)+(65280&e)+((255&e)<<16)}},{key:"texture",get:function(){return this._texture},set:function(e){this._texture!==e&&(this._texture=e,this.cachedTint=16777215,this._textureID=-1,this._textureTrimmedID=-1,e&&(e.baseTexture.hasLoaded?this._onTextureUpdate():e.once("update",this._onTextureUpdate,this)))}}]),n}(p.default);r.default=m},{"../const":46,"../display/Container":48,"../math":70,"../textures/Texture":115,"../utils":125}],103:[function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}r.__esModule=!0;var a=e("../../renderers/canvas/CanvasRenderer"),o=n(a),c=e("../../const"),h=e("../../math"),s=e("./CanvasTinter"),f=n(s),d=new h.Matrix,u=function(){function t(e){i(this,t),this.renderer=e}return t.prototype.render=function(e){var t=e._texture,r=this.renderer,n=t._frame.width,i=t._frame.height,a=e.transform.worldTransform,o=0,s=0;if(!(t.orig.width<=0||t.orig.height<=0)&&t.baseTexture.source&&(r.setBlendMode(e.blendMode),t.valid)){r.context.globalAlpha=e.worldAlpha;var u=t.baseTexture.scaleMode===c.SCALE_MODES.LINEAR;r.smoothProperty&&r.context[r.smoothProperty]!==u&&(r.context[r.smoothProperty]=u),t.trim?(o=t.trim.width/2+t.trim.x-e.anchor.x*t.orig.width,s=t.trim.height/2+t.trim.y-e.anchor.y*t.orig.height):(o=(.5-e.anchor.x)*t.orig.width,s=(.5-e.anchor.y)*t.orig.height),t.rotate&&(a.copy(d),a=d,h.GroupD8.matrixAppendRotationInv(a,t.rotate,o,s),o=0,s=0),o-=n/2,s-=i/2,r.roundPixels?(r.context.setTransform(a.a,a.b,a.c,a.d,a.tx*r.resolution|0,a.ty*r.resolution|0),o|=0,s|=0):r.context.setTransform(a.a,a.b,a.c,a.d,a.tx*r.resolution,a.ty*r.resolution);var l=t.baseTexture.resolution;16777215!==e.tint?(e.cachedTint===e.tint&&e.tintedTexture.tintId===e._texture._updateID||(e.cachedTint=e.tint,e.tintedTexture=f.default.getTintedTexture(e,e.tint)),r.context.drawImage(e.tintedTexture,0,0,n*l,i*l,o*r.resolution,s*r.resolution,n*r.resolution,i*r.resolution)):r.context.drawImage(t.baseTexture.source,t._frame.x*l,t._frame.y*l,n*l,i*l,o*r.resolution,s*r.resolution,n*r.resolution,i*r.resolution)}},t.prototype.destroy=function(){this.renderer=null},t}();r.default=u,o.default.registerPlugin("sprite",u)},{"../../const":46,"../../math":70,"../../renderers/canvas/CanvasRenderer":77,"./CanvasTinter":104}],104:[function(e,t,r){"use strict";r.__esModule=!0;var d=e("../../utils"),n=e("../../renderers/canvas/utils/canUseNewCanvasBlendModes"),i=function(e){return e&&e.__esModule?e:{default:e}}(n),s={getTintedTexture:function(e,t){var r=e._texture;t=s.roundColor(t);var n="#"+("00000"+(0|t).toString(16)).substr(-6);r.tintCache=r.tintCache||{};var i=r.tintCache[n],a=void 0;if(i){if(i.tintId===r._updateID)return r.tintCache[n];a=r.tintCache[n]}else a=s.canvas||document.createElement("canvas");if(s.tintMethod(r,t,a),a.tintId=r._updateID,s.convertTintToImage){var o=new Image;o.src=a.toDataURL(),r.tintCache[n]=o}else r.tintCache[n]=a,s.canvas=null;return a},tintWithMultiply:function(e,t,r){var n=r.getContext("2d"),i=e._frame.clone(),a=e.baseTexture.resolution;i.x*=a,i.y*=a,i.width*=a,i.height*=a,r.width=Math.ceil(i.width),r.height=Math.ceil(i.height),n.save(),n.fillStyle="#"+("00000"+(0|t).toString(16)).substr(-6),n.fillRect(0,0,i.width,i.height),n.globalCompositeOperation="multiply",n.drawImage(e.baseTexture.source,i.x,i.y,i.width,i.height,0,0,i.width,i.height),n.globalCompositeOperation="destination-atop",n.drawImage(e.baseTexture.source,i.x,i.y,i.width,i.height,0,0,i.width,i.height),n.restore()},tintWithOverlay:function(e,t,r){var n=r.getContext("2d"),i=e._frame.clone(),a=e.baseTexture.resolution;i.x*=a,i.y*=a,i.width*=a,i.height*=a,r.width=Math.ceil(i.width),r.height=Math.ceil(i.height),n.save(),n.globalCompositeOperation="copy",n.fillStyle="#"+("00000"+(0|t).toString(16)).substr(-6),n.fillRect(0,0,i.width,i.height),n.globalCompositeOperation="destination-atop",n.drawImage(e.baseTexture.source,i.x,i.y,i.width,i.height,0,0,i.width,i.height),n.restore()},tintWithPerPixel:function(e,t,r){var n=r.getContext("2d"),i=e._frame.clone(),a=e.baseTexture.resolution;i.x*=a,i.y*=a,i.width*=a,i.height*=a,r.width=Math.ceil(i.width),r.height=Math.ceil(i.height),n.save(),n.globalCompositeOperation="copy",n.drawImage(e.baseTexture.source,i.x,i.y,i.width,i.height,0,0,i.width,i.height),n.restore();for(var o=(0,d.hex2rgb)(t),s=o[0],u=o[1],l=o[2],c=n.getImageData(0,0,i.width,i.height),h=c.data,f=0;f<h.length;f+=4)h[f+0]*=s,h[f+1]*=u,h[f+2]*=l;n.putImageData(c,0,0)},roundColor:function(e){var t=s.cacheStepsPerColorChannel,r=(0,d.hex2rgb)(e);return r[0]=Math.min(255,r[0]/t*t),r[1]=Math.min(255,r[1]/t*t),r[2]=Math.min(255,r[2]/t*t),(0,d.rgb2hex)(r)},cacheStepsPerColorChannel:8,convertTintToImage:!1,canUseMultiply:(0,i.default)(),tintMethod:0};s.tintMethod=s.canUseMultiply?s.tintWithMultiply:s.tintWithPerPixel,r.default=s},{"../../renderers/canvas/utils/canUseNewCanvasBlendModes":80,"../../utils":125}],105:[function(e,t,r){"use strict";function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}r.__esModule=!0;var i=function(){function t(e){n(this,t),this.vertices=new ArrayBuffer(e),this.float32View=new Float32Array(this.vertices),this.uint32View=new Uint32Array(this.vertices)}return t.prototype.destroy=function(){this.vertices=null,this.positions=null,this.uvs=null,this.colors=null},t}();r.default=i},{}],106:[function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function s(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function u(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}r.__esModule=!0;var i=e("../../renderers/webgl/utils/ObjectRenderer"),a=n(i),l=e("../../renderers/webgl/WebGLRenderer"),c=n(l),h=e("../../utils/createIndicesForQuads"),f=n(h),d=e("./generateMultiTextureShader"),p=n(d),v=e("../../renderers/webgl/utils/checkMaxIfStatmentsInShader"),m=n(v),g=e("./BatchBuffer"),y=n(g),x=e("../../settings"),F=n(x),B=e("../../utils"),b=e("pixi-gl-core"),U=n(b),w=e("bit-twiddle"),k=n(w),j=0,z=0,_=function(i){function a(e){o(this,a);var t=s(this,i.call(this,e));t.vertSize=5,t.vertByteSize=4*t.vertSize,t.size=F.default.SPRITE_BATCH_SIZE,t.buffers=[];for(var r=1;r<=k.default.nextPow2(t.size);r*=2)t.buffers.push(new y.default(4*r*t.vertByteSize));t.indices=(0,f.default)(t.size),t.shader=null,t.currentIndex=0,t.groups=[];for(var n=0;n<t.size;n++)t.groups[n]={textures:[],textureCount:0,ids:[],size:0,start:0,blend:0};return t.sprites=[],t.vertexBuffers=[],t.vaos=[],t.vaoMax=2,t.vertexCount=0,t.renderer.on("prerender",t.onPrerender,t),t}return u(a,i),a.prototype.onContextChange=function(){var e=this.renderer.gl;this.renderer.legacy?this.MAX_TEXTURES=1:(this.MAX_TEXTURES=Math.min(e.getParameter(e.MAX_TEXTURE_IMAGE_UNITS),F.default.SPRITE_MAX_TEXTURES),this.MAX_TEXTURES=(0,m.default)(this.MAX_TEXTURES,e)),this.shader=(0,p.default)(e,this.MAX_TEXTURES),this.indexBuffer=U.default.GLBuffer.createIndexBuffer(e,this.indices,e.STATIC_DRAW),this.renderer.bindVao(null);for(var t=this.shader.attributes,r=0;r<this.vaoMax;r++){var n=this.vertexBuffers[r]=U.default.GLBuffer.createVertexBuffer(e,null,e.STREAM_DRAW),i=this.renderer.createVao().addIndex(this.indexBuffer).addAttribute(n,t.aVertexPosition,e.FLOAT,!1,this.vertByteSize,0).addAttribute(n,t.aTextureCoord,e.UNSIGNED_SHORT,!0,this.vertByteSize,8).addAttribute(n,t.aColor,e.UNSIGNED_BYTE,!0,this.vertByteSize,12);t.aTextureId&&i.addAttribute(n,t.aTextureId,e.FLOAT,!1,this.vertByteSize,16),this.vaos[r]=i}this.vao=this.vaos[0],this.currentBlendMode=99999,this.boundTextures=new Array(this.MAX_TEXTURES)},a.prototype.onPrerender=function(){this.vertexCount=0},a.prototype.render=function(e){this.currentIndex>=this.size&&this.flush(),e._texture._uvs&&(this.sprites[this.currentIndex++]=e)},a.prototype.flush=function(){if(0!==this.currentIndex){var e=this.renderer.gl,t=this.MAX_TEXTURES,r=k.default.nextPow2(this.currentIndex),n=k.default.log2(r),i=this.buffers[n],a=this.sprites,o=this.groups,s=i.float32View,u=i.uint32View,l=this.boundTextures,c=this.renderer.boundTextures,h=this.renderer.textureGC.count,f=0,d=void 0,p=void 0,v=1,m=0,g=o[0],y=void 0,x=void 0,b=B.premultiplyBlendMode[a[0]._texture.baseTexture.premultipliedAlpha?1:0][a[0].blendMode];g.textureCount=0,g.start=0,g.blend=b,j++;var w=void 0;for(w=0;w<t;++w)l[w]=c[w],l[w]._virtalBoundId=w;for(w=0;w<this.currentIndex;++w){var _=a[w];d=_._texture.baseTexture;var T=B.premultiplyBlendMode[Number(d.premultipliedAlpha)][_.blendMode];if(b!==T&&(b=T,p=null,m=t,j++),p!==d&&(p=d,d._enabled!==j)){if(m===t&&(j++,g.size=w-g.start,m=0,g=o[v++],g.blend=b,g.textureCount=0,g.start=w),d.touched=h,-1===d._virtalBoundId)for(var E=0;E<t;++E){var M=(E+z)%t,S=l[M];if(S._enabled!==j){z++,S._virtalBoundId=-1,d._virtalBoundId=M,l[M]=d;break}}d._enabled=j,g.textureCount++,g.ids[m]=d._virtalBoundId,g.textures[m++]=d}if(y=_.vertexData,x=_._texture._uvs.uvsUint32,this.renderer.roundPixels){var A=this.renderer.resolution;s[f]=(y[0]*A|0)/A,s[f+1]=(y[1]*A|0)/A,s[f+5]=(y[2]*A|0)/A,s[f+6]=(y[3]*A|0)/A,s[f+10]=(y[4]*A|0)/A,s[f+11]=(y[5]*A|0)/A,s[f+15]=(y[6]*A|0)/A,s[f+16]=(y[7]*A|0)/A}else s[f]=y[0],s[f+1]=y[1],s[f+5]=y[2],s[f+6]=y[3],s[f+10]=y[4],s[f+11]=y[5],s[f+15]=y[6],s[f+16]=y[7];u[f+2]=x[0],u[f+7]=x[1],u[f+12]=x[2],u[f+17]=x[3];var R=Math.min(_.worldAlpha,1),P=R<1&&d.premultipliedAlpha?(0,B.premultiplyTint)(_._tintRGB,R):_._tintRGB+(255*R<<24);u[f+3]=u[f+8]=u[f+13]=u[f+18]=P,s[f+4]=s[f+9]=s[f+14]=s[f+19]=d._virtalBoundId,f+=20}if(g.size=w-g.start,F.default.CAN_UPLOAD_SAME_BUFFER)this.vertexBuffers[this.vertexCount].upload(i.vertices,0,!0);else{if(this.vaoMax<=this.vertexCount){this.vaoMax++;var C=this.shader.attributes,O=this.vertexBuffers[this.vertexCount]=U.default.GLBuffer.createVertexBuffer(e,null,e.STREAM_DRAW),L=this.renderer.createVao().addIndex(this.indexBuffer).addAttribute(O,C.aVertexPosition,e.FLOAT,!1,this.vertByteSize,0).addAttribute(O,C.aTextureCoord,e.UNSIGNED_SHORT,!0,this.vertByteSize,8).addAttribute(O,C.aColor,e.UNSIGNED_BYTE,!0,this.vertByteSize,12);C.aTextureId&&L.addAttribute(O,C.aTextureId,e.FLOAT,!1,this.vertByteSize,16),this.vaos[this.vertexCount]=L}this.renderer.bindVao(this.vaos[this.vertexCount]),this.vertexBuffers[this.vertexCount].upload(i.vertices,0,!1),this.vertexCount++}for(w=0;w<t;++w)c[w]._virtalBoundId=-1;for(w=0;w<v;++w){for(var I=o[w],D=I.textureCount,N=0;N<D;N++)p=I.textures[N],c[I.ids[N]]!==p&&this.renderer.bindTexture(p,I.ids[N],!0),p._virtalBoundId=-1;this.renderer.state.setBlendMode(I.blend),e.drawElements(e.TRIANGLES,6*I.size,e.UNSIGNED_SHORT,6*I.start*2)}this.currentIndex=0}},a.prototype.start=function(){this.renderer.bindShader(this.shader),F.default.CAN_UPLOAD_SAME_BUFFER&&(this.renderer.bindVao(this.vaos[this.vertexCount]),this.vertexBuffers[this.vertexCount].bind())},a.prototype.stop=function(){this.flush()},a.prototype.destroy=function(){for(var e=0;e<this.vaoMax;e++)this.vertexBuffers[e]&&this.vertexBuffers[e].destroy(),this.vaos[e]&&this.vaos[e].destroy();this.indexBuffer&&this.indexBuffer.destroy(),this.renderer.off("prerender",this.onPrerender,this),i.prototype.destroy.call(this),this.shader&&(this.shader.destroy(),this.shader=null),this.vertexBuffers=null,this.vaos=null,this.indexBuffer=null,this.indices=null,this.sprites=null;for(var t=0;t<this.buffers.length;++t)this.buffers[t].destroy()},a}(a.default);r.default=_,c.default.registerPlugin("sprite",_)},{"../../renderers/webgl/WebGLRenderer":84,"../../renderers/webgl/utils/ObjectRenderer":94,"../../renderers/webgl/utils/checkMaxIfStatmentsInShader":97,"../../settings":101,"../../utils":125,"../../utils/createIndicesForQuads":123,"./BatchBuffer":105,"./generateMultiTextureShader":107,"bit-twiddle":1,"pixi-gl-core":12}],107:[function(e,t,r){"use strict";function n(e,t){var r=u;r=r.replace(/%count%/gi,t),r=r.replace(/%forloop%/gi,o(t));for(var n=new s.default(e,"precision highp float;\nattribute vec2 aVertexPosition;\nattribute vec2 aTextureCoord;\nattribute vec4 aColor;\nattribute float aTextureId;\n\nuniform mat3 projectionMatrix;\n\nvarying vec2 vTextureCoord;\nvarying vec4 vColor;\nvarying float vTextureId;\n\nvoid main(void){\n    gl_Position = vec4((projectionMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);\n\n    vTextureCoord = aTextureCoord;\n    vTextureId = aTextureId;\n    vColor = aColor;\n}\n",r),i=[],a=0;a<t;a++)i[a]=a;return n.bind(),n.uniforms.uSamplers=i,n}function o(e){var t="";t+="\n",t+="\n";for(var r=0;r<e;r++)r>0&&(t+="\nelse "),r<e-1&&(t+="if(textureId == "+r+".0)"),t+="\n{",t+="\n\tcolor = texture2D(uSamplers["+r+"], vTextureCoord);",t+="\n}";return t+="\n",t+="\n"}r.__esModule=!0,r.default=n;var i=e("../../Shader"),s=function(e){return e&&e.__esModule?e:{default:e}}(i),u=(e("path"),["varying vec2 vTextureCoord;","varying vec4 vColor;","varying float vTextureId;","uniform sampler2D uSamplers[%count%];","void main(void){","vec4 color;","float textureId = floor(vTextureId+0.5);","%forloop%","gl_FragColor = color * vColor;","}"].join("\n"))},{"../../Shader":44,path:23}],108:[function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function s(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function u(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function i(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}r.__esModule=!0;var l=function(){function n(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(e,t,r){return t&&n(e.prototype,t),r&&n(e,r),e}}(),a=e("../sprites/Sprite"),o=n(a),c=e("../textures/Texture"),h=n(c),f=e("../math"),d=e("../utils"),v=e("../const"),p=e("../settings"),m=n(p),g=e("./TextStyle"),y=n(g),x=e("./TextMetrics"),b=n(x),w=e("../utils/trimCanvas"),_=n(w),T={texture:!0,children:!1,baseTexture:!0},E=function(a){function o(e,t,r){s(this,o),r=r||document.createElement("canvas"),r.width=3,r.height=3;var n=h.default.fromCanvas(r,m.default.SCALE_MODE,"text");n.orig=new f.Rectangle,n.trim=new f.Rectangle;var i=u(this,a.call(this,n));return h.default.addToCache(i._texture,i._texture.baseTexture.textureCacheIds[0]),i.canvas=r,i.context=i.canvas.getContext("2d"),i.resolution=m.default.RESOLUTION,i._text=null,i._style=null,i._styleListener=null,i._font="",i.text=e,i.style=t,i.localStyleID=-1,i}return i(o,a),o.prototype.updateText=function(e){var t=this._style;if(this.localStyleID!==t.styleID&&(this.dirty=!0,this.localStyleID=t.styleID),this.dirty||!e){this._font=this._style.toFontString();var r=this.context,n=b.default.measureText(this._text,this._style,this._style.wordWrap,this.canvas),i=n.width,a=n.height,o=n.lines,s=n.lineHeight,u=n.lineWidths,l=n.maxLineWidth,c=n.fontProperties;this.canvas.width=Math.ceil((i+2*t.padding)*this.resolution),this.canvas.height=Math.ceil((a+2*t.padding)*this.resolution),r.scale(this.resolution,this.resolution),r.clearRect(0,0,this.canvas.width,this.canvas.height),r.font=this._font,r.strokeStyle=t.stroke,r.lineWidth=t.strokeThickness,r.textBaseline=t.textBaseline,r.lineJoin=t.lineJoin,r.miterLimit=t.miterLimit;var h=void 0,f=void 0;if(t.dropShadow){r.fillStyle=t.dropShadowColor,r.globalAlpha=t.dropShadowAlpha,r.shadowBlur=t.dropShadowBlur,t.dropShadowBlur>0&&(r.shadowColor=t.dropShadowColor);for(var d=Math.cos(t.dropShadowAngle)*t.dropShadowDistance,p=Math.sin(t.dropShadowAngle)*t.dropShadowDistance,v=0;v<o.length;v++)h=t.strokeThickness/2,f=t.strokeThickness/2+v*s+c.ascent,"right"===t.align?h+=l-u[v]:"center"===t.align&&(h+=(l-u[v])/2),t.fill&&(this.drawLetterSpacing(o[v],h+d+t.padding,f+p+t.padding),t.stroke&&t.strokeThickness&&(r.strokeStyle=t.dropShadowColor,this.drawLetterSpacing(o[v],h+d+t.padding,f+p+t.padding,!0),r.strokeStyle=t.stroke))}r.shadowBlur=0,r.globalAlpha=1,r.fillStyle=this._generateFillStyle(t,o);for(var m=0;m<o.length;m++)h=t.strokeThickness/2,f=t.strokeThickness/2+m*s+c.ascent,"right"===t.align?h+=l-u[m]:"center"===t.align&&(h+=(l-u[m])/2),t.stroke&&t.strokeThickness&&this.drawLetterSpacing(o[m],h+t.padding,f+t.padding,!0),t.fill&&this.drawLetterSpacing(o[m],h+t.padding,f+t.padding);this.updateTexture()}},o.prototype.drawLetterSpacing=function(e,t,r){var n=arguments.length>3&&void 0!==arguments[3]&&arguments[3],i=this._style,a=i.letterSpacing;if(0===a)return void(n?this.context.strokeText(e,t,r):this.context.fillText(e,t,r));for(var o=String.prototype.split.call(e,""),s=t,u=0,l="";u<e.length;)l=o[u++],n?this.context.strokeText(l,s,r):this.context.fillText(l,s,r),s+=this.context.measureText(l).width+a},o.prototype.updateTexture=function(){var e=this.canvas;if(this._style.trim){var t=(0,_.default)(e);e.width=t.width,e.height=t.height,this.context.putImageData(t.data,0,0)}var r=this._texture,n=this._style,i=n.trim?0:n.padding,a=r.baseTexture;a.hasLoaded=!0,a.resolution=this.resolution,a.realWidth=e.width,a.realHeight=e.height,a.width=e.width/this.resolution,a.height=e.height/this.resolution,r.trim.width=r._frame.width=e.width/this.resolution,r.trim.height=r._frame.height=e.height/this.resolution,r.trim.x=-i,r.trim.y=-i,r.orig.width=r._frame.width-2*i,r.orig.height=r._frame.height-2*i,this._onTextureUpdate(),a.emit("update",a),this.dirty=!1},o.prototype.renderWebGL=function(e){this.resolution!==e.resolution&&(this.resolution=e.resolution,this.dirty=!0),this.updateText(!0),a.prototype.renderWebGL.call(this,e)},o.prototype._renderCanvas=function(e){this.resolution!==e.resolution&&(this.resolution=e.resolution,this.dirty=!0),this.updateText(!0),a.prototype._renderCanvas.call(this,e)},o.prototype.getLocalBounds=function(e){return this.updateText(!0),a.prototype.getLocalBounds.call(this,e)},o.prototype._calculateBounds=function(){this.updateText(!0),this.calculateVertices(),this._bounds.addQuad(this.vertexData)},o.prototype._onStyleChange=function(){this.dirty=!0},o.prototype._generateFillStyle=function(e,t){if(!Array.isArray(e.fill))return e.fill;if(navigator.isCocoonJS)return e.fill[0];var r=void 0,n=void 0,i=void 0,a=void 0,o=this.canvas.width/this.resolution,s=this.canvas.height/this.resolution,u=e.fill.slice(),l=e.fillGradientStops.slice();if(!l.length)for(var c=u.length+1,h=1;h<c;++h)l.push(h/c);if(u.unshift(e.fill[0]),l.unshift(0),u.push(e.fill[e.fill.length-1]),l.push(1),e.fillGradientType===v.TEXT_GRADIENT.LINEAR_VERTICAL){r=this.context.createLinearGradient(o/2,0,o/2,s),n=(u.length+1)*t.length,i=0;for(var f=0;f<t.length;f++){i+=1;for(var d=0;d<u.length;d++)a="number"==typeof l[d]?l[d]/t.length+f/t.length:i/n,r.addColorStop(a,u[d]),i++}}else{r=this.context.createLinearGradient(0,s/2,o,s/2),n=u.length+1,i=1;for(var p=0;p<u.length;p++)a="number"==typeof l[p]?l[p]:i/n,r.addColorStop(a,u[p]),i++}return r},o.prototype.destroy=function(e){"boolean"==typeof e&&(e={children:e}),e=Object.assign({},T,e),a.prototype.destroy.call(this,e),this.context=null,this.canvas=null,this._style=null},l(o,[{key:"width",get:function(){return this.updateText(!0),Math.abs(this.scale.x)*this._texture.orig.width},set:function(e){this.updateText(!0);var t=(0,d.sign)(this.scale.x)||1;this.scale.x=t*e/this._texture.orig.width,this._width=e}},{key:"height",get:function(){return this.updateText(!0),Math.abs(this.scale.y)*this._texture.orig.height},set:function(e){this.updateText(!0);var t=(0,d.sign)(this.scale.y)||1;this.scale.y=t*e/this._texture.orig.height,this._height=e}},{key:"style",get:function(){return this._style},set:function(e){e=e||{},e instanceof y.default?this._style=e:this._style=new y.default(e),this.localStyleID=-1,this.dirty=!0}},{key:"text",get:function(){return this._text},set:function(e){e=String(""===e||null===e||void 0===e?" ":e),this._text!==e&&(this._text=e,this.dirty=!0)}}]),o}(o.default);r.default=E},{"../const":46,"../math":70,"../settings":101,"../sprites/Sprite":102,"../textures/Texture":115,"../utils":125,"../utils/trimCanvas":130,"./TextMetrics":109,"./TextStyle":110}],109:[function(e,t,r){"use strict";function l(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}r.__esModule=!0;var n=function(){function y(e,t,r,n,i,a,o,s,u){l(this,y),this.text=e,this.style=t,this.width=r,this.height=n,this.lines=i,this.lineWidths=a,this.lineHeight=o,this.maxLineWidth=s,this.fontProperties=u}return y.measureText=function(e,t,r){var n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:y._canvas;r=r||t.wordWrap;var i=t.toFontString(),a=y.measureFont(i),o=n.getContext("2d");o.font=i;for(var s=r?y.wordWrap(e,t,n):e,u=s.split(/(?:\r\n|\r|\n)/),l=new Array(u.length),c=0,h=0;h<u.length;h++){var f=o.measureText(u[h]).width+(u[h].length-1)*t.letterSpacing;l[h]=f,c=Math.max(c,f)}var d=c+t.strokeThickness;t.dropShadow&&(d+=t.dropShadowDistance);var p=t.lineHeight||a.fontSize+t.strokeThickness,v=Math.max(p,a.fontSize+t.strokeThickness)+(u.length-1)*(p+t.leading);return t.dropShadow&&(v+=t.dropShadowDistance),new y(e,t,d,v,u,l,p+t.leading,c,a)},y.wordWrap=function(e,t){for(var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:y._canvas,n=r.getContext("2d"),i="",a=e.split("\n"),o=t.wordWrapWidth,s={},u=0;u<a.length;u++){for(var l=o,c=a[u].split(" "),h=0;h<c.length;h++){var f=n.measureText(c[h]).width;if(t.breakWords&&f>o)for(var d=c[h].split(""),p=0;p<d.length;p++){var v=d[p],m=s[v];void 0===m&&(m=n.measureText(v).width,s[v]=m),m>l?(i+="\n"+v,l=o-m):(0===p&&(i+=" "),i+=v,l-=m)}else{var g=f+n.measureText(" ").width;0===h||g>l?(h>0&&(i+="\n"),i+=c[h],l=o-f):(l-=g,i+=" "+c[h])}}u<a.length-1&&(i+="\n")}return i},y.measureFont=function(e){if(y._fonts[e])return y._fonts[e];var t={},r=y._canvas,n=y._context;n.font=e;var i=Math.ceil(n.measureText("|MÉq").width),a=Math.ceil(n.measureText("M").width),o=2*a;a=1.4*a|0,r.width=i,r.height=o,n.fillStyle="#f00",n.fillRect(0,0,i,o),n.font=e,n.textBaseline="alphabetic",n.fillStyle="#000",n.fillText("|MÉq",0,a);var s=n.getImageData(0,0,i,o).data,u=s.length,l=4*i,c=0,h=0,f=!1;for(c=0;c<a;++c){for(var d=0;d<l;d+=4)if(255!==s[h+d]){f=!0;break}if(f)break;h+=l}for(t.ascent=a-c,h=u-l,f=!1,c=o;c>a;--c){for(var p=0;p<l;p+=4)if(255!==s[h+p]){f=!0;break}if(f)break;h-=l}return t.descent=c-a,t.fontSize=t.ascent+t.descent,y._fonts[e]=t,t},y}();r.default=n;var i=document.createElement("canvas");i.width=i.height=10,n._canvas=i,n._context=i.getContext("2d"),n._fonts={}},{}],110:[function(e,t,r){"use strict";function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e){return"number"==typeof e?(0,l.hex2string)(e):("string"==typeof e&&0===e.indexOf("0x")&&(e=e.replace("0x","#")),e)}function a(e){if(Array.isArray(e)){for(var t=0;t<e.length;++t)e[t]=i(e[t]);return e}return i(e)}function o(e,t){if(!Array.isArray(e)||!Array.isArray(t))return!1;if(e.length!==t.length)return!1;for(var r=0;r<e.length;++r)if(e[r]!==t[r])return!1;return!0}r.__esModule=!0;var s=function(){function n(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(e,t,r){return t&&n(e.prototype,t),r&&n(e,r),e}}(),u=e("../const"),l=e("../utils"),c={align:"left",breakWords:!1,dropShadow:!1,dropShadowAlpha:1,dropShadowAngle:Math.PI/6,dropShadowBlur:0,dropShadowColor:"black",dropShadowDistance:5,fill:"black",fillGradientType:u.TEXT_GRADIENT.LINEAR_VERTICAL,fillGradientStops:[],fontFamily:"Arial",fontSize:26,fontStyle:"normal",fontVariant:"normal",fontWeight:"normal",letterSpacing:0,lineHeight:0,lineJoin:"miter",miterLimit:10,padding:0,stroke:"black",strokeThickness:0,textBaseline:"alphabetic",trim:!1,wordWrap:!1,wordWrapWidth:100,leading:0},h=function(){function r(e){n(this,r),this.styleID=0,Object.assign(this,c,e)}return r.prototype.clone=function(){var e={};for(var t in c)e[t]=this[t];return new r(e)},r.prototype.reset=function(){Object.assign(this,c)},r.prototype.toFontString=function(){var e="number"==typeof this.fontSize?this.fontSize+"px":this.fontSize,t=this.fontFamily;Array.isArray(this.fontFamily)||(t=this.fontFamily.split(","));for(var r=t.length-1;r>=0;r--){var n=t[r].trim();/([\"\'])[^\'\"]+\1/.test(n)||(n='"'+n+'"'),t[r]=n}return this.fontStyle+" "+this.fontVariant+" "+this.fontWeight+" "+e+" "+t.join(",")},s(r,[{key:"align",get:function(){return this._align},set:function(e){this._align!==e&&(this._align=e,this.styleID++)}},{key:"breakWords",get:function(){return this._breakWords},set:function(e){this._breakWords!==e&&(this._breakWords=e,this.styleID++)}},{key:"dropShadow",get:function(){return this._dropShadow},set:function(e){this._dropShadow!==e&&(this._dropShadow=e,this.styleID++)}},{key:"dropShadowAlpha",get:function(){return this._dropShadowAlpha},set:function(e){this._dropShadowAlpha!==e&&(this._dropShadowAlpha=e,this.styleID++)}},{key:"dropShadowAngle",get:function(){return this._dropShadowAngle},set:function(e){this._dropShadowAngle!==e&&(this._dropShadowAngle=e,this.styleID++)}},{key:"dropShadowBlur",get:function(){return this._dropShadowBlur},set:function(e){this._dropShadowBlur!==e&&(this._dropShadowBlur=e,this.styleID++)}},{key:"dropShadowColor",get:function(){return this._dropShadowColor},set:function(e){var t=a(e);this._dropShadowColor!==t&&(this._dropShadowColor=t,this.styleID++)}},{key:"dropShadowDistance",get:function(){return this._dropShadowDistance},set:function(e){this._dropShadowDistance!==e&&(this._dropShadowDistance=e,this.styleID++)}},{key:"fill",get:function(){return this._fill},set:function(e){var t=a(e);this._fill!==t&&(this._fill=t,this.styleID++)}},{key:"fillGradientType",get:function(){return this._fillGradientType},set:function(e){this._fillGradientType!==e&&(this._fillGradientType=e,this.styleID++)}},{key:"fillGradientStops",get:function(){return this._fillGradientStops},set:function(e){o(this._fillGradientStops,e)||(this._fillGradientStops=e,this.styleID++)}},{key:"fontFamily",get:function(){return this._fontFamily},set:function(e){this.fontFamily!==e&&(this._fontFamily=e,this.styleID++)}},{key:"fontSize",get:function(){return this._fontSize},set:function(e){this._fontSize!==e&&(this._fontSize=e,this.styleID++)}},{key:"fontStyle",get:function(){return this._fontStyle},set:function(e){this._fontStyle!==e&&(this._fontStyle=e,this.styleID++)}},{key:"fontVariant",get:function(){return this._fontVariant},set:function(e){this._fontVariant!==e&&(this._fontVariant=e,this.styleID++)}},{key:"fontWeight",get:function(){return this._fontWeight},set:function(e){this._fontWeight!==e&&(this._fontWeight=e,this.styleID++)}},{key:"letterSpacing",get:function(){return this._letterSpacing},set:function(e){this._letterSpacing!==e&&(this._letterSpacing=e,this.styleID++)}},{key:"lineHeight",get:function(){return this._lineHeight},set:function(e){this._lineHeight!==e&&(this._lineHeight=e,this.styleID++)}},{key:"leading",get:function(){return this._leading},set:function(e){this._leading!==e&&(this._leading=e,this.styleID++)}},{key:"lineJoin",get:function(){return this._lineJoin},set:function(e){this._lineJoin!==e&&(this._lineJoin=e,this.styleID++)}},{key:"miterLimit",get:function(){return this._miterLimit},set:function(e){this._miterLimit!==e&&(this._miterLimit=e,this.styleID++)}},{key:"padding",get:function(){return this._padding},set:function(e){this._padding!==e&&(this._padding=e,this.styleID++)}},{key:"stroke",get:function(){return this._stroke},set:function(e){var t=a(e);this._stroke!==t&&(this._stroke=t,this.styleID++)}},{key:"strokeThickness",get:function(){return this._strokeThickness},set:function(e){this._strokeThickness!==e&&(this._strokeThickness=e,this.styleID++)}},{key:"textBaseline",get:function(){return this._textBaseline},set:function(e){this._textBaseline!==e&&(this._textBaseline=e,this.styleID++)}},{key:"trim",get:function(){return this._trim},set:function(e){this._trim!==e&&(this._trim=e,this.styleID++)}},{key:"wordWrap",get:function(){return this._wordWrap},set:function(e){this._wordWrap!==e&&(this._wordWrap=e,this.styleID++)}},{key:"wordWrapWidth",get:function(){return this._wordWrapWidth},set:function(e){this._wordWrapWidth!==e&&(this._wordWrapWidth=e,this.styleID++)}}]),r}();r.default=h},{"../const":46,"../utils":125}],111:[function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function s(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function u(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function i(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}r.__esModule=!0;var a=e("./BaseTexture"),o=n(a),l=e("../settings"),c=n(l),h=function(a){function o(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:100,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:100,r=arguments[2],n=arguments[3];s(this,o);var i=u(this,a.call(this,null,r));return i.resolution=n||c.default.RESOLUTION,i.width=Math.ceil(e),i.height=Math.ceil(t),i.realWidth=i.width*i.resolution,i.realHeight=i.height*i.resolution,i.scaleMode=void 0!==r?r:c.default.SCALE_MODE,i.hasLoaded=!0,i._glRenderTargets={},i._canvasRenderTarget=null,i.valid=!1,i}return i(o,a),o.prototype.resize=function(e,t){e=Math.ceil(e),t=Math.ceil(t),e===this.width&&t===this.height||(this.valid=e>0&&t>0,this.width=e,this.height=t,this.realWidth=this.width*this.resolution,this.realHeight=this.height*this.resolution,this.valid&&this.emit("update",this))},o.prototype.destroy=function(){a.prototype.destroy.call(this,!0),this.renderer=null},o}(o.default);r.default=h},{"../settings":101,"./BaseTexture":112}],112:[function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function s(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function u(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}r.__esModule=!0;var l=e("../utils"),i=e("../settings"),c=n(i),o=e("eventemitter3"),h=n(o),f=e("../utils/determineCrossOrigin"),d=n(f),p=e("bit-twiddle"),v=n(p),m=function(i){function o(e,t,r){a(this,o);var n=s(this,i.call(this));return n.uid=(0,l.uid)(),n.touched=0,n.resolution=r||c.default.RESOLUTION,n.width=100,n.height=100,n.realWidth=100,n.realHeight=100,n.scaleMode=void 0!==t?t:c.default.SCALE_MODE,n.hasLoaded=!1,n.isLoading=!1,n.source=null,n.origSource=null,n.imageType=null,n.sourceScale=1,n.premultipliedAlpha=!0,n.imageUrl=null,n.isPowerOfTwo=!1,n.mipmap=c.default.MIPMAP_TEXTURES,n.wrapMode=c.default.WRAP_MODE,n._glTextures={},n._enabled=0,n._virtalBoundId=-1,n._destroyed=!1,n.textureCacheIds=[],e&&n.loadSource(e),n}return u(o,i),o.prototype.update=function(){"svg"!==this.imageType&&(this.realWidth=this.source.naturalWidth||this.source.videoWidth||this.source.width,this.realHeight=this.source.naturalHeight||this.source.videoHeight||this.source.height,this._updateDimensions()),this.emit("update",this)},o.prototype._updateDimensions=function(){this.width=this.realWidth/this.resolution,this.height=this.realHeight/this.resolution,this.isPowerOfTwo=v.default.isPow2(this.realWidth)&&v.default.isPow2(this.realHeight)},o.prototype.loadSource=function(e){var t=this.isLoading;this.hasLoaded=!1,this.isLoading=!1,t&&this.source&&(this.source.onload=null,this.source.onerror=null);var r=!this.source;if(this.source=e,(e.src&&e.complete||e.getContext)&&e.width&&e.height)this._updateImageType(),"svg"===this.imageType?this._loadSvgSource():this._sourceLoaded(),r&&this.emit("loaded",this);else if(!e.getContext){this.isLoading=!0;var n=this;if(e.onload=function(){if(n._updateImageType(),e.onload=null,e.onerror=null,n.isLoading){if(n.isLoading=!1,n._sourceLoaded(),"svg"===n.imageType)return void n._loadSvgSource();n.emit("loaded",n)}},e.onerror=function(){e.onload=null,e.onerror=null,n.isLoading&&(n.isLoading=!1,n.emit("error",n))},e.complete&&e.src){if(e.onload=null,e.onerror=null,"svg"===n.imageType)return void n._loadSvgSource();this.isLoading=!1,e.width&&e.height?(this._sourceLoaded(),t&&this.emit("loaded",this)):t&&this.emit("error",this)}}},o.prototype._updateImageType=function(){if(this.imageUrl){var e=(0,l.decomposeDataUri)(this.imageUrl),t=void 0;if(e&&"image"===e.mediaType){var r=e.subType.split("+")[0];if(!(t=(0,l.getUrlFileExtension)("."+r)))throw new Error("Invalid image type in data URI.")}else(t=(0,l.getUrlFileExtension)(this.imageUrl))||(t="png");this.imageType=t}},o.prototype._loadSvgSource=function(){if("svg"===this.imageType){var e=(0,l.decomposeDataUri)(this.imageUrl);e?this._loadSvgSourceUsingDataUri(e):this._loadSvgSourceUsingXhr()}},o.prototype._loadSvgSourceUsingDataUri=function(e){var t=void 0;if("base64"===e.encoding){if(!atob)throw new Error("Your browser doesn't support base64 conversions.");t=atob(e.data)}else t=e.data;this._loadSvgSourceUsingString(t)},o.prototype._loadSvgSourceUsingXhr=function(){var e=this,t=new XMLHttpRequest;t.onload=function(){if(t.readyState!==t.DONE||200!==t.status)throw new Error("Failed to load SVG using XHR.");e._loadSvgSourceUsingString(t.response)},t.onerror=function(){return e.emit("error",e)},t.open("GET",this.imageUrl,!0),t.send()},o.prototype._loadSvgSourceUsingString=function(e){var t=(0,l.getSvgSize)(e),r=t.width,n=t.height;if(!r||!n)throw new Error("The SVG image must have width and height defined (in pixels), canvas API needs them.");this.realWidth=Math.round(r*this.sourceScale),this.realHeight=Math.round(n*this.sourceScale),this._updateDimensions();var i=document.createElement("canvas");i.width=this.realWidth,i.height=this.realHeight,i._pixiId="canvas_"+(0,l.uid)(),i.getContext("2d").drawImage(this.source,0,0,r,n,0,0,this.realWidth,this.realHeight),this.origSource=this.source,this.source=i,o.addToCache(this,i._pixiId),this.isLoading=!1,this._sourceLoaded(),this.emit("loaded",this)},o.prototype._sourceLoaded=function(){this.hasLoaded=!0,this.update()},o.prototype.destroy=function(){this.imageUrl&&(delete l.TextureCache[this.imageUrl],this.imageUrl=null,navigator.isCocoonJS||(this.source.src="")),this.source=null,this.dispose(),o.removeFromCache(this),this.textureCacheIds=null,this._destroyed=!0},o.prototype.dispose=function(){this.emit("dispose",this)},o.prototype.updateSourceImage=function(e){this.source.src=e,this.loadSource(this.source)},o.fromImage=function(e,t,r,n){var i=l.BaseTextureCache[e];if(!i){var a=new Image;void 0===t&&0!==e.indexOf("data:")?a.crossOrigin=(0,d.default)(e):t&&(a.crossOrigin="string"==typeof t?t:"anonymous"),i=new o(a,r),i.imageUrl=e,n&&(i.sourceScale=n),i.resolution=(0,l.getResolutionOfUrl)(e),a.src=e,o.addToCache(i,e)}return i},o.fromCanvas=function(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"canvas";e._pixiId||(e._pixiId=r+"_"+(0,l.uid)());var n=l.BaseTextureCache[e._pixiId];return n||(n=new o(e,t),o.addToCache(n,e._pixiId)),n},o.from=function(e,t,r){if("string"==typeof e)return o.fromImage(e,void 0,t,r);if(e instanceof HTMLImageElement){var n=e.src,i=l.BaseTextureCache[n];return i||(i=new o(e,t),i.imageUrl=n,r&&(i.sourceScale=r),i.resolution=(0,l.getResolutionOfUrl)(n),o.addToCache(i,n)),i}return e instanceof HTMLCanvasElement?o.fromCanvas(e,t):e},o.addToCache=function(e,t){t&&(-1===e.textureCacheIds.indexOf(t)&&e.textureCacheIds.push(t),l.BaseTextureCache[t]=e)},o.removeFromCache=function(e){if("string"==typeof e){var t=l.BaseTextureCache[e];if(t){var r=t.textureCacheIds.indexOf(e);return r>-1&&t.textureCacheIds.splice(r,1),delete l.BaseTextureCache[e],t}}else if(e&&e.textureCacheIds){for(var n=0;n<e.textureCacheIds.length;++n)delete l.BaseTextureCache[e.textureCacheIds[n]];return e.textureCacheIds.length=0,e}return null},o}(h.default);r.default=m},{"../settings":101,"../utils":125,"../utils/determineCrossOrigin":124,"bit-twiddle":1,eventemitter3:3}],113:[function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function c(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function h(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function i(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}r.__esModule=!0;var a=e("./BaseRenderTexture"),f=n(a),o=e("./Texture"),s=n(o),u=function(u){function l(e,t){c(this,l);var r=null;if(!(e instanceof f.default)){var n=arguments[1],i=arguments[2],a=arguments[3],o=arguments[4];console.warn("Please use RenderTexture.create("+n+", "+i+") instead of the ctor directly."),r=arguments[0],t=null,e=new f.default(n,i,a,o)}var s=h(this,u.call(this,e,t));return s.legacyRenderer=r,s.valid=!0,s._updateUvs(),s}return i(l,u),l.prototype.resize=function(e,t,r){e=Math.ceil(e),t=Math.ceil(t),this.valid=e>0&&t>0,this._frame.width=this.orig.width=e,this._frame.height=this.orig.height=t,r||this.baseTexture.resize(e,t),this._updateUvs()},l.create=function(e,t,r,n){return new l(new f.default(e,t,r,n))},l}(s.default);r.default=u},{"./BaseRenderTexture":111,"./Texture":115}],114:[function(e,t,r){"use strict";function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}r.__esModule=!0;var i=function(){function n(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(e,t,r){return t&&n(e.prototype,t),r&&n(e,r),e}}(),c=e("../"),a=e("../utils"),o=function(){function l(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;n(this,l),this.baseTexture=e,this.textures={},this.data=t,this.resolution=this._updateResolution(r||this.baseTexture.imageUrl),this._frames=this.data.frames,this._frameKeys=Object.keys(this._frames),this._batchIndex=0,this._callback=null}return i(l,null,[{key:"BATCH_SIZE",get:function(){return 1e3}}]),l.prototype._updateResolution=function(e){var t=this.data.meta.scale,r=(0,a.getResolutionOfUrl)(e,null);return null===r&&(r=void 0!==t?parseFloat(t):1),1!==r&&(this.baseTexture.resolution=r,this.baseTexture.update()),r},l.prototype.parse=function(e){this._batchIndex=0,this._callback=e,this._frameKeys.length<=l.BATCH_SIZE?(this._processFrames(0),this._parseComplete()):this._nextBatch()},l.prototype._processFrames=function(e){for(var t=e,r=l.BATCH_SIZE,n=this.baseTexture.sourceScale;t-e<r&&t<this._frameKeys.length;){var i=this._frameKeys[t],a=this._frames[i].frame;if(a){var o=null,s=null,u=new c.Rectangle(0,0,Math.floor(this._frames[i].sourceSize.w*n)/this.resolution,Math.floor(this._frames[i].sourceSize.h*n)/this.resolution);o=this._frames[i].rotated?new c.Rectangle(Math.floor(a.x*n)/this.resolution,Math.floor(a.y*n)/this.resolution,Math.floor(a.h*n)/this.resolution,Math.floor(a.w*n)/this.resolution):new c.Rectangle(Math.floor(a.x*n)/this.resolution,Math.floor(a.y*n)/this.resolution,Math.floor(a.w*n)/this.resolution,Math.floor(a.h*n)/this.resolution),this._frames[i].trimmed&&(s=new c.Rectangle(Math.floor(this._frames[i].spriteSourceSize.x*n)/this.resolution,Math.floor(this._frames[i].spriteSourceSize.y*n)/this.resolution,Math.floor(a.w*n)/this.resolution,Math.floor(a.h*n)/this.resolution)),this.textures[i]=new c.Texture(this.baseTexture,o,u,s,this._frames[i].rotated?2:0),c.Texture.addToCache(this.textures[i],i)}t++}},l.prototype._parseComplete=function(){var e=this._callback;this._callback=null,this._batchIndex=0,e.call(this,this.textures)},l.prototype._nextBatch=function(){var e=this;this._processFrames(this._batchIndex*l.BATCH_SIZE),this._batchIndex++,setTimeout(function(){e._batchIndex*l.BATCH_SIZE<e._frameKeys.length?e._nextBatch():e._parseComplete()},0)},l.prototype.destroy=function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];for(var t in this.textures)this.textures[t].destroy();this._frames=null,this._frameKeys=null,this.data=null,this.textures=null,e&&this.baseTexture.destroy(),this.baseTexture=null},l}();r.default=o},{"../":65,"../utils":125}],115:[function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function u(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function l(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function i(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}function a(e){e.destroy=function(){},e.on=function(){},e.once=function(){},e.emit=function(){}}r.__esModule=!0;var c=function(){function n(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(e,t,r){return t&&n(e.prototype,t),r&&n(e,r),e}}(),o=e("./BaseTexture"),h=n(o),s=e("./VideoBaseTexture"),f=n(s),d=e("./TextureUvs"),p=n(d),v=e("eventemitter3"),m=n(v),g=e("../math"),y=e("../utils"),x=e("../settings"),b=n(x),w=function(o){function s(e,t,r,n,i){u(this,s);var a=l(this,o.call(this));if(a.noFrame=!1,t||(a.noFrame=!0,t=new g.Rectangle(0,0,1,1)),e instanceof s&&(e=e.baseTexture),a.baseTexture=e,a._frame=t,a.trim=n,a.valid=!1,a.requiresUpdate=!1,a._uvs=null,a.orig=r||t,a._rotate=Number(i||0),!0===i)a._rotate=2;else if(a._rotate%2!=0)throw new Error("attempt to use diamond-shaped UVs. If you are sure, set rotation manually");return e.hasLoaded?(a.noFrame&&(t=new g.Rectangle(0,0,e.width,e.height),e.on("update",a.onBaseTextureUpdated,a)),a.frame=t):e.once("loaded",a.onBaseTextureLoaded,a),a._updateID=0,a.transform=null,a.textureCacheIds=[],a}return i(s,o),s.prototype.update=function(){this.baseTexture.update()},s.prototype.onBaseTextureLoaded=function(e){this._updateID++,this.noFrame?this.frame=new g.Rectangle(0,0,e.width,e.height):this.frame=this._frame,this.baseTexture.on("update",this.onBaseTextureUpdated,this),this.emit("update",this)},s.prototype.onBaseTextureUpdated=function(e){this._updateID++,this._frame.width=e.width,this._frame.height=e.height,this.emit("update",this)},s.prototype.destroy=function(e){this.baseTexture&&(e&&(y.TextureCache[this.baseTexture.imageUrl]&&s.removeFromCache(this.baseTexture.imageUrl),this.baseTexture.destroy()),this.baseTexture.off("update",this.onBaseTextureUpdated,this),this.baseTexture.off("loaded",this.onBaseTextureLoaded,this),this.baseTexture=null),this._frame=null,this._uvs=null,this.trim=null,this.orig=null,this.valid=!1,s.removeFromCache(this),this.textureCacheIds=null},s.prototype.clone=function(){return new s(this.baseTexture,this.frame,this.orig,this.trim,this.rotate)},s.prototype._updateUvs=function(){this._uvs||(this._uvs=new p.default),this._uvs.set(this._frame,this.baseTexture,this.rotate),this._updateID++},s.fromImage=function(e,t,r,n){var i=y.TextureCache[e];return i||(i=new s(h.default.fromImage(e,t,r,n)),s.addToCache(i,e)),i},s.fromFrame=function(e){var t=y.TextureCache[e];if(!t)throw new Error('The frameId "'+e+'" does not exist in the texture cache');return t},s.fromCanvas=function(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"canvas";return new s(h.default.fromCanvas(e,t,r))},s.fromVideo=function(e,t){return"string"==typeof e?s.fromVideoUrl(e,t):new s(f.default.fromVideo(e,t))},s.fromVideoUrl=function(e,t){return new s(f.default.fromUrl(e,t))},s.from=function(e){if("string"==typeof e){var t=y.TextureCache[e];if(!t){return null!==e.match(/\.(mp4|webm|ogg|h264|avi|mov)$/)?s.fromVideoUrl(e):s.fromImage(e)}return t}return e instanceof HTMLImageElement?new s(h.default.from(e)):e instanceof HTMLCanvasElement?s.fromCanvas(e,b.default.SCALE_MODE,"HTMLCanvasElement"):e instanceof HTMLVideoElement?s.fromVideo(e):e instanceof h.default?new s(e):e},s.fromLoader=function(e,t,r){var n=new h.default(e,void 0,(0,y.getResolutionOfUrl)(t)),i=new s(n);return n.imageUrl=t,r||(r=t),h.default.addToCache(i.baseTexture,r),s.addToCache(i,r),r!==t&&(h.default.addToCache(i.baseTexture,t),s.addToCache(i,t)),i},s.addToCache=function(e,t){t&&(-1===e.textureCacheIds.indexOf(t)&&e.textureCacheIds.push(t),y.TextureCache[t]=e)},s.removeFromCache=function(e){if("string"==typeof e){var t=y.TextureCache[e];if(t){var r=t.textureCacheIds.indexOf(e);return r>-1&&t.textureCacheIds.splice(r,1),delete y.TextureCache[e],t}}else if(e&&e.textureCacheIds){for(var n=0;n<e.textureCacheIds.length;++n)y.TextureCache[e.textureCacheIds[n]]===e&&delete y.TextureCache[e.textureCacheIds[n]];return e.textureCacheIds.length=0,e}return null},c(s,[{key:"frame",get:function(){return this._frame},set:function(e){this._frame=e,this.noFrame=!1;var t=e.x,r=e.y,n=e.width,i=e.height,a=t+n>this.baseTexture.width,o=r+i>this.baseTexture.height;if(a||o){var s=a&&o?"and":"or",u="X: "+t+" + "+n+" = "+(t+n)+" > "+this.baseTexture.width,l="Y: "+r+" + "+i+" = "+(r+i)+" > "+this.baseTexture.height;throw new Error("Texture Error: frame does not fit inside the base Texture dimensions: "+u+" "+s+" "+l)}this.valid=n&&i&&this.baseTexture.hasLoaded,this.trim||this.rotate||(this.orig=e),this.valid&&this._updateUvs()}},{key:"rotate",get:function(){return this._rotate},set:function(e){this._rotate=e,this.valid&&this._updateUvs()}},{key:"width",get:function(){return this.orig.width}},{key:"height",get:function(){return this.orig.height}}]),s}(m.default);r.default=w,w.EMPTY=new w(new h.default),a(w.EMPTY),a(w.EMPTY.baseTexture),w.WHITE=function(){var e=document.createElement("canvas");e.width=10,e.height=10;var t=e.getContext("2d");return t.fillStyle="white",t.fillRect(0,0,10,10),new w(new h.default(e))}(),a(w.WHITE),a(w.WHITE.baseTexture)},{"../math":70,"../settings":101,"../utils":125,"./BaseTexture":112,"./TextureUvs":117,"./VideoBaseTexture":118,eventemitter3:3}],116:[function(e,t,r){"use strict";function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}r.__esModule=!0;var i=function(){function n(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(e,t,r){return t&&n(e.prototype,t),r&&n(e,r),e}}(),a=e("../math/Matrix"),o=function(e){return e&&e.__esModule?e:{default:e}}(a),l=new o.default,s=function(){function r(e,t){n(this,r),this._texture=e,this.mapCoord=new o.default,this.uClampFrame=new Float32Array(4),this.uClampOffset=new Float32Array(2),this._lastTextureID=-1,this.clampOffset=0,this.clampMargin=void 0===t?.5:t}return r.prototype.multiplyUvs=function(e,t){void 0===t&&(t=e);for(var r=this.mapCoord,n=0;n<e.length;n+=2){var i=e[n],a=e[n+1];t[n]=i*r.a+a*r.c+r.tx,t[n+1]=i*r.b+a*r.d+r.ty}return t},r.prototype.update=function(e){var t=this._texture;if(!t||!t.valid)return!1;if(!e&&this._lastTextureID===t._updateID)return!1;this._lastTextureID=t._updateID;var r=t._uvs;this.mapCoord.set(r.x1-r.x0,r.y1-r.y0,r.x3-r.x0,r.y3-r.y0,r.x0,r.y0);var n=t.orig,i=t.trim;i&&(l.set(n.width/i.width,0,0,n.height/i.height,-i.x/i.width,-i.y/i.height),this.mapCoord.append(l));var a=t.baseTexture,o=this.uClampFrame,s=this.clampMargin/a.resolution,u=this.clampOffset;return o[0]=(t._frame.x+s+u)/a.width,o[1]=(t._frame.y+s+u)/a.height,o[2]=(t._frame.x+t._frame.width-s+u)/a.width,o[3]=(t._frame.y+t._frame.height-s+u)/a.height,this.uClampOffset[0]=u/a.realWidth,this.uClampOffset[1]=u/a.realHeight,!0},i(r,[{key:"texture",get:function(){return this._texture},set:function(e){this._texture=e,this._lastTextureID=-1}}]),r}();r.default=s},{"../math/Matrix":67}],117:[function(e,t,r){"use strict";function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}r.__esModule=!0;var i=e("../math/GroupD8"),l=function(e){return e&&e.__esModule?e:{default:e}}(i),a=function(){function e(){n(this,e),this.x0=0,this.y0=0,this.x1=1,this.y1=0,this.x2=1,this.y2=1,this.x3=0,this.y3=1,this.uvsUint32=new Uint32Array(4)}return e.prototype.set=function(e,t,r){var n=t.width,i=t.height;if(r){var a=e.width/2/n,o=e.height/2/i,s=e.x/n+a,u=e.y/i+o;r=l.default.add(r,l.default.NW),this.x0=s+a*l.default.uX(r),this.y0=u+o*l.default.uY(r),r=l.default.add(r,2),this.x1=s+a*l.default.uX(r),this.y1=u+o*l.default.uY(r),r=l.default.add(r,2),this.x2=s+a*l.default.uX(r),this.y2=u+o*l.default.uY(r),r=l.default.add(r,2),this.x3=s+a*l.default.uX(r),this.y3=u+o*l.default.uY(r)}else this.x0=e.x/n,this.y0=e.y/i,this.x1=(e.x+e.width)/n,this.y1=e.y/i,this.x2=(e.x+e.width)/n,this.y2=(e.y+e.height)/i,this.x3=e.x/n,this.y3=(e.y+e.height)/i;this.uvsUint32[0]=(65535*this.y0&65535)<<16|65535*this.x0&65535,this.uvsUint32[1]=(65535*this.y1&65535)<<16|65535*this.x1&65535,this.uvsUint32[2]=(65535*this.y2&65535)<<16|65535*this.x2&65535,this.uvsUint32[3]=(65535*this.y3&65535)<<16|65535*this.x3&65535},e}();r.default=a},{"../math/GroupD8":66}],118:[function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function s(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}function u(e,t){t||(t="video/"+e.substr(e.lastIndexOf(".")+1));var r=document.createElement("source");return r.src=e,r.type=t,r}r.__esModule=!0;var l=function(){function n(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(e,t,r){return t&&n(e.prototype,t),r&&n(e,r),e}}(),o=e("./BaseTexture"),c=n(o),h=e("../utils"),f=e("../ticker"),d=e("../const"),p=e("../utils/determineCrossOrigin"),v=n(p),m=function(n){function o(e,t){if(i(this,o),!e)throw new Error("No video source element specified.");(e.readyState===e.HAVE_ENOUGH_DATA||e.readyState===e.HAVE_FUTURE_DATA)&&e.width&&e.height&&(e.complete=!0);var r=a(this,n.call(this,e,t));return r.width=e.videoWidth,r.height=e.videoHeight,r._autoUpdate=!0,r._isAutoUpdating=!1,r.autoPlay=!0,r.update=r.update.bind(r),r._onCanPlay=r._onCanPlay.bind(r),e.addEventListener("play",r._onPlayStart.bind(r)),e.addEventListener("pause",r._onPlayStop.bind(r)),r.hasLoaded=!1,r.__loaded=!1,r._isSourceReady()?r._onCanPlay():(e.addEventListener("canplay",r._onCanPlay),e.addEventListener("canplaythrough",r._onCanPlay)),r}return s(o,n),o.prototype._isSourcePlaying=function(){var e=this.source;return e.currentTime>0&&!1===e.paused&&!1===e.ended&&e.readyState>2},o.prototype._isSourceReady=function(){return 3===this.source.readyState||4===this.source.readyState},o.prototype._onPlayStart=function(){this.hasLoaded||this._onCanPlay(),!this._isAutoUpdating&&this.autoUpdate&&(f.shared.add(this.update,this,d.UPDATE_PRIORITY.HIGH),this._isAutoUpdating=!0)},o.prototype._onPlayStop=function(){this._isAutoUpdating&&(f.shared.remove(this.update,this),this._isAutoUpdating=!1)},o.prototype._onCanPlay=function(){this.hasLoaded=!0,this.source&&(this.source.removeEventListener("canplay",this._onCanPlay),this.source.removeEventListener("canplaythrough",this._onCanPlay),this.width=this.source.videoWidth,this.height=this.source.videoHeight,this.__loaded||(this.__loaded=!0,this.emit("loaded",this)),this._isSourcePlaying()?this._onPlayStart():this.autoPlay&&this.source.play())},o.prototype.destroy=function(){this._isAutoUpdating&&f.shared.remove(this.update,this),this.source&&this.source._pixiId&&(c.default.removeFromCache(this.source._pixiId),delete this.source._pixiId),n.prototype.destroy.call(this)},o.fromVideo=function(e,t){e._pixiId||(e._pixiId="video_"+(0,h.uid)());var r=h.BaseTextureCache[e._pixiId];return r||(r=new o(e,t),c.default.addToCache(r,e._pixiId)),r},o.fromUrl=function(e,t,r){var n=document.createElement("video");n.setAttribute("webkit-playsinline",""),n.setAttribute("playsinline","");var i=Array.isArray(e)?e[0].src||e[0]:e.src||e;if(void 0===r&&0!==i.indexOf("data:")?n.crossOrigin=(0,v.default)(i):r&&(n.crossOrigin="string"==typeof r?r:"anonymous"),Array.isArray(e))for(var a=0;a<e.length;++a)n.appendChild(u(e[a].src||e[a],e[a].mime));else n.appendChild(u(i,e.mime));return n.load(),o.fromVideo(n,t)},l(o,[{key:"autoUpdate",get:function(){return this._autoUpdate},set:function(e){e!==this._autoUpdate&&(this._autoUpdate=e,!this._autoUpdate&&this._isAutoUpdating?(f.shared.remove(this.update,this),this._isAutoUpdating=!1):this._autoUpdate&&!this._isAutoUpdating&&(f.shared.add(this.update,this,d.UPDATE_PRIORITY.HIGH),this._isAutoUpdating=!0))}}]),o}(c.default);r.default=m,m.fromUrls=m.fromUrl},{"../const":46,"../ticker":121,"../utils":125,"../utils/determineCrossOrigin":124,"./BaseTexture":112}],119:[function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}r.__esModule=!0;var a=function(){function n(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(e,t,r){return t&&n(e.prototype,t),r&&n(e,r),e}}(),o=e("../settings"),s=n(o),u=e("../const"),l=e("./TickerListener"),c=n(l),h=function(){function e(){var t=this;i(this,e),this._head=new c.default(null,null,1/0),this._requestId=null,this._maxElapsedMS=100,this.autoStart=!1,this.deltaTime=1,this.elapsedMS=1/s.default.TARGET_FPMS,this.lastTime=-1,this.speed=1,this.started=!1,this._tick=function(e){t._requestId=null,t.started&&(t.update(e),t.started&&null===t._requestId&&t._head.next&&(t._requestId=requestAnimationFrame(t._tick)))}}return e.prototype._requestIfNeeded=function(){null===this._requestId&&this._head.next&&(this.lastTime=performance.now(),this._requestId=requestAnimationFrame(this._tick))},e.prototype._cancelIfNeeded=function(){null!==this._requestId&&(cancelAnimationFrame(this._requestId),this._requestId=null)},e.prototype._startIfPossible=function(){this.started?this._requestIfNeeded():this.autoStart&&this.start()},e.prototype.add=function(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:u.UPDATE_PRIORITY.NORMAL;return this._addListener(new c.default(e,t,r))},e.prototype.addOnce=function(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:u.UPDATE_PRIORITY.NORMAL;return this._addListener(new c.default(e,t,r,!0))},e.prototype._addListener=function(e){var t=this._head.next,r=this._head;if(t){for(;t;){if(e.priority>t.priority){e.connect(r);break}r=t,t=t.next}e.previous||e.connect(r)}else e.connect(r);return this._startIfPossible(),this},e.prototype.remove=function(e,t){for(var r=this._head.next;r;)r=r.match(e,t)?r.destroy():r.next;return this._head.next||this._cancelIfNeeded(),this},e.prototype.start=function(){this.started||(this.started=!0,this._requestIfNeeded())},e.prototype.stop=function(){this.started&&(this.started=!1,this._cancelIfNeeded())},e.prototype.destroy=function(){this.stop();for(var e=this._head.next;e;)e=e.destroy(!0);this._head.destroy(),this._head=null},e.prototype.update=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:performance.now(),t=void 0;if(e>this.lastTime){t=this.elapsedMS=e-this.lastTime,t>this._maxElapsedMS&&(t=this._maxElapsedMS),this.deltaTime=t*s.default.TARGET_FPMS*this.speed;for(var r=this._head,n=r.next;n;)n=n.emit(this.deltaTime);r.next||this._cancelIfNeeded()}else this.deltaTime=this.elapsedMS=0;this.lastTime=e},a(e,[{key:"FPS",get:function(){return 1e3/this.elapsedMS}},{key:"minFPS",get:function(){return 1e3/this._maxElapsedMS},set:function(e){var t=Math.min(Math.max(0,e)/1e3,s.default.TARGET_FPMS);this._maxElapsedMS=1/t}}]),e}();r.default=h},{"../const":46,"../settings":101,"./TickerListener":120}],120:[function(e,t,r){"use strict";function a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}r.__esModule=!0;var n=function(){function i(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,n=arguments.length>3&&void 0!==arguments[3]&&arguments[3];a(this,i),this.fn=e,this.context=t,this.priority=r,this.once=n,this.next=null,this.previous=null,this._destroyed=!1}return i.prototype.match=function(e,t){return t=t||null,this.fn===e&&this.context===t},i.prototype.emit=function(e){this.fn&&(this.context?this.fn.call(this.context,e):this.fn(e));var t=this.next;return this.once&&this.destroy(!0),this._destroyed&&(this.next=null),t},i.prototype.connect=function(e){this.previous=e,e.next&&(e.next.previous=this),this.next=e.next,e.next=this},i.prototype.destroy=function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];this._destroyed=!0,this.fn=null,this.context=null,this.previous&&(this.previous.next=this.next),this.next&&(this.next.previous=this.previous);var t=this.previous;return this.next=e?null:t,this.previous=null,t},i}();r.default=n},{}],121:[function(e,t,r){"use strict";r.__esModule=!0,r.Ticker=r.shared=void 0;var n=e("./Ticker"),i=function(e){return e&&e.__esModule?e:{default:e}}(n),a=new i.default;a.autoStart=!0,a.destroy=function(){},r.shared=a,r.Ticker=i.default},{"./Ticker":119}],122:[function(e,t,r){"use strict";function n(){return!(!!navigator.platform&&/iPad|iPhone|iPod/.test(navigator.platform))}r.__esModule=!0,r.default=n},{}],123:[function(e,t,r){"use strict";function n(e){for(var t=6*e,r=new Uint16Array(t),n=0,i=0;n<t;n+=6,i+=4)r[n+0]=i+0,r[n+1]=i+1,r[n+2]=i+2,r[n+3]=i+0,r[n+4]=i+2,r[n+5]=i+3;return r}r.__esModule=!0,r.default=n},{}],124:[function(e,t,r){"use strict";function n(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:window.location;if(0===e.indexOf("data:"))return"";t=t||window.location,o||(o=document.createElement("a")),o.href=e,e=a.default.parse(o.href);var r=!e.port&&""===t.port||e.port===t.port;return e.hostname===t.hostname&&r&&e.protocol===t.protocol?"":"anonymous"}r.__esModule=!0,r.default=n;var i=e("url"),a=function(e){return e&&e.__esModule?e:{default:e}}(i),o=void 0},{url:29}],125:[function(e,t,r){"use strict";function n(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t.default=e,t}function i(e){return e&&e.__esModule?e:{default:e}}function a(){return++U}function o(e,t){return t=t||[],t[0]=(e>>16&255)/255,t[1]=(e>>8&255)/255,t[2]=(255&e)/255,t}function s(e){return e=e.toString(16),"#"+(e="000000".substr(0,6-e.length)+e)}function u(e){return(255*e[0]<<16)+(255*e[1]<<8)+(255*e[2]|0)}function l(e,t){var r=M.default.RETINA_PREFIX.exec(e);return r?parseFloat(r[1]):void 0!==t?t:1}function c(e){var t=T.DATA_URI.exec(e);if(t)return{mediaType:t[1]?t[1].toLowerCase():void 0,subType:t[2]?t[2].toLowerCase():void 0,encoding:t[3]?t[3].toLowerCase():void 0,data:t[4]}}function h(e){var t=T.URL_FILE_EXTENSION.exec(e);if(t)return t[1].toLowerCase()}function f(e){var t=T.SVG_SIZE.exec(e),r={};return t&&(r[t[1]]=Math.round(parseFloat(t[3])),r[t[5]]=Math.round(parseFloat(t[7]))),r}function d(){k=!0}function p(e){if(!k){if(navigator.userAgent.toLowerCase().indexOf("chrome")>-1){var t=["\n %c %c %c PixiJS "+T.VERSION+" - ✰ "+e+" ✰  %c  %c  http://www.pixijs.com/  %c %c ♥%c♥%c♥ \n\n","background: #ff66a5; padding:5px 0;","background: #ff66a5; padding:5px 0;","color: #ff66a5; background: #030307; padding:5px 0;","background: #ff66a5; padding:5px 0;","background: #ffc3dc; padding:5px 0;","background: #ff66a5; padding:5px 0;","color: #ff2424; background: #fff; padding:5px 0;","color: #ff2424; background: #fff; padding:5px 0;","color: #ff2424; background: #fff; padding:5px 0;"];window.console.log.apply(console,t)}else window.console&&window.console.log("PixiJS "+T.VERSION+" - "+e+" - http://www.pixijs.com/");k=!0}}function v(){var e={stencil:!0,failIfMajorPerformanceCaveat:!0};try{if(!window.WebGLRenderingContext)return!1;var t=document.createElement("canvas"),r=t.getContext("webgl",e)||t.getContext("experimental-webgl",e),n=!(!r||!r.getContextAttributes().stencil);if(r){var i=r.getExtension("WEBGL_lose_context");i&&i.loseContext()}return r=null,n}catch(e){return!1}}function m(e){return 0===e?0:e<0?-1:1}function g(){var e=void 0;for(e in j)j[e].destroy();for(e in z)z[e].destroy()}function y(){var e=void 0;for(e in j)delete j[e];for(e in z)delete z[e]}function x(e,t){return H[t?1:0][e]}function b(e,t){if(1===t)return(255*t<<24)+e;if(0===t)return 0;var r=e>>16&255,n=e>>8&255,i=255&e;return r=r*t+.5|0,n=n*t+.5|0,i=i*t+.5|0,(255*t<<24)+(r<<16)+(n<<8)+i}function w(e,t,r,n){return r=r||new Float32Array(4),n||void 0===n?(r[0]=e[0]*t,r[1]=e[1]*t,r[2]=e[2]*t):(r[0]=e[0],r[1]=e[1],r[2]=e[2]),r[3]=t,r}function _(e,t,r,n){return r=r||new Float32Array(4),r[0]=(e>>16&255)/255,r[1]=(e>>8&255)/255,r[2]=(255&e)/255,(n||void 0===n)&&(r[0]*=t,r[1]*=t,r[2]*=t),r[3]=t,r}r.__esModule=!0,r.premultiplyBlendMode=r.BaseTextureCache=r.TextureCache=r.mixins=r.pluginTarget=r.EventEmitter=r.removeItems=r.isMobile=void 0,r.uid=a,r.hex2rgb=o,r.hex2string=s,r.rgb2hex=u,r.getResolutionOfUrl=l,r.decomposeDataUri=c,r.getUrlFileExtension=h,r.getSvgSize=f,r.skipHello=d,r.sayHello=p,r.isWebGLSupported=v,r.sign=m,r.destroyTextureCache=g,r.clearTextureCache=y,r.correctBlendMode=x,r.premultiplyTint=b,r.premultiplyRgba=w,r.premultiplyTintToRgba=_;var T=e("../const"),E=e("../settings"),M=i(E),S=e("eventemitter3"),A=i(S),R=e("./pluginTarget"),P=i(R),C=e("./mixin"),O=n(C),L=e("ismobilejs"),I=n(L),D=e("remove-array-items"),N=i(D),F=e("./mapPremultipliedBlendModes"),B=i(F),U=0,k=!1;r.isMobile=I,r.removeItems=N.default,r.EventEmitter=A.default,r.pluginTarget=P.default,r.mixins=O;var j=r.TextureCache=Object.create(null),z=r.BaseTextureCache=Object.create(null),H=r.premultiplyBlendMode=(0,B.default)()},{"../const":46,"../settings":101,"./mapPremultipliedBlendModes":126,"./mixin":128,"./pluginTarget":129,eventemitter3:3,ismobilejs:4,"remove-array-items":31}],126:[function(e,t,r){"use strict";function n(){for(var e=[],t=[],r=0;r<32;r++)e[r]=r,t[r]=r;e[i.BLEND_MODES.NORMAL_NPM]=i.BLEND_MODES.NORMAL,e[i.BLEND_MODES.ADD_NPM]=i.BLEND_MODES.ADD,e[i.BLEND_MODES.SCREEN_NPM]=i.BLEND_MODES.SCREEN,t[i.BLEND_MODES.NORMAL]=i.BLEND_MODES.NORMAL_NPM,t[i.BLEND_MODES.ADD]=i.BLEND_MODES.ADD_NPM,t[i.BLEND_MODES.SCREEN]=i.BLEND_MODES.SCREEN_NPM;var n=[];return n.push(t),n.push(e),n}r.__esModule=!0,r.default=n;var i=e("../const")},{"../const":46}],127:[function(e,t,r){"use strict";function n(e){return a.default.tablet||a.default.phone?4:e}r.__esModule=!0,r.default=n;var i=e("ismobilejs"),a=function(e){return e&&e.__esModule?e:{default:e}}(i)},{ismobilejs:4}],128:[function(e,t,r){"use strict";function n(e,t){if(e&&t)for(var r=Object.keys(t),n=0;n<r.length;++n){var i=r[n];Object.defineProperty(e,i,Object.getOwnPropertyDescriptor(t,i))}}function i(e,t){o.push(e,t)}function a(){for(var e=0;e<o.length;e+=2)n(o[e],o[e+1]);o.length=0}r.__esModule=!0,r.mixin=n,r.delayMixin=i,r.performMixins=a;var o=[]},{}],129:[function(e,t,r){"use strict";function n(r){r.__plugins={},r.registerPlugin=function(e,t){r.__plugins[e]=t},r.prototype.initPlugins=function(){this.plugins=this.plugins||{};for(var e in r.__plugins)this.plugins[e]=new r.__plugins[e](this)},r.prototype.destroyPlugins=function(){for(var e in this.plugins)this.plugins[e].destroy(),this.plugins[e]=null;this.plugins=null}}r.__esModule=!0,r.default={mixin:function(e){n(e)}}},{}],130:[function(e,t,r){"use strict";function n(e){var t=e.width,r=e.height,n=e.getContext("2d"),i=n.getImageData(0,0,t,r),a=i.data,o=a.length,s={top:null,left:null,right:null,bottom:null},u=void 0,l=void 0,c=void 0;for(u=0;u<o;u+=4)0!==a[u+3]&&(l=u/4%t,c=~~(u/4/t),null===s.top&&(s.top=c),null===s.left?s.left=l:l<s.left&&(s.left=l),null===s.right?s.right=l+1:s.right<l&&(s.right=l+1),null===s.bottom?s.bottom=c:s.bottom<c&&(s.bottom=c));return t=s.right-s.left,r=s.bottom-s.top+1,{height:r,width:t,data:n.getImageData(s.left,s.top,t,r)}}r.__esModule=!0,r.default=n},{}],131:[function(e,t,r){"use strict";function d(e){}function n(r){var e=r.mesh,t=r.particles,n=r.extras,i=r.filters,a=r.prepare,o=r.loaders,s=r.interaction;Object.defineProperties(r,{SpriteBatch:{get:function(){throw new ReferenceError("SpriteBatch does not exist any more, please use the new ParticleContainer instead.")}},AssetLoader:{get:function(){throw new ReferenceError("The loader system was overhauled in PixiJS v3, please see the new PIXI.loaders.Loader class.")}},Stage:{get:function(){return d("You do not need to use a PIXI Stage any more, you can simply render any container."),r.Container}},DisplayObjectContainer:{get:function(){return d("DisplayObjectContainer has been shortened to Container, please use Container from now on."),r.Container}},Strip:{get:function(){return d("The Strip class has been renamed to Mesh and moved to mesh.Mesh, please use mesh.Mesh from now on."),e.Mesh}},Rope:{get:function(){return d("The Rope class has been moved to mesh.Rope, please use mesh.Rope from now on."),e.Rope}},ParticleContainer:{get:function(){return d("The ParticleContainer class has been moved to particles.ParticleContainer, please use particles.ParticleContainer from now on."),t.ParticleContainer}},MovieClip:{get:function(){return d("The MovieClip class has been moved to extras.AnimatedSprite, please use extras.AnimatedSprite."),n.AnimatedSprite}},TilingSprite:{get:function(){return d("The TilingSprite class has been moved to extras.TilingSprite, please use extras.TilingSprite from now on."),n.TilingSprite}},BitmapText:{get:function(){return d("The BitmapText class has been moved to extras.BitmapText, please use extras.BitmapText from now on."),n.BitmapText}},blendModes:{get:function(){return d("The blendModes has been moved to BLEND_MODES, please use BLEND_MODES from now on."),r.BLEND_MODES}},scaleModes:{get:function(){return d("The scaleModes has been moved to SCALE_MODES, please use SCALE_MODES from now on."),r.SCALE_MODES}},BaseTextureCache:{get:function(){return d("The BaseTextureCache class has been moved to utils.BaseTextureCache, please use utils.BaseTextureCache from now on."),r.utils.BaseTextureCache}},TextureCache:{get:function(){return d("The TextureCache class has been moved to utils.TextureCache, please use utils.TextureCache from now on."),r.utils.TextureCache}},math:{get:function(){return d("The math namespace is deprecated, please access members already accessible on PIXI."),r}},AbstractFilter:{get:function(){return d("AstractFilter has been renamed to Filter, please use PIXI.Filter"),r.Filter}},TransformManual:{get:function(){return d("TransformManual has been renamed to TransformBase, please update your pixi-spine"),r.TransformBase}},TARGET_FPMS:{get:function(){return d("PIXI.TARGET_FPMS has been deprecated, please use PIXI.settings.TARGET_FPMS"),r.settings.TARGET_FPMS},set:function(e){d("PIXI.TARGET_FPMS has been deprecated, please use PIXI.settings.TARGET_FPMS"),r.settings.TARGET_FPMS=e}},FILTER_RESOLUTION:{get:function(){return d("PIXI.FILTER_RESOLUTION has been deprecated, please use PIXI.settings.FILTER_RESOLUTION"),r.settings.FILTER_RESOLUTION},set:function(e){d("PIXI.FILTER_RESOLUTION has been deprecated, please use PIXI.settings.FILTER_RESOLUTION"),r.settings.FILTER_RESOLUTION=e}},RESOLUTION:{get:function(){return d("PIXI.RESOLUTION has been deprecated, please use PIXI.settings.RESOLUTION"),r.settings.RESOLUTION},set:function(e){d("PIXI.RESOLUTION has been deprecated, please use PIXI.settings.RESOLUTION"),r.settings.RESOLUTION=e}},MIPMAP_TEXTURES:{get:function(){return d("PIXI.MIPMAP_TEXTURES has been deprecated, please use PIXI.settings.MIPMAP_TEXTURES"),r.settings.MIPMAP_TEXTURES},set:function(e){d("PIXI.MIPMAP_TEXTURES has been deprecated, please use PIXI.settings.MIPMAP_TEXTURES"),r.settings.MIPMAP_TEXTURES=e}},SPRITE_BATCH_SIZE:{get:function(){return d("PIXI.SPRITE_BATCH_SIZE has been deprecated, please use PIXI.settings.SPRITE_BATCH_SIZE"),r.settings.SPRITE_BATCH_SIZE},set:function(e){d("PIXI.SPRITE_BATCH_SIZE has been deprecated, please use PIXI.settings.SPRITE_BATCH_SIZE"),r.settings.SPRITE_BATCH_SIZE=e}},SPRITE_MAX_TEXTURES:{get:function(){return d("PIXI.SPRITE_MAX_TEXTURES has been deprecated, please use PIXI.settings.SPRITE_MAX_TEXTURES"),r.settings.SPRITE_MAX_TEXTURES},set:function(e){d("PIXI.SPRITE_MAX_TEXTURES has been deprecated, please use PIXI.settings.SPRITE_MAX_TEXTURES"),r.settings.SPRITE_MAX_TEXTURES=e}},RETINA_PREFIX:{get:function(){return d("PIXI.RETINA_PREFIX has been deprecated, please use PIXI.settings.RETINA_PREFIX"),r.settings.RETINA_PREFIX},set:function(e){d("PIXI.RETINA_PREFIX has been deprecated, please use PIXI.settings.RETINA_PREFIX"),r.settings.RETINA_PREFIX=e}},DEFAULT_RENDER_OPTIONS:{get:function(){return d("PIXI.DEFAULT_RENDER_OPTIONS has been deprecated, please use PIXI.settings.DEFAULT_RENDER_OPTIONS"),r.settings.RENDER_OPTIONS}}});for(var u=[{parent:"TRANSFORM_MODE",target:"TRANSFORM_MODE"},{parent:"GC_MODES",target:"GC_MODE"},{parent:"WRAP_MODES",target:"WRAP_MODE"},{parent:"SCALE_MODES",target:"SCALE_MODE"},{parent:"PRECISION",target:"PRECISION_FRAGMENT"}],l=0;l<u.length;l++)!function(e){var t=u[e];Object.defineProperty(r[t.parent],"DEFAULT",{get:function(){return d("PIXI."+t.parent+".DEFAULT has been deprecated, please use PIXI.settings."+t.target),r.settings[t.target]},set:function(e){d("PIXI."+t.parent+".DEFAULT has been deprecated, please use PIXI.settings."+t.target),r.settings[t.target]=e}})}(l);Object.defineProperties(r.settings,{PRECISION:{get:function(){return d("PIXI.settings.PRECISION has been deprecated, please use PIXI.settings.PRECISION_FRAGMENT"),r.settings.PRECISION_FRAGMENT},set:function(e){d("PIXI.settings.PRECISION has been deprecated, please use PIXI.settings.PRECISION_FRAGMENT"),r.settings.PRECISION_FRAGMENT=e}}}),n.AnimatedSprite&&Object.defineProperties(n,{MovieClip:{get:function(){return d("The MovieClip class has been renamed to AnimatedSprite, please use AnimatedSprite from now on."),n.AnimatedSprite}}}),n&&Object.defineProperties(n,{TextureTransform:{get:function(){return d("The TextureTransform class has been renamed to TextureMatrix, please use PIXI.TextureMatrix from now on."),r.TextureMatrix}}}),r.DisplayObject.prototype.generateTexture=function(e,t,r){return d("generateTexture has moved to the renderer, please use renderer.generateTexture(displayObject)"),e.generateTexture(this,t,r)},r.Graphics.prototype.generateTexture=function(e,t){return d("graphics generate texture has moved to the renderer. Or to render a graphics to a texture using canvas please use generateCanvasTexture"),this.generateCanvasTexture(e,t)},r.GroupD8.isSwapWidthHeight=function(e){return d("GroupD8.isSwapWidthHeight was renamed to GroupD8.isVertical"),r.GroupD8.isVertical(e)},r.RenderTexture.prototype.render=function(e,t,r,n){this.legacyRenderer.render(e,this,r,t,!n),d("RenderTexture.render is now deprecated, please use renderer.render(displayObject, renderTexture)")},r.RenderTexture.prototype.getImage=function(e){return d("RenderTexture.getImage is now deprecated, please use renderer.extract.image(target)"),this.legacyRenderer.extract.image(e)},r.RenderTexture.prototype.getBase64=function(e){return d("RenderTexture.getBase64 is now deprecated, please use renderer.extract.base64(target)"),this.legacyRenderer.extract.base64(e)},r.RenderTexture.prototype.getCanvas=function(e){return d("RenderTexture.getCanvas is now deprecated, please use renderer.extract.canvas(target)"),this.legacyRenderer.extract.canvas(e)},r.RenderTexture.prototype.getPixels=function(e){return d("RenderTexture.getPixels is now deprecated, please use renderer.extract.pixels(target)"),this.legacyRenderer.pixels(e)},r.Sprite.prototype.setTexture=function(e){this.texture=e,d("setTexture is now deprecated, please use the texture property, e.g : sprite.texture = texture;")},n.BitmapText&&(n.BitmapText.prototype.setText=function(e){this.text=e,d("setText is now deprecated, please use the text property, e.g : myBitmapText.text = 'my text';")}),r.Text.prototype.setText=function(e){this.text=e,d("setText is now deprecated, please use the text property, e.g : myText.text = 'my text';")},r.Text.calculateFontProperties=function(e){return d("Text.calculateFontProperties is now deprecated, please use the TextMetrics.measureFont"),r.TextMetrics.measureFont(e)},Object.defineProperties(r.Text,{fontPropertiesCache:{get:function(){return d("Text.fontPropertiesCache is deprecated"),r.TextMetrics._fonts}},fontPropertiesCanvas:{get:function(){return d("Text.fontPropertiesCanvas is deprecated"),r.TextMetrics._canvas}},fontPropertiesContext:{get:function(){return d("Text.fontPropertiesContext is deprecated"),r.TextMetrics._context}}}),r.Text.prototype.setStyle=function(e){this.style=e,d("setStyle is now deprecated, please use the style property, e.g : myText.style = style;")},r.Text.prototype.determineFontProperties=function(e){return d("determineFontProperties is now deprecated, please use TextMetrics.measureFont method"),r.TextMetrics.measureFont(e)},r.Text.getFontStyle=function(e){return d("getFontStyle is now deprecated, please use TextStyle.toFontString() instead"),e=e||{},e instanceof r.TextStyle||(e=new r.TextStyle(e)),e.toFontString()},Object.defineProperties(r.TextStyle.prototype,{font:{get:function(){d("text style property 'font' is now deprecated, please use the 'fontFamily', 'fontSize', 'fontStyle', 'fontVariant' and 'fontWeight' properties from now on");var e="number"==typeof this._fontSize?this._fontSize+"px":this._fontSize;return this._fontStyle+" "+this._fontVariant+" "+this._fontWeight+" "+e+" "+this._fontFamily},set:function(e){d("text style property 'font' is now deprecated, please use the 'fontFamily','fontSize',fontStyle','fontVariant' and 'fontWeight' properties from now on"),e.indexOf("italic")>1?this._fontStyle="italic":e.indexOf("oblique")>-1?this._fontStyle="oblique":this._fontStyle="normal",e.indexOf("small-caps")>-1?this._fontVariant="small-caps":this._fontVariant="normal";var t=e.split(" "),r=-1;this._fontSize=26;for(var n=0;n<t.length;++n)if(t[n].match(/(px|pt|em|%)/)){r=n,this._fontSize=t[n];break}this._fontWeight="normal";for(var i=0;i<r;++i)if(t[i].match(/(bold|bolder|lighter|100|200|300|400|500|600|700|800|900)/)){this._fontWeight=t[i];break}if(r>-1&&r<t.length-1){this._fontFamily="";for(var a=r+1;a<t.length;++a)this._fontFamily+=t[a]+" ";this._fontFamily=this._fontFamily.slice(0,-1)}else this._fontFamily="Arial";this.styleID++}}}),r.Texture.prototype.setFrame=function(e){this.frame=e,d("setFrame is now deprecated, please use the frame property, e.g: myTexture.frame = frame;")},r.Texture.addTextureToCache=function(e,t){r.Texture.addToCache(e,t),d("Texture.addTextureToCache is deprecated, please use Texture.addToCache from now on.")},r.Texture.removeTextureFromCache=function(e){return d("Texture.removeTextureFromCache is deprecated, please use Texture.removeFromCache from now on. Be aware that Texture.removeFromCache does not automatically its BaseTexture from the BaseTextureCache. For that, use BaseTexture.removeFromCache"),r.BaseTexture.removeFromCache(e),r.Texture.removeFromCache(e)},Object.defineProperties(i,{AbstractFilter:{get:function(){return d("AstractFilter has been renamed to Filter, please use PIXI.Filter"),r.AbstractFilter}},SpriteMaskFilter:{get:function(){return d("filters.SpriteMaskFilter is an undocumented alias, please use SpriteMaskFilter from now on."),r.SpriteMaskFilter}},VoidFilter:{get:function(){return d("VoidFilter has been renamed to AlphaFilter, please use PIXI.filters.AlphaFilter"),i.AlphaFilter}}}),r.utils.uuid=function(){return d("utils.uuid() is deprecated, please use utils.uid() from now on."),r.utils.uid()},r.utils.canUseNewCanvasBlendModes=function(){return d("utils.canUseNewCanvasBlendModes() is deprecated, please use CanvasTinter.canUseMultiply from now on"),r.CanvasTinter.canUseMultiply};var c=!0;if(Object.defineProperty(r.utils,"_saidHello",{set:function(e){e&&(d("PIXI.utils._saidHello is deprecated, please use PIXI.utils.skipHello()"),this.skipHello()),c=e},get:function(){return c}}),a.BasePrepare&&(a.BasePrepare.prototype.register=function(e,t){return d("renderer.plugins.prepare.register is now deprecated, please use renderer.plugins.prepare.registerFindHook & renderer.plugins.prepare.registerUploadHook"),e&&this.registerFindHook(e),t&&this.registerUploadHook(t),this}),a.canvas&&Object.defineProperty(a.canvas,"UPLOADS_PER_FRAME",{set:function(){d("PIXI.CanvasPrepare.UPLOADS_PER_FRAME has been removed. Please set renderer.plugins.prepare.limiter.maxItemsPerFrame on your renderer")},get:function(){return d("PIXI.CanvasPrepare.UPLOADS_PER_FRAME has been removed. Please use renderer.plugins.prepare.limiter"),NaN}}),a.webgl&&Object.defineProperty(a.webgl,"UPLOADS_PER_FRAME",{set:function(){d("PIXI.WebGLPrepare.UPLOADS_PER_FRAME has been removed. Please set renderer.plugins.prepare.limiter.maxItemsPerFrame on your renderer")},get:function(){return d("PIXI.WebGLPrepare.UPLOADS_PER_FRAME has been removed. Please use renderer.plugins.prepare.limiter"),NaN}}),o.Loader){var h=o.Resource,f=o.Loader;Object.defineProperties(h.prototype,{isJson:{get:function(){return d("The isJson property is deprecated, please use `resource.type === Resource.TYPE.JSON`."),this.type===h.TYPE.JSON}},isXml:{get:function(){return d("The isXml property is deprecated, please use `resource.type === Resource.TYPE.XML`."),this.type===h.TYPE.XML}},isImage:{get:function(){return d("The isImage property is deprecated, please use `resource.type === Resource.TYPE.IMAGE`."),this.type===h.TYPE.IMAGE}},isAudio:{get:function(){return d("The isAudio property is deprecated, please use `resource.type === Resource.TYPE.AUDIO`."),this.type===h.TYPE.AUDIO}},isVideo:{get:function(){return d("The isVideo property is deprecated, please use `resource.type === Resource.TYPE.VIDEO`."),this.type===h.TYPE.VIDEO}}}),Object.defineProperties(f.prototype,{before:{get:function(){return d("The before() method is deprecated, please use pre()."),this.pre}},after:{get:function(){return d("The after() method is deprecated, please use use()."),this.use}}})}s.interactiveTarget&&Object.defineProperty(s.interactiveTarget,"defaultCursor",{set:function(e){d("Property defaultCursor has been replaced with 'cursor'. "),this.cursor=e},get:function(){return d("Property defaultCursor has been replaced with 'cursor'. "),this.cursor}}),s.InteractionManager&&(Object.defineProperty(s.InteractionManager,"defaultCursorStyle",{set:function(e){d("Property defaultCursorStyle has been replaced with 'cursorStyles.default'. "),this.cursorStyles.default=e},get:function(){return d("Property defaultCursorStyle has been replaced with 'cursorStyles.default'. "),this.cursorStyles.default}}),Object.defineProperty(s.InteractionManager,"currentCursorStyle",{set:function(e){d("Property currentCursorStyle has been removed.See the currentCursorMode property, which works differently."),this.currentCursorMode=e},get:function(){return d("Property currentCursorStyle has been removed.See the currentCursorMode property, which works differently."),this.currentCursorMode}}))}r.__esModule=!0,r.default=n},{}],132:[function(e,t,r){"use strict";function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}r.__esModule=!0;var i=e("../../core"),c=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t.default=e,t}(i),h=new c.Rectangle,a=function(){function t(e){n(this,t),this.renderer=e,e.extract=this}return t.prototype.image=function(e){var t=new Image;return t.src=this.base64(e),t},t.prototype.base64=function(e){return this.canvas(e).toDataURL()},t.prototype.canvas=function(e){var t=this.renderer,r=void 0,n=void 0,i=void 0,a=void 0;e&&(a=e instanceof c.RenderTexture?e:t.generateTexture(e)),a?(r=a.baseTexture._canvasRenderTarget.context,n=a.baseTexture._canvasRenderTarget.resolution,i=a.frame):(r=t.rootContext,i=h,i.width=this.renderer.width,i.height=this.renderer.height);var o=i.width*n,s=i.height*n,u=new c.CanvasRenderTarget(o,s),l=r.getImageData(i.x*n,i.y*n,o,s);return u.context.putImageData(l,0,0),u.canvas},t.prototype.pixels=function(e){var t=this.renderer,r=void 0,n=void 0,i=void 0,a=void 0;return e&&(a=e instanceof c.RenderTexture?e:t.generateTexture(e)),a?(r=a.baseTexture._canvasRenderTarget.context,n=a.baseTexture._canvasRenderTarget.resolution,i=a.frame):(r=t.rootContext,i=h,i.width=t.width,i.height=t.height),r.getImageData(0,0,i.width*n,i.height*n).data},t.prototype.destroy=function(){this.renderer.extract=null,this.renderer=null},t}();r.default=a,c.CanvasRenderer.registerPlugin("extract",a)},{"../../core":65}],133:[function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}r.__esModule=!0;var i=e("./webgl/WebGLExtract");Object.defineProperty(r,"webgl",{enumerable:!0,get:function(){return n(i).default}});var a=e("./canvas/CanvasExtract");Object.defineProperty(r,"canvas",{enumerable:!0,get:function(){return n(a).default}})},{"./canvas/CanvasExtract":132,"./webgl/WebGLExtract":134}],134:[function(e,t,r){"use strict";function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}r.__esModule=!0;var i=e("../../core"),d=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t.default=e,t}(i),p=new d.Rectangle,a=function(){function t(e){n(this,t),this.renderer=e,e.extract=this}return t.prototype.image=function(e){var t=new Image;return t.src=this.base64(e),t},t.prototype.base64=function(e){return this.canvas(e).toDataURL()},t.prototype.canvas=function(e){var t=this.renderer,r=void 0,n=void 0,i=void 0,a=!1,o=void 0;e&&(o=e instanceof d.RenderTexture?e:this.renderer.generateTexture(e)),o?(r=o.baseTexture._glRenderTargets[this.renderer.CONTEXT_UID],n=r.resolution,i=o.frame,a=!1):(r=this.renderer.rootRenderTarget,n=r.resolution,a=!0,i=p,i.width=r.size.width,i.height=r.size.height);var s=i.width*n,u=i.height*n,l=new d.CanvasRenderTarget(s,u);if(r){t.bindRenderTarget(r);var c=new Uint8Array(4*s*u),h=t.gl;h.readPixels(i.x*n,i.y*n,s,u,h.RGBA,h.UNSIGNED_BYTE,c);var f=l.context.getImageData(0,0,s,u);f.data.set(c),l.context.putImageData(f,0,0),a&&(l.context.scale(1,-1),l.context.drawImage(l.canvas,0,-u))}return l.canvas},t.prototype.pixels=function(e){var t=this.renderer,r=void 0,n=void 0,i=void 0,a=void 0;e&&(a=e instanceof d.RenderTexture?e:this.renderer.generateTexture(e)),a?(r=a.baseTexture._glRenderTargets[this.renderer.CONTEXT_UID],n=r.resolution,i=a.frame):(r=this.renderer.rootRenderTarget,n=r.resolution,i=p,i.width=r.size.width,i.height=r.size.height);var o=i.width*n,s=i.height*n,u=new Uint8Array(4*o*s);if(r){t.bindRenderTarget(r);var l=t.gl;l.readPixels(i.x*n,i.y*n,o,s,l.RGBA,l.UNSIGNED_BYTE,u)}return u},t.prototype.destroy=function(){this.renderer.extract=null,this.renderer=null},t}();r.default=a,d.WebGLRenderer.registerPlugin("extract",a)},{"../../core":65}],135:[function(e,t,r){"use strict";function a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function s(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}r.__esModule=!0;var u=function(){function n(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(e,t,r){return t&&n(e.prototype,t),r&&n(e,r),e}}(),n=e("../core"),l=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t.default=e,t}(n),i=function(n){function i(e,t){a(this,i);var r=o(this,n.call(this,e[0]instanceof l.Texture?e[0]:e[0].texture));return r._textures=null,r._durations=null,r.textures=e,r._autoUpdate=!1!==t,r.animationSpeed=1,r.loop=!0,r.onComplete=null,r.onFrameChange=null,r.onLoop=null,r._currentTime=0,r.playing=!1,r}return s(i,n),i.prototype.stop=function(){this.playing&&(this.playing=!1,this._autoUpdate&&l.ticker.shared.remove(this.update,this))},i.prototype.play=function(){this.playing||(this.playing=!0,this._autoUpdate&&l.ticker.shared.add(this.update,this,l.UPDATE_PRIORITY.HIGH))},i.prototype.gotoAndStop=function(e){this.stop();var t=this.currentFrame;this._currentTime=e,t!==this.currentFrame&&this.updateTexture()},i.prototype.gotoAndPlay=function(e){var t=this.currentFrame;this._currentTime=e,t!==this.currentFrame&&this.updateTexture(),this.play()},i.prototype.update=function(e){var t=this.animationSpeed*e,r=this.currentFrame;if(null!==this._durations){var n=this._currentTime%1*this._durations[this.currentFrame];for(n+=t/60*1e3;n<0;)this._currentTime--,n+=this._durations[this.currentFrame];var i=Math.sign(this.animationSpeed*e);for(this._currentTime=Math.floor(this._currentTime);n>=this._durations[this.currentFrame];)n-=this._durations[this.currentFrame]*i,this._currentTime+=i;this._currentTime+=n/this._durations[this.currentFrame]}else this._currentTime+=t;this._currentTime<0&&!this.loop?(this.gotoAndStop(0),this.onComplete&&this.onComplete()):this._currentTime>=this._textures.length&&!this.loop?(this.gotoAndStop(this._textures.length-1),this.onComplete&&this.onComplete()):r!==this.currentFrame&&(this.loop&&this.onLoop&&(this.animationSpeed>0&&this.currentFrame<r?this.onLoop():this.animationSpeed<0&&this.currentFrame>r&&this.onLoop()),this.updateTexture())},i.prototype.updateTexture=function(){this._texture=this._textures[this.currentFrame],this._textureID=-1,this.cachedTint=16777215,this.onFrameChange&&this.onFrameChange(this.currentFrame)},i.prototype.destroy=function(e){this.stop(),n.prototype.destroy.call(this,e)},i.fromFrames=function(e){for(var t=[],r=0;r<e.length;++r)t.push(l.Texture.fromFrame(e[r]));return new i(t)},i.fromImages=function(e){for(var t=[],r=0;r<e.length;++r)t.push(l.Texture.fromImage(e[r]));return new i(t)},u(i,[{key:"totalFrames",get:function(){return this._textures.length}},{key:"textures",get:function(){return this._textures},set:function(e){if(e[0]instanceof l.Texture)this._textures=e,this._durations=null;else{this._textures=[],this._durations=[];for(var t=0;t<e.length;t++)this._textures.push(e[t].texture),this._durations.push(e[t].time)}this.gotoAndStop(0),this.updateTexture()}},{key:"currentFrame",get:function(){var e=Math.floor(this._currentTime)%this._textures.length;return e<0&&(e+=this._textures.length),e}}]),i}(l.Sprite);r.default=i},{"../core":65}],136:[function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function o(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}r.__esModule=!0;var s=function(){function n(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(e,t,r){return t&&n(e.prototype,t),r&&n(e,r),e}}(),u=e("../core"),S=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t.default=e,t}(u),l=e("../core/math/ObservablePoint"),c=n(l),y=e("../core/utils"),h=e("../core/settings"),x=n(h),f=function(n){function M(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};i(this,M);var r=a(this,n.call(this));return r._textWidth=0,r._textHeight=0,r._glyphs=[],r._font={tint:void 0!==t.tint?t.tint:16777215,align:t.align||"left",name:null,size:0},r.font=t.font,r._text=e,r._maxWidth=0,r._maxLineHeight=0,r._anchor=new c.default(function(){r.dirty=!0},r,0,0),r.dirty=!1,r.updateText(),r}return o(M,n),M.prototype.updateText=function(){for(var e=M.fonts[this._font.name],t=this._font.size/e.size,r=new S.Point,n=[],i=[],a=null,o=0,s=0,u=0,l=-1,c=0,h=0,f=0,d=0;d<this.text.length;d++){var p=this.text.charCodeAt(d);if(/(\s)/.test(this.text.charAt(d))&&(l=d,c=o),/(?:\r\n|\r|\n)/.test(this.text.charAt(d)))i.push(o),s=Math.max(s,o),u++,r.x=0,r.y+=e.lineHeight,a=null;else if(-1!==l&&this._maxWidth>0&&r.x*t>this._maxWidth)S.utils.removeItems(n,l-h,d-l),d=l,l=-1,++h,i.push(c),s=Math.max(s,c),u++,r.x=0,r.y+=e.lineHeight,a=null;else{var v=e.chars[p];v&&(a&&v.kerning[a]&&(r.x+=v.kerning[a]),n.push({texture:v.texture,line:u,charCode:p,position:new S.Point(r.x+v.xOffset,r.y+v.yOffset)}),o=r.x+(v.texture.width+v.xOffset),r.x+=v.xAdvance,f=Math.max(f,v.yOffset+v.texture.height),a=p)}}i.push(o),s=Math.max(s,o);for(var m=[],g=0;g<=u;g++){var y=0;"right"===this._font.align?y=s-i[g]:"center"===this._font.align&&(y=(s-i[g])/2),m.push(y)}for(var x=n.length,b=this.tint,w=0;w<x;w++){var _=this._glyphs[w];_?_.texture=n[w].texture:(_=new S.Sprite(n[w].texture),this._glyphs.push(_)),_.position.x=(n[w].position.x+m[n[w].line])*t,_.position.y=n[w].position.y*t,_.scale.x=_.scale.y=t,_.tint=b,_.parent||this.addChild(_)}for(var T=x;T<this._glyphs.length;++T)this.removeChild(this._glyphs[T]);if(this._textWidth=s*t,this._textHeight=(r.y+e.lineHeight)*t,0!==this.anchor.x||0!==this.anchor.y)for(var E=0;E<x;E++)this._glyphs[E].x-=this._textWidth*this.anchor.x,this._glyphs[E].y-=this._textHeight*this.anchor.y;this._maxLineHeight=f*t},M.prototype.updateTransform=function(){this.validate(),this.containerUpdateTransform()},M.prototype.getLocalBounds=function(){return this.validate(),n.prototype.getLocalBounds.call(this)},M.prototype.validate=function(){this.dirty&&(this.updateText(),this.dirty=!1)},M.registerFont=function(e,t){var r={},n=e.getElementsByTagName("info")[0],i=e.getElementsByTagName("common")[0],a=e.getElementsByTagName("page")[0].getAttribute("file"),o=(0,y.getResolutionOfUrl)(a,x.default.RESOLUTION);r.font=n.getAttribute("face"),r.size=parseInt(n.getAttribute("size"),10),r.lineHeight=parseInt(i.getAttribute("lineHeight"),10)/o,r.chars={};for(var s=e.getElementsByTagName("char"),u=0;u<s.length;u++){var l=s[u],c=parseInt(l.getAttribute("id"),10),h=new S.Rectangle(parseInt(l.getAttribute("x"),10)/o+t.frame.x/o,parseInt(l.getAttribute("y"),10)/o+t.frame.y/o,parseInt(l.getAttribute("width"),10)/o,parseInt(l.getAttribute("height"),10)/o);r.chars[c]={xOffset:parseInt(l.getAttribute("xoffset"),10)/o,yOffset:parseInt(l.getAttribute("yoffset"),10)/o,xAdvance:parseInt(l.getAttribute("xadvance"),10)/o,kerning:{},texture:new S.Texture(t.baseTexture,h)}}for(var f=e.getElementsByTagName("kerning"),d=0;d<f.length;d++){var p=f[d],v=parseInt(p.getAttribute("first"),10)/o,m=parseInt(p.getAttribute("second"),10)/o,g=parseInt(p.getAttribute("amount"),10)/o;r.chars[m]&&(r.chars[m].kerning[v]=g)}return M.fonts[r.font]=r,r},s(M,[{key:"tint",get:function(){return this._font.tint},set:function(e){this._font.tint="number"==typeof e&&e>=0?e:16777215,this.dirty=!0}},{key:"align",get:function(){return this._font.align},set:function(e){this._font.align=e||"left",this.dirty=!0}},{key:"anchor",get:function(){return this._anchor},set:function(e){"number"==typeof e?this._anchor.set(e):this._anchor.copy(e)}},{key:"font",get:function(){return this._font},set:function(e){e&&("string"==typeof e?(e=e.split(" "),this._font.name=1===e.length?e[0]:e.slice(1).join(" "),this._font.size=e.length>=2?parseInt(e[0],10):M.fonts[this._font.name].size):(this._font.name=e.name,this._font.size="number"==typeof e.size?e.size:parseInt(e.size,10)),this.dirty=!0)}},{key:"text",get:function(){return this._text},set:function(e){e=e.toString()||" ",this._text!==e&&(this._text=e,this.dirty=!0)}},{key:"maxWidth",get:function(){return this._maxWidth},set:function(e){this._maxWidth!==e&&(this._maxWidth=e,this.dirty=!0)}},{key:"maxLineHeight",get:function(){return this.validate(),this._maxLineHeight}},{key:"textWidth",get:function(){return this.validate(),this._textWidth}},{key:"textHeight",get:function(){return this.validate(),this._textHeight}}]),M}(S.Container);r.default=f,f.fonts={}},{"../core":65,"../core/math/ObservablePoint":68,"../core/settings":101,"../core/utils":125}],137:[function(e,t,r){"use strict";function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function s(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function n(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}r.__esModule=!0;var u=function(){function n(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(e,t,r){return t&&n(e.prototype,t),r&&n(e,r),e}}(),i=e("../core"),f=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t.default=e,t}(i),a=e("../core/sprites/canvas/CanvasTinter"),d=function(e){return e&&e.__esModule?e:{default:e}}(a),l=new f.Point,c=function(i){function a(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:100,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:100;o(this,a);var n=s(this,i.call(this,e));return n.tileTransform=new f.TransformStatic,n._width=t,n._height=r,n._canvasPattern=null,n.uvTransform=e.transform||new f.TextureMatrix(e),n.pluginName="tilingSprite",n.uvRespectAnchor=!1,n}return n(a,i),a.prototype._onTextureUpdate=function(){this.uvTransform&&(this.uvTransform.texture=this._texture),this.cachedTint=16777215},a.prototype._renderWebGL=function(e){var t=this._texture;t&&t.valid&&(this.tileTransform.updateLocalTransform(),this.uvTransform.update(),e.setObjectRenderer(e.plugins[this.pluginName]),e.plugins[this.pluginName].render(this))},a.prototype._renderCanvas=function(e){var t=this._texture;if(t.baseTexture.hasLoaded){var r=e.context,n=this.worldTransform,i=e.resolution,a=t.baseTexture,o=a.resolution,s=this.tilePosition.x/this.tileScale.x%t._frame.width*o,u=this.tilePosition.y/this.tileScale.y%t._frame.height*o;if(this._textureID!==this._texture._updateID||this.cachedTint!==this.tint){this._textureID=this._texture._updateID;var l=new f.CanvasRenderTarget(t._frame.width,t._frame.height,o);16777215!==this.tint?(this.tintedTexture=d.default.getTintedTexture(this,this.tint),l.context.drawImage(this.tintedTexture,0,0)):l.context.drawImage(a.source,-t._frame.x*o,-t._frame.y*o),this.cachedTint=this.tint,this._canvasPattern=l.context.createPattern(l.canvas,"repeat")}r.globalAlpha=this.worldAlpha,r.setTransform(n.a*i,n.b*i,n.c*i,n.d*i,n.tx*i,n.ty*i),e.setBlendMode(this.blendMode),r.fillStyle=this._canvasPattern,r.scale(this.tileScale.x/o,this.tileScale.y/o);var c=this.anchor.x*-this._width,h=this.anchor.y*-this._height;this.uvRespectAnchor?(r.translate(s,u),r.fillRect(-s+c,-u+h,this._width/this.tileScale.x*o,this._height/this.tileScale.y*o)):(r.translate(s+c,u+h),r.fillRect(-s,-u,this._width/this.tileScale.x*o,this._height/this.tileScale.y*o))}},a.prototype._calculateBounds=function(){var e=this._width*-this._anchor._x,t=this._height*-this._anchor._y,r=this._width*(1-this._anchor._x),n=this._height*(1-this._anchor._y);this._bounds.addFrame(this.transform,e,t,r,n)},a.prototype.getLocalBounds=function(e){return 0===this.children.length?(this._bounds.minX=this._width*-this._anchor._x,this._bounds.minY=this._height*-this._anchor._y,this._bounds.maxX=this._width*(1-this._anchor._x),this._bounds.maxY=this._height*(1-this._anchor._x),e||(this._localBoundsRect||(this._localBoundsRect=new f.Rectangle),e=this._localBoundsRect),this._bounds.getRectangle(e)):i.prototype.getLocalBounds.call(this,e)},a.prototype.containsPoint=function(e){this.worldTransform.applyInverse(e,l);var t=this._width,r=this._height,n=-t*this.anchor._x;if(l.x>=n&&l.x<n+t){var i=-r*this.anchor._y;if(l.y>=i&&l.y<i+r)return!0}return!1},a.prototype.destroy=function(e){i.prototype.destroy.call(this,e),this.tileTransform=null,this.uvTransform=null},a.from=function(e,t,r){return new a(f.Texture.from(e),t,r)},a.fromFrame=function(e,t,r){var n=f.utils.TextureCache[e];if(!n)throw new Error('The frameId "'+e+'" does not exist in the texture cache '+this);return new a(n,t,r)},a.fromImage=function(e,t,r,n,i){return new a(f.Texture.fromImage(e,n,i),t,r)},u(a,[{key:"clampMargin",get:function(){return this.uvTransform.clampMargin},set:function(e){this.uvTransform.clampMargin=e,this.uvTransform.update(!0)}},{key:"tileScale",get:function(){return this.tileTransform.scale},set:function(e){this.tileTransform.scale.copy(e)}},{key:"tilePosition",get:function(){return this.tileTransform.position},set:function(e){this.tileTransform.position.copy(e)}},{key:"width",get:function(){return this._width},set:function(e){this._width=e}},{key:"height",get:function(){return this._height},set:function(e){this._height=e}}]),a}(f.Sprite);r.default=c},{"../core":65,"../core/sprites/canvas/CanvasTinter":104}],138:[function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var a=e("../core"),c=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t.default=e,t}(a),o=e("../core/textures/Texture"),h=n(o),s=e("../core/textures/BaseTexture"),f=n(s),d=e("../core/utils"),u=c.DisplayObject,p=new c.Matrix;u.prototype._cacheAsBitmap=!1,u.prototype._cacheData=!1;var l=function e(){i(this,e),this.textureCacheId=null,this.originalRenderWebGL=null,this.originalRenderCanvas=null,this.originalCalculateBounds=null,this.originalGetLocalBounds=null,this.originalUpdateTransform=null,this.originalHitTest=null,this.originalDestroy=null,this.originalMask=null,this.originalFilterArea=null,this.sprite=null};Object.defineProperties(u.prototype,{cacheAsBitmap:{get:function(){return this._cacheAsBitmap},set:function(e){if(this._cacheAsBitmap!==e){this._cacheAsBitmap=e;var t=void 0;e?(this._cacheData||(this._cacheData=new l),t=this._cacheData,t.originalRenderWebGL=this.renderWebGL,t.originalRenderCanvas=this.renderCanvas,t.originalUpdateTransform=this.updateTransform,t.originalCalculateBounds=this._calculateBounds,t.originalGetLocalBounds=this.getLocalBounds,t.originalDestroy=this.destroy,t.originalContainsPoint=this.containsPoint,t.originalMask=this._mask,t.originalFilterArea=this.filterArea,this.renderWebGL=this._renderCachedWebGL,this.renderCanvas=this._renderCachedCanvas,this.destroy=this._cacheAsBitmapDestroy):(t=this._cacheData,t.sprite&&this._destroyCachedDisplayObject(),this.renderWebGL=t.originalRenderWebGL,this.renderCanvas=t.originalRenderCanvas,this._calculateBounds=t.originalCalculateBounds,this.getLocalBounds=t.originalGetLocalBounds,this.destroy=t.originalDestroy,this.updateTransform=t.originalUpdateTransform,this.containsPoint=t.originalContainsPoint,this._mask=t.originalMask,this.filterArea=t.originalFilterArea)}}}}),u.prototype._renderCachedWebGL=function(e){!this.visible||this.worldAlpha<=0||!this.renderable||(this._initCachedDisplayObject(e),this._cacheData.sprite._transformID=-1,this._cacheData.sprite.worldAlpha=this.worldAlpha,this._cacheData.sprite._renderWebGL(e))},u.prototype._initCachedDisplayObject=function(e){if(!this._cacheData||!this._cacheData.sprite){var t=this.alpha;this.alpha=1,e.currentRenderer.flush();var r=this.getLocalBounds().clone();if(this._filters){var n=this._filters[0].padding;r.pad(n)}var i=e._activeRenderTarget,a=e.filterManager.filterStack,o=c.RenderTexture.create(0|r.width,0|r.height),s="cacheAsBitmap_"+(0,d.uid)();this._cacheData.textureCacheId=s,f.default.addToCache(o.baseTexture,s),h.default.addToCache(o,s);var u=p;u.tx=-r.x,u.ty=-r.y,this.transform.worldTransform.identity(),this.renderWebGL=this._cacheData.originalRenderWebGL,e.render(this,o,!0,u,!0),e.bindRenderTarget(i),e.filterManager.filterStack=a,this.renderWebGL=this._renderCachedWebGL,this.updateTransform=this.displayObjectUpdateTransform,this._mask=null,this.filterArea=null;var l=new c.Sprite(o);l.transform.worldTransform=this.transform.worldTransform,l.anchor.x=-r.x/r.width,l.anchor.y=-r.y/r.height,l.alpha=t,l._bounds=this._bounds,this._calculateBounds=this._calculateCachedBounds,this.getLocalBounds=this._getCachedLocalBounds,this._cacheData.sprite=l,this.transform._parentID=-1,this.parent?this.updateTransform():(this.parent=e._tempDisplayObjectParent,this.updateTransform(),this.parent=null),this.containsPoint=l.containsPoint.bind(l)}},u.prototype._renderCachedCanvas=function(e){!this.visible||this.worldAlpha<=0||!this.renderable||(this._initCachedDisplayObjectCanvas(e),this._cacheData.sprite.worldAlpha=this.worldAlpha,this._cacheData.sprite.renderCanvas(e))},u.prototype._initCachedDisplayObjectCanvas=function(e){if(!this._cacheData||!this._cacheData.sprite){var t=this.getLocalBounds(),r=this.alpha;this.alpha=1;var n=e.context,i=c.RenderTexture.create(0|t.width,0|t.height),a="cacheAsBitmap_"+(0,d.uid)();this._cacheData.textureCacheId=a,f.default.addToCache(i.baseTexture,a),h.default.addToCache(i,a);var o=p;this.transform.localTransform.copy(o),o.invert(),o.tx-=t.x,o.ty-=t.y,this.renderCanvas=this._cacheData.originalRenderCanvas,e.render(this,i,!0,o,!1),e.context=n,this.renderCanvas=this._renderCachedCanvas,this._calculateBounds=this._calculateCachedBounds,this._mask=null,this.filterArea=null;var s=new c.Sprite(i);s.transform.worldTransform=this.transform.worldTransform,s.anchor.x=-t.x/t.width,s.anchor.y=-t.y/t.height,s._bounds=this._bounds,s.alpha=r,this.parent?this.updateTransform():(this.parent=e._tempDisplayObjectParent,this.updateTransform(),this.parent=null),this.updateTransform=this.displayObjectUpdateTransform,this._cacheData.sprite=s,this.containsPoint=s.containsPoint.bind(s)}},u.prototype._calculateCachedBounds=function(){this._cacheData.sprite._calculateBounds()},u.prototype._getCachedLocalBounds=function(){return this._cacheData.sprite.getLocalBounds()},u.prototype._destroyCachedDisplayObject=function(){this._cacheData.sprite._texture.destroy(!0),this._cacheData.sprite=null,f.default.removeFromCache(this._cacheData.textureCacheId),h.default.removeFromCache(this._cacheData.textureCacheId),this._cacheData.textureCacheId=null},u.prototype._cacheAsBitmapDestroy=function(e){this.cacheAsBitmap=!1,this.destroy(e)}},{"../core":65,"../core/textures/BaseTexture":112,"../core/textures/Texture":115,"../core/utils":125}],139:[function(e,t,r){"use strict";var n=e("../core"),i=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t.default=e,t}(n);i.DisplayObject.prototype.name=null,i.Container.prototype.getChildByName=function(e){for(var t=0;t<this.children.length;t++)if(this.children[t].name===e)return this.children[t];return null}},{"../core":65}],140:[function(e,t,r){"use strict";var n=e("../core"),i=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t.default=e,t}(n);i.DisplayObject.prototype.getGlobalPosition=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new i.Point,t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return this.parent?this.parent.toGlobal(this.position,e,t):(e.x=this.position.x,e.y=this.position.y),e}},{"../core":65}],141:[function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}r.__esModule=!0,r.BitmapText=r.TilingSpriteRenderer=r.TilingSprite=r.AnimatedSprite=void 0;var i=e("./AnimatedSprite");Object.defineProperty(r,"AnimatedSprite",{enumerable:!0,get:function(){return n(i).default}});var a=e("./TilingSprite");Object.defineProperty(r,"TilingSprite",{enumerable:!0,get:function(){return n(a).default}});var o=e("./webgl/TilingSpriteRenderer");Object.defineProperty(r,"TilingSpriteRenderer",{enumerable:!0,get:function(){return n(o).default}});var s=e("./BitmapText");Object.defineProperty(r,"BitmapText",{enumerable:!0,get:function(){return n(s).default}}),e("./cacheAsBitmap"),e("./getChildByName"),e("./getGlobalPosition")},{"./AnimatedSprite":135,"./BitmapText":136,"./TilingSprite":137,"./cacheAsBitmap":138,"./getChildByName":139,"./getGlobalPosition":140,"./webgl/TilingSpriteRenderer":142}],142:[function(e,t,r){"use strict";function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function o(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}r.__esModule=!0;var n=e("../../core"),p=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t.default=e,t}(n),v=e("../../core/const"),m=(e("path"),new p.Matrix),s=function(r){function n(e){i(this,n);var t=a(this,r.call(this,e));return t.shader=null,t.simpleShader=null,t.quad=null,t}return o(n,r),n.prototype.onContextChange=function(){var e=this.renderer.gl;this.shader=new p.Shader(e,"attribute vec2 aVertexPosition;\nattribute vec2 aTextureCoord;\n\nuniform mat3 projectionMatrix;\nuniform mat3 translationMatrix;\nuniform mat3 uTransform;\n\nvarying vec2 vTextureCoord;\n\nvoid main(void)\n{\n    gl_Position = vec4((projectionMatrix * translationMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);\n\n    vTextureCoord = (uTransform * vec3(aTextureCoord, 1.0)).xy;\n}\n","varying vec2 vTextureCoord;\n\nuniform sampler2D uSampler;\nuniform vec4 uColor;\nuniform mat3 uMapCoord;\nuniform vec4 uClampFrame;\nuniform vec2 uClampOffset;\n\nvoid main(void)\n{\n    vec2 coord = mod(vTextureCoord - uClampOffset, vec2(1.0, 1.0)) + uClampOffset;\n    coord = (uMapCoord * vec3(coord, 1.0)).xy;\n    coord = clamp(coord, uClampFrame.xy, uClampFrame.zw);\n\n    vec4 sample = texture2D(uSampler, coord);\n    gl_FragColor = sample * uColor;\n}\n"),this.simpleShader=new p.Shader(e,"attribute vec2 aVertexPosition;\nattribute vec2 aTextureCoord;\n\nuniform mat3 projectionMatrix;\nuniform mat3 translationMatrix;\nuniform mat3 uTransform;\n\nvarying vec2 vTextureCoord;\n\nvoid main(void)\n{\n    gl_Position = vec4((projectionMatrix * translationMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);\n\n    vTextureCoord = (uTransform * vec3(aTextureCoord, 1.0)).xy;\n}\n","varying vec2 vTextureCoord;\n\nuniform sampler2D uSampler;\nuniform vec4 uColor;\n\nvoid main(void)\n{\n    vec4 sample = texture2D(uSampler, vTextureCoord);\n    gl_FragColor = sample * uColor;\n}\n"),this.renderer.bindVao(null),this.quad=new p.Quad(e,this.renderer.state.attribState),this.quad.initVao(this.shader)},n.prototype.render=function(e){var t=this.renderer,r=this.quad;t.bindVao(r.vao);var n=r.vertices;n[0]=n[6]=e._width*-e.anchor.x,n[1]=n[3]=e._height*-e.anchor.y,n[2]=n[4]=e._width*(1-e.anchor.x),n[5]=n[7]=e._height*(1-e.anchor.y),e.uvRespectAnchor&&(n=r.uvs,n[0]=n[6]=-e.anchor.x,n[1]=n[3]=-e.anchor.y,n[2]=n[4]=1-e.anchor.x,n[5]=n[7]=1-e.anchor.y),r.upload();var i=e._texture,a=i.baseTexture,o=e.tileTransform.localTransform,s=e.uvTransform,u=a.isPowerOfTwo&&i.frame.width===a.width&&i.frame.height===a.height;u&&(a._glTextures[t.CONTEXT_UID]?u=a.wrapMode!==v.WRAP_MODES.CLAMP:a.wrapMode===v.WRAP_MODES.CLAMP&&(a.wrapMode=v.WRAP_MODES.REPEAT));var l=u?this.simpleShader:this.shader;t.bindShader(l);var c=i.width,h=i.height,f=e._width,d=e._height;m.set(o.a*c/f,o.b*c/d,o.c*h/f,o.d*h/d,o.tx/f,o.ty/d),m.invert(),u?m.prepend(s.mapCoord):(l.uniforms.uMapCoord=s.mapCoord.toArray(!0),l.uniforms.uClampFrame=s.uClampFrame,l.uniforms.uClampOffset=s.uClampOffset),l.uniforms.uTransform=m.toArray(!0),l.uniforms.uColor=p.utils.premultiplyTintToRgba(e.tint,e.worldAlpha,l.uniforms.uColor,a.premultipliedAlpha),l.uniforms.translationMatrix=e.transform.worldTransform.toArray(!0),l.uniforms.uSampler=t.bindTexture(i),t.setBlendMode(p.utils.correctBlendMode(e.blendMode,a.premultipliedAlpha)),r.vao.draw(this.renderer.gl.TRIANGLES,6,0)},n}(p.ObjectRenderer);r.default=s,p.WebGLRenderer.registerPlugin("tilingSprite",s)},{"../../core":65,"../../core/const":46,path:23}],143:[function(e,t,r){"use strict";function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}r.__esModule=!0;var o=function(){function n(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(e,t,r){return t&&n(e.prototype,t),r&&n(e,r),e}}(),s=e("../../core"),u=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t.default=e,t}(s),l=(e("path"),function(t){function r(){n(this,r);var e=i(this,t.call(this,"attribute vec2 aVertexPosition;\nattribute vec2 aTextureCoord;\n\nuniform mat3 projectionMatrix;\n\nvarying vec2 vTextureCoord;\n\nvoid main(void)\n{\n    gl_Position = vec4((projectionMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);\n    vTextureCoord = aTextureCoord;\n}","varying vec2 vTextureCoord;\n\nuniform sampler2D uSampler;\nuniform float uAlpha;\n\nvoid main(void)\n{\n   gl_FragColor = texture2D(uSampler, vTextureCoord) * uAlpha;\n}\n"));return e.alpha=1,e.glShaderKey="alpha",e}return a(r,t),o(r,[{key:"alpha",get:function(){return this.uniforms.uAlpha},set:function(e){this.uniforms.uAlpha=e}}]),r}(u.Filter));r.default=l},{"../../core":65,path:23}],144:[function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function s(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function u(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function i(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}r.__esModule=!0;var l=function(){function n(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(e,t,r){return t&&n(e.prototype,t),r&&n(e,r),e}}(),a=e("../../core"),c=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t.default=e,t}(a),o=e("./BlurXFilter"),h=n(o),f=e("./BlurYFilter"),d=n(f),p=function(a){function o(e,t,r,n){s(this,o);var i=u(this,a.call(this));return i.blurXFilter=new h.default(e,t,r,n),i.blurYFilter=new d.default(e,t,r,n),i.padding=0,i.resolution=r||c.settings.RESOLUTION,i.quality=t||4,i.blur=e||8,i}return i(o,a),o.prototype.apply=function(e,t,r){var n=e.getRenderTarget(!0);this.blurXFilter.apply(e,t,n,!0),this.blurYFilter.apply(e,n,r,!1),e.returnRenderTarget(n)},l(o,[{key:"blur",get:function(){return this.blurXFilter.blur},set:function(e){this.blurXFilter.blur=this.blurYFilter.blur=e,this.padding=2*Math.max(Math.abs(this.blurXFilter.strength),Math.abs(this.blurYFilter.strength))}},{key:"quality",get:function(){return this.blurXFilter.quality},set:function(e){this.blurXFilter.quality=this.blurYFilter.quality=e}},{key:"blurX",get:function(){return this.blurXFilter.blur},set:function(e){this.blurXFilter.blur=e,this.padding=2*Math.max(Math.abs(this.blurXFilter.strength),Math.abs(this.blurYFilter.strength))}},{key:"blurY",get:function(){return this.blurYFilter.blur},set:function(e){this.blurYFilter.blur=e,this.padding=2*Math.max(Math.abs(this.blurXFilter.strength),Math.abs(this.blurYFilter.strength))}},{key:"blendMode",get:function(){return this.blurYFilter._blendMode},set:function(e){this.blurYFilter._blendMode=e}}]),o}(c.Filter);r.default=p},{"../../core":65,"./BlurXFilter":145,"./BlurYFilter":146}],145:[function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function l(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function c(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function i(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}r.__esModule=!0;var a=function(){function n(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(e,t,r){return t&&n(e.prototype,t),r&&n(e,r),e}}(),o=e("../../core"),h=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t.default=e,t}(o),s=e("./generateBlurVertSource"),f=n(s),u=e("./generateBlurFragSource"),d=n(u),p=e("./getMaxBlurKernelSize"),v=n(p),m=function(s){function u(e,t,r,n){l(this,u),n=n||5;var i=(0,f.default)(n,!0),a=(0,d.default)(n),o=c(this,s.call(this,i,a));return o.resolution=r||h.settings.RESOLUTION,o._quality=0,o.quality=t||4,o.strength=e||8,o.firstRun=!0,o}return i(u,s),u.prototype.apply=function(e,t,r,n){if(this.firstRun){var i=e.renderer.gl,a=(0,v.default)(i);this.vertexSrc=(0,f.default)(a,!0),this.fragmentSrc=(0,d.default)(a),this.firstRun=!1}if(this.uniforms.strength=1/r.size.width*(r.size.width/t.size.width),this.uniforms.strength*=this.strength,this.uniforms.strength/=this.passes,1===this.passes)e.applyFilter(this,t,r,n);else{for(var o=e.getRenderTarget(!0),s=t,u=o,l=0;l<this.passes-1;l++){e.applyFilter(this,s,u,!0);var c=u;u=s,s=c}e.applyFilter(this,s,r,n),e.returnRenderTarget(o)}},a(u,[{key:"blur",get:function(){return this.strength},set:function(e){this.padding=2*Math.abs(e),this.strength=e}},{key:"quality",get:function(){return this._quality},set:function(e){this._quality=e,this.passes=e}}]),u}(h.Filter);r.default=m},{"../../core":65,"./generateBlurFragSource":147,"./generateBlurVertSource":148,"./getMaxBlurKernelSize":149}],146:[function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function l(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function c(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function i(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}r.__esModule=!0;var a=function(){function n(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(e,t,r){return t&&n(e.prototype,t),r&&n(e,r),e}}(),o=e("../../core"),h=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t.default=e,t}(o),s=e("./generateBlurVertSource"),f=n(s),u=e("./generateBlurFragSource"),d=n(u),p=e("./getMaxBlurKernelSize"),v=n(p),m=function(s){function u(e,t,r,n){l(this,u),n=n||5;var i=(0,f.default)(n,!1),a=(0,d.default)(n),o=c(this,s.call(this,i,a));return o.resolution=r||h.settings.RESOLUTION,o._quality=0,o.quality=t||4,o.strength=e||8,o.firstRun=!0,o}return i(u,s),u.prototype.apply=function(e,t,r,n){if(this.firstRun){var i=e.renderer.gl,a=(0,v.default)(i);this.vertexSrc=(0,f.default)(a,!1),this.fragmentSrc=(0,d.default)(a),this.firstRun=!1}if(this.uniforms.strength=1/r.size.height*(r.size.height/t.size.height),this.uniforms.strength*=this.strength,this.uniforms.strength/=this.passes,1===this.passes)e.applyFilter(this,t,r,n);else{for(var o=e.getRenderTarget(!0),s=t,u=o,l=0;l<this.passes-1;l++){e.applyFilter(this,s,u,!0);var c=u;u=s,s=c}e.applyFilter(this,s,r,n),e.returnRenderTarget(o)}},a(u,[{key:"blur",get:function(){return this.strength},set:function(e){this.padding=2*Math.abs(e),this.strength=e}},{key:"quality",get:function(){return this._quality},set:function(e){this._quality=e,this.passes=e}}]),u}(h.Filter);r.default=m},{"../../core":65,"./generateBlurFragSource":147,"./generateBlurVertSource":148,"./getMaxBlurKernelSize":149}],147:[function(e,t,r){"use strict";function n(e){for(var t=l[e],r=t.length,n=c,i="",a="gl_FragColor += texture2D(uSampler, vBlurTexCoords[%index%]) * %value%;",o=void 0,s=0;s<e;s++){var u=a.replace("%index%",s);o=s,s>=r&&(o=e-s-1),u=u.replace("%value%",t[o]),i+=u,i+="\n"}return n=n.replace("%blur%",i),n=n.replace("%size%",e)}r.__esModule=!0,r.default=n;var l={5:[.153388,.221461,.250301],7:[.071303,.131514,.189879,.214607],9:[.028532,.067234,.124009,.179044,.20236],11:[.0093,.028002,.065984,.121703,.175713,.198596],13:[.002406,.009255,.027867,.065666,.121117,.174868,.197641],15:[489e-6,.002403,.009246,.02784,.065602,.120999,.174697,.197448]},c=["varying vec2 vBlurTexCoords[%size%];","uniform sampler2D uSampler;","void main(void)","{","    gl_FragColor = vec4(0.0);","    %blur%","}"].join("\n")},{}],148:[function(e,t,r){"use strict";function n(e,t){var r=Math.ceil(e/2),n=u,i="",a=void 0;a=t?"vBlurTexCoords[%index%] = aTextureCoord + vec2(%sampleIndex% * strength, 0.0);":"vBlurTexCoords[%index%] = aTextureCoord + vec2(0.0, %sampleIndex% * strength);";for(var o=0;o<e;o++){var s=a.replace("%index%",o);s=s.replace("%sampleIndex%",o-(r-1)+".0"),i+=s,i+="\n"}return n=n.replace("%blur%",i),n=n.replace("%size%",e)}r.__esModule=!0,r.default=n;var u=["attribute vec2 aVertexPosition;","attribute vec2 aTextureCoord;","uniform float strength;","uniform mat3 projectionMatrix;","varying vec2 vBlurTexCoords[%size%];","void main(void)","{","gl_Position = vec4((projectionMatrix * vec3((aVertexPosition), 1.0)).xy, 0.0, 1.0);","%blur%","}"].join("\n")},{}],149:[function(e,t,r){"use strict";function n(e){for(var t=e.getParameter(e.MAX_VARYING_VECTORS),r=15;r>t;)r-=2;return r}r.__esModule=!0,r.default=n},{}],150:[function(e,t,r){"use strict";function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}r.__esModule=!0;var o=function(){function n(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(e,t,r){return t&&n(e.prototype,t),r&&n(e,r),e}}(),s=e("../../core"),u=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t.default=e,t}(s),l=(e("path"),function(t){function r(){n(this,r);var e=i(this,t.call(this,"attribute vec2 aVertexPosition;\nattribute vec2 aTextureCoord;\n\nuniform mat3 projectionMatrix;\n\nvarying vec2 vTextureCoord;\n\nvoid main(void)\n{\n    gl_Position = vec4((projectionMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);\n    vTextureCoord = aTextureCoord;\n}","varying vec2 vTextureCoord;\nuniform sampler2D uSampler;\nuniform float m[20];\nuniform float uAlpha;\n\nvoid main(void)\n{\n    vec4 c = texture2D(uSampler, vTextureCoord);\n\n    if (uAlpha == 0.0) {\n        gl_FragColor = c;\n        return;\n    }\n\n    // Un-premultiply alpha before applying the color matrix. See issue #3539.\n    if (c.a > 0.0) {\n      c.rgb /= c.a;\n    }\n\n    vec4 result;\n\n    result.r = (m[0] * c.r);\n        result.r += (m[1] * c.g);\n        result.r += (m[2] * c.b);\n        result.r += (m[3] * c.a);\n        result.r += m[4];\n\n    result.g = (m[5] * c.r);\n        result.g += (m[6] * c.g);\n        result.g += (m[7] * c.b);\n        result.g += (m[8] * c.a);\n        result.g += m[9];\n\n    result.b = (m[10] * c.r);\n       result.b += (m[11] * c.g);\n       result.b += (m[12] * c.b);\n       result.b += (m[13] * c.a);\n       result.b += m[14];\n\n    result.a = (m[15] * c.r);\n       result.a += (m[16] * c.g);\n       result.a += (m[17] * c.b);\n       result.a += (m[18] * c.a);\n       result.a += m[19];\n\n    vec3 rgb = mix(c.rgb, result.rgb, uAlpha);\n\n    // Premultiply alpha again.\n    rgb *= result.a;\n\n    gl_FragColor = vec4(rgb, result.a);\n}\n"));return e.uniforms.m=[1,0,0,0,0,0,1,0,0,0,0,0,1,0,0,0,0,0,1,0],e.alpha=1,e}return a(r,t),r.prototype._loadMatrix=function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],r=e;t&&(this._multiply(r,this.uniforms.m,e),r=this._colorMatrix(r)),this.uniforms.m=r},r.prototype._multiply=function(e,t,r){return e[0]=t[0]*r[0]+t[1]*r[5]+t[2]*r[10]+t[3]*r[15],e[1]=t[0]*r[1]+t[1]*r[6]+t[2]*r[11]+t[3]*r[16],e[2]=t[0]*r[2]+t[1]*r[7]+t[2]*r[12]+t[3]*r[17],e[3]=t[0]*r[3]+t[1]*r[8]+t[2]*r[13]+t[3]*r[18],e[4]=t[0]*r[4]+t[1]*r[9]+t[2]*r[14]+t[3]*r[19]+t[4],e[5]=t[5]*r[0]+t[6]*r[5]+t[7]*r[10]+t[8]*r[15],e[6]=t[5]*r[1]+t[6]*r[6]+t[7]*r[11]+t[8]*r[16],e[7]=t[5]*r[2]+t[6]*r[7]+t[7]*r[12]+t[8]*r[17],e[8]=t[5]*r[3]+t[6]*r[8]+t[7]*r[13]+t[8]*r[18],e[9]=t[5]*r[4]+t[6]*r[9]+t[7]*r[14]+t[8]*r[19]+t[9],e[10]=t[10]*r[0]+t[11]*r[5]+t[12]*r[10]+t[13]*r[15],e[11]=t[10]*r[1]+t[11]*r[6]+t[12]*r[11]+t[13]*r[16],e[12]=t[10]*r[2]+t[11]*r[7]+t[12]*r[12]+t[13]*r[17],e[13]=t[10]*r[3]+t[11]*r[8]+t[12]*r[13]+t[13]*r[18],e[14]=t[10]*r[4]+t[11]*r[9]+t[12]*r[14]+t[13]*r[19]+t[14],e[15]=t[15]*r[0]+t[16]*r[5]+t[17]*r[10]+t[18]*r[15],e[16]=t[15]*r[1]+t[16]*r[6]+t[17]*r[11]+t[18]*r[16],e[17]=t[15]*r[2]+t[16]*r[7]+t[17]*r[12]+t[18]*r[17],e[18]=t[15]*r[3]+t[16]*r[8]+t[17]*r[13]+t[18]*r[18],e[19]=t[15]*r[4]+t[16]*r[9]+t[17]*r[14]+t[18]*r[19]+t[19],e},r.prototype._colorMatrix=function(e){var t=new Float32Array(e);return t[4]/=255,t[9]/=255,t[14]/=255,t[19]/=255,t},r.prototype.brightness=function(e,t){var r=[e,0,0,0,0,0,e,0,0,0,0,0,e,0,0,0,0,0,1,0];this._loadMatrix(r,t)},r.prototype.greyscale=function(e,t){var r=[e,e,e,0,0,e,e,e,0,0,e,e,e,0,0,0,0,0,1,0];this._loadMatrix(r,t)},r.prototype.blackAndWhite=function(e){var t=[.3,.6,.1,0,0,.3,.6,.1,0,0,.3,.6,.1,0,0,0,0,0,1,0];this._loadMatrix(t,e)},r.prototype.hue=function(e,t){e=(e||0)/180*Math.PI;var r=Math.cos(e),n=Math.sin(e),i=Math.sqrt,a=1/3,o=i(a),s=r+(1-r)*a,u=a*(1-r)-o*n,l=a*(1-r)+o*n,c=a*(1-r)+o*n,h=r+a*(1-r),f=a*(1-r)-o*n,d=a*(1-r)-o*n,p=a*(1-r)+o*n,v=r+a*(1-r),m=[s,u,l,0,0,c,h,f,0,0,d,p,v,0,0,0,0,0,1,0];this._loadMatrix(m,t)},r.prototype.contrast=function(e,t){var r=(e||0)+1,n=-.5*(r-1),i=[r,0,0,0,n,0,r,0,0,n,0,0,r,0,n,0,0,0,1,0];this._loadMatrix(i,t)},r.prototype.saturate=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,t=arguments[1],r=2*e/3+1,n=-.5*(r-1),i=[r,n,n,0,0,n,r,n,0,0,n,n,r,0,0,0,0,0,1,0];this._loadMatrix(i,t)},r.prototype.desaturate=function(){this.saturate(-1)},r.prototype.negative=function(e){var t=[0,1,1,0,0,1,0,1,0,0,1,1,0,0,0,0,0,0,1,0];this._loadMatrix(t,e)},r.prototype.sepia=function(e){var t=[.393,.7689999,.18899999,0,0,.349,.6859999,.16799999,0,0,.272,.5339999,.13099999,0,0,0,0,0,1,0];this._loadMatrix(t,e)},r.prototype.technicolor=function(e){var t=[1.9125277891456083,-.8545344976951645,-.09155508482755585,0,11.793603434377337,-.3087833385928097,1.7658908555458428,-.10601743074722245,0,-70.35205161461398,-.231103377548616,-.7501899197440212,1.847597816108189,0,30.950940869491138,0,0,0,1,0];this._loadMatrix(t,e)},r.prototype.polaroid=function(e){var t=[1.438,-.062,-.062,0,0,-.122,1.378,-.122,0,0,-.016,-.016,1.483,0,0,0,0,0,1,0];this._loadMatrix(t,e)},r.prototype.toBGR=function(e){var t=[0,0,1,0,0,0,1,0,0,0,1,0,0,0,0,0,0,0,1,0];this._loadMatrix(t,e)},r.prototype.kodachrome=function(e){var t=[1.1285582396593525,-.3967382283601348,-.03992559172921793,0,63.72958762196502,-.16404339962244616,1.0835251566291304,-.05498805115633132,0,24.732407896706203,-.16786010706155763,-.5603416277695248,1.6014850761964943,0,35.62982807460946,0,0,0,1,0];this._loadMatrix(t,e)},r.prototype.browni=function(e){var t=[.5997023498159715,.34553243048391263,-.2708298674538042,0,47.43192855600873,-.037703249837783157,.8609577587992641,.15059552388459913,0,-36.96841498319127,.24113635128153335,-.07441037908422492,.44972182064877153,0,-7.562075277591283,0,0,0,1,0];this._loadMatrix(t,e)},r.prototype.vintage=function(e){var t=[.6279345635605994,.3202183420819367,-.03965408211312453,0,9.651285835294123,.02578397704808868,.6441188644374771,.03259127616149294,0,7.462829176470591,.0466055556782719,-.0851232987247891,.5241648018700465,0,5.159190588235296,0,0,0,1,0];this._loadMatrix(t,e)},r.prototype.colorTone=function(e,t,r,n,i){e=e||.2,t=t||.15,r=r||16770432,n=n||3375104;var a=(r>>16&255)/255,o=(r>>8&255)/255,s=(255&r)/255,u=(n>>16&255)/255,l=(n>>8&255)/255,c=(255&n)/255,h=[.3,.59,.11,0,0,a,o,s,e,0,u,l,c,t,0,a-u,o-l,s-c,0,0];this._loadMatrix(h,i)},r.prototype.night=function(e,t){e=e||.1;var r=[-2*e,-e,0,0,0,-e,0,e,0,0,0,e,2*e,0,0,0,0,0,1,0];this._loadMatrix(r,t)},r.prototype.predator=function(e,t){var r=[11.224130630493164*e,-4.794486999511719*e,-2.8746118545532227*e,0*e,.40342438220977783*e,-3.6330697536468506*e,9.193157196044922*e,-2.951810836791992*e,0*e,-1.316135048866272*e,-3.2184197902679443*e,-4.2375030517578125*e,7.476448059082031*e,0*e,.8044459223747253*e,0,0,0,1,0];this._loadMatrix(r,t)},r.prototype.lsd=function(e){var t=[2,-.4,.5,0,0,-.5,2,-.4,0,0,-.4,-.5,3,0,0,0,0,0,1,0];this._loadMatrix(t,e)},r.prototype.reset=function(){var e=[1,0,0,0,0,0,1,0,0,0,0,0,1,0,0,0,0,0,1,0];this._loadMatrix(e,!1)},o(r,[{key:"matrix",get:function(){return this.uniforms.m},set:function(e){this.uniforms.m=e}},{key:"alpha",get:function(){return this.uniforms.uAlpha},set:function(e){this.uniforms.uAlpha=e}}]),r}(u.Filter));r.default=l,l.prototype.grayscale=l.prototype.greyscale},{"../../core":65,path:23}],151:[function(e,t,r){"use strict";function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function s(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function n(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}r.__esModule=!0;var u=function(){function n(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(e,t,r){return t&&n(e.prototype,t),r&&n(e,r),e}}(),i=e("../../core"),l=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t.default=e,t}(i),a=(e("path"),function(i){function a(e,t){o(this,a);var r=new l.Matrix;e.renderable=!1;var n=s(this,i.call(this,"attribute vec2 aVertexPosition;\nattribute vec2 aTextureCoord;\n\nuniform mat3 projectionMatrix;\nuniform mat3 filterMatrix;\n\nvarying vec2 vTextureCoord;\nvarying vec2 vFilterCoord;\n\nvoid main(void)\n{\n   gl_Position = vec4((projectionMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);\n   vFilterCoord = ( filterMatrix * vec3( aTextureCoord, 1.0)  ).xy;\n   vTextureCoord = aTextureCoord;\n}","varying vec2 vFilterCoord;\nvarying vec2 vTextureCoord;\n\nuniform vec2 scale;\n\nuniform sampler2D uSampler;\nuniform sampler2D mapSampler;\n\nuniform vec4 filterClamp;\n\nvoid main(void)\n{\n   vec4 map =  texture2D(mapSampler, vFilterCoord);\n\n   map -= 0.5;\n   map.xy *= scale;\n\n   gl_FragColor = texture2D(uSampler, clamp(vec2(vTextureCoord.x + map.x, vTextureCoord.y + map.y), filterClamp.xy, filterClamp.zw));\n}\n"));return n.maskSprite=e,n.maskMatrix=r,n.uniforms.mapSampler=e._texture,n.uniforms.filterMatrix=r,n.uniforms.scale={x:1,y:1},null!==t&&void 0!==t||(t=20),n.scale=new l.Point(t,t),n}return n(a,i),a.prototype.apply=function(e,t,r){var n=1/r.destinationFrame.width*(r.size.width/t.size.width);this.uniforms.filterMatrix=e.calculateSpriteMatrix(this.maskMatrix,this.maskSprite),this.uniforms.scale.x=this.scale.x*n,this.uniforms.scale.y=this.scale.y*n,e.applyFilter(this,t,r)},u(a,[{key:"map",get:function(){return this.uniforms.mapSampler},set:function(e){this.uniforms.mapSampler=e}}]),a}(l.Filter));r.default=a},{"../../core":65,path:23}],152:[function(e,t,r){"use strict";function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}r.__esModule=!0;var o=e("../../core"),s=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t.default=e,t}(o),u=(e("path"),function(e){function t(){return n(this,t),i(this,e.call(this,"\nattribute vec2 aVertexPosition;\nattribute vec2 aTextureCoord;\n\nuniform mat3 projectionMatrix;\n\nvarying vec2 v_rgbNW;\nvarying vec2 v_rgbNE;\nvarying vec2 v_rgbSW;\nvarying vec2 v_rgbSE;\nvarying vec2 v_rgbM;\n\nuniform vec4 filterArea;\n\nvarying vec2 vTextureCoord;\n\nvec2 mapCoord( vec2 coord )\n{\n    coord *= filterArea.xy;\n    coord += filterArea.zw;\n\n    return coord;\n}\n\nvec2 unmapCoord( vec2 coord )\n{\n    coord -= filterArea.zw;\n    coord /= filterArea.xy;\n\n    return coord;\n}\n\nvoid texcoords(vec2 fragCoord, vec2 resolution,\n               out vec2 v_rgbNW, out vec2 v_rgbNE,\n               out vec2 v_rgbSW, out vec2 v_rgbSE,\n               out vec2 v_rgbM) {\n    vec2 inverseVP = 1.0 / resolution.xy;\n    v_rgbNW = (fragCoord + vec2(-1.0, -1.0)) * inverseVP;\n    v_rgbNE = (fragCoord + vec2(1.0, -1.0)) * inverseVP;\n    v_rgbSW = (fragCoord + vec2(-1.0, 1.0)) * inverseVP;\n    v_rgbSE = (fragCoord + vec2(1.0, 1.0)) * inverseVP;\n    v_rgbM = vec2(fragCoord * inverseVP);\n}\n\nvoid main(void) {\n\n   gl_Position = vec4((projectionMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);\n\n   vTextureCoord = aTextureCoord;\n\n   vec2 fragCoord = vTextureCoord * filterArea.xy;\n\n   texcoords(fragCoord, filterArea.xy, v_rgbNW, v_rgbNE, v_rgbSW, v_rgbSE, v_rgbM);\n}",'varying vec2 v_rgbNW;\nvarying vec2 v_rgbNE;\nvarying vec2 v_rgbSW;\nvarying vec2 v_rgbSE;\nvarying vec2 v_rgbM;\n\nvarying vec2 vTextureCoord;\nuniform sampler2D uSampler;\nuniform vec4 filterArea;\n\n/**\n Basic FXAA implementation based on the code on geeks3d.com with the\n modification that the texture2DLod stuff was removed since it\'s\n unsupported by WebGL.\n \n --\n \n From:\n https://github.com/mitsuhiko/webgl-meincraft\n \n Copyright (c) 2011 by Armin Ronacher.\n \n Some rights reserved.\n \n Redistribution and use in source and binary forms, with or without\n modification, are permitted provided that the following conditions are\n met:\n \n * Redistributions of source code must retain the above copyright\n notice, this list of conditions and the following disclaimer.\n \n * Redistributions in binary form must reproduce the above\n copyright notice, this list of conditions and the following\n disclaimer in the documentation and/or other materials provided\n with the distribution.\n \n * The names of the contributors may not be used to endorse or\n promote products derived from this software without specific\n prior written permission.\n \n THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS\n "AS IS" AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT\n LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR\n A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT\n OWNER OR CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL,\n SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT\n LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE,\n DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY\n THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT\n (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE\n OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.\n */\n\n#ifndef FXAA_REDUCE_MIN\n#define FXAA_REDUCE_MIN   (1.0/ 128.0)\n#endif\n#ifndef FXAA_REDUCE_MUL\n#define FXAA_REDUCE_MUL   (1.0 / 8.0)\n#endif\n#ifndef FXAA_SPAN_MAX\n#define FXAA_SPAN_MAX     8.0\n#endif\n\n//optimized version for mobile, where dependent\n//texture reads can be a bottleneck\nvec4 fxaa(sampler2D tex, vec2 fragCoord, vec2 resolution,\n          vec2 v_rgbNW, vec2 v_rgbNE,\n          vec2 v_rgbSW, vec2 v_rgbSE,\n          vec2 v_rgbM) {\n    vec4 color;\n    mediump vec2 inverseVP = vec2(1.0 / resolution.x, 1.0 / resolution.y);\n    vec3 rgbNW = texture2D(tex, v_rgbNW).xyz;\n    vec3 rgbNE = texture2D(tex, v_rgbNE).xyz;\n    vec3 rgbSW = texture2D(tex, v_rgbSW).xyz;\n    vec3 rgbSE = texture2D(tex, v_rgbSE).xyz;\n    vec4 texColor = texture2D(tex, v_rgbM);\n    vec3 rgbM  = texColor.xyz;\n    vec3 luma = vec3(0.299, 0.587, 0.114);\n    float lumaNW = dot(rgbNW, luma);\n    float lumaNE = dot(rgbNE, luma);\n    float lumaSW = dot(rgbSW, luma);\n    float lumaSE = dot(rgbSE, luma);\n    float lumaM  = dot(rgbM,  luma);\n    float lumaMin = min(lumaM, min(min(lumaNW, lumaNE), min(lumaSW, lumaSE)));\n    float lumaMax = max(lumaM, max(max(lumaNW, lumaNE), max(lumaSW, lumaSE)));\n    \n    mediump vec2 dir;\n    dir.x = -((lumaNW + lumaNE) - (lumaSW + lumaSE));\n    dir.y =  ((lumaNW + lumaSW) - (lumaNE + lumaSE));\n    \n    float dirReduce = max((lumaNW + lumaNE + lumaSW + lumaSE) *\n                          (0.25 * FXAA_REDUCE_MUL), FXAA_REDUCE_MIN);\n    \n    float rcpDirMin = 1.0 / (min(abs(dir.x), abs(dir.y)) + dirReduce);\n    dir = min(vec2(FXAA_SPAN_MAX, FXAA_SPAN_MAX),\n              max(vec2(-FXAA_SPAN_MAX, -FXAA_SPAN_MAX),\n                  dir * rcpDirMin)) * inverseVP;\n    \n    vec3 rgbA = 0.5 * (\n                       texture2D(tex, fragCoord * inverseVP + dir * (1.0 / 3.0 - 0.5)).xyz +\n                       texture2D(tex, fragCoord * inverseVP + dir * (2.0 / 3.0 - 0.5)).xyz);\n    vec3 rgbB = rgbA * 0.5 + 0.25 * (\n                                     texture2D(tex, fragCoord * inverseVP + dir * -0.5).xyz +\n                                     texture2D(tex, fragCoord * inverseVP + dir * 0.5).xyz);\n    \n    float lumaB = dot(rgbB, luma);\n    if ((lumaB < lumaMin) || (lumaB > lumaMax))\n        color = vec4(rgbA, texColor.a);\n    else\n        color = vec4(rgbB, texColor.a);\n    return color;\n}\n\nvoid main() {\n\n      vec2 fragCoord = vTextureCoord * filterArea.xy;\n\n      vec4 color;\n\n    color = fxaa(uSampler, fragCoord, filterArea.xy, v_rgbNW, v_rgbNE, v_rgbSW, v_rgbSE, v_rgbM);\n\n      gl_FragColor = color;\n}\n'))}return a(t,e),t}(s.Filter));r.default=u},{"../../core":65,path:23}],153:[function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}r.__esModule=!0;var i=e("./fxaa/FXAAFilter");Object.defineProperty(r,"FXAAFilter",{enumerable:!0,get:function(){return n(i).default}});var a=e("./noise/NoiseFilter");Object.defineProperty(r,"NoiseFilter",{enumerable:!0,get:function(){return n(a).default}});var o=e("./displacement/DisplacementFilter");Object.defineProperty(r,"DisplacementFilter",{enumerable:!0,get:function(){return n(o).default}});var s=e("./blur/BlurFilter");Object.defineProperty(r,"BlurFilter",{enumerable:!0,get:function(){return n(s).default}});var u=e("./blur/BlurXFilter");Object.defineProperty(r,"BlurXFilter",{enumerable:!0,get:function(){return n(u).default}});var l=e("./blur/BlurYFilter");Object.defineProperty(r,"BlurYFilter",{enumerable:!0,get:function(){return n(l).default}});var c=e("./colormatrix/ColorMatrixFilter");Object.defineProperty(r,"ColorMatrixFilter",{enumerable:!0,get:function(){return n(c).default}});var h=e("./alpha/AlphaFilter");Object.defineProperty(r,"AlphaFilter",{enumerable:!0,get:function(){return n(h).default}})},{"./alpha/AlphaFilter":143,"./blur/BlurFilter":144,"./blur/BlurXFilter":145,"./blur/BlurYFilter":146,"./colormatrix/ColorMatrixFilter":150,"./displacement/DisplacementFilter":151,"./fxaa/FXAAFilter":152,"./noise/NoiseFilter":154}],154:[function(e,t,r){"use strict";function a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function s(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}r.__esModule=!0;var u=function(){function n(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(e,t,r){return t&&n(e.prototype,t),r&&n(e,r),e}}(),n=e("../../core"),i=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t.default=e,t}(n),l=(e("path"),function(n){function i(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:.5,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Math.random();a(this,i);var r=o(this,n.call(this,"attribute vec2 aVertexPosition;\nattribute vec2 aTextureCoord;\n\nuniform mat3 projectionMatrix;\n\nvarying vec2 vTextureCoord;\n\nvoid main(void)\n{\n    gl_Position = vec4((projectionMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);\n    vTextureCoord = aTextureCoord;\n}","precision highp float;\n\nvarying vec2 vTextureCoord;\nvarying vec4 vColor;\n\nuniform float uNoise;\nuniform float uSeed;\nuniform sampler2D uSampler;\n\nfloat rand(vec2 co)\n{\n    return fract(sin(dot(co.xy, vec2(12.9898, 78.233))) * 43758.5453);\n}\n\nvoid main()\n{\n    vec4 color = texture2D(uSampler, vTextureCoord);\n    float randomValue = rand(gl_FragCoord.xy * uSeed);\n    float diff = (randomValue - 0.5) * uNoise;\n\n    // Un-premultiply alpha before applying the color matrix. See issue #3539.\n    if (color.a > 0.0) {\n        color.rgb /= color.a;\n    }\n\n    color.r += diff;\n    color.g += diff;\n    color.b += diff;\n\n    // Premultiply alpha again.\n    color.rgb *= color.a;\n\n    gl_FragColor = color;\n}\n"));return r.noise=e,r.seed=t,r}return s(i,n),u(i,[{key:"noise",get:function(){return this.uniforms.uNoise},set:function(e){this.uniforms.uNoise=e}},{key:"seed",get:function(){return this.uniforms.uSeed},set:function(e){this.uniforms.uSeed=e}}]),i}(i.Filter));r.default=l},{"../../core":65,path:23}],155:[function(e,t,r){"use strict";function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}r.__esModule=!0;var i=function(){function n(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(e,t,r){return t&&n(e.prototype,t),r&&n(e,r),e}}(),a=e("../core"),o=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t.default=e,t}(a),s=function(){function e(){n(this,e),this.global=new o.Point,this.target=null,this.originalEvent=null,this.identifier=null,this.isPrimary=!1,this.button=0,this.buttons=0,this.width=0,this.height=0,this.tiltX=0,this.tiltY=0,this.pointerType=null,this.pressure=0,this.rotationAngle=0,this.twist=0,this.tangentialPressure=0}return e.prototype.getLocalPosition=function(e,t,r){return e.worldTransform.applyInverse(r||this.global,t)},e.prototype._copyEvent=function(e){e.isPrimary&&(this.isPrimary=!0),this.button=e.button,this.buttons=e.buttons,this.width=e.width,this.height=e.height,this.tiltX=e.tiltX,this.tiltY=e.tiltY,this.pointerType=e.pointerType,this.pressure=e.pressure,this.rotationAngle=e.rotationAngle,this.twist=e.twist||0,this.tangentialPressure=e.tangentialPressure||0},e.prototype._reset=function(){this.isPrimary=!1},i(e,[{key:"pointerId",get:function(){return this.identifier}}]),e}();r.default=s},{"../core":65}],156:[function(e,t,r){"use strict";function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}r.__esModule=!0;var i=function(){function e(){n(this,e),this.stopped=!1,this.target=null,this.currentTarget=null,this.type=null,this.data=null}return e.prototype.stopPropagation=function(){this.stopped=!0},e.prototype._reset=function(){this.stopped=!1,this.currentTarget=null,this.target=null},e}();r.default=i},{}],157:[function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function s(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}r.__esModule=!0;var u="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},i=e("../core"),l=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t.default=e,t}(i),c=e("./InteractionData"),h=n(c),f=e("./InteractionEvent"),d=n(f),p=e("./InteractionTrackingData"),v=n(p),m=e("eventemitter3"),g=n(m),y=e("./interactiveTarget"),x=n(y);l.utils.mixins.delayMixin(l.DisplayObject.prototype,x.default);var b="MOUSE",w={target:null,data:{global:null}},_=function(n){function i(e,t){a(this,i);var r=o(this,n.call(this));return t=t||{},r.renderer=e,r.autoPreventDefault=void 0===t.autoPreventDefault||t.autoPreventDefault,r.interactionFrequency=t.interactionFrequency||10,r.mouse=new h.default,r.mouse.identifier=b,r.mouse.global.set(-999999),r.activeInteractionData={},r.activeInteractionData[b]=r.mouse,r.interactionDataPool=[],r.eventData=new d.default,r.interactionDOMElement=null,r.moveWhenInside=!1,r.eventsAdded=!1,r.mouseOverRenderer=!1,r.supportsTouchEvents="ontouchstart"in window,r.supportsPointerEvents=!!window.PointerEvent,r.onPointerUp=r.onPointerUp.bind(r),r.processPointerUp=r.processPointerUp.bind(r),r.onPointerCancel=r.onPointerCancel.bind(r),r.processPointerCancel=r.processPointerCancel.bind(r),r.onPointerDown=r.onPointerDown.bind(r),r.processPointerDown=r.processPointerDown.bind(r),r.onPointerMove=r.onPointerMove.bind(r),r.processPointerMove=r.processPointerMove.bind(r),r.onPointerOut=r.onPointerOut.bind(r),r.processPointerOverOut=r.processPointerOverOut.bind(r),r.onPointerOver=r.onPointerOver.bind(r),r.cursorStyles={default:"inherit",pointer:"pointer"},r.currentCursorMode=null,r.cursor=null,r._tempPoint=new l.Point,r.resolution=1,r.setTargetElement(r.renderer.view,r.renderer.resolution),r}return s(i,n),i.prototype.hitTest=function(e,t){return w.target=null,w.data.global=e,t||(t=this.renderer._lastObjectRendered),this.processInteractive(w,t,null,!0),w.target},i.prototype.setTargetElement=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;this.removeEvents(),this.interactionDOMElement=e,this.resolution=t,this.addEvents()},i.prototype.addEvents=function(){this.interactionDOMElement&&(l.ticker.shared.add(this.update,this,l.UPDATE_PRIORITY.INTERACTION),window.navigator.msPointerEnabled?(this.interactionDOMElement.style["-ms-content-zooming"]="none",this.interactionDOMElement.style["-ms-touch-action"]="none"):this.supportsPointerEvents&&(this.interactionDOMElement.style["touch-action"]="none"),this.supportsPointerEvents?(window.document.addEventListener("pointermove",this.onPointerMove,!0),this.interactionDOMElement.addEventListener("pointerdown",this.onPointerDown,!0),this.interactionDOMElement.addEventListener("pointerleave",this.onPointerOut,!0),this.interactionDOMElement.addEventListener("pointerover",this.onPointerOver,!0),window.addEventListener("pointercancel",this.onPointerCancel,!0),window.addEventListener("pointerup",this.onPointerUp,!0)):(window.document.addEventListener("mousemove",this.onPointerMove,!0),this.interactionDOMElement.addEventListener("mousedown",this.onPointerDown,!0),this.interactionDOMElement.addEventListener("mouseout",this.onPointerOut,!0),this.interactionDOMElement.addEventListener("mouseover",this.onPointerOver,!0),window.addEventListener("mouseup",this.onPointerUp,!0)),this.supportsTouchEvents&&(this.interactionDOMElement.addEventListener("touchstart",this.onPointerDown,!0),this.interactionDOMElement.addEventListener("touchcancel",this.onPointerCancel,!0),this.interactionDOMElement.addEventListener("touchend",this.onPointerUp,!0),this.interactionDOMElement.addEventListener("touchmove",this.onPointerMove,!0)),this.eventsAdded=!0)},i.prototype.removeEvents=function(){this.interactionDOMElement&&(l.ticker.shared.remove(this.update,this),window.navigator.msPointerEnabled?(this.interactionDOMElement.style["-ms-content-zooming"]="",this.interactionDOMElement.style["-ms-touch-action"]=""):this.supportsPointerEvents&&(this.interactionDOMElement.style["touch-action"]=""),this.supportsPointerEvents?(window.document.removeEventListener("pointermove",this.onPointerMove,!0),this.interactionDOMElement.removeEventListener("pointerdown",this.onPointerDown,!0),this.interactionDOMElement.removeEventListener("pointerleave",this.onPointerOut,!0),this.interactionDOMElement.removeEventListener("pointerover",this.onPointerOver,!0),window.removeEventListener("pointercancel",this.onPointerCancel,!0),window.removeEventListener("pointerup",this.onPointerUp,!0)):(window.document.removeEventListener("mousemove",this.onPointerMove,!0),this.interactionDOMElement.removeEventListener("mousedown",this.onPointerDown,!0),this.interactionDOMElement.removeEventListener("mouseout",this.onPointerOut,!0),this.interactionDOMElement.removeEventListener("mouseover",this.onPointerOver,!0),window.removeEventListener("mouseup",this.onPointerUp,!0)),this.supportsTouchEvents&&(this.interactionDOMElement.removeEventListener("touchstart",this.onPointerDown,!0),this.interactionDOMElement.removeEventListener("touchcancel",this.onPointerCancel,!0),this.interactionDOMElement.removeEventListener("touchend",this.onPointerUp,!0),this.interactionDOMElement.removeEventListener("touchmove",this.onPointerMove,!0)),this.interactionDOMElement=null,this.eventsAdded=!1)},i.prototype.update=function(e){if(this._deltaTime+=e,!(this._deltaTime<this.interactionFrequency)&&(this._deltaTime=0,this.interactionDOMElement)){if(this.didMove)return void(this.didMove=!1);this.cursor=null;for(var t in this.activeInteractionData)if(this.activeInteractionData.hasOwnProperty(t)){var r=this.activeInteractionData[t];if(r.originalEvent&&"touch"!==r.pointerType){var n=this.configureInteractionEventForDOMEvent(this.eventData,r.originalEvent,r);this.processInteractive(n,this.renderer._lastObjectRendered,this.processPointerOverOut,!0)}}this.setCursorMode(this.cursor)}},i.prototype.setCursorMode=function(e){if(e=e||"default",this.currentCursorMode!==e){this.currentCursorMode=e;var t=this.cursorStyles[e];if(t)switch(void 0===t?"undefined":u(t)){case"string":this.interactionDOMElement.style.cursor=t;break;case"function":t(e);break;case"object":Object.assign(this.interactionDOMElement.style,t)}else"string"!=typeof e||Object.prototype.hasOwnProperty.call(this.cursorStyles,e)||(this.interactionDOMElement.style.cursor=e)}},i.prototype.dispatchEvent=function(e,t,r){r.stopped||(r.currentTarget=e,r.type=t,e.emit(t,r),e[t]&&e[t](r))},i.prototype.mapPositionToPoint=function(e,t,r){var n=void 0;n=this.interactionDOMElement.parentElement?this.interactionDOMElement.getBoundingClientRect():{x:0,y:0,width:0,height:0};var i=navigator.isCocoonJS?this.resolution:1/this.resolution;e.x=(t-n.left)*(this.interactionDOMElement.width/n.width)*i,e.y=(r-n.top)*(this.interactionDOMElement.height/n.height)*i},i.prototype.processInteractive=function(e,t,r,n,i){if(!t||!t.visible)return!1;var a=e.data.global;i=t.interactive||i;var o=!1,s=i;if(t.hitArea?s=!1:n&&t._mask&&(t._mask.containsPoint(a)||(n=!1)),t.interactiveChildren&&t.children)for(var u=t.children,l=u.length-1;l>=0;l--){var c=u[l],h=this.processInteractive(e,c,r,n,s);if(h){if(!c.parent)continue;s=!1,h&&(e.target&&(n=!1),o=!0)}}return i&&(n&&!e.target&&(t.hitArea?(t.worldTransform.applyInverse(a,this._tempPoint),t.hitArea.contains(this._tempPoint.x,this._tempPoint.y)&&(o=!0)):t.containsPoint&&t.containsPoint(a)&&(o=!0)),t.interactive&&(o&&!e.target&&(e.target=t),r&&r(e,t,!!o))),o},i.prototype.onPointerDown=function(e){if(!this.supportsTouchEvents||"touch"!==e.pointerType){var t=this.normalizeToPointerData(e);this.autoPreventDefault&&t[0].isNormalized&&e.preventDefault();for(var r=t.length,n=0;n<r;n++){var i=t[n],a=this.getInteractionDataForPointerId(i),o=this.configureInteractionEventForDOMEvent(this.eventData,i,a);if(o.data.originalEvent=e,this.processInteractive(o,this.renderer._lastObjectRendered,this.processPointerDown,!0),this.emit("pointerdown",o),"touch"===i.pointerType)this.emit("touchstart",o);else if("mouse"===i.pointerType||"pen"===i.pointerType){var s=2===i.button;this.emit(s?"rightdown":"mousedown",this.eventData)}}}},i.prototype.processPointerDown=function(e,t,r){var n=e.data,i=e.data.identifier;if(r)if(t.trackedPointers[i]||(t.trackedPointers[i]=new v.default(i)),this.dispatchEvent(t,"pointerdown",e),"touch"===n.pointerType)this.dispatchEvent(t,"touchstart",e);else if("mouse"===n.pointerType||"pen"===n.pointerType){var a=2===n.button;a?t.trackedPointers[i].rightDown=!0:t.trackedPointers[i].leftDown=!0,this.dispatchEvent(t,a?"rightdown":"mousedown",e)}},i.prototype.onPointerComplete=function(e,t,r){for(var n=this.normalizeToPointerData(e),i=n.length,a=e.target!==this.interactionDOMElement?"outside":"",o=0;o<i;o++){var s=n[o],u=this.getInteractionDataForPointerId(s),l=this.configureInteractionEventForDOMEvent(this.eventData,s,u);if(l.data.originalEvent=e,this.processInteractive(l,this.renderer._lastObjectRendered,r,t||!a),this.emit(t?"pointercancel":"pointerup"+a,l),"mouse"===s.pointerType||"pen"===s.pointerType){var c=2===s.button;this.emit(c?"rightup"+a:"mouseup"+a,l)}else"touch"===s.pointerType&&(this.emit(t?"touchcancel":"touchend"+a,l),this.releaseInteractionDataForPointerId(s.pointerId,u))}},i.prototype.onPointerCancel=function(e){this.supportsTouchEvents&&"touch"===e.pointerType||this.onPointerComplete(e,!0,this.processPointerCancel)},i.prototype.processPointerCancel=function(e,t){var r=e.data,n=e.data.identifier;void 0!==t.trackedPointers[n]&&(delete t.trackedPointers[n],this.dispatchEvent(t,"pointercancel",e),"touch"===r.pointerType&&this.dispatchEvent(t,"touchcancel",e))},i.prototype.onPointerUp=function(e){this.supportsTouchEvents&&"touch"===e.pointerType||this.onPointerComplete(e,!1,this.processPointerUp)},i.prototype.processPointerUp=function(e,t,r){var n=e.data,i=e.data.identifier,a=t.trackedPointers[i],o="touch"===n.pointerType;if("mouse"===n.pointerType||"pen"===n.pointerType){var s=2===n.button,u=v.default.FLAGS,l=s?u.RIGHT_DOWN:u.LEFT_DOWN,c=void 0!==a&&a.flags&l;r?(this.dispatchEvent(t,s?"rightup":"mouseup",e),c&&this.dispatchEvent(t,s?"rightclick":"click",e)):c&&this.dispatchEvent(t,s?"rightupoutside":"mouseupoutside",e),a&&(s?a.rightDown=!1:a.leftDown=!1)}r?(this.dispatchEvent(t,"pointerup",e),o&&this.dispatchEvent(t,"touchend",e),a&&(this.dispatchEvent(t,"pointertap",e),o&&(this.dispatchEvent(t,"tap",e),a.over=!1))):a&&(this.dispatchEvent(t,"pointerupoutside",e),o&&this.dispatchEvent(t,"touchendoutside",e)),a&&a.none&&delete t.trackedPointers[i]},i.prototype.onPointerMove=function(e){if(!this.supportsTouchEvents||"touch"!==e.pointerType){var t=this.normalizeToPointerData(e);"mouse"===t[0].pointerType&&(this.didMove=!0,this.cursor=null);for(var r=t.length,n=0;n<r;n++){var i=t[n],a=this.getInteractionDataForPointerId(i),o=this.configureInteractionEventForDOMEvent(this.eventData,i,a);o.data.originalEvent=e;var s="touch"!==i.pointerType||this.moveWhenInside;this.processInteractive(o,this.renderer._lastObjectRendered,this.processPointerMove,s),this.emit("pointermove",o),"touch"===i.pointerType&&this.emit("touchmove",o),"mouse"!==i.pointerType&&"pen"!==i.pointerType||this.emit("mousemove",o)}"mouse"===t[0].pointerType&&this.setCursorMode(this.cursor)}},i.prototype.processPointerMove=function(e,t,r){var n=e.data,i="touch"===n.pointerType,a="mouse"===n.pointerType||"pen"===n.pointerType;a&&this.processPointerOverOut(e,t,r),this.moveWhenInside&&!r||(this.dispatchEvent(t,"pointermove",e),i&&this.dispatchEvent(t,"touchmove",e),a&&this.dispatchEvent(t,"mousemove",e))},i.prototype.onPointerOut=function(e){if(!this.supportsTouchEvents||"touch"!==e.pointerType){var t=this.normalizeToPointerData(e),r=t[0];"mouse"===r.pointerType&&(this.mouseOverRenderer=!1,this.setCursorMode(null));var n=this.getInteractionDataForPointerId(r),i=this.configureInteractionEventForDOMEvent(this.eventData,r,n);i.data.originalEvent=r,this.processInteractive(i,this.renderer._lastObjectRendered,this.processPointerOverOut,!1),this.emit("pointerout",i),"mouse"===r.pointerType||"pen"===r.pointerType?this.emit("mouseout",i):this.releaseInteractionDataForPointerId(n.identifier)}},i.prototype.processPointerOverOut=function(e,t,r){var n=e.data,i=e.data.identifier,a="mouse"===n.pointerType||"pen"===n.pointerType,o=t.trackedPointers[i];r&&!o&&(o=t.trackedPointers[i]=new v.default(i)),void 0!==o&&(r&&this.mouseOverRenderer?(o.over||(o.over=!0,this.dispatchEvent(t,"pointerover",e),a&&this.dispatchEvent(t,"mouseover",e)),a&&null===this.cursor&&(this.cursor=t.cursor)):o.over&&(o.over=!1,this.dispatchEvent(t,"pointerout",this.eventData),a&&this.dispatchEvent(t,"mouseout",e),o.none&&delete t.trackedPointers[i]))},i.prototype.onPointerOver=function(e){var t=this.normalizeToPointerData(e),r=t[0],n=this.getInteractionDataForPointerId(r),i=this.configureInteractionEventForDOMEvent(this.eventData,r,n);i.data.originalEvent=r,"mouse"===r.pointerType&&(this.mouseOverRenderer=!0),this.emit("pointerover",i),"mouse"!==r.pointerType&&"pen"!==r.pointerType||this.emit("mouseover",i)},i.prototype.getInteractionDataForPointerId=function(e){var t=e.pointerId,r=void 0;return t===b||"mouse"===e.pointerType?r=this.mouse:this.activeInteractionData[t]?r=this.activeInteractionData[t]:(r=this.interactionDataPool.pop()||new h.default,r.identifier=t,this.activeInteractionData[t]=r),r._copyEvent(e),r},i.prototype.releaseInteractionDataForPointerId=function(e){var t=this.activeInteractionData[e];t&&(delete this.activeInteractionData[e],t._reset(),this.interactionDataPool.push(t))},i.prototype.configureInteractionEventForDOMEvent=function(e,t,r){return e.data=r,this.mapPositionToPoint(r.global,t.clientX,t.clientY),navigator.isCocoonJS&&"touch"===t.pointerType&&(r.global.x=r.global.x/this.resolution,r.global.y=r.global.y/this.resolution),"touch"===t.pointerType&&(t.globalX=r.global.x,t.globalY=r.global.y),r.originalEvent=t,e._reset(),e},i.prototype.normalizeToPointerData=function(e){var t=[];if(this.supportsTouchEvents&&e instanceof TouchEvent)for(var r=0,n=e.changedTouches.length;r<n;r++){var i=e.changedTouches[r];void 0===i.button&&(i.button=e.touches.length?1:0),void 0===i.buttons&&(i.buttons=e.touches.length?1:0),void 0===i.isPrimary&&(i.isPrimary=1===e.touches.length&&"touchstart"===e.type),void 0===i.width&&(i.width=i.radiusX||1),void 0===i.height&&(i.height=i.radiusY||1),void 0===i.tiltX&&(i.tiltX=0),void 0===i.tiltY&&(i.tiltY=0),void 0===i.pointerType&&(i.pointerType="touch"),void 0===i.pointerId&&(i.pointerId=i.identifier||0),void 0===i.pressure&&(i.pressure=i.force||.5),i.twist=0,i.tangentialPressure=0,void 0===i.layerX&&(i.layerX=i.offsetX=i.clientX),void 0===i.layerY&&(i.layerY=i.offsetY=i.clientY),i.isNormalized=!0,t.push(i)}else!(e instanceof MouseEvent)||this.supportsPointerEvents&&e instanceof window.PointerEvent?t.push(e):(void 0===e.isPrimary&&(e.isPrimary=!0),void 0===e.width&&(e.width=1),void 0===e.height&&(e.height=1),void 0===e.tiltX&&(e.tiltX=0),void 0===e.tiltY&&(e.tiltY=0),void 0===e.pointerType&&(e.pointerType="mouse"),void 0===e.pointerId&&(e.pointerId=b),void 0===e.pressure&&(e.pressure=.5),e.twist=0,e.tangentialPressure=0,e.isNormalized=!0,t.push(e));return t},i.prototype.destroy=function(){this.removeEvents(),this.removeAllListeners(),this.renderer=null,this.mouse=null,this.eventData=null,this.interactionDOMElement=null,this.onPointerDown=null,this.processPointerDown=null,this.onPointerUp=null,this.processPointerUp=null,this.onPointerCancel=null,this.processPointerCancel=null,this.onPointerMove=null,this.processPointerMove=null,this.onPointerOut=null,this.processPointerOverOut=null,this.onPointerOver=null,this._tempPoint=null},i}(g.default);r.default=_,l.WebGLRenderer.registerPlugin("interaction",_),l.CanvasRenderer.registerPlugin("interaction",_)},{"../core":65,"./InteractionData":155,"./InteractionEvent":156,"./InteractionTrackingData":158,"./interactiveTarget":160,eventemitter3:3}],158:[function(e,t,r){"use strict";function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}r.__esModule=!0;var i=function(){function n(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(e,t,r){return t&&n(e.prototype,t),r&&n(e,r),e}}(),a=function(){function t(e){n(this,t),this._pointerId=e,this._flags=t.FLAGS.NONE}return t.prototype._doSet=function(e,t){this._flags=t?this._flags|e:this._flags&~e},i(t,[{key:"pointerId",get:function(){return this._pointerId}},{key:"flags",get:function(){return this._flags},set:function(e){this._flags=e}},{key:"none",get:function(){return this._flags===this.constructor.FLAGS.NONE}},{key:"over",get:function(){return 0!=(this._flags&this.constructor.FLAGS.OVER)},set:function(e){this._doSet(this.constructor.FLAGS.OVER,e)}},{key:"rightDown",get:function(){return 0!=(this._flags&this.constructor.FLAGS.RIGHT_DOWN)},set:function(e){this._doSet(this.constructor.FLAGS.RIGHT_DOWN,e)}},{key:"leftDown",get:function(){return 0!=(this._flags&this.constructor.FLAGS.LEFT_DOWN)},set:function(e){this._doSet(this.constructor.FLAGS.LEFT_DOWN,e)}}]),t}();r.default=a,a.FLAGS=Object.freeze({NONE:0,OVER:1,LEFT_DOWN:2,RIGHT_DOWN:4})},{}],159:[function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}r.__esModule=!0;var i=e("./InteractionData");Object.defineProperty(r,"InteractionData",{enumerable:!0,get:function(){return n(i).default}});var a=e("./InteractionManager");Object.defineProperty(r,"InteractionManager",{enumerable:!0,get:function(){return n(a).default}});var o=e("./interactiveTarget");Object.defineProperty(r,"interactiveTarget",{enumerable:!0,get:function(){return n(o).default}});var s=e("./InteractionTrackingData");Object.defineProperty(r,"InteractionTrackingData",{enumerable:!0,get:function(){return n(s).default}});var u=e("./InteractionEvent");Object.defineProperty(r,"InteractionEvent",{enumerable:!0,get:function(){return n(u).default}})},{"./InteractionData":155,"./InteractionEvent":156,"./InteractionManager":157,"./InteractionTrackingData":158,"./interactiveTarget":160}],160:[function(e,t,r){"use strict";r.__esModule=!0,r.default={interactive:!1,interactiveChildren:!0,hitArea:null,get buttonMode(){return"pointer"===this.cursor},set buttonMode(e){e?this.cursor="pointer":"pointer"===this.cursor&&(this.cursor=null)},cursor:null,get trackedPointers(){return void 0===this._trackedPointers&&(this._trackedPointers={}),this._trackedPointers},_trackedPointers:void 0}},{}],161:[function(e,t,r){"use strict";function a(e,t){e.bitmapFont=i.BitmapText.registerFont(e.data,t)}r.__esModule=!0,r.parse=a,r.default=function(){return function(t,r){if(!t.data||t.type!==u.Resource.TYPE.XML)return void r();if(0===t.data.getElementsByTagName("page").length||0===t.data.getElementsByTagName("info").length||null===t.data.getElementsByTagName("info")[0].getAttribute("face"))return void r();var e=t.isDataUrl?"":o.dirname(t.url);t.isDataUrl&&("."===e&&(e=""),this.baseUrl&&e&&"/"===this.baseUrl.charAt(this.baseUrl.length-1)&&(e+="/")),(e=e.replace(this.baseUrl,""))&&"/"!==e.charAt(e.length-1)&&(e+="/");var n=e+t.data.getElementsByTagName("page")[0].getAttribute("file");if(s.utils.TextureCache[n])a(t,s.utils.TextureCache[n]),r();else{var i={crossOrigin:t.crossOrigin,loadType:u.Resource.LOAD_TYPE.IMAGE,metadata:t.metadata.imageMetadata,parentResource:t};this.add(t.name+"_image",n,i,function(e){a(t,e.texture),r()})}}};var n=e("path"),o=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t.default=e,t}(n),s=e("../core"),u=e("resource-loader"),i=e("../extras")},{"../core":65,"../extras":141,path:23,"resource-loader":36}],162:[function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}r.__esModule=!0,r.shared=r.Resource=r.textureParser=r.getResourcePath=r.spritesheetParser=r.parseBitmapFontData=r.bitmapFontParser=r.Loader=void 0;var i=e("./bitmapFontParser");Object.defineProperty(r,"bitmapFontParser",{enumerable:!0,get:function(){return n(i).default}}),Object.defineProperty(r,"parseBitmapFontData",{enumerable:!0,get:function(){return i.parse}});var a=e("./spritesheetParser");Object.defineProperty(r,"spritesheetParser",{enumerable:!0,get:function(){return n(a).default}}),Object.defineProperty(r,"getResourcePath",{enumerable:!0,get:function(){return a.getResourcePath}});var o=e("./textureParser");Object.defineProperty(r,"textureParser",{enumerable:!0,get:function(){return n(o).default}});var s=e("resource-loader");Object.defineProperty(r,"Resource",{enumerable:!0,get:function(){return s.Resource}});var u=e("../core/Application"),l=n(u),c=e("./loader"),h=n(c);r.Loader=h.default;var f=new h.default;f.destroy=function(){},r.shared=f;var d=l.default.prototype;d._loader=null,Object.defineProperty(d,"loader",{get:function(){if(!this._loader){var e=this._options.sharedLoader;this._loader=e?f:new h.default}return this._loader}}),d._parentDestroy=d.destroy,d.destroy=function(e){this._loader&&(this._loader.destroy(),this._loader=null),this._parentDestroy(e)}},{"../core/Application":43,"./bitmapFontParser":161,"./loader":163,"./spritesheetParser":164,"./textureParser":165,"resource-loader":36}],163:[function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function s(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function u(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}r.__esModule=!0;var i=e("resource-loader"),a=n(i),l=e("resource-loader/lib/middlewares/parsing/blob"),c=e("eventemitter3"),h=n(c),f=e("./textureParser"),d=n(f),p=e("./spritesheetParser"),v=n(p),m=e("./bitmapFontParser"),g=n(m),y=function(i){function a(e,t){o(this,a);var n=s(this,i.call(this,e,t));h.default.call(n);for(var r=0;r<a._pixiMiddleware.length;++r)n.use(a._pixiMiddleware[r]());return n.onStart.add(function(e){return n.emit("start",e)}),n.onProgress.add(function(e,t){return n.emit("progress",e,t)}),n.onError.add(function(e,t,r){return n.emit("error",e,t,r)}),n.onLoad.add(function(e,t){return n.emit("load",e,t)}),n.onComplete.add(function(e,t){return n.emit("complete",e,t)}),n}return u(a,i),a.addPixiMiddleware=function(e){a._pixiMiddleware.push(e)},a.prototype.destroy=function(){this.removeAllListeners(),this.reset()},a}(a.default);r.default=y;for(var x in h.default.prototype)y.prototype[x]=h.default.prototype[x];y._pixiMiddleware=[l.blobMiddlewareFactory,d.default,v.default,g.default];var b=a.default.Resource;b.setExtensionXhrType("fnt",b.XHR_RESPONSE_TYPE.DOCUMENT)},{"./bitmapFontParser":161,"./spritesheetParser":164,"./textureParser":165,eventemitter3:3,"resource-loader":36,"resource-loader/lib/middlewares/parsing/blob":37}],164:[function(e,t,r){"use strict";function a(e,t){return e.isDataUrl?e.data.meta.image:i.default.resolve(e.url.replace(t,""),e.data.meta.image)}r.__esModule=!0,r.default=function(){return function(r,n){var e=r.name+"_image";if(!r.data||r.type!==o.Resource.TYPE.JSON||!r.data.frames||this.resources[e])return void n();var t={crossOrigin:r.crossOrigin,loadType:o.Resource.LOAD_TYPE.IMAGE,metadata:r.metadata.imageMetadata,parentResource:r},i=a(r,this.baseUrl);this.add(e,i,t,function(e){var t=new s.Spritesheet(e.texture.baseTexture,r.data,r.url);t.parse(function(){r.spritesheet=t,r.textures=t.textures,n()})})}},r.getResourcePath=a;var o=e("resource-loader"),n=e("url"),i=function(e){return e&&e.__esModule?e:{default:e}}(n),s=e("../core")},{"../core":65,"resource-loader":36,url:29}],165:[function(e,t,r){"use strict";r.__esModule=!0,r.default=function(){return function(e,t){e.data&&e.type===n.Resource.TYPE.IMAGE&&(e.texture=a.default.fromLoader(e.data,e.url,e.name)),t()}};var n=e("resource-loader"),i=e("../core/textures/Texture"),a=function(e){return e&&e.__esModule?e:{default:e}}(i)},{"../core/textures/Texture":115,"resource-loader":36}],166:[function(e,t,r){"use strict";function s(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function u(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function n(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}r.__esModule=!0;var i=function(){function n(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(e,t,r){return t&&n(e.prototype,t),r&&n(e,r),e}}(),a=e("../core"),l=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t.default=e,t}(a),o=e("../core/textures/Texture"),h=function(e){return e&&e.__esModule?e:{default:e}}(o),f=new l.Point,d=new l.Polygon,c=function(o){function c(e,t,r,n,i){s(this,c);var a=u(this,o.call(this));return a._texture=e||h.default.EMPTY,a.uvs=r||new Float32Array([0,0,1,0,1,1,0,1]),a.vertices=t||new Float32Array([0,0,100,0,100,100,0,100]),a.indices=n||new Uint16Array([0,1,3,2]),a.dirty=0,a.indexDirty=0,a.blendMode=l.BLEND_MODES.NORMAL,a.canvasPadding=0,a.drawMode=i||c.DRAW_MODES.TRIANGLE_MESH,a.shader=null,a.tintRgb=new Float32Array([1,1,1]),a._glDatas={},a._uvTransform=new l.TextureMatrix(a._texture),a.uploadUvTransform=!1,a.pluginName="mesh",a}return n(c,o),c.prototype._renderWebGL=function(e){this.refresh(),e.setObjectRenderer(e.plugins[this.pluginName]),e.plugins[this.pluginName].render(this)},c.prototype._renderCanvas=function(e){this.refresh(),e.plugins[this.pluginName].render(this)},c.prototype._onTextureUpdate=function(){this._uvTransform.texture=this._texture,this.refresh()},c.prototype.multiplyUvs=function(){this.uploadUvTransform||this._uvTransform.multiplyUvs(this.uvs)},c.prototype.refresh=function(e){this._uvTransform.update(e)&&this._refresh()},c.prototype._refresh=function(){},c.prototype._calculateBounds=function(){this._bounds.addVertices(this.transform,this.vertices,0,this.vertices.length)},c.prototype.containsPoint=function(e){if(!this.getBounds().contains(e.x,e.y))return!1;this.worldTransform.applyInverse(e,f);for(var t=this.vertices,r=d.points,n=this.indices,i=this.indices.length,a=this.drawMode===c.DRAW_MODES.TRIANGLES?3:1,o=0;o+2<i;o+=a){var s=2*n[o],u=2*n[o+1],l=2*n[o+2];if(r[0]=t[s],r[1]=t[s+1],r[2]=t[u],r[3]=t[u+1],r[4]=t[l],r[5]=t[l+1],d.contains(f.x,f.y))return!0}return!1},i(c,[{key:"texture",get:function(){return this._texture},set:function(e){this._texture!==e&&(this._texture=e,e&&(e.baseTexture.hasLoaded?this._onTextureUpdate():e.once("update",this._onTextureUpdate,this)))}},{key:"tint",get:function(){return l.utils.rgb2hex(this.tintRgb)},set:function(e){this.tintRgb=l.utils.hex2rgb(e,this.tintRgb)}}]),c}(l.Container);r.default=c,c.DRAW_MODES={TRIANGLE_MESH:0,TRIANGLES:1}},{"../core":65,"../core/textures/Texture":115}],167:[function(e,t,r){"use strict";function u(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function l(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function n(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}r.__esModule=!0;var i=function(){function n(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(e,t,r){return t&&n(e.prototype,t),r&&n(e,r),e}}(),a=e("./Plane"),o=function(e){return e&&e.__esModule?e:{default:e}}(a),c=10,s=function(o){function s(e,t,r,n,i){u(this,s);var a=l(this,o.call(this,e,4,4));return a._origWidth=e.orig.width,a._origHeight=e.orig.height,a._width=a._origWidth,a._height=a._origHeight,a.leftWidth=void 0!==t?t:c,a.rightWidth=void 0!==n?n:c,a.topHeight=void 0!==r?r:c,a.bottomHeight=void 0!==i?i:c,a.refresh(!0),a}return n(s,o),s.prototype.updateHorizontalVertices=function(){var e=this.vertices;e[9]=e[11]=e[13]=e[15]=this._topHeight,e[17]=e[19]=e[21]=e[23]=this._height-this._bottomHeight,e[25]=e[27]=e[29]=e[31]=this._height},s.prototype.updateVerticalVertices=function(){var e=this.vertices;e[2]=e[10]=e[18]=e[26]=this._leftWidth,e[4]=e[12]=e[20]=e[28]=this._width-this._rightWidth,e[6]=e[14]=e[22]=e[30]=this._width},s.prototype._renderCanvas=function(e){var t=e.context;t.globalAlpha=this.worldAlpha;var r=this.worldTransform,n=e.resolution;e.roundPixels?t.setTransform(r.a*n,r.b*n,r.c*n,r.d*n,r.tx*n|0,r.ty*n|0):t.setTransform(r.a*n,r.b*n,r.c*n,r.d*n,r.tx*n,r.ty*n);var i=this._texture.baseTexture,a=i.source,o=i.width*i.resolution,s=i.height*i.resolution;this.drawSegment(t,a,o,s,0,1,10,11),this.drawSegment(t,a,o,s,2,3,12,13),this.drawSegment(t,a,o,s,4,5,14,15),this.drawSegment(t,a,o,s,8,9,18,19),this.drawSegment(t,a,o,s,10,11,20,21),this.drawSegment(t,a,o,s,12,13,22,23),this.drawSegment(t,a,o,s,16,17,26,27),this.drawSegment(t,a,o,s,18,19,28,29),this.drawSegment(t,a,o,s,20,21,30,31)},s.prototype.drawSegment=function(e,t,r,n,i,a,o,s){var u=this.uvs,l=this.vertices,c=(u[o]-u[i])*r,h=(u[s]-u[a])*n,f=l[o]-l[i],d=l[s]-l[a];c<1&&(c=1),h<1&&(h=1),f<1&&(f=1),d<1&&(d=1),e.drawImage(t,u[i]*r,u[a]*n,c,h,l[i],l[a],f,d)},s.prototype._refresh=function(){o.prototype._refresh.call(this);var e=this.uvs,t=this._texture;this._origWidth=t.orig.width,this._origHeight=t.orig.height;var r=1/this._origWidth,n=1/this._origHeight;e[0]=e[8]=e[16]=e[24]=0,e[1]=e[3]=e[5]=e[7]=0,e[6]=e[14]=e[22]=e[30]=1,e[25]=e[27]=e[29]=e[31]=1,e[2]=e[10]=e[18]=e[26]=r*this._leftWidth,e[4]=e[12]=e[20]=e[28]=1-r*this._rightWidth,e[9]=e[11]=e[13]=e[15]=n*this._topHeight,e[17]=e[19]=e[21]=e[23]=1-n*this._bottomHeight,this.updateHorizontalVertices(),this.updateVerticalVertices(),this.dirty++,this.multiplyUvs()},i(s,[{key:"width",get:function(){return this._width},set:function(e){this._width=e,this._refresh()}},{key:"height",get:function(){return this._height},set:function(e){this._height=e,this._refresh()}},{key:"leftWidth",get:function(){return this._leftWidth},set:function(e){this._leftWidth=e,this._refresh()}},{key:"rightWidth",get:function(){return this._rightWidth},set:function(e){this._rightWidth=e,this._refresh()}},{key:"topHeight",get:function(){return this._topHeight},set:function(e){this._topHeight=e,this._refresh()}},{key:"bottomHeight",get:function(){return this._bottomHeight},set:function(e){this._bottomHeight=e,this._refresh()}}]),s}(o.default);r.default=s},{"./Plane":168}],168:[function(e,t,r){"use strict";function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function s(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function n(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}r.__esModule=!0;var i=e("./Mesh"),u=function(e){return e&&e.__esModule?e:{default:e}}(i),a=function(i){function a(e,t,r){o(this,a);var n=s(this,i.call(this,e));return n._ready=!0,n.verticesX=t||10,n.verticesY=r||10,n.drawMode=u.default.DRAW_MODES.TRIANGLES,n.refresh(),n}return n(a,i),a.prototype._refresh=function(){for(var e=this._texture,t=this.verticesX*this.verticesY,r=[],n=[],i=[],a=[],o=this.verticesX-1,s=this.verticesY-1,u=e.width/o,l=e.height/s,c=0;c<t;c++){var h=c%this.verticesX,f=c/this.verticesX|0;r.push(h*u,f*l),i.push(h/o,f/s)}for(var d=o*s,p=0;p<d;p++){var v=p%o,m=p/o|0,g=m*this.verticesX+v,y=m*this.verticesX+v+1,x=(m+1)*this.verticesX+v,b=(m+1)*this.verticesX+v+1;a.push(g,y,x),a.push(y,b,x)}this.vertices=new Float32Array(r),this.uvs=new Float32Array(i),this.colors=new Float32Array(n),this.indices=new Uint16Array(a),this.dirty++,this.indexDirty++,this.multiplyUvs()},a.prototype._onTextureUpdate=function(){u.default.prototype._onTextureUpdate.call(this),this._ready&&this.refresh()},a}(u.default);r.default=a},{"./Mesh":166}],169:[function(e,t,r){"use strict";function a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function s(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}r.__esModule=!0;var n=e("./Mesh"),i=function(e){return e&&e.__esModule?e:{default:e}}(n),u=function(n){function i(e,t){a(this,i);var r=o(this,n.call(this,e));return r.points=t,r.vertices=new Float32Array(4*t.length),r.uvs=new Float32Array(4*t.length),r.colors=new Float32Array(2*t.length),r.indices=new Uint16Array(2*t.length),r.autoUpdate=!0,r.refresh(),r}return s(i,n),i.prototype._refresh=function(){var e=this.points;if(!(e.length<1)&&this._texture._uvs){this.vertices.length/4!==e.length&&(this.vertices=new Float32Array(4*e.length),this.uvs=new Float32Array(4*e.length),this.colors=new Float32Array(2*e.length),this.indices=new Uint16Array(2*e.length));var t=this.uvs,r=this.indices,n=this.colors;t[0]=0,t[1]=0,t[2]=0,t[3]=1,n[0]=1,n[1]=1,r[0]=0,r[1]=1;for(var i=e.length,a=1;a<i;a++){var o=4*a,s=a/(i-1);t[o]=s,t[o+1]=0,t[o+2]=s,t[o+3]=1,o=2*a,n[o]=1,n[o+1]=1,o=2*a,r[o]=o,r[o+1]=o+1}this.dirty++,this.indexDirty++,this.multiplyUvs(),this.refreshVertices()}},i.prototype.refreshVertices=function(){var e=this.points;if(!(e.length<1))for(var t=e[0],r=void 0,n=0,i=0,a=this.vertices,o=e.length,s=0;s<o;s++){var u=e[s],l=4*s;r=s<e.length-1?e[s+1]:u,i=-(r.x-t.x),n=r.y-t.y;var c=10*(1-s/(o-1));c>1&&(c=1);var h=Math.sqrt(n*n+i*i),f=this._texture.height/2;n/=h,i/=h,n*=f,i*=f,a[l]=u.x+n,a[l+1]=u.y+i,a[l+2]=u.x-n,a[l+3]=u.y-i,t=u}},i.prototype.updateTransform=function(){this.autoUpdate&&this.refreshVertices(),this.containerUpdateTransform()},i}(i.default);r.default=u},{"./Mesh":166}],170:[function(e,t,r){"use strict";function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}r.__esModule=!0;var i=e("../../core"),a=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t.default=e,t}(i),o=e("../Mesh"),s=function(e){return e&&e.__esModule?e:{default:e}}(o),u=function(){function t(e){n(this,t),this.renderer=e}return t.prototype.render=function(e){var t=this.renderer,r=t.context,n=e.worldTransform,i=t.resolution;t.roundPixels?r.setTransform(n.a*i,n.b*i,n.c*i,n.d*i,n.tx*i|0,n.ty*i|0):r.setTransform(n.a*i,n.b*i,n.c*i,n.d*i,n.tx*i,n.ty*i),t.setBlendMode(e.blendMode),e.drawMode===s.default.DRAW_MODES.TRIANGLE_MESH?this._renderTriangleMesh(e):this._renderTriangles(e)},t.prototype._renderTriangleMesh=function(e){for(var t=e.vertices.length/2,r=0;r<t-2;r++){var n=2*r;this._renderDrawTriangle(e,n,n+2,n+4)}},t.prototype._renderTriangles=function(e){for(var t=e.indices,r=t.length,n=0;n<r;n+=3){var i=2*t[n],a=2*t[n+1],o=2*t[n+2];this._renderDrawTriangle(e,i,a,o)}},t.prototype._renderDrawTriangle=function(e,t,r,n){var i=this.renderer.context,a=e.uvs,o=e.vertices,s=e._texture;if(s.valid){var u=s.baseTexture,l=u.source,c=u.width,h=u.height,f=void 0,d=void 0,p=void 0,v=void 0,m=void 0,g=void 0;if(e.uploadUvTransform){var y=e._uvTransform.mapCoord;f=(a[t]*y.a+a[t+1]*y.c+y.tx)*u.width,d=(a[r]*y.a+a[r+1]*y.c+y.tx)*u.width,p=(a[n]*y.a+a[n+1]*y.c+y.tx)*u.width,v=(a[t]*y.b+a[t+1]*y.d+y.ty)*u.height,m=(a[r]*y.b+a[r+1]*y.d+y.ty)*u.height,g=(a[n]*y.b+a[n+1]*y.d+y.ty)*u.height}else f=a[t]*u.width,d=a[r]*u.width,p=a[n]*u.width,v=a[t+1]*u.height,m=a[r+1]*u.height,g=a[n+1]*u.height;var x=o[t],b=o[r],w=o[n],_=o[t+1],T=o[r+1],E=o[n+1];if(e.canvasPadding>0){var M=e.canvasPadding/e.worldTransform.a,S=e.canvasPadding/e.worldTransform.d,A=(x+b+w)/3,R=(_+T+E)/3,P=x-A,C=_-R,O=Math.sqrt(P*P+C*C);x=A+P/O*(O+M),_=R+C/O*(O+S),P=b-A,C=T-R,O=Math.sqrt(P*P+C*C),b=A+P/O*(O+M),T=R+C/O*(O+S),P=w-A,C=E-R,O=Math.sqrt(P*P+C*C),w=A+P/O*(O+M),E=R+C/O*(O+S)}i.save(),i.beginPath(),i.moveTo(x,_),i.lineTo(b,T),i.lineTo(w,E),i.closePath(),i.clip();var L=f*m+v*p+d*g-m*p-v*d-f*g,I=x*m+v*w+b*g-m*w-v*b-x*g,D=f*b+x*p+d*w-b*p-x*d-f*w,N=f*m*w+v*b*p+x*d*g-x*m*p-v*d*w-f*b*g,F=_*m+v*E+T*g-m*E-v*T-_*g,B=f*T+_*p+d*E-T*p-_*d-f*E,U=f*m*E+v*T*p+_*d*g-_*m*p-v*d*E-f*T*g;i.transform(I/L,F/L,D/L,B/L,N/L,U/L),i.drawImage(l,0,0,c*u.resolution,h*u.resolution,0,0,c,h),i.restore(),this.renderer.invalidateBlendMode()}},t.prototype.renderMeshFlat=function(e){var t=this.renderer.context,r=e.vertices,n=r.length/2;t.beginPath();for(var i=1;i<n-2;++i){var a=2*i,o=r[a],s=r[a+1],u=r[a+2],l=r[a+3],c=r[a+4],h=r[a+5];t.moveTo(o,s),t.lineTo(u,l),t.lineTo(c,h)}t.fillStyle="#FF0000",t.fill(),t.closePath()},t.prototype.destroy=function(){this.renderer=null},t}();r.default=u,a.CanvasRenderer.registerPlugin("mesh",u)},{"../../core":65,"../Mesh":166}],171:[function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}r.__esModule=!0;var i=e("./Mesh");Object.defineProperty(r,"Mesh",{enumerable:!0,get:function(){return n(i).default}});var a=e("./webgl/MeshRenderer");Object.defineProperty(r,"MeshRenderer",{enumerable:!0,get:function(){return n(a).default}});var o=e("./canvas/CanvasMeshRenderer");Object.defineProperty(r,"CanvasMeshRenderer",{enumerable:!0,get:function(){return n(o).default}});var s=e("./Plane");Object.defineProperty(r,"Plane",{enumerable:!0,get:function(){return n(s).default}});var u=e("./NineSlicePlane");Object.defineProperty(r,"NineSlicePlane",{enumerable:!0,get:function(){return n(u).default}});var l=e("./Rope");Object.defineProperty(r,"Rope",{enumerable:!0,get:function(){return n(l).default}})},{"./Mesh":166,"./NineSlicePlane":167,"./Plane":168,"./Rope":169,"./canvas/CanvasMeshRenderer":170,"./webgl/MeshRenderer":172}],172:[function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function o(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}r.__esModule=!0;var s=e("../../core"),u=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t.default=e,t}(s),l=e("pixi-gl-core"),c=n(l),h=e("../Mesh"),f=n(h),d=(e("path"),u.Matrix.IDENTITY),p=function(r){function n(e){i(this,n);var t=a(this,r.call(this,e));return t.shader=null,t}return o(n,r),n.prototype.onContextChange=function(){var e=this.renderer.gl;this.shader=new u.Shader(e,"attribute vec2 aVertexPosition;\nattribute vec2 aTextureCoord;\n\nuniform mat3 projectionMatrix;\nuniform mat3 translationMatrix;\nuniform mat3 uTransform;\n\nvarying vec2 vTextureCoord;\n\nvoid main(void)\n{\n    gl_Position = vec4((projectionMatrix * translationMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);\n\n    vTextureCoord = (uTransform * vec3(aTextureCoord, 1.0)).xy;\n}\n","varying vec2 vTextureCoord;\nuniform vec4 uColor;\n\nuniform sampler2D uSampler;\n\nvoid main(void)\n{\n    gl_FragColor = texture2D(uSampler, vTextureCoord) * uColor;\n}\n")},n.prototype.render=function(e){var t=this.renderer,r=t.gl,n=e._texture;if(n.valid){var i=e._glDatas[t.CONTEXT_UID];i||(t.bindVao(null),i={shader:this.shader,vertexBuffer:c.default.GLBuffer.createVertexBuffer(r,e.vertices,r.STREAM_DRAW),uvBuffer:c.default.GLBuffer.createVertexBuffer(r,e.uvs,r.STREAM_DRAW),indexBuffer:c.default.GLBuffer.createIndexBuffer(r,e.indices,r.STATIC_DRAW),vao:null,dirty:e.dirty,indexDirty:e.indexDirty},i.vao=new c.default.VertexArrayObject(r).addIndex(i.indexBuffer).addAttribute(i.vertexBuffer,i.shader.attributes.aVertexPosition,r.FLOAT,!1,8,0).addAttribute(i.uvBuffer,i.shader.attributes.aTextureCoord,r.FLOAT,!1,8,0),e._glDatas[t.CONTEXT_UID]=i),t.bindVao(i.vao),e.dirty!==i.dirty&&(i.dirty=e.dirty,i.uvBuffer.upload(e.uvs)),e.indexDirty!==i.indexDirty&&(i.indexDirty=e.indexDirty,i.indexBuffer.upload(e.indices)),i.vertexBuffer.upload(e.vertices),t.bindShader(i.shader),i.shader.uniforms.uSampler=t.bindTexture(n),t.state.setBlendMode(u.utils.correctBlendMode(e.blendMode,n.baseTexture.premultipliedAlpha)),i.shader.uniforms.uTransform&&(e.uploadUvTransform?i.shader.uniforms.uTransform=e._uvTransform.mapCoord.toArray(!0):i.shader.uniforms.uTransform=d.toArray(!0)),i.shader.uniforms.translationMatrix=e.worldTransform.toArray(!0),i.shader.uniforms.uColor=u.utils.premultiplyRgba(e.tintRgb,e.worldAlpha,i.shader.uniforms.uColor,n.baseTexture.premultipliedAlpha);var a=e.drawMode===f.default.DRAW_MODES.TRIANGLE_MESH?r.TRIANGLE_STRIP:r.TRIANGLES;i.vao.draw(a,e.indices.length,0)}},n}(u.ObjectRenderer);r.default=p,u.WebGLRenderer.registerPlugin("mesh",p)},{"../../core":65,"../Mesh":166,path:23,"pixi-gl-core":12}],173:[function(e,t,r){"use strict";function s(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function u(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function n(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}r.__esModule=!0;var i=function(){function n(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(e,t,r){return t&&n(e.prototype,t),r&&n(e,r),e}}(),a=e("../core"),l=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t.default=e,t}(a),c=e("../core/utils"),o=function(a){function o(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1500,t=arguments[1],r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:16384,n=arguments.length>3&&void 0!==arguments[3]&&arguments[3];s(this,o);var i=u(this,a.call(this));return r>16384&&(r=16384),r>e&&(r=e),i._properties=[!1,!0,!1,!1,!1],i._maxSize=e,i._batchSize=r,i._glBuffers={},i._bufferToUpdate=0,i.interactiveChildren=!1,i.blendMode=l.BLEND_MODES.NORMAL,i.autoResize=n,i.roundPixels=!0,i.baseTexture=null,i.setProperties(t),i._tint=0,i.tintRgb=new Float32Array(4),i.tint=16777215,i}return n(o,a),o.prototype.setProperties=function(e){e&&(this._properties[0]="scale"in e?!!e.scale:this._properties[0],this._properties[1]="position"in e?!!e.position:this._properties[1],this._properties[2]="rotation"in e?!!e.rotation:this._properties[2],this._properties[3]="uvs"in e?!!e.uvs:this._properties[3],this._properties[4]="alpha"in e||"tint"in e?!!e.alpha||!!e.tint:this._properties[4])},o.prototype.updateTransform=function(){this.displayObjectUpdateTransform()},o.prototype.renderWebGL=function(e){var t=this;this.visible&&!(this.worldAlpha<=0)&&this.children.length&&this.renderable&&(this.baseTexture||(this.baseTexture=this.children[0]._texture.baseTexture,this.baseTexture.hasLoaded||this.baseTexture.once("update",function(){return t.onChildrenChange(0)})),e.setObjectRenderer(e.plugins.particle),e.plugins.particle.render(this))},o.prototype.onChildrenChange=function(e){var t=Math.floor(e/this._batchSize);t<this._bufferToUpdate&&(this._bufferToUpdate=t)},o.prototype.renderCanvas=function(e){if(this.visible&&!(this.worldAlpha<=0)&&this.children.length&&this.renderable){var t=e.context,r=this.worldTransform,n=!0,i=0,a=0,o=0,s=0;e.setBlendMode(this.blendMode),t.globalAlpha=this.worldAlpha,this.displayObjectUpdateTransform();for(var u=0;u<this.children.length;++u){var l=this.children[u];if(l.visible){var c=l._texture.frame;if(t.globalAlpha=this.worldAlpha*l.alpha,l.rotation%(2*Math.PI)==0)n&&(t.setTransform(r.a,r.b,r.c,r.d,r.tx*e.resolution,r.ty*e.resolution),n=!1),i=l.anchor.x*(-c.width*l.scale.x)+l.position.x+.5,a=l.anchor.y*(-c.height*l.scale.y)+l.position.y+.5,o=c.width*l.scale.x,s=c.height*l.scale.y;else{n||(n=!0),l.displayObjectUpdateTransform();var h=l.worldTransform;e.roundPixels?t.setTransform(h.a,h.b,h.c,h.d,h.tx*e.resolution|0,h.ty*e.resolution|0):t.setTransform(h.a,h.b,h.c,h.d,h.tx*e.resolution,h.ty*e.resolution),i=l.anchor.x*-c.width+.5,a=l.anchor.y*-c.height+.5,o=c.width,s=c.height}var f=l._texture.baseTexture.resolution;t.drawImage(l._texture.baseTexture.source,c.x*f,c.y*f,c.width*f,c.height*f,i*e.resolution,a*e.resolution,o*e.resolution,s*e.resolution)}}}},o.prototype.destroy=function(e){if(a.prototype.destroy.call(this,e),this._buffers)for(var t=0;t<this._buffers.length;++t)this._buffers[t].destroy();this._properties=null,this._buffers=null},i(o,[{key:"tint",get:function(){return this._tint},set:function(e){this._tint=e,(0,c.hex2rgb)(e,this.tintRgb)}}]),o}(l.Container);r.default=o},{"../core":65,"../core/utils":125}],174:[function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}r.__esModule=!0;var i=e("./ParticleContainer");Object.defineProperty(r,"ParticleContainer",{enumerable:!0,get:function(){return n(i).default}});var a=e("./webgl/ParticleRenderer");Object.defineProperty(r,"ParticleRenderer",{enumerable:!0,get:function(){return n(a).default}})},{"./ParticleContainer":173,"./webgl/ParticleRenderer":176}],175:[function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function s(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}r.__esModule=!0;var i=e("pixi-gl-core"),d=n(i),a=e("../../core/utils/createIndicesForQuads"),p=n(a),o=function(){function o(e,t,r,n){s(this,o),this.gl=e,this.size=n,this.dynamicProperties=[],this.staticProperties=[];for(var i=0;i<t.length;++i){var a=t[i];a={attribute:a.attribute,size:a.size,uploadFunction:a.uploadFunction,unsignedByte:a.unsignedByte,offset:a.offset},r[i]?this.dynamicProperties.push(a):this.staticProperties.push(a)}this.staticStride=0,this.staticBuffer=null,this.staticData=null,this.staticDataUint32=null,this.dynamicStride=0,this.dynamicBuffer=null,this.dynamicData=null,this.dynamicDataUint32=null,this.initBuffers()}return o.prototype.initBuffers=function(){var e=this.gl,t=0;this.indices=(0,p.default)(this.size),this.indexBuffer=d.default.GLBuffer.createIndexBuffer(e,this.indices,e.STATIC_DRAW),this.dynamicStride=0;for(var r=0;r<this.dynamicProperties.length;++r){var n=this.dynamicProperties[r];n.offset=t,t+=n.size,this.dynamicStride+=n.size}var i=new ArrayBuffer(this.size*this.dynamicStride*4*4);this.dynamicData=new Float32Array(i),this.dynamicDataUint32=new Uint32Array(i),this.dynamicBuffer=d.default.GLBuffer.createVertexBuffer(e,i,e.STREAM_DRAW);var a=0;this.staticStride=0;for(var o=0;o<this.staticProperties.length;++o){var s=this.staticProperties[o];s.offset=a,a+=s.size,this.staticStride+=s.size}var u=new ArrayBuffer(this.size*this.staticStride*4*4);this.staticData=new Float32Array(u),this.staticDataUint32=new Uint32Array(u),this.staticBuffer=d.default.GLBuffer.createVertexBuffer(e,u,e.STATIC_DRAW),this.vao=new d.default.VertexArrayObject(e).addIndex(this.indexBuffer);for(var l=0;l<this.dynamicProperties.length;++l){var c=this.dynamicProperties[l];c.unsignedByte?this.vao.addAttribute(this.dynamicBuffer,c.attribute,e.UNSIGNED_BYTE,!0,4*this.dynamicStride,4*c.offset):this.vao.addAttribute(this.dynamicBuffer,c.attribute,e.FLOAT,!1,4*this.dynamicStride,4*c.offset)}for(var h=0;h<this.staticProperties.length;++h){var f=this.staticProperties[h];f.unsignedByte?this.vao.addAttribute(this.staticBuffer,f.attribute,e.UNSIGNED_BYTE,!0,4*this.staticStride,4*f.offset):this.vao.addAttribute(this.staticBuffer,f.attribute,e.FLOAT,!1,4*this.staticStride,4*f.offset)}},o.prototype.uploadDynamic=function(e,t,r){for(var n=0;n<this.dynamicProperties.length;n++){var i=this.dynamicProperties[n];i.uploadFunction(e,t,r,i.unsignedByte?this.dynamicDataUint32:this.dynamicData,this.dynamicStride,i.offset)}this.dynamicBuffer.upload()},o.prototype.uploadStatic=function(e,t,r){for(var n=0;n<this.staticProperties.length;n++){var i=this.staticProperties[n];i.uploadFunction(e,t,r,i.unsignedByte?this.staticDataUint32:this.staticData,this.staticStride,i.offset)}this.staticBuffer.upload()},o.prototype.destroy=function(){this.dynamicProperties=null,this.dynamicData=null,this.dynamicBuffer.destroy(),this.staticProperties=null,this.staticData=null,this.staticBuffer.destroy()},o}();r.default=o},{"../../core/utils/createIndicesForQuads":123,"pixi-gl-core":12}],176:[function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function o(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}r.__esModule=!0;var s=e("../../core"),p=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t.default=e,t}(s),u=e("./ParticleShader"),l=n(u),c=e("./ParticleBuffer"),h=n(c),f=e("../../core/utils"),d=function(r){function n(e){i(this,n);var t=a(this,r.call(this,e));return t.shader=null,t.indexBuffer=null,t.properties=null,t.tempMatrix=new p.Matrix,t.CONTEXT_UID=0,t}return o(n,r),n.prototype.onContextChange=function(){var e=this.renderer.gl;this.CONTEXT_UID=this.renderer.CONTEXT_UID,this.shader=new l.default(e),this.properties=[{attribute:this.shader.attributes.aVertexPosition,size:2,uploadFunction:this.uploadVertices,offset:0},{attribute:this.shader.attributes.aPositionCoord,size:2,uploadFunction:this.uploadPosition,offset:0},{attribute:this.shader.attributes.aRotation,size:1,uploadFunction:this.uploadRotation,offset:0},{attribute:this.shader.attributes.aTextureCoord,size:2,uploadFunction:this.uploadUvs,offset:0},{attribute:this.shader.attributes.aColor,size:1,unsignedByte:!0,uploadFunction:this.uploadTint,offset:0}]},n.prototype.start=function(){this.renderer.bindShader(this.shader)},n.prototype.render=function(e){var t=e.children,r=e._maxSize,n=e._batchSize,i=this.renderer,a=t.length;if(0!==a){a>r&&(a=r);var o=e._glBuffers[i.CONTEXT_UID];o||(o=e._glBuffers[i.CONTEXT_UID]=this.generateBuffers(e));var s=t[0]._texture.baseTexture;this.renderer.setBlendMode(p.utils.correctBlendMode(e.blendMode,s.premultipliedAlpha));var u=i.gl,l=e.worldTransform.copy(this.tempMatrix);l.prepend(i._activeRenderTarget.projectionMatrix),this.shader.uniforms.projectionMatrix=l.toArray(!0),this.shader.uniforms.uColor=p.utils.premultiplyRgba(e.tintRgb,e.worldAlpha,this.shader.uniforms.uColor,s.premultipliedAlpha),this.shader.uniforms.uSampler=i.bindTexture(s);for(var c=0,h=0;c<a;c+=n,h+=1){var f=a-c;if(f>n&&(f=n),h>=o.length){if(!e.autoResize)break;o.push(this._generateOneMoreBuffer(e))}var d=o[h];d.uploadDynamic(t,c,f),e._bufferToUpdate===h&&(d.uploadStatic(t,c,f),e._bufferToUpdate=h+1),i.bindVao(d.vao),d.vao.draw(u.TRIANGLES,6*f)}}},n.prototype.generateBuffers=function(e){for(var t=this.renderer.gl,r=[],n=e._maxSize,i=e._batchSize,a=e._properties,o=0;o<n;o+=i)r.push(new h.default(t,this.properties,a,i));return r},n.prototype._generateOneMoreBuffer=function(e){var t=this.renderer.gl,r=e._batchSize,n=e._properties;return new h.default(t,this.properties,n,r)},n.prototype.uploadVertices=function(e,t,r,n,i,a){for(var o=0,s=0,u=0,l=0,c=0;c<r;++c){var h=e[t+c],f=h._texture,d=h.scale.x,p=h.scale.y,v=f.trim,m=f.orig;v?(s=v.x-h.anchor.x*m.width,o=s+v.width,l=v.y-h.anchor.y*m.height,u=l+v.height):(o=m.width*(1-h.anchor.x),s=m.width*-h.anchor.x,u=m.height*(1-h.anchor.y),l=m.height*-h.anchor.y),n[a]=s*d,n[a+1]=l*p,n[a+i]=o*d,n[a+i+1]=l*p,n[a+2*i]=o*d,n[a+2*i+1]=u*p,n[a+3*i]=s*d,n[a+3*i+1]=u*p,a+=4*i}},n.prototype.uploadPosition=function(e,t,r,n,i,a){for(var o=0;o<r;o++){var s=e[t+o].position;n[a]=s.x,n[a+1]=s.y,n[a+i]=s.x,n[a+i+1]=s.y,n[a+2*i]=s.x,n[a+2*i+1]=s.y,n[a+3*i]=s.x,n[a+3*i+1]=s.y,a+=4*i}},n.prototype.uploadRotation=function(e,t,r,n,i,a){for(var o=0;o<r;o++){var s=e[t+o].rotation;n[a]=s,n[a+i]=s,n[a+2*i]=s,n[a+3*i]=s,a+=4*i}},n.prototype.uploadUvs=function(e,t,r,n,i,a){for(var o=0;o<r;++o){var s=e[t+o]._texture._uvs;s?(n[a]=s.x0,n[a+1]=s.y0,n[a+i]=s.x1,n[a+i+1]=s.y1,n[a+2*i]=s.x2,n[a+2*i+1]=s.y2,n[a+3*i]=s.x3,n[a+3*i+1]=s.y3,a+=4*i):(n[a]=0,n[a+1]=0,n[a+i]=0,n[a+i+1]=0,n[a+2*i]=0,n[a+2*i+1]=0,n[a+3*i]=0,n[a+3*i+1]=0,a+=4*i)}},n.prototype.uploadTint=function(e,t,r,n,i,a){for(var o=0;o<r;++o){var s=e[t+o],u=s._texture.baseTexture.premultipliedAlpha,l=s.alpha,c=l<1&&u?(0,f.premultiplyTint)(s._tintRGB,l):s._tintRGB+(255*l<<24);n[a]=c,n[a+i]=c,n[a+2*i]=c,n[a+3*i]=c,a+=4*i}},n.prototype.destroy=function(){this.renderer.gl&&this.renderer.gl.deleteBuffer(this.indexBuffer),r.prototype.destroy.call(this),this.shader.destroy(),this.indices=null,this.tempMatrix=null},n}(p.ObjectRenderer);r.default=d,p.WebGLRenderer.registerPlugin("particle",d)},{"../../core":65,"../../core/utils":125,"./ParticleBuffer":175,"./ParticleShader":177}],177:[function(e,t,r){"use strict";function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}r.__esModule=!0;var o=e("../../core/Shader"),s=function(e){return e&&e.__esModule?e:{default:e}}(o),u=function(t){function r(e){return n(this,r),i(this,t.call(this,e,["attribute vec2 aVertexPosition;","attribute vec2 aTextureCoord;","attribute vec4 aColor;","attribute vec2 aPositionCoord;","attribute vec2 aScale;","attribute float aRotation;","uniform mat3 projectionMatrix;","uniform vec4 uColor;","varying vec2 vTextureCoord;","varying vec4 vColor;","void main(void){","   vec2 v = aVertexPosition;","   v.x = (aVertexPosition.x) * cos(aRotation) - (aVertexPosition.y) * sin(aRotation);","   v.y = (aVertexPosition.x) * sin(aRotation) + (aVertexPosition.y) * cos(aRotation);","   v = v + aPositionCoord;","   gl_Position = vec4((projectionMatrix * vec3(v, 1.0)).xy, 0.0, 1.0);","   vTextureCoord = aTextureCoord;","   vColor = aColor * uColor;","}"].join("\n"),["varying vec2 vTextureCoord;","varying vec4 vColor;","uniform sampler2D uSampler;","void main(void){","  vec4 color = texture2D(uSampler, vTextureCoord) * vColor;","  if (color.a == 0.0) discard;","  gl_FragColor = color;","}"].join("\n")))}return a(r,t),r}(s.default);r.default=u},{"../../core/Shader":44}],178:[function(e,t,r){"use strict";Math.sign||(Math.sign=function(e){return e=Number(e),0===e||isNaN(e)?e:e>0?1:-1})},{}],179:[function(e,t,r){"use strict";var n=e("object-assign"),i=function(e){return e&&e.__esModule?e:{default:e}}(n);Object.assign||(Object.assign=i.default)},{"object-assign":5}],180:[function(e,t,r){"use strict";e("./Object.assign"),e("./requestAnimationFrame"),e("./Math.sign"),window.ArrayBuffer||(window.ArrayBuffer=Array),window.Float32Array||(window.Float32Array=Array),window.Uint32Array||(window.Uint32Array=Array),window.Uint16Array||(window.Uint16Array=Array)},{"./Math.sign":178,"./Object.assign":179,"./requestAnimationFrame":181}],181:[function(e,t,r){(function(e){"use strict";if(Date.now&&Date.prototype.getTime||(Date.now=function(){return(new Date).getTime()}),!e.performance||!e.performance.now){var t=Date.now();e.performance||(e.performance={}),e.performance.now=function(){return Date.now()-t}}for(var n=Date.now(),r=["ms","moz","webkit","o"],i=0;i<r.length&&!e.requestAnimationFrame;++i){var a=r[i];e.requestAnimationFrame=e[a+"RequestAnimationFrame"],e.cancelAnimationFrame=e[a+"CancelAnimationFrame"]||e[a+"CancelRequestAnimationFrame"]}e.requestAnimationFrame||(e.requestAnimationFrame=function(e){if("function"!=typeof e)throw new TypeError(e+"is not a function");var t=Date.now(),r=16+n-t;return r<0&&(r=0),n=t,setTimeout(function(){n=Date.now(),e(performance.now())},r)}),e.cancelAnimationFrame||(e.cancelAnimationFrame=function(e){return clearTimeout(e)})}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],182:[function(e,t,r){"use strict";function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){var r=!1;if(e&&e._textures&&e._textures.length)for(var n=0;n<e._textures.length;n++)if(e._textures[n]instanceof f.Texture){var i=e._textures[n].baseTexture;-1===t.indexOf(i)&&(t.push(i),r=!0)}return r}function a(e,t){return e instanceof f.BaseTexture&&(-1===t.indexOf(e)&&t.push(e),!0)}function o(e,t){if(e._texture&&e._texture instanceof f.Texture){var r=e._texture.baseTexture;return-1===t.indexOf(r)&&t.push(r),!0}return!1}function s(e,t){return t instanceof f.Text&&(t.updateText(!0),!0)}function u(e,t){if(t instanceof f.TextStyle){var r=t.toFontString();return f.TextMetrics.measureFont(r),!0}return!1}function l(e,t){if(e instanceof f.Text){-1===t.indexOf(e.style)&&t.push(e.style),-1===t.indexOf(e)&&t.push(e);var r=e._texture.baseTexture;return-1===t.indexOf(r)&&t.push(r),!0}return!1}function c(e,t){return e instanceof f.TextStyle&&(-1===t.indexOf(e)&&t.push(e),!0)}r.__esModule=!0;var h=e("../core"),f=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t.default=e,t}(h),d=e("./limiters/CountLimiter"),p=function(e){return e&&e.__esModule?e:{default:e}}(d),v=f.ticker.shared;f.settings.UPLOADS_PER_FRAME=4;var m=function(){function r(e){var t=this;n(this,r),this.limiter=new p.default(f.settings.UPLOADS_PER_FRAME),this.renderer=e,this.uploadHookHelper=null,this.queue=[],this.addHooks=[],this.uploadHooks=[],this.completes=[],this.ticking=!1,this.delayedTick=function(){t.queue&&t.prepareItems()},this.registerFindHook(l),this.registerFindHook(c),this.registerFindHook(i),this.registerFindHook(a),this.registerFindHook(o),this.registerUploadHook(s),this.registerUploadHook(u)}return r.prototype.upload=function(e,t){"function"==typeof e&&(t=e,e=null),e&&this.add(e),this.queue.length?(t&&this.completes.push(t),this.ticking||(this.ticking=!0,v.addOnce(this.tick,this,f.UPDATE_PRIORITY.UTILITY))):t&&t()},r.prototype.tick=function(){setTimeout(this.delayedTick,0)},r.prototype.prepareItems=function(){for(this.limiter.beginFrame();this.queue.length&&this.limiter.allowedToUpload();){var e=this.queue[0],t=!1;if(e&&!e._destroyed)for(var r=0,n=this.uploadHooks.length;r<n;r++)if(this.uploadHooks[r](this.uploadHookHelper,e)){this.queue.shift(),t=!0;break}t||this.queue.shift()}if(this.queue.length)v.addOnce(this.tick,this,f.UPDATE_PRIORITY.UTILITY);else{this.ticking=!1;var i=this.completes.slice(0);this.completes.length=0;for(var a=0,o=i.length;a<o;a++)i[a]()}},r.prototype.registerFindHook=function(e){return e&&this.addHooks.push(e),this},r.prototype.registerUploadHook=function(e){return e&&this.uploadHooks.push(e),this},r.prototype.add=function(e){for(var t=0,r=this.addHooks.length;t<r&&!this.addHooks[t](e,this.queue);t++);if(e instanceof f.Container)for(var n=e.children.length-1;n>=0;n--)this.add(e.children[n]);return this},r.prototype.destroy=function(){this.ticking&&v.remove(this.tick,this),this.ticking=!1,this.addHooks=null,this.uploadHooks=null,this.renderer=null,this.completes=null,this.queue=null,this.limiter=null,this.uploadHookHelper=null},r}();r.default=m},{"../core":65,"./limiters/CountLimiter":185}],183:[function(e,t,r){"use strict";function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function o(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}function s(e,t){if(t instanceof u.BaseTexture){var r=t.source,n=0===r.width?e.canvas.width:Math.min(e.canvas.width,r.width),i=0===r.height?e.canvas.height:Math.min(e.canvas.height,r.height);return e.ctx.drawImage(r,0,0,n,i,0,0,e.canvas.width,e.canvas.height),!0}return!1}r.__esModule=!0;var n=e("../../core"),u=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t.default=e,t}(n),l=e("../BasePrepare"),c=function(e){return e&&e.__esModule?e:{default:e}}(l),h=16,f=function(r){function n(e){i(this,n);var t=a(this,r.call(this,e));return t.uploadHookHelper=t,t.canvas=document.createElement("canvas"),t.canvas.width=h,t.canvas.height=h,t.ctx=t.canvas.getContext("2d"),t.registerUploadHook(s),t}return o(n,r),n.prototype.destroy=function(){r.prototype.destroy.call(this),this.ctx=null,this.canvas=null},n}(c.default);r.default=f,u.CanvasRenderer.registerPlugin("prepare",f)},{"../../core":65,"../BasePrepare":182}],184:[function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}r.__esModule=!0;var i=e("./webgl/WebGLPrepare");Object.defineProperty(r,"webgl",{enumerable:!0,get:function(){return n(i).default}});var a=e("./canvas/CanvasPrepare");Object.defineProperty(r,"canvas",{enumerable:!0,get:function(){return n(a).default}});var o=e("./BasePrepare");Object.defineProperty(r,"BasePrepare",{enumerable:!0,get:function(){return n(o).default}});var s=e("./limiters/CountLimiter");Object.defineProperty(r,"CountLimiter",{enumerable:!0,get:function(){return n(s).default}});var u=e("./limiters/TimeLimiter");Object.defineProperty(r,"TimeLimiter",{enumerable:!0,get:function(){return n(u).default}})},{"./BasePrepare":182,"./canvas/CanvasPrepare":183,"./limiters/CountLimiter":185,"./limiters/TimeLimiter":186,"./webgl/WebGLPrepare":187}],185:[function(e,t,r){"use strict";function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}r.__esModule=!0;var i=function(){function t(e){n(this,t),this.maxItemsPerFrame=e,this.itemsLeft=0}return t.prototype.beginFrame=function(){this.itemsLeft=this.maxItemsPerFrame},t.prototype.allowedToUpload=function(){return this.itemsLeft-- >0},t}();r.default=i},{}],186:[function(e,t,r){"use strict";function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}r.__esModule=!0;var i=function(){function t(e){n(this,t),this.maxMilliseconds=e,this.frameStart=0}return t.prototype.beginFrame=function(){this.frameStart=Date.now()},t.prototype.allowedToUpload=function(){return Date.now()-this.frameStart<this.maxMilliseconds},t}();r.default=i},{}],187:[function(e,t,r){"use strict";function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function o(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}function s(e,t){return t instanceof c.BaseTexture&&(t._glTextures[e.CONTEXT_UID]||e.textureManager.updateTexture(t),!0)}function u(e,t){return t instanceof c.Graphics&&((t.dirty||t.clearDirty||!t._webGL[e.plugins.graphics.CONTEXT_UID])&&e.plugins.graphics.updateGraphics(t),!0)}function l(e,t){return e instanceof c.Graphics&&(t.push(e),!0)}r.__esModule=!0;var n=e("../../core"),c=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t.default=e,t}(n),h=e("../BasePrepare"),f=function(e){return e&&e.__esModule?e:{default:e}}(h),d=function(r){function n(e){i(this,n);var t=a(this,r.call(this,e));return t.uploadHookHelper=t.renderer,t.registerFindHook(l),t.registerUploadHook(s),t.registerUploadHook(u),t}return o(n,r),n}(f.default);r.default=d,c.WebGLRenderer.registerPlugin("prepare",d)},{"../../core":65,"../BasePrepare":182}],188:[function(M,e,S){(function(e){"use strict";function t(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t.default=e,t}S.__esModule=!0,S.loader=S.prepare=S.particles=S.mesh=S.loaders=S.interaction=S.filters=S.extras=S.extract=S.accessibility=void 0;var r=M("./polyfill");Object.keys(r).forEach(function(e){"default"!==e&&"__esModule"!==e&&Object.defineProperty(S,e,{enumerable:!0,get:function(){return r[e]}})});var n=M("./core");Object.keys(n).forEach(function(e){"default"!==e&&"__esModule"!==e&&Object.defineProperty(S,e,{enumerable:!0,get:function(){return n[e]}})});var i=M("./deprecation"),a=function(e){return e&&e.__esModule?e:{default:e}}(i),o=M("./accessibility"),s=t(o),u=M("./extract"),l=t(u),c=M("./extras"),h=t(c),f=M("./filters"),d=t(f),p=M("./interaction"),v=t(p),m=M("./loaders"),g=t(m),y=M("./mesh"),x=t(y),b=M("./particles"),w=t(b),_=M("./prepare"),T=t(_);n.utils.mixins.performMixins();var E=g.shared||null;S.accessibility=s,S.extract=l,S.extras=h,S.filters=d,S.interaction=v,S.loaders=g,S.mesh=x,S.particles=w,S.prepare=T,S.loader=E,"function"==typeof a.default&&(0,a.default)(S),e.PIXI=S}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"./accessibility":42,"./core":65,"./deprecation":131,"./extract":133,"./extras":141,"./filters":153,"./interaction":159,"./loaders":162,"./mesh":171,"./particles":174,"./polyfill":180,"./prepare":184}]},{},[188])(188)});(function(){"use strict";var t,r=[];function e(e){r.push(e);1==r.length&&t()}function n(){for(;r.length;)r[0](),r.shift()}t=function(){setTimeout(n)};function a(e){this.a=o;this.b=void 0;this.f=[];var t=this;try{e(function(e){u(t,e)},function(e){l(t,e)})}catch(e){l(t,e)}}var o=2;function i(r){return new a(function(e,t){t(r)})}function s(t){return new a(function(e){e(t)})}function u(t,e){if(t.a==o){if(e==t)throw new TypeError;var r=!1;try{var n=e&&e.then;if(null!=e&&"object"==typeof e&&"function"==typeof n){n.call(e,function(e){r||u(t,e);r=!0},function(e){r||l(t,e);r=!0});return}}catch(e){r||l(t,e);return}t.a=0;t.b=e;c(t)}}function l(e,t){if(e.a==o){if(t==e)throw new TypeError;e.a=1;e.b=t;c(e)}}function c(i){e(function(){if(i.a!=o)for(;i.f.length;){var t=i.f.shift(),e=t[0],r=t[1],n=t[2],t=t[3];try{0==i.a?"function"==typeof e?n(e.call(void 0,i.b)):n(i.b):1==i.a&&("function"==typeof r?n(r.call(void 0,i.b)):t(i.b))}catch(e){t(e)}}})}a.prototype.g=function(e){return this.c(void 0,e)};a.prototype.c=function(r,n){var i=this;return new a(function(e,t){i.f.push([r,n,e,t]);c(i)})};function h(o){return new a(function(r,e){function t(t){return function(e){i[t]=e;n+=1;n==o.length&&r(i)}}var n=0,i=[];0==o.length&&r(i);for(var a=0;a<o.length;a+=1)s(o[a]).c(t(a),e)})}function f(n){return new a(function(e,t){for(var r=0;r<n.length;r+=1)s(n[r]).c(e,t)})}window.Promise||(window.Promise=a,window.Promise.resolve=s,window.Promise.reject=i,window.Promise.race=f,window.Promise.all=h,window.Promise.prototype.then=a.prototype.c,window.Promise.prototype["catch"]=a.prototype.g)})();(function(){function i(e,t){document.addEventListener?e.addEventListener("scroll",t,!1):e.attachEvent("scroll",t)}function r(t){document.body?t():document.addEventListener?document.addEventListener("DOMContentLoaded",function e(){document.removeEventListener("DOMContentLoaded",e);t()}):document.attachEvent("onreadystatechange",function e(){if("interactive"==document.readyState||"complete"==document.readyState)document.detachEvent("onreadystatechange",e),t()})}function b(e){this.a=document.createElement("div");this.a.setAttribute("aria-hidden","true");this.a.appendChild(document.createTextNode(e));this.b=document.createElement("span");this.c=document.createElement("span");this.h=document.createElement("span");this.f=document.createElement("span");this.g=-1;this.b.style.cssText="max-width:none;display:inline-block;position:absolute;height:100%;width:100%;overflow:scroll;font-size:16px;";this.c.style.cssText="max-width:none;display:inline-block;position:absolute;height:100%;width:100%;overflow:scroll;font-size:16px;";this.f.style.cssText="max-width:none;display:inline-block;position:absolute;height:100%;width:100%;overflow:scroll;font-size:16px;";this.h.style.cssText="display:inline-block;width:200%;height:200%;font-size:16px;max-width:none;";this.b.appendChild(this.h);this.c.appendChild(this.f);this.a.appendChild(this.b);this.a.appendChild(this.c)}function w(e,t){e.a.style.cssText="max-width:none;min-width:20px;min-height:20px;display:inline-block;overflow:hidden;position:absolute;width:auto;margin:0;padding:0;top:-999px;white-space:nowrap;font-synthesis:none;font:"+t+";"}function a(e){var t=e.a.offsetWidth,r=t+100;e.f.style.width=r+"px";e.c.scrollLeft=r;e.b.scrollLeft=e.b.scrollWidth+100;return e.g!==t?(e.g=t,!0):!1}function _(e,t){function r(){var e=n;a(e)&&e.a.parentNode&&t(e.g)}var n=e;i(e.b,r);i(e.c,r);a(e)}function e(e,t){var r=t||{};this.family=e;this.style=r.style||"normal";this.weight=r.weight||"normal";this.stretch=r.stretch||"normal"}var T=null,t=null,n=null,o=null;function s(){if(null===t)if(u()&&/Apple/.test(window.navigator.vendor)){var e=/AppleWebKit\/([0-9]+)(?:\.([0-9]+))(?:\.([0-9]+))/.exec(window.navigator.userAgent);t=!!e&&603>parseInt(e[1],10)}else t=!1;return t}function u(){null===o&&(o=!!document.fonts);return o}function l(){if(null===n){var e=document.createElement("div");try{e.style.font="condensed 100px sans-serif"}catch(e){}n=""!==e.style.font}return n}function E(e,t){return[e.style,e.weight,l()?e.stretch:"","100px",t].join(" ")}e.prototype.load=function(e,t){var v=this,m=e||"BESbswy",g=0,y=t||3e3,x=(new Date).getTime();return new Promise(function(d,p){if(u()&&!s()){var e=new Promise(function(t,e){function r(){(new Date).getTime()-x>=y?e():document.fonts.load(E(v,'"'+v.family+'"'),m).then(function(e){1<=e.length?t():setTimeout(r,25)},function(){e()})}r()}),t=new Promise(function(e,t){g=setTimeout(t,y)});Promise.race([t,e]).then(function(){clearTimeout(g);d(v)},function(){p(v)})}else r(function(){function t(){var e;if(e=-1!=o&&-1!=s||-1!=o&&-1!=u||-1!=s&&-1!=u)(e=o!=s&&o!=u&&s!=u)||(null===T&&(e=/AppleWebKit\/([0-9]+)(?:\.([0-9]+))/.exec(window.navigator.userAgent),T=!!e&&(536>parseInt(e[1],10)||536===parseInt(e[1],10)&&11>=parseInt(e[2],10))),e=T&&(o==l&&s==l&&u==l||o==c&&s==c&&u==c||o==h&&s==h&&u==h)),e=!e;e&&(f.parentNode&&f.parentNode.removeChild(f),clearTimeout(g),d(v))}function r(){if((new Date).getTime()-x>=y)f.parentNode&&f.parentNode.removeChild(f),p(v);else{var e=document.hidden;if(!0===e||void 0===e)o=n.a.offsetWidth,s=i.a.offsetWidth,u=a.a.offsetWidth,t();g=setTimeout(r,50)}}var n=new b(m),i=new b(m),a=new b(m),o=-1,s=-1,u=-1,l=-1,c=-1,h=-1,f=document.createElement("div");f.dir="ltr";w(n,E(v,"sans-serif"));w(i,E(v,"serif"));w(a,E(v,"monospace"));f.appendChild(n.a);f.appendChild(i.a);f.appendChild(a.a);document.body.appendChild(f);l=n.a.offsetWidth;c=i.a.offsetWidth;h=a.a.offsetWidth;r();_(n,function(e){o=e;t()});w(n,E(v,'"'+v.family+'",sans-serif'));_(i,function(e){s=e;t()});w(i,E(v,'"'+v.family+'",serif'));_(a,function(e){u=e;t()});w(a,E(v,'"'+v.family+'",monospace'))})})};"object"===typeof module?module.exports=e:(window.FontFaceObserver=e,window.FontFaceObserver.prototype.load=e.prototype.load)})();(function(){function c(a,o,s){function u(r,e){if(!o[r]){if(!a[r]){var t="function"==typeof require&&require;if(!e&&t)return t(r,!0);if(l)return l(r,!0);var n=new Error("Cannot find module '"+r+"'");throw n.code="MODULE_NOT_FOUND",n}var i=o[r]={exports:{}};a[r][0].call(i.exports,function(e){var t=a[r][1][e];return u(t||e)},i,i.exports,c,a,o,s)}return o[r].exports}for(var l="function"==typeof require&&require,e=0;e<s.length;e++)u(s[e]);return u}return c})()({1:[function(e,t,r){"use strict";var n=i(e("three"));function s(e){if(typeof WeakMap!=="function")return null;var t=new WeakMap;var r=new WeakMap;return(s=function(e){return e?r:t})(e)}function i(e,t){if(!t&&e&&e.__esModule){return e}if(e===null||typeof e!=="object"&&typeof e!=="function"){return{default:e}}var r=s(t);if(r&&r.has(e)){return r.get(e)}var n={};var i=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var a in e){if(a!=="default"&&Object.prototype.hasOwnProperty.call(e,a)){var o=i?Object.getOwnPropertyDescriptor(e,a):null;if(o&&(o.get||o.set)){Object.defineProperty(n,a,o)}else{n[a]=e[a]}}}n.default=e;if(r){r.set(e,n)}return n}window.THREE=n},{three:2}],2:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:true});r.AlwaysStencilFunc=r.AlwaysDepth=r.AlphaFormat=r.AdditiveBlending=r.AddOperation=r.AddEquation=r.ACESFilmicToneMapping=void 0;r.AmbientLight=Ad;r.AmbientLightProbe=Kd;r.AnimationClip=Sf;r.AnimationLoader=Nf;r.AnimationMixer=Pp;r.AnimationObjectGroup=Ap;r.AnimationUtils=void 0;r.ArcCurve=Gf;r.ArrayCamera=Ol;r.ArrowHelper=Cv;r.Audio=sp;r.AudioAnalyser=dp;r.AudioContext=void 0;r.AudioListener=op;r.AudioLoader=Xd;r.AxesHelper=Ov;r.AxisHelper=nm;r.BasicShadowMap=r.BasicDepthPacking=r.BackSide=void 0;r.BinaryTextureLoader=um;r.Bone=hc;r.BooleanKeyframeTrack=xf;r.BoundingBoxHelper=im;r.Box2=Up;r.Box3=cn;r.Box3Helper=Mv;r.BoxGeometry=r.BoxBufferGeometry=void 0;r.BoxHelper=Ev;r.BufferAttribute=Vn;r.BufferGeometry=li;r.BufferGeometryLoader=Id;r.Cache=r.ByteType=void 0;r.Camera=Gi;r.CameraHelper=wv;r.CanvasRenderer=cm;r.CanvasTexture=Ic;r.CatmullRomCurve3=Zf;r.CineonToneMapping=void 0;r.CircleBufferGeometry=$h;r.CircleGeometry=Qh;r.ClampToEdgeWrapping=void 0;r.Clock=tp;r.ClosedSplineCurve3=em;r.Color=Fn;r.ColorKeyframeTrack=bf;r.CompressedTexture=Lc;r.CompressedTextureLoader=Ff;r.ConeBufferGeometry=Kh;r.ConeGeometry=Jh;r.CubeCamera=Xi;r.CubeRefractionMapping=r.CubeReflectionMapping=r.CubeGeometry=void 0;r.CubeTexture=Bs;r.CubeTextureLoader=kf;r.CubeUVRefractionMapping=r.CubeUVReflectionMapping=void 0;r.CubicBezierCurve=od;r.CubicBezierCurve3=sd;r.CubicInterpolant=vf;r.CullFaceNone=r.CullFaceFrontBack=r.CullFaceFront=r.CullFaceBack=void 0;r.Curve=zf;r.CurvePath=pd;r.CustomBlending=void 0;r.CylinderBufferGeometry=Zh;r.CylinderGeometry=Yh;r.Cylindrical=Fp;r.DataTexture=Zi;r.DataTexture2DArray=Us;r.DataTexture3D=ks;r.DataTextureLoader=Bf;r.DepthStencilFormat=r.DepthFormat=r.DefaultLoadingManager=r.DecrementWrapStencilOp=r.DecrementStencilOp=void 0;r.DepthTexture=Dc;r.DirectionalLight=Sd;r.DirectionalLightHelper=yv;r.DirectionalLightShadow=Md;r.DiscreteInterpolant=gf;r.DodecahedronBufferGeometry=Xc;r.DodecahedronGeometry=qc;r.DstColorFactor=r.DstAlphaFactor=r.DoubleSide=void 0;r.DynamicBufferAttribute=Vv;r.EdgesGeometry=Xh;r.EdgesHelper=am;r.EllipseCurve=Hf;r.EquirectangularRefractionMapping=r.EquirectangularReflectionMapping=r.EqualStencilFunc=r.EqualDepth=void 0;r.Euler=Dr;r.EventDispatcher=or;r.ExtrudeBufferGeometry=Ih;r.ExtrudeGeometry=Lh;r.Face3=jn;r.Face4=Lv;r.FaceColors=void 0;r.FaceNormalsHelper=pv;r.FileLoader=Df;r.FlatShading=void 0;r.Float32Attribute=Qv;r.Float32BufferAttribute=Qn;r.Float64Attribute=$v;r.Float64BufferAttribute=$n;r.FloatType=void 0;r.Fog=kl;r.FogExp2=Ul;r.Font=zd;r.FontLoader=Vd;r.FrontSide=r.FrontFaceDirectionCW=r.FrontFaceDirectionCCW=void 0;r.Frustum=ra;r.GammaEncoding=void 0;r.Geometry=Di;r.GreaterStencilFunc=r.GreaterEqualStencilFunc=r.GreaterEqualDepth=r.GreaterDepth=r.GeometryUtils=void 0;r.GridHelper=uv;r.Group=Cl;r.HalfFloatType=void 0;r.HemisphereLight=yd;r.HemisphereLightHelper=ov;r.HemisphereLightProbe=Jd;r.IcosahedronBufferGeometry=Wc;r.IcosahedronGeometry=Vc;r.ImageBitmapLoader=kd;r.ImageLoader=Uf;r.ImageUtils=void 0;r.ImmediateRenderObject=Hp;r.IncrementWrapStencilOp=r.IncrementStencilOp=void 0;r.InstancedBufferAttribute=Ld;r.InstancedBufferGeometry=Od;r.InstancedInterleavedBuffer=Op;r.InstancedMesh=fc;r.Int16Attribute=Yv;r.Int16BufferAttribute=Yn;r.Int32Attribute=Jv;r.Int32BufferAttribute=Jn;r.Int8Attribute=Wv;r.Int8BufferAttribute=Wn;r.IntType=void 0;r.InterleavedBuffer=jl;r.InterleavedBufferAttribute=zl;r.Interpolant=pf;r.InvertStencilOp=r.InterpolateSmooth=r.InterpolateLinear=r.InterpolateDiscrete=void 0;r.JSONLoader=hm;r.KeepStencilOp=void 0;r.KeyframeTrack=yf;r.LOD=oc;r.LatheBufferGeometry=Gh;r.LatheGeometry=Hh;r.Layers=Nr;r.LensFlare=dm;r.LessStencilFunc=r.LessEqualStencilFunc=r.LessEqualDepth=r.LessDepth=void 0;r.Light=gd;r.LightProbe=Zd;r.LightProbeHelper=sv;r.LightShadow=xd;r.Line=xc;r.Line3=zp;r.LineBasicMaterial=dc;r.LineCurve=ud;r.LineCurve3=ld;r.LineDashedMaterial=hf;r.LineLoop=Tc;r.LinePieces=void 0;r.LineSegments=_c;r.LinearFilter=r.LinearEncoding=r.LineStrip=void 0;r.LinearInterpolant=mf;r.LinearMipMapNearestFilter=r.LinearMipMapLinearFilter=void 0;r.LinearToneMapping=r.LinearMipmapNearestFilter=r.LinearMipmapLinearFilter=r.LinearMipMapNearestFilter=r.LinearMipMapLinearFilter=void 0;r.Loader=Lf;r.LoaderUtils=void 0;r.LoadingManager=Cf;r.MOUSE=r.LuminanceFormat=r.LuminanceAlphaFormat=r.LoopRepeat=r.LoopPingPong=r.LoopOnce=r.LogLuvEncoding=void 0;r.Material=Hn;r.MaterialLoader=Pd;r.Math=void 0;r.Matrix3=mr;r.Matrix4=Or;r.MaxEquation=void 0;r.Mesh=Ai;r.MeshBasicMaterial=Gn;r.MeshDepthMaterial=bl;r.MeshDistanceMaterial=wl;r.MeshFaceMaterial=Nv;r.MeshLambertMaterial=lf;r.MeshMatcapMaterial=cf;r.MeshNormalMaterial=uf;r.MeshPhongMaterial=of;r.MeshPhysicalMaterial=af;r.MeshStandardMaterial=nf;r.MeshToonMaterial=sf;r.MixOperation=r.MirroredRepeatWrapping=r.MinEquation=void 0;r.MultiMaterial=Fv;r.NotEqualStencilFunc=r.NotEqualDepth=r.NormalBlending=r.NoToneMapping=r.NoColors=r.NoBlending=r.NeverStencilFunc=r.NeverDepth=r.NearestMipmapNearestFilter=r.NearestMipmapLinearFilter=r.NearestMipMapNearestFilter=r.NearestMipMapLinearFilter=r.NearestFilter=r.MultiplyOperation=r.MultiplyBlending=void 0;r.NumberKeyframeTrack=wf;r.Object3D=Zr;r.ObjectLoader=Nd;r.ObjectSpaceNormalMap=void 0;r.OctahedronBufferGeometry=Gc;r.OctahedronGeometry=Hc;r.OneMinusSrcColorFactor=r.OneMinusSrcAlphaFactor=r.OneMinusDstColorFactor=r.OneMinusDstAlphaFactor=r.OneFactor=void 0;r.OrthographicCamera=Ed;r.PCFSoftShadowMap=r.PCFShadowMap=void 0;r.ParametricBufferGeometry=Bc;r.ParametricGeometry=Fc;r.Particle=Uv;r.ParticleBasicMaterial=zv;r.ParticleSystem=kv;r.ParticleSystemMaterial=Hv;r.Path=vd;r.PerspectiveCamera=Vi;r.Plane=$i;r.PlaneBufferGeometry=Ms;r.PlaneGeometry=Es;r.PlaneHelper=Sv;r.PointCloud=Bv;r.PointCloudMaterial=jv;r.PointLight=Td;r.PointLightHelper=tv;r.Points=Pc;r.PointsMaterial=Ec;r.PolarGridHelper=lv;r.PolyhedronBufferGeometry=kc;r.PolyhedronGeometry=Uc;r.PositionalAudio=fp;r.PositionalAudioHelper=cv;r.PropertyBinding=Sp;r.PropertyMixer=pp;r.QuadraticBezierCurve=cd;r.QuadraticBezierCurve3=hd;r.Quaternion=hr;r.QuaternionKeyframeTrack=Tf;r.QuaternionLinearInterpolant=_f;r.RGBA_ASTC_10x6_Format=r.RGBA_ASTC_10x5_Format=r.RGBA_ASTC_10x10_Format=r.RGBAFormat=r.RGBADepthPacking=r.REVISION=void 0;r.RGB_S3TC_DXT1_Format=r.RGB_PVRTC_4BPPV1_Format=r.RGB_PVRTC_2BPPV1_Format=r.RGB_ETC1_Format=r.RGBM7Encoding=r.RGBM16Encoding=r.RGBFormat=r.RGBEFormat=r.RGBEEncoding=r.RGBDEncoding=r.RGBA_S3TC_DXT5_Format=r.RGBA_S3TC_DXT3_Format=r.RGBA_S3TC_DXT1_Format=r.RGBA_PVRTC_4BPPV1_Format=r.RGBA_PVRTC_2BPPV1_Format=r.RGBA_ASTC_8x8_Format=r.RGBA_ASTC_8x6_Format=r.RGBA_ASTC_8x5_Format=r.RGBA_ASTC_6x6_Format=r.RGBA_ASTC_6x5_Format=r.RGBA_ASTC_5x5_Format=r.RGBA_ASTC_5x4_Format=r.RGBA_ASTC_4x4_Format=r.RGBA_ASTC_12x12_Format=r.RGBA_ASTC_12x10_Format=r.RGBA_ASTC_10x8_Format=r.RGBA_ASTC_10x6_Format=r.RGBA_ASTC_10x5_Format=r.RGBA_ASTC_10x10_Format=r.RGBAFormat=r.RGBADepthPacking=r.REVISION=void 0;r.RawShaderMaterial=rf;r.Ray=wn;r.Raycaster=Lp;r.RectAreaLight=Rd;r.RectAreaLightHelper=rv;r.ReverseSubtractEquation=r.ReplaceStencilOp=r.RepeatWrapping=r.ReinhardToneMapping=r.RedFormat=void 0;r.RingBufferGeometry=zh;r.RingGeometry=jh;r.Scene=Jr;r.ShaderLib=r.ShaderChunk=r.SceneUtils=void 0;r.ShaderMaterial=Hi;r.ShadowMaterial=tf;r.Shape=md;r.ShapeBufferGeometry=Wh;r.ShapeGeometry=Vh;r.ShapePath=jd;r.ShortType=r.ShapeUtils=void 0;r.Skeleton=cc;r.SkeletonHelper=ev;r.SkinnedMesh=sc;r.SmoothShading=void 0;r.Sphere=dn;r.SphereBufferGeometry=kh;r.SphereGeometry=Uh;r.Spherical=Np;r.SphericalHarmonics3=Yd;r.SphericalReflectionMapping=void 0;r.Spline=rm;r.SplineCurve=fd;r.SplineCurve3=tm;r.SpotLight=wd;r.SpotLightHelper=Zp;r.SpotLightShadow=bd;r.Sprite=rc;r.SpriteMaterial=Hl;r.SrcColorFactor=r.SrcAlphaSaturateFactor=r.SrcAlphaFactor=void 0;r.StereoCamera=ep;r.StringKeyframeTrack=Ef;r.TangentSpaceNormalMap=r.TOUCH=r.SubtractiveBlending=r.SubtractEquation=void 0;r.TetrahedronBufferGeometry=zc;r.TetrahedronGeometry=jc;r.TextBufferGeometry=Bh;r.TextGeometry=Fh;r.Texture=br;r.TextureLoader=jf;r.TorusBufferGeometry=$c;r.TorusGeometry=Qc;r.TorusKnotBufferGeometry=Kc;r.TorusKnotGeometry=Jc;r.Triangle=Ln;r.TrianglesDrawMode=r.TriangleStripDrawMode=r.TriangleFanDrawMode=void 0;r.TubeBufferGeometry=Zc;r.TubeGeometry=Yc;r.UVMapping=void 0;r.Uint16Attribute=Zv;r.Uint16BufferAttribute=Zn;r.Uint32Attribute=Kv;r.Uint32BufferAttribute=Kn;r.Uint8Attribute=qv;r.Uint8BufferAttribute=qn;r.Uint8ClampedAttribute=Xv;r.Uint8ClampedBufferAttribute=Xn;r.Uncharted2ToneMapping=void 0;r.Uniform=Cp;r.VSMShadowMap=r.UnsignedShortType=r.UnsignedShort565Type=r.UnsignedShort5551Type=r.UnsignedShort4444Type=r.UnsignedIntType=r.UnsignedInt248Type=r.UnsignedByteType=r.UniformsUtils=r.UniformsLib=void 0;r.Vector2=cr;r.Vector3=pr;r.Vector4=wr;r.VectorKeyframeTrack=Mf;r.Vertex=Gv;r.VertexColors=void 0;r.VertexNormalsHelper=Xp;r.VideoTexture=Oc;r.WebGLMultisampleRenderTarget=Tr;r.WebGLRenderTarget=_r;r.WebGLRenderTargetCube=Yi;r.WebGLRenderer=Bl;r.WebGLUtils=Al;r.WireframeGeometry=Nc;r.WireframeHelper=om;r.WrapAroundEnding=void 0;r.XHRLoader=sm;r.sRGBEncoding=r.ZeroStencilOp=r.ZeroSlopeEnding=r.ZeroFactor=r.ZeroCurvatureEnding=void 0;if(Number.EPSILON===undefined){Number.EPSILON=Math.pow(2,-52)}if(Number.isInteger===undefined){Number.isInteger=function(e){return typeof e==="number"&&isFinite(e)&&Math.floor(e)===e}}if(Math.sign===undefined){Math.sign=function(e){return e<0?-1:e>0?1:+e}}if("name"in Function.prototype===false){Object.defineProperty(Function.prototype,"name",{get:function(){return this.toString().match(/^\s*function\s*([^\(\s]*)/)[1]}})}if(Object.assign===undefined){Object.assign=function(e){if(e===undefined||e===null){throw new TypeError("Cannot convert undefined or null to object")}var t=Object(e);for(var r=1;r<arguments.length;r++){var n=arguments[r];if(n!==undefined&&n!==null){for(var i in n){if(Object.prototype.hasOwnProperty.call(n,i)){t[i]=n[i]}}}}return t}}var n="109";r.REVISION=n;var i={LEFT:0,MIDDLE:1,RIGHT:2,ROTATE:0,DOLLY:1,PAN:2};r.MOUSE=i;var a={ROTATE:0,PAN:1,DOLLY_PAN:2,DOLLY_ROTATE:3};r.TOUCH=a;var ce=0;r.CullFaceNone=ce;var he=1;r.CullFaceBack=he;var fe=2;r.CullFaceFront=fe;var o=3;r.CullFaceFrontBack=o;var s=0;r.FrontFaceDirectionCW=s;var u=1;r.FrontFaceDirectionCCW=u;var l=0;r.BasicShadowMap=l;var c=1;r.PCFShadowMap=c;var h=2;r.PCFSoftShadowMap=h;var I=3;r.VSMShadowMap=I;var D=0;r.FrontSide=D;var ze=1;r.BackSide=ze;var de=2;r.DoubleSide=de;var f=1;r.FlatShading=f;var d=2;r.SmoothShading=d;var p=0;r.NoColors=p;var v=1;r.FaceColors=v;var g=2;r.VertexColors=g;var pe=0;r.NoBlending=pe;var ve=1;r.NormalBlending=ve;var me=2;r.AdditiveBlending=me;var ge=3;r.SubtractiveBlending=ge;var ye=4;r.MultiplyBlending=ye;var xe=5;r.CustomBlending=xe;var be=100;r.AddEquation=be;var m=101;r.SubtractEquation=m;var y=102;r.ReverseSubtractEquation=y;var x=103;r.MinEquation=x;var b=104;r.MaxEquation=b;var w=200;r.ZeroFactor=w;var _=201;r.OneFactor=_;var T=202;r.SrcColorFactor=T;var E=203;r.OneMinusSrcColorFactor=E;var M=204;r.SrcAlphaFactor=M;var S=205;r.OneMinusSrcAlphaFactor=S;var A=206;r.DstAlphaFactor=A;var R=207;r.OneMinusDstAlphaFactor=R;var P=208;r.DstColorFactor=P;var C=209;r.OneMinusDstColorFactor=C;var O=210;r.SrcAlphaSaturateFactor=O;var we=0;r.NeverDepth=we;var _e=1;r.AlwaysDepth=_e;var Te=2;r.LessDepth=Te;var Ee=3;r.LessEqualDepth=Ee;var Me=4;r.EqualDepth=Me;var Se=5;r.GreaterEqualDepth=Se;var Ae=6;r.GreaterDepth=Ae;var Re=7;r.NotEqualDepth=Re;var L=0;r.MultiplyOperation=L;var N=1;r.MixOperation=N;var F=2;r.AddOperation=F;var B=0;r.NoToneMapping=B;var He=1;r.LinearToneMapping=He;var U=2;r.ReinhardToneMapping=U;var k=3;r.Uncharted2ToneMapping=k;var j=4;r.CineonToneMapping=j;var z=5;r.ACESFilmicToneMapping=z;var H=300;r.UVMapping=H;var G=301;r.CubeReflectionMapping=G;var V=302;r.CubeRefractionMapping=V;var W=303;r.EquirectangularReflectionMapping=W;var q=304;r.EquirectangularRefractionMapping=q;var X=305;r.SphericalReflectionMapping=X;var Y=306;r.CubeUVReflectionMapping=Y;var Z=307;r.CubeUVRefractionMapping=Z;var J=1e3;r.RepeatWrapping=J;var K=1001;r.ClampToEdgeWrapping=K;var Q=1002;r.MirroredRepeatWrapping=Q;var $=1003;r.NearestFilter=$;var ee=1004;r.NearestMipmapNearestFilter=ee;var te=1004;r.NearestMipMapNearestFilter=te;var re=1005;r.NearestMipmapLinearFilter=re;var ne=1005;r.NearestMipMapLinearFilter=ne;var ie=1006;r.LinearFilter=ie;var ae=1007;r.LinearMipmapNearestFilter=ae;var oe=1007;r.LinearMipMapNearestFilter=oe;var se=1008;r.LinearMipmapLinearFilter=se;var ue=1008;r.LinearMipMapLinearFilter=ue;var Ge=1009;r.UnsignedByteType=Ge;var le=1010;r.ByteType=le;var Pe=1011;r.ShortType=Pe;var Ce=1012;r.UnsignedShortType=Ce;var Oe=1013;r.IntType=Oe;var Le=1014;r.UnsignedIntType=Le;var Ve=1015;r.FloatType=Ve;var We=1016;r.HalfFloatType=We;var Ie=1017;r.UnsignedShort4444Type=Ie;var De=1018;r.UnsignedShort5551Type=De;var Ne=1019;r.UnsignedShort565Type=Ne;var Fe=1020;r.UnsignedInt248Type=Fe;var Be=1021;r.AlphaFormat=Be;var Ue=1022;r.RGBFormat=Ue;var qe=1023;r.RGBAFormat=qe;var ke=1024;r.LuminanceFormat=ke;var je=1025;r.LuminanceAlphaFormat=je;var Xe=qe;r.RGBEFormat=Xe;var Ye=1026;r.DepthFormat=Ye;var Ze=1027;r.DepthStencilFormat=Ze;var Je=1028;r.RedFormat=Je;var Ke=33776;r.RGB_S3TC_DXT1_Format=Ke;var Qe=33777;r.RGBA_S3TC_DXT1_Format=Qe;var $e=33778;r.RGBA_S3TC_DXT3_Format=$e;var et=33779;r.RGBA_S3TC_DXT5_Format=et;var tt=35840;r.RGB_PVRTC_4BPPV1_Format=tt;var rt=35841;r.RGB_PVRTC_2BPPV1_Format=rt;var nt=35842;r.RGBA_PVRTC_4BPPV1_Format=nt;var it=35843;r.RGBA_PVRTC_2BPPV1_Format=it;var at=36196;r.RGB_ETC1_Format=at;var ot=37808;r.RGBA_ASTC_4x4_Format=ot;var st=37809;r.RGBA_ASTC_5x4_Format=st;var ut=37810;r.RGBA_ASTC_5x5_Format=ut;var lt=37811;r.RGBA_ASTC_6x5_Format=lt;var ct=37812;r.RGBA_ASTC_6x6_Format=ct;var ht=37813;r.RGBA_ASTC_8x5_Format=ht;var ft=37814;r.RGBA_ASTC_8x6_Format=ft;var dt=37815;r.RGBA_ASTC_8x8_Format=dt;var pt=37816;r.RGBA_ASTC_10x5_Format=pt;var vt=37817;r.RGBA_ASTC_10x6_Format=vt;var mt=37818;r.RGBA_ASTC_10x8_Format=mt;var gt=37819;r.RGBA_ASTC_10x10_Format=gt;var yt=37820;r.RGBA_ASTC_12x10_Format=yt;var xt=37821;r.RGBA_ASTC_12x12_Format=xt;var bt=2200;r.LoopOnce=bt;var wt=2201;r.LoopRepeat=wt;var _t=2202;r.LoopPingPong=_t;var Tt=2300;r.InterpolateDiscrete=Tt;var Et=2301;r.InterpolateLinear=Et;var Mt=2302;r.InterpolateSmooth=Mt;var St=2400;r.ZeroCurvatureEnding=St;var At=2401;r.ZeroSlopeEnding=At;var Rt=2402;r.WrapAroundEnding=Rt;var Pt=0;r.TrianglesDrawMode=Pt;var Ct=1;r.TriangleStripDrawMode=Ct;var Ot=2;r.TriangleFanDrawMode=Ot;var Lt=3e3;r.LinearEncoding=Lt;var It=3001;r.sRGBEncoding=It;var Dt=3007;r.GammaEncoding=Dt;var Nt=3002;r.RGBEEncoding=Nt;var Ft=3003;r.LogLuvEncoding=Ft;var Bt=3004;r.RGBM7Encoding=Bt;var Ut=3005;r.RGBM16Encoding=Ut;var kt=3006;r.RGBDEncoding=kt;var jt=3200;r.BasicDepthPacking=jt;var zt=3201;r.RGBADepthPacking=zt;var Ht=0;r.TangentSpaceNormalMap=Ht;var Gt=1;r.ObjectSpaceNormalMap=Gt;var Vt=0;r.ZeroStencilOp=Vt;var Wt=7680;r.KeepStencilOp=Wt;var qt=7681;r.ReplaceStencilOp=qt;var Xt=7682;r.IncrementStencilOp=Xt;var Yt=7683;r.DecrementStencilOp=Yt;var Zt=34055;r.IncrementWrapStencilOp=Zt;var Jt=34056;r.DecrementWrapStencilOp=Jt;var Kt=5386;r.InvertStencilOp=Kt;var Qt=512;r.NeverStencilFunc=Qt;var $t=513;r.LessStencilFunc=$t;var er=514;r.EqualStencilFunc=er;var tr=515;r.LessEqualStencilFunc=tr;var rr=516;r.GreaterStencilFunc=rr;var nr=517;r.NotEqualStencilFunc=nr;var ir=518;r.GreaterEqualStencilFunc=ir;var ar=519;r.AlwaysStencilFunc=ar;function or(){}Object.assign(or.prototype,{addEventListener:function(e,t){if(this._listeners===undefined)this._listeners={};var r=this._listeners;if(r[e]===undefined){r[e]=[]}if(r[e].indexOf(t)===-1){r[e].push(t)}},hasEventListener:function(e,t){if(this._listeners===undefined)return false;var r=this._listeners;return r[e]!==undefined&&r[e].indexOf(t)!==-1},removeEventListener:function(e,t){if(this._listeners===undefined)return;var r=this._listeners;var n=r[e];if(n!==undefined){var i=n.indexOf(t);if(i!==-1){n.splice(i,1)}}},dispatchEvent:function(e){if(this._listeners===undefined)return;var t=this._listeners;var r=t[e.type];if(r!==undefined){e.target=this;var n=r.slice(0);for(var i=0,a=n.length;i<a;i++){n[i].call(this,e)}}}});var sr=[];for(var ur=0;ur<256;ur++){sr[ur]=(ur<16?"0":"")+ur.toString(16)}var lr={DEG2RAD:Math.PI/180,RAD2DEG:180/Math.PI,generateUUID:function(){var e=Math.random()*4294967295|0;var t=Math.random()*4294967295|0;var r=Math.random()*4294967295|0;var n=Math.random()*4294967295|0;var i=sr[e&255]+sr[e>>8&255]+sr[e>>16&255]+sr[e>>24&255]+"-"+sr[t&255]+sr[t>>8&255]+"-"+sr[t>>16&15|64]+sr[t>>24&255]+"-"+sr[r&63|128]+sr[r>>8&255]+"-"+sr[r>>16&255]+sr[r>>24&255]+sr[n&255]+sr[n>>8&255]+sr[n>>16&255]+sr[n>>24&255];return i.toUpperCase()},clamp:function(e,t,r){return Math.max(t,Math.min(r,e))},euclideanModulo:function(e,t){return(e%t+t)%t},mapLinear:function(e,t,r,n,i){return n+(e-t)*(i-n)/(r-t)},lerp:function(e,t,r){return(1-r)*e+r*t},smoothstep:function(e,t,r){if(e<=t)return 0;if(e>=r)return 1;e=(e-t)/(r-t);return e*e*(3-2*e)},smootherstep:function(e,t,r){if(e<=t)return 0;if(e>=r)return 1;e=(e-t)/(r-t);return e*e*e*(e*(e*6-15)+10)},randInt:function(e,t){return e+Math.floor(Math.random()*(t-e+1))},randFloat:function(e,t){return e+Math.random()*(t-e)},randFloatSpread:function(e){return e*(.5-Math.random())},degToRad:function(e){return e*lr.DEG2RAD},radToDeg:function(e){return e*lr.RAD2DEG},isPowerOfTwo:function(e){return(e&e-1)===0&&e!==0},ceilPowerOfTwo:function(e){return Math.pow(2,Math.ceil(Math.log(e)/Math.LN2))},floorPowerOfTwo:function(e){return Math.pow(2,Math.floor(Math.log(e)/Math.LN2))}};r.Math=lr;function cr(e,t){this.x=e||0;this.y=t||0}Object.defineProperties(cr.prototype,{width:{get:function(){return this.x},set:function(e){this.x=e}},height:{get:function(){return this.y},set:function(e){this.y=e}}});Object.assign(cr.prototype,{isVector2:true,set:function(e,t){this.x=e;this.y=t;return this},setScalar:function(e){this.x=e;this.y=e;return this},setX:function(e){this.x=e;return this},setY:function(e){this.y=e;return this},setComponent:function(e,t){switch(e){case 0:this.x=t;break;case 1:this.y=t;break;default:throw new Error("index is out of range: "+e)}return this},getComponent:function(e){switch(e){case 0:return this.x;case 1:return this.y;default:throw new Error("index is out of range: "+e)}},clone:function(){return new this.constructor(this.x,this.y)},copy:function(e){this.x=e.x;this.y=e.y;return this},add:function(e,t){if(t!==undefined){console.warn("THREE.Vector2: .add() now only accepts one argument. Use .addVectors( a, b ) instead.");return this.addVectors(e,t)}this.x+=e.x;this.y+=e.y;return this},addScalar:function(e){this.x+=e;this.y+=e;return this},addVectors:function(e,t){this.x=e.x+t.x;this.y=e.y+t.y;return this},addScaledVector:function(e,t){this.x+=e.x*t;this.y+=e.y*t;return this},sub:function(e,t){if(t!==undefined){console.warn("THREE.Vector2: .sub() now only accepts one argument. Use .subVectors( a, b ) instead.");return this.subVectors(e,t)}this.x-=e.x;this.y-=e.y;return this},subScalar:function(e){this.x-=e;this.y-=e;return this},subVectors:function(e,t){this.x=e.x-t.x;this.y=e.y-t.y;return this},multiply:function(e){this.x*=e.x;this.y*=e.y;return this},multiplyScalar:function(e){this.x*=e;this.y*=e;return this},divide:function(e){this.x/=e.x;this.y/=e.y;return this},divideScalar:function(e){return this.multiplyScalar(1/e)},applyMatrix3:function(e){var t=this.x,r=this.y;var n=e.elements;this.x=n[0]*t+n[3]*r+n[6];this.y=n[1]*t+n[4]*r+n[7];return this},min:function(e){this.x=Math.min(this.x,e.x);this.y=Math.min(this.y,e.y);return this},max:function(e){this.x=Math.max(this.x,e.x);this.y=Math.max(this.y,e.y);return this},clamp:function(e,t){this.x=Math.max(e.x,Math.min(t.x,this.x));this.y=Math.max(e.y,Math.min(t.y,this.y));return this},clampScalar:function(e,t){this.x=Math.max(e,Math.min(t,this.x));this.y=Math.max(e,Math.min(t,this.y));return this},clampLength:function(e,t){var r=this.length();return this.divideScalar(r||1).multiplyScalar(Math.max(e,Math.min(t,r)))},floor:function(){this.x=Math.floor(this.x);this.y=Math.floor(this.y);return this},ceil:function(){this.x=Math.ceil(this.x);this.y=Math.ceil(this.y);return this},round:function(){this.x=Math.round(this.x);this.y=Math.round(this.y);return this},roundToZero:function(){this.x=this.x<0?Math.ceil(this.x):Math.floor(this.x);this.y=this.y<0?Math.ceil(this.y):Math.floor(this.y);return this},negate:function(){this.x=-this.x;this.y=-this.y;return this},dot:function(e){return this.x*e.x+this.y*e.y},cross:function(e){return this.x*e.y-this.y*e.x},lengthSq:function(){return this.x*this.x+this.y*this.y},length:function(){return Math.sqrt(this.x*this.x+this.y*this.y)},manhattanLength:function(){return Math.abs(this.x)+Math.abs(this.y)},normalize:function(){return this.divideScalar(this.length()||1)},angle:function(){var e=Math.atan2(this.y,this.x);if(e<0)e+=2*Math.PI;return e},distanceTo:function(e){return Math.sqrt(this.distanceToSquared(e))},distanceToSquared:function(e){var t=this.x-e.x,r=this.y-e.y;return t*t+r*r},manhattanDistanceTo:function(e){return Math.abs(this.x-e.x)+Math.abs(this.y-e.y)},setLength:function(e){return this.normalize().multiplyScalar(e)},lerp:function(e,t){this.x+=(e.x-this.x)*t;this.y+=(e.y-this.y)*t;return this},lerpVectors:function(e,t,r){return this.subVectors(t,e).multiplyScalar(r).add(e)},equals:function(e){return e.x===this.x&&e.y===this.y},fromArray:function(e,t){if(t===undefined)t=0;this.x=e[t];this.y=e[t+1];return this},toArray:function(e,t){if(e===undefined)e=[];if(t===undefined)t=0;e[t]=this.x;e[t+1]=this.y;return e},fromBufferAttribute:function(e,t,r){if(r!==undefined){console.warn("THREE.Vector2: offset has been removed from .fromBufferAttribute().")}this.x=e.getX(t);this.y=e.getY(t);return this},rotateAround:function(e,t){var r=Math.cos(t),n=Math.sin(t);var i=this.x-e.x;var a=this.y-e.y;this.x=i*r-a*n+e.x;this.y=i*n+a*r+e.y;return this}});function hr(e,t,r,n){this._x=e||0;this._y=t||0;this._z=r||0;this._w=n!==undefined?n:1}Object.assign(hr,{slerp:function(e,t,r,n){return r.copy(e).slerp(t,n)},slerpFlat:function(e,t,r,n,i,a,o){var s=r[n+0],u=r[n+1],l=r[n+2],c=r[n+3],h=i[a+0],f=i[a+1],d=i[a+2],p=i[a+3];if(c!==p||s!==h||u!==f||l!==d){var v=1-o,m=s*h+u*f+l*d+c*p,g=m>=0?1:-1,y=1-m*m;if(y>Number.EPSILON){var x=Math.sqrt(y),b=Math.atan2(x,m*g);v=Math.sin(v*b)/x;o=Math.sin(o*b)/x}var w=o*g;s=s*v+h*w;u=u*v+f*w;l=l*v+d*w;c=c*v+p*w;if(v===1-o){var _=1/Math.sqrt(s*s+u*u+l*l+c*c);s*=_;u*=_;l*=_;c*=_}}e[t]=s;e[t+1]=u;e[t+2]=l;e[t+3]=c}});Object.defineProperties(hr.prototype,{x:{get:function(){return this._x},set:function(e){this._x=e;this._onChangeCallback()}},y:{get:function(){return this._y},set:function(e){this._y=e;this._onChangeCallback()}},z:{get:function(){return this._z},set:function(e){this._z=e;this._onChangeCallback()}},w:{get:function(){return this._w},set:function(e){this._w=e;this._onChangeCallback()}}});Object.assign(hr.prototype,{isQuaternion:true,set:function(e,t,r,n){this._x=e;this._y=t;this._z=r;this._w=n;this._onChangeCallback();return this},clone:function(){return new this.constructor(this._x,this._y,this._z,this._w)},copy:function(e){this._x=e.x;this._y=e.y;this._z=e.z;this._w=e.w;this._onChangeCallback();return this},setFromEuler:function(e,t){if(!(e&&e.isEuler)){throw new Error("THREE.Quaternion: .setFromEuler() now expects an Euler rotation rather than a Vector3 and order.")}var r=e._x,n=e._y,i=e._z,a=e.order;var o=Math.cos;var s=Math.sin;var u=o(r/2);var l=o(n/2);var c=o(i/2);var h=s(r/2);var f=s(n/2);var d=s(i/2);if(a==="XYZ"){this._x=h*l*c+u*f*d;this._y=u*f*c-h*l*d;this._z=u*l*d+h*f*c;this._w=u*l*c-h*f*d}else if(a==="YXZ"){this._x=h*l*c+u*f*d;this._y=u*f*c-h*l*d;this._z=u*l*d-h*f*c;this._w=u*l*c+h*f*d}else if(a==="ZXY"){this._x=h*l*c-u*f*d;this._y=u*f*c+h*l*d;this._z=u*l*d+h*f*c;this._w=u*l*c-h*f*d}else if(a==="ZYX"){this._x=h*l*c-u*f*d;this._y=u*f*c+h*l*d;this._z=u*l*d-h*f*c;this._w=u*l*c+h*f*d}else if(a==="YZX"){this._x=h*l*c+u*f*d;this._y=u*f*c+h*l*d;this._z=u*l*d-h*f*c;this._w=u*l*c-h*f*d}else if(a==="XZY"){this._x=h*l*c-u*f*d;this._y=u*f*c-h*l*d;this._z=u*l*d+h*f*c;this._w=u*l*c+h*f*d}if(t!==false)this._onChangeCallback();return this},setFromAxisAngle:function(e,t){var r=t/2,n=Math.sin(r);this._x=e.x*n;this._y=e.y*n;this._z=e.z*n;this._w=Math.cos(r);this._onChangeCallback();return this},setFromRotationMatrix:function(e){var t=e.elements,r=t[0],n=t[4],i=t[8],a=t[1],o=t[5],s=t[9],u=t[2],l=t[6],c=t[10],h=r+o+c,f;if(h>0){f=.5/Math.sqrt(h+1);this._w=.25/f;this._x=(l-s)*f;this._y=(i-u)*f;this._z=(a-n)*f}else if(r>o&&r>c){f=2*Math.sqrt(1+r-o-c);this._w=(l-s)/f;this._x=.25*f;this._y=(n+a)/f;this._z=(i+u)/f}else if(o>c){f=2*Math.sqrt(1+o-r-c);this._w=(i-u)/f;this._x=(n+a)/f;this._y=.25*f;this._z=(s+l)/f}else{f=2*Math.sqrt(1+c-r-o);this._w=(a-n)/f;this._x=(i+u)/f;this._y=(s+l)/f;this._z=.25*f}this._onChangeCallback();return this},setFromUnitVectors:function(e,t){var r=1e-6;var n=e.dot(t)+1;if(n<r){n=0;if(Math.abs(e.x)>Math.abs(e.z)){this._x=-e.y;this._y=e.x;this._z=0;this._w=n}else{this._x=0;this._y=-e.z;this._z=e.y;this._w=n}}else{this._x=e.y*t.z-e.z*t.y;this._y=e.z*t.x-e.x*t.z;this._z=e.x*t.y-e.y*t.x;this._w=n}return this.normalize()},angleTo:function(e){return 2*Math.acos(Math.abs(lr.clamp(this.dot(e),-1,1)))},rotateTowards:function(e,t){var r=this.angleTo(e);if(r===0)return this;var n=Math.min(1,t/r);this.slerp(e,n);return this},inverse:function(){return this.conjugate()},conjugate:function(){this._x*=-1;this._y*=-1;this._z*=-1;this._onChangeCallback();return this},dot:function(e){return this._x*e._x+this._y*e._y+this._z*e._z+this._w*e._w},lengthSq:function(){return this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w},length:function(){return Math.sqrt(this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w)},normalize:function(){var e=this.length();if(e===0){this._x=0;this._y=0;this._z=0;this._w=1}else{e=1/e;this._x=this._x*e;this._y=this._y*e;this._z=this._z*e;this._w=this._w*e}this._onChangeCallback();return this},multiply:function(e,t){if(t!==undefined){console.warn("THREE.Quaternion: .multiply() now only accepts one argument. Use .multiplyQuaternions( a, b ) instead.");return this.multiplyQuaternions(e,t)}return this.multiplyQuaternions(this,e)},premultiply:function(e){return this.multiplyQuaternions(e,this)},multiplyQuaternions:function(e,t){var r=e._x,n=e._y,i=e._z,a=e._w;var o=t._x,s=t._y,u=t._z,l=t._w;this._x=r*l+a*o+n*u-i*s;this._y=n*l+a*s+i*o-r*u;this._z=i*l+a*u+r*s-n*o;this._w=a*l-r*o-n*s-i*u;this._onChangeCallback();return this},slerp:function(e,t){if(t===0)return this;if(t===1)return this.copy(e);var r=this._x,n=this._y,i=this._z,a=this._w;var o=a*e._w+r*e._x+n*e._y+i*e._z;if(o<0){this._w=-e._w;this._x=-e._x;this._y=-e._y;this._z=-e._z;o=-o}else{this.copy(e)}if(o>=1){this._w=a;this._x=r;this._y=n;this._z=i;return this}var s=1-o*o;if(s<=Number.EPSILON){var u=1-t;this._w=u*a+t*this._w;this._x=u*r+t*this._x;this._y=u*n+t*this._y;this._z=u*i+t*this._z;this.normalize();this._onChangeCallback();return this}var l=Math.sqrt(s);var c=Math.atan2(l,o);var h=Math.sin((1-t)*c)/l,f=Math.sin(t*c)/l;this._w=a*h+this._w*f;this._x=r*h+this._x*f;this._y=n*h+this._y*f;this._z=i*h+this._z*f;this._onChangeCallback();return this},equals:function(e){return e._x===this._x&&e._y===this._y&&e._z===this._z&&e._w===this._w},fromArray:function(e,t){if(t===undefined)t=0;this._x=e[t];this._y=e[t+1];this._z=e[t+2];this._w=e[t+3];this._onChangeCallback();return this},toArray:function(e,t){if(e===undefined)e=[];if(t===undefined)t=0;e[t]=this._x;e[t+1]=this._y;e[t+2]=this._z;e[t+3]=this._w;return e},_onChange:function(e){this._onChangeCallback=e;return this},_onChangeCallback:function(){}});var fr=new pr;var dr=new hr;function pr(e,t,r){this.x=e||0;this.y=t||0;this.z=r||0}Object.assign(pr.prototype,{isVector3:true,set:function(e,t,r){this.x=e;this.y=t;this.z=r;return this},setScalar:function(e){this.x=e;this.y=e;this.z=e;return this},setX:function(e){this.x=e;return this},setY:function(e){this.y=e;return this},setZ:function(e){this.z=e;return this},setComponent:function(e,t){switch(e){case 0:this.x=t;break;case 1:this.y=t;break;case 2:this.z=t;break;default:throw new Error("index is out of range: "+e)}return this},getComponent:function(e){switch(e){case 0:return this.x;case 1:return this.y;case 2:return this.z;default:throw new Error("index is out of range: "+e)}},clone:function(){return new this.constructor(this.x,this.y,this.z)},copy:function(e){this.x=e.x;this.y=e.y;this.z=e.z;return this},add:function(e,t){if(t!==undefined){console.warn("THREE.Vector3: .add() now only accepts one argument. Use .addVectors( a, b ) instead.");return this.addVectors(e,t)}this.x+=e.x;this.y+=e.y;this.z+=e.z;return this},addScalar:function(e){this.x+=e;this.y+=e;this.z+=e;return this},addVectors:function(e,t){this.x=e.x+t.x;this.y=e.y+t.y;this.z=e.z+t.z;return this},addScaledVector:function(e,t){this.x+=e.x*t;this.y+=e.y*t;this.z+=e.z*t;return this},sub:function(e,t){if(t!==undefined){console.warn("THREE.Vector3: .sub() now only accepts one argument. Use .subVectors( a, b ) instead.");return this.subVectors(e,t)}this.x-=e.x;this.y-=e.y;this.z-=e.z;return this},subScalar:function(e){this.x-=e;this.y-=e;this.z-=e;return this},subVectors:function(e,t){this.x=e.x-t.x;this.y=e.y-t.y;this.z=e.z-t.z;return this},multiply:function(e,t){if(t!==undefined){console.warn("THREE.Vector3: .multiply() now only accepts one argument. Use .multiplyVectors( a, b ) instead.");return this.multiplyVectors(e,t)}this.x*=e.x;this.y*=e.y;this.z*=e.z;return this},multiplyScalar:function(e){this.x*=e;this.y*=e;this.z*=e;return this},multiplyVectors:function(e,t){this.x=e.x*t.x;this.y=e.y*t.y;this.z=e.z*t.z;return this},applyEuler:function(e){if(!(e&&e.isEuler)){console.error("THREE.Vector3: .applyEuler() now expects an Euler rotation rather than a Vector3 and order.")}return this.applyQuaternion(dr.setFromEuler(e))},applyAxisAngle:function(e,t){return this.applyQuaternion(dr.setFromAxisAngle(e,t))},applyMatrix3:function(e){var t=this.x,r=this.y,n=this.z;var i=e.elements;this.x=i[0]*t+i[3]*r+i[6]*n;this.y=i[1]*t+i[4]*r+i[7]*n;this.z=i[2]*t+i[5]*r+i[8]*n;return this},applyMatrix4:function(e){var t=this.x,r=this.y,n=this.z;var i=e.elements;var a=1/(i[3]*t+i[7]*r+i[11]*n+i[15]);this.x=(i[0]*t+i[4]*r+i[8]*n+i[12])*a;this.y=(i[1]*t+i[5]*r+i[9]*n+i[13])*a;this.z=(i[2]*t+i[6]*r+i[10]*n+i[14])*a;return this},applyQuaternion:function(e){var t=this.x,r=this.y,n=this.z;var i=e.x,a=e.y,o=e.z,s=e.w;var u=s*t+a*n-o*r;var l=s*r+o*t-i*n;var c=s*n+i*r-a*t;var h=-i*t-a*r-o*n;this.x=u*s+h*-i+l*-o-c*-a;this.y=l*s+h*-a+c*-i-u*-o;this.z=c*s+h*-o+u*-a-l*-i;return this},project:function(e){return this.applyMatrix4(e.matrixWorldInverse).applyMatrix4(e.projectionMatrix)},unproject:function(e){return this.applyMatrix4(e.projectionMatrixInverse).applyMatrix4(e.matrixWorld)},transformDirection:function(e){var t=this.x,r=this.y,n=this.z;var i=e.elements;this.x=i[0]*t+i[4]*r+i[8]*n;this.y=i[1]*t+i[5]*r+i[9]*n;this.z=i[2]*t+i[6]*r+i[10]*n;return this.normalize()},divide:function(e){this.x/=e.x;this.y/=e.y;this.z/=e.z;return this},divideScalar:function(e){return this.multiplyScalar(1/e)},min:function(e){this.x=Math.min(this.x,e.x);this.y=Math.min(this.y,e.y);this.z=Math.min(this.z,e.z);return this},max:function(e){this.x=Math.max(this.x,e.x);this.y=Math.max(this.y,e.y);this.z=Math.max(this.z,e.z);return this},clamp:function(e,t){this.x=Math.max(e.x,Math.min(t.x,this.x));this.y=Math.max(e.y,Math.min(t.y,this.y));this.z=Math.max(e.z,Math.min(t.z,this.z));return this},clampScalar:function(e,t){this.x=Math.max(e,Math.min(t,this.x));this.y=Math.max(e,Math.min(t,this.y));this.z=Math.max(e,Math.min(t,this.z));return this},clampLength:function(e,t){var r=this.length();return this.divideScalar(r||1).multiplyScalar(Math.max(e,Math.min(t,r)))},floor:function(){this.x=Math.floor(this.x);this.y=Math.floor(this.y);this.z=Math.floor(this.z);return this},ceil:function(){this.x=Math.ceil(this.x);this.y=Math.ceil(this.y);this.z=Math.ceil(this.z);return this},round:function(){this.x=Math.round(this.x);this.y=Math.round(this.y);this.z=Math.round(this.z);return this},roundToZero:function(){this.x=this.x<0?Math.ceil(this.x):Math.floor(this.x);this.y=this.y<0?Math.ceil(this.y):Math.floor(this.y);this.z=this.z<0?Math.ceil(this.z):Math.floor(this.z);return this},negate:function(){this.x=-this.x;this.y=-this.y;this.z=-this.z;return this},dot:function(e){return this.x*e.x+this.y*e.y+this.z*e.z},lengthSq:function(){return this.x*this.x+this.y*this.y+this.z*this.z},length:function(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z)},manhattanLength:function(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)},normalize:function(){return this.divideScalar(this.length()||1)},setLength:function(e){return this.normalize().multiplyScalar(e)},lerp:function(e,t){this.x+=(e.x-this.x)*t;this.y+=(e.y-this.y)*t;this.z+=(e.z-this.z)*t;return this},lerpVectors:function(e,t,r){return this.subVectors(t,e).multiplyScalar(r).add(e)},cross:function(e,t){if(t!==undefined){console.warn("THREE.Vector3: .cross() now only accepts one argument. Use .crossVectors( a, b ) instead.");return this.crossVectors(e,t)}return this.crossVectors(this,e)},crossVectors:function(e,t){var r=e.x,n=e.y,i=e.z;var a=t.x,o=t.y,s=t.z;this.x=n*s-i*o;this.y=i*a-r*s;this.z=r*o-n*a;return this},projectOnVector:function(e){var t=e.dot(this)/e.lengthSq();return this.copy(e).multiplyScalar(t)},projectOnPlane:function(e){fr.copy(this).projectOnVector(e);return this.sub(fr)},reflect:function(e){return this.sub(fr.copy(e).multiplyScalar(2*this.dot(e)))},angleTo:function(e){var t=Math.sqrt(this.lengthSq()*e.lengthSq());if(t===0)console.error("THREE.Vector3: angleTo() can't handle zero length vectors.");var r=this.dot(e)/t;return Math.acos(lr.clamp(r,-1,1))},distanceTo:function(e){return Math.sqrt(this.distanceToSquared(e))},distanceToSquared:function(e){var t=this.x-e.x,r=this.y-e.y,n=this.z-e.z;return t*t+r*r+n*n},manhattanDistanceTo:function(e){return Math.abs(this.x-e.x)+Math.abs(this.y-e.y)+Math.abs(this.z-e.z)},setFromSpherical:function(e){return this.setFromSphericalCoords(e.radius,e.phi,e.theta)},setFromSphericalCoords:function(e,t,r){var n=Math.sin(t)*e;this.x=n*Math.sin(r);this.y=Math.cos(t)*e;this.z=n*Math.cos(r);return this},setFromCylindrical:function(e){return this.setFromCylindricalCoords(e.radius,e.theta,e.y)},setFromCylindricalCoords:function(e,t,r){this.x=e*Math.sin(t);this.y=r;this.z=e*Math.cos(t);return this},setFromMatrixPosition:function(e){var t=e.elements;this.x=t[12];this.y=t[13];this.z=t[14];return this},setFromMatrixScale:function(e){var t=this.setFromMatrixColumn(e,0).length();var r=this.setFromMatrixColumn(e,1).length();var n=this.setFromMatrixColumn(e,2).length();this.x=t;this.y=r;this.z=n;return this},setFromMatrixColumn:function(e,t){return this.fromArray(e.elements,t*4)},equals:function(e){return e.x===this.x&&e.y===this.y&&e.z===this.z},fromArray:function(e,t){if(t===undefined)t=0;this.x=e[t];this.y=e[t+1];this.z=e[t+2];return this},toArray:function(e,t){if(e===undefined)e=[];if(t===undefined)t=0;e[t]=this.x;e[t+1]=this.y;e[t+2]=this.z;return e},fromBufferAttribute:function(e,t,r){if(r!==undefined){console.warn("THREE.Vector3: offset has been removed from .fromBufferAttribute().")}this.x=e.getX(t);this.y=e.getY(t);this.z=e.getZ(t);return this}});var vr=new pr;function mr(){this.elements=[1,0,0,0,1,0,0,0,1];if(arguments.length>0){console.error("THREE.Matrix3: the constructor no longer reads arguments. use .set() instead.")}}Object.assign(mr.prototype,{isMatrix3:true,set:function(e,t,r,n,i,a,o,s,u){var l=this.elements;l[0]=e;l[1]=n;l[2]=o;l[3]=t;l[4]=i;l[5]=s;l[6]=r;l[7]=a;l[8]=u;return this},identity:function(){this.set(1,0,0,0,1,0,0,0,1);return this},clone:function(){return(new this.constructor).fromArray(this.elements)},copy:function(e){var t=this.elements;var r=e.elements;t[0]=r[0];t[1]=r[1];t[2]=r[2];t[3]=r[3];t[4]=r[4];t[5]=r[5];t[6]=r[6];t[7]=r[7];t[8]=r[8];return this},setFromMatrix4:function(e){var t=e.elements;this.set(t[0],t[4],t[8],t[1],t[5],t[9],t[2],t[6],t[10]);return this},applyToBufferAttribute:function(e){for(var t=0,r=e.count;t<r;t++){vr.x=e.getX(t);vr.y=e.getY(t);vr.z=e.getZ(t);vr.applyMatrix3(this);e.setXYZ(t,vr.x,vr.y,vr.z)}return e},multiply:function(e){return this.multiplyMatrices(this,e)},premultiply:function(e){return this.multiplyMatrices(e,this)},multiplyMatrices:function(e,t){var r=e.elements;var n=t.elements;var i=this.elements;var a=r[0],o=r[3],s=r[6];var u=r[1],l=r[4],c=r[7];var h=r[2],f=r[5],d=r[8];var p=n[0],v=n[3],m=n[6];var g=n[1],y=n[4],x=n[7];var b=n[2],w=n[5],_=n[8];i[0]=a*p+o*g+s*b;i[3]=a*v+o*y+s*w;i[6]=a*m+o*x+s*_;i[1]=u*p+l*g+c*b;i[4]=u*v+l*y+c*w;i[7]=u*m+l*x+c*_;i[2]=h*p+f*g+d*b;i[5]=h*v+f*y+d*w;i[8]=h*m+f*x+d*_;return this},multiplyScalar:function(e){var t=this.elements;t[0]*=e;t[3]*=e;t[6]*=e;t[1]*=e;t[4]*=e;t[7]*=e;t[2]*=e;t[5]*=e;t[8]*=e;return this},determinant:function(){var e=this.elements;var t=e[0],r=e[1],n=e[2],i=e[3],a=e[4],o=e[5],s=e[6],u=e[7],l=e[8];return t*a*l-t*o*u-r*i*l+r*o*s+n*i*u-n*a*s},getInverse:function(e,t){if(e&&e.isMatrix4){console.error("THREE.Matrix3: .getInverse() no longer takes a Matrix4 argument.")}var r=e.elements,n=this.elements,i=r[0],a=r[1],o=r[2],s=r[3],u=r[4],l=r[5],c=r[6],h=r[7],f=r[8],d=f*u-l*h,p=l*c-f*s,v=h*s-u*c,m=i*d+a*p+o*v;if(m===0){var g="THREE.Matrix3: .getInverse() can't invert matrix, determinant is 0";if(t===true){throw new Error(g)}else{console.warn(g)}return this.identity()}var y=1/m;n[0]=d*y;n[1]=(o*h-f*a)*y;n[2]=(l*a-o*u)*y;n[3]=p*y;n[4]=(f*i-o*c)*y;n[5]=(o*s-l*i)*y;n[6]=v*y;n[7]=(a*c-h*i)*y;n[8]=(u*i-a*s)*y;return this},transpose:function(){var e,t=this.elements;e=t[1];t[1]=t[3];t[3]=e;e=t[2];t[2]=t[6];t[6]=e;e=t[5];t[5]=t[7];t[7]=e;return this},getNormalMatrix:function(e){return this.setFromMatrix4(e).getInverse(this).transpose()},transposeIntoArray:function(e){var t=this.elements;e[0]=t[0];e[1]=t[3];e[2]=t[6];e[3]=t[1];e[4]=t[4];e[5]=t[7];e[6]=t[2];e[7]=t[5];e[8]=t[8];return this},setUvTransform:function(e,t,r,n,i,a,o){var s=Math.cos(i);var u=Math.sin(i);this.set(r*s,r*u,-r*(s*a+u*o)+a+e,-n*u,n*s,-n*(-u*a+s*o)+o+t,0,0,1)},scale:function(e,t){var r=this.elements;r[0]*=e;r[3]*=e;r[6]*=e;r[1]*=t;r[4]*=t;r[7]*=t;return this},rotate:function(e){var t=Math.cos(e);var r=Math.sin(e);var n=this.elements;var i=n[0],a=n[3],o=n[6];var s=n[1],u=n[4],l=n[7];n[0]=t*i+r*s;n[3]=t*a+r*u;n[6]=t*o+r*l;n[1]=-r*i+t*s;n[4]=-r*a+t*u;n[7]=-r*o+t*l;return this},translate:function(e,t){var r=this.elements;r[0]+=e*r[2];r[3]+=e*r[5];r[6]+=e*r[8];r[1]+=t*r[2];r[4]+=t*r[5];r[7]+=t*r[8];return this},equals:function(e){var t=this.elements;var r=e.elements;for(var n=0;n<9;n++){if(t[n]!==r[n])return false}return true},fromArray:function(e,t){if(t===undefined)t=0;for(var r=0;r<9;r++){this.elements[r]=e[r+t]}return this},toArray:function(e,t){if(e===undefined)e=[];if(t===undefined)t=0;var r=this.elements;e[t]=r[0];e[t+1]=r[1];e[t+2]=r[2];e[t+3]=r[3];e[t+4]=r[4];e[t+5]=r[5];e[t+6]=r[6];e[t+7]=r[7];e[t+8]=r[8];return e}});var gr;var yr={getDataURL:function(e){var t;if(typeof HTMLCanvasElement=="undefined"){return e.src}else if(e instanceof HTMLCanvasElement){t=e}else{if(gr===undefined)gr=document.createElementNS("http://www.w3.org/1999/xhtml","canvas");gr.width=e.width;gr.height=e.height;var r=gr.getContext("2d");if(e instanceof ImageData){r.putImageData(e,0,0)}else{r.drawImage(e,0,0,e.width,e.height)}t=gr}if(t.width>2048||t.height>2048){return t.toDataURL("image/jpeg",.6)}else{return t.toDataURL("image/png")}}};r.ImageUtils=yr;var xr=0;function br(e,t,r,n,i,a,o,s,u,l){Object.defineProperty(this,"id",{value:xr++});this.uuid=lr.generateUUID();this.name="";this.image=e!==undefined?e:br.DEFAULT_IMAGE;this.mipmaps=[];this.mapping=t!==undefined?t:br.DEFAULT_MAPPING;this.wrapS=r!==undefined?r:K;this.wrapT=n!==undefined?n:K;this.magFilter=i!==undefined?i:ie;this.minFilter=a!==undefined?a:se;this.anisotropy=u!==undefined?u:1;this.format=o!==undefined?o:qe;this.type=s!==undefined?s:Ge;this.offset=new cr(0,0);this.repeat=new cr(1,1);this.center=new cr(0,0);this.rotation=0;this.matrixAutoUpdate=true;this.matrix=new mr;this.generateMipmaps=true;this.premultiplyAlpha=false;this.flipY=true;this.unpackAlignment=4;this.encoding=l!==undefined?l:Lt;this.version=0;this.onUpdate=null}br.DEFAULT_IMAGE=undefined;br.DEFAULT_MAPPING=H;br.prototype=Object.assign(Object.create(or.prototype),{constructor:br,isTexture:true,updateMatrix:function(){this.matrix.setUvTransform(this.offset.x,this.offset.y,this.repeat.x,this.repeat.y,this.rotation,this.center.x,this.center.y)},clone:function(){return(new this.constructor).copy(this)},copy:function(e){this.name=e.name;this.image=e.image;this.mipmaps=e.mipmaps.slice(0);this.mapping=e.mapping;this.wrapS=e.wrapS;this.wrapT=e.wrapT;this.magFilter=e.magFilter;this.minFilter=e.minFilter;this.anisotropy=e.anisotropy;this.format=e.format;this.type=e.type;this.offset.copy(e.offset);this.repeat.copy(e.repeat);this.center.copy(e.center);this.rotation=e.rotation;this.matrixAutoUpdate=e.matrixAutoUpdate;this.matrix.copy(e.matrix);this.generateMipmaps=e.generateMipmaps;this.premultiplyAlpha=e.premultiplyAlpha;this.flipY=e.flipY;this.unpackAlignment=e.unpackAlignment;this.encoding=e.encoding;return this},toJSON:function(e){var t=e===undefined||typeof e==="string";if(!t&&e.textures[this.uuid]!==undefined){return e.textures[this.uuid]}var r={metadata:{version:4.5,type:"Texture",generator:"Texture.toJSON"},uuid:this.uuid,name:this.name,mapping:this.mapping,repeat:[this.repeat.x,this.repeat.y],offset:[this.offset.x,this.offset.y],center:[this.center.x,this.center.y],rotation:this.rotation,wrap:[this.wrapS,this.wrapT],format:this.format,type:this.type,encoding:this.encoding,minFilter:this.minFilter,magFilter:this.magFilter,anisotropy:this.anisotropy,flipY:this.flipY,premultiplyAlpha:this.premultiplyAlpha,unpackAlignment:this.unpackAlignment};if(this.image!==undefined){var n=this.image;if(n.uuid===undefined){n.uuid=lr.generateUUID()}if(!t&&e.images[n.uuid]===undefined){var i;if(Array.isArray(n)){i=[];for(var a=0,o=n.length;a<o;a++){i.push(yr.getDataURL(n[a]))}}else{i=yr.getDataURL(n)}e.images[n.uuid]={uuid:n.uuid,url:i}}r.image=n.uuid}if(!t){e.textures[this.uuid]=r}return r},dispose:function(){this.dispatchEvent({type:"dispose"})},transformUv:function(e){if(this.mapping!==H)return e;e.applyMatrix3(this.matrix);if(e.x<0||e.x>1){switch(this.wrapS){case J:e.x=e.x-Math.floor(e.x);break;case K:e.x=e.x<0?0:1;break;case Q:if(Math.abs(Math.floor(e.x)%2)===1){e.x=Math.ceil(e.x)-e.x}else{e.x=e.x-Math.floor(e.x)}break}}if(e.y<0||e.y>1){switch(this.wrapT){case J:e.y=e.y-Math.floor(e.y);break;case K:e.y=e.y<0?0:1;break;case Q:if(Math.abs(Math.floor(e.y)%2)===1){e.y=Math.ceil(e.y)-e.y}else{e.y=e.y-Math.floor(e.y)}break}}if(this.flipY){e.y=1-e.y}return e}});Object.defineProperty(br.prototype,"needsUpdate",{set:function(e){if(e===true)this.version++}});function wr(e,t,r,n){this.x=e||0;this.y=t||0;this.z=r||0;this.w=n!==undefined?n:1}Object.defineProperties(wr.prototype,{width:{get:function(){return this.z},set:function(e){this.z=e}},height:{get:function(){return this.w},set:function(e){this.w=e}}});Object.assign(wr.prototype,{isVector4:true,set:function(e,t,r,n){this.x=e;this.y=t;this.z=r;this.w=n;return this},setScalar:function(e){this.x=e;this.y=e;this.z=e;this.w=e;return this},setX:function(e){this.x=e;return this},setY:function(e){this.y=e;return this},setZ:function(e){this.z=e;return this},setW:function(e){this.w=e;return this},setComponent:function(e,t){switch(e){case 0:this.x=t;break;case 1:this.y=t;break;case 2:this.z=t;break;case 3:this.w=t;break;default:throw new Error("index is out of range: "+e)}return this},getComponent:function(e){switch(e){case 0:return this.x;case 1:return this.y;case 2:return this.z;case 3:return this.w;default:throw new Error("index is out of range: "+e)}},clone:function(){return new this.constructor(this.x,this.y,this.z,this.w)},copy:function(e){this.x=e.x;this.y=e.y;this.z=e.z;this.w=e.w!==undefined?e.w:1;return this},add:function(e,t){if(t!==undefined){console.warn("THREE.Vector4: .add() now only accepts one argument. Use .addVectors( a, b ) instead.");return this.addVectors(e,t)}this.x+=e.x;this.y+=e.y;this.z+=e.z;this.w+=e.w;return this},addScalar:function(e){this.x+=e;this.y+=e;this.z+=e;this.w+=e;return this},addVectors:function(e,t){this.x=e.x+t.x;this.y=e.y+t.y;this.z=e.z+t.z;this.w=e.w+t.w;return this},addScaledVector:function(e,t){this.x+=e.x*t;this.y+=e.y*t;this.z+=e.z*t;this.w+=e.w*t;return this},sub:function(e,t){if(t!==undefined){console.warn("THREE.Vector4: .sub() now only accepts one argument. Use .subVectors( a, b ) instead.");return this.subVectors(e,t)}this.x-=e.x;this.y-=e.y;this.z-=e.z;this.w-=e.w;return this},subScalar:function(e){this.x-=e;this.y-=e;this.z-=e;this.w-=e;return this},subVectors:function(e,t){this.x=e.x-t.x;this.y=e.y-t.y;this.z=e.z-t.z;this.w=e.w-t.w;return this},multiplyScalar:function(e){this.x*=e;this.y*=e;this.z*=e;this.w*=e;return this},applyMatrix4:function(e){var t=this.x,r=this.y,n=this.z,i=this.w;var a=e.elements;this.x=a[0]*t+a[4]*r+a[8]*n+a[12]*i;this.y=a[1]*t+a[5]*r+a[9]*n+a[13]*i;this.z=a[2]*t+a[6]*r+a[10]*n+a[14]*i;this.w=a[3]*t+a[7]*r+a[11]*n+a[15]*i;return this},divideScalar:function(e){return this.multiplyScalar(1/e)},setAxisAngleFromQuaternion:function(e){this.w=2*Math.acos(e.w);var t=Math.sqrt(1-e.w*e.w);if(t<1e-4){this.x=1;this.y=0;this.z=0}else{this.x=e.x/t;this.y=e.y/t;this.z=e.z/t}return this},setAxisAngleFromRotationMatrix:function(e){var t,r,n,i,a=.01,o=.1,s=e.elements,u=s[0],l=s[4],c=s[8],h=s[1],f=s[5],d=s[9],p=s[2],v=s[6],m=s[10];if(Math.abs(l-h)<a&&Math.abs(c-p)<a&&Math.abs(d-v)<a){if(Math.abs(l+h)<o&&Math.abs(c+p)<o&&Math.abs(d+v)<o&&Math.abs(u+f+m-3)<o){this.set(1,0,0,0);return this}t=Math.PI;var g=(u+1)/2;var y=(f+1)/2;var x=(m+1)/2;var b=(l+h)/4;var w=(c+p)/4;var _=(d+v)/4;if(g>y&&g>x){if(g<a){r=0;n=.707106781;i=.707106781}else{r=Math.sqrt(g);n=b/r;i=w/r}}else if(y>x){if(y<a){r=.707106781;n=0;i=.707106781}else{n=Math.sqrt(y);r=b/n;i=_/n}}else{if(x<a){r=.707106781;n=.707106781;i=0}else{i=Math.sqrt(x);r=w/i;n=_/i}}this.set(r,n,i,t);return this}var T=Math.sqrt((v-d)*(v-d)+(c-p)*(c-p)+(h-l)*(h-l));if(Math.abs(T)<.001)T=1;this.x=(v-d)/T;this.y=(c-p)/T;this.z=(h-l)/T;this.w=Math.acos((u+f+m-1)/2);return this},min:function(e){this.x=Math.min(this.x,e.x);this.y=Math.min(this.y,e.y);this.z=Math.min(this.z,e.z);this.w=Math.min(this.w,e.w);return this},max:function(e){this.x=Math.max(this.x,e.x);this.y=Math.max(this.y,e.y);this.z=Math.max(this.z,e.z);this.w=Math.max(this.w,e.w);return this},clamp:function(e,t){this.x=Math.max(e.x,Math.min(t.x,this.x));this.y=Math.max(e.y,Math.min(t.y,this.y));this.z=Math.max(e.z,Math.min(t.z,this.z));this.w=Math.max(e.w,Math.min(t.w,this.w));return this},clampScalar:function(e,t){this.x=Math.max(e,Math.min(t,this.x));this.y=Math.max(e,Math.min(t,this.y));this.z=Math.max(e,Math.min(t,this.z));this.w=Math.max(e,Math.min(t,this.w));return this},clampLength:function(e,t){var r=this.length();return this.divideScalar(r||1).multiplyScalar(Math.max(e,Math.min(t,r)))},floor:function(){this.x=Math.floor(this.x);this.y=Math.floor(this.y);this.z=Math.floor(this.z);this.w=Math.floor(this.w);return this},ceil:function(){this.x=Math.ceil(this.x);this.y=Math.ceil(this.y);this.z=Math.ceil(this.z);this.w=Math.ceil(this.w);return this},round:function(){this.x=Math.round(this.x);this.y=Math.round(this.y);this.z=Math.round(this.z);this.w=Math.round(this.w);return this},roundToZero:function(){this.x=this.x<0?Math.ceil(this.x):Math.floor(this.x);this.y=this.y<0?Math.ceil(this.y):Math.floor(this.y);this.z=this.z<0?Math.ceil(this.z):Math.floor(this.z);this.w=this.w<0?Math.ceil(this.w):Math.floor(this.w);return this},negate:function(){this.x=-this.x;this.y=-this.y;this.z=-this.z;this.w=-this.w;return this},dot:function(e){return this.x*e.x+this.y*e.y+this.z*e.z+this.w*e.w},lengthSq:function(){return this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w},length:function(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w)},manhattanLength:function(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)+Math.abs(this.w)},normalize:function(){return this.divideScalar(this.length()||1)},setLength:function(e){return this.normalize().multiplyScalar(e)},lerp:function(e,t){this.x+=(e.x-this.x)*t;this.y+=(e.y-this.y)*t;this.z+=(e.z-this.z)*t;this.w+=(e.w-this.w)*t;return this},lerpVectors:function(e,t,r){return this.subVectors(t,e).multiplyScalar(r).add(e)},equals:function(e){return e.x===this.x&&e.y===this.y&&e.z===this.z&&e.w===this.w},fromArray:function(e,t){if(t===undefined)t=0;this.x=e[t];this.y=e[t+1];this.z=e[t+2];this.w=e[t+3];return this},toArray:function(e,t){if(e===undefined)e=[];if(t===undefined)t=0;e[t]=this.x;e[t+1]=this.y;e[t+2]=this.z;e[t+3]=this.w;return e},fromBufferAttribute:function(e,t,r){if(r!==undefined){console.warn("THREE.Vector4: offset has been removed from .fromBufferAttribute().")}this.x=e.getX(t);this.y=e.getY(t);this.z=e.getZ(t);this.w=e.getW(t);return this}});function _r(e,t,r){this.width=e;this.height=t;this.scissor=new wr(0,0,e,t);this.scissorTest=false;this.viewport=new wr(0,0,e,t);r=r||{};this.texture=new br(undefined,undefined,r.wrapS,r.wrapT,r.magFilter,r.minFilter,r.format,r.type,r.anisotropy,r.encoding);this.texture.image={};this.texture.image.width=e;this.texture.image.height=t;this.texture.generateMipmaps=r.generateMipmaps!==undefined?r.generateMipmaps:false;this.texture.minFilter=r.minFilter!==undefined?r.minFilter:ie;this.depthBuffer=r.depthBuffer!==undefined?r.depthBuffer:true;this.stencilBuffer=r.stencilBuffer!==undefined?r.stencilBuffer:true;this.depthTexture=r.depthTexture!==undefined?r.depthTexture:null}_r.prototype=Object.assign(Object.create(or.prototype),{constructor:_r,isWebGLRenderTarget:true,setSize:function(e,t){if(this.width!==e||this.height!==t){this.width=e;this.height=t;this.texture.image.width=e;this.texture.image.height=t;this.dispose()}this.viewport.set(0,0,e,t);this.scissor.set(0,0,e,t)},clone:function(){return(new this.constructor).copy(this)},copy:function(e){this.width=e.width;this.height=e.height;this.viewport.copy(e.viewport);this.texture=e.texture.clone();this.depthBuffer=e.depthBuffer;this.stencilBuffer=e.stencilBuffer;this.depthTexture=e.depthTexture;return this},dispose:function(){this.dispatchEvent({type:"dispose"})}});function Tr(e,t,r){_r.call(this,e,t,r);this.samples=4}Tr.prototype=Object.assign(Object.create(_r.prototype),{constructor:Tr,isWebGLMultisampleRenderTarget:true,copy:function(e){_r.prototype.copy.call(this,e);this.samples=e.samples;return this}});var Er=new pr;var Mr=new Or;var Sr=new pr(0,0,0);var Ar=new pr(1,1,1);var Rr=new pr;var Pr=new pr;var Cr=new pr;function Or(){this.elements=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1];if(arguments.length>0){console.error("THREE.Matrix4: the constructor no longer reads arguments. use .set() instead.")}}Object.assign(Or.prototype,{isMatrix4:true,set:function(e,t,r,n,i,a,o,s,u,l,c,h,f,d,p,v){var m=this.elements;m[0]=e;m[4]=t;m[8]=r;m[12]=n;m[1]=i;m[5]=a;m[9]=o;m[13]=s;m[2]=u;m[6]=l;m[10]=c;m[14]=h;m[3]=f;m[7]=d;m[11]=p;m[15]=v;return this},identity:function(){this.set(1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1);return this},clone:function(){return(new Or).fromArray(this.elements)},copy:function(e){var t=this.elements;var r=e.elements;t[0]=r[0];t[1]=r[1];t[2]=r[2];t[3]=r[3];t[4]=r[4];t[5]=r[5];t[6]=r[6];t[7]=r[7];t[8]=r[8];t[9]=r[9];t[10]=r[10];t[11]=r[11];t[12]=r[12];t[13]=r[13];t[14]=r[14];t[15]=r[15];return this},copyPosition:function(e){var t=this.elements,r=e.elements;t[12]=r[12];t[13]=r[13];t[14]=r[14];return this},extractBasis:function(e,t,r){e.setFromMatrixColumn(this,0);t.setFromMatrixColumn(this,1);r.setFromMatrixColumn(this,2);return this},makeBasis:function(e,t,r){this.set(e.x,t.x,r.x,0,e.y,t.y,r.y,0,e.z,t.z,r.z,0,0,0,0,1);return this},extractRotation:function(e){var t=this.elements;var r=e.elements;var n=1/Er.setFromMatrixColumn(e,0).length();var i=1/Er.setFromMatrixColumn(e,1).length();var a=1/Er.setFromMatrixColumn(e,2).length();t[0]=r[0]*n;t[1]=r[1]*n;t[2]=r[2]*n;t[3]=0;t[4]=r[4]*i;t[5]=r[5]*i;t[6]=r[6]*i;t[7]=0;t[8]=r[8]*a;t[9]=r[9]*a;t[10]=r[10]*a;t[11]=0;t[12]=0;t[13]=0;t[14]=0;t[15]=1;return this},makeRotationFromEuler:function(e){if(!(e&&e.isEuler)){console.error("THREE.Matrix4: .makeRotationFromEuler() now expects a Euler rotation rather than a Vector3 and order.")}var t=this.elements;var r=e.x,n=e.y,i=e.z;var a=Math.cos(r),o=Math.sin(r);var s=Math.cos(n),u=Math.sin(n);var l=Math.cos(i),c=Math.sin(i);if(e.order==="XYZ"){var h=a*l,f=a*c,d=o*l,p=o*c;t[0]=s*l;t[4]=-s*c;t[8]=u;t[1]=f+d*u;t[5]=h-p*u;t[9]=-o*s;t[2]=p-h*u;t[6]=d+f*u;t[10]=a*s}else if(e.order==="YXZ"){var v=s*l,m=s*c,g=u*l,y=u*c;t[0]=v+y*o;t[4]=g*o-m;t[8]=a*u;t[1]=a*c;t[5]=a*l;t[9]=-o;t[2]=m*o-g;t[6]=y+v*o;t[10]=a*s}else if(e.order==="ZXY"){var v=s*l,m=s*c,g=u*l,y=u*c;t[0]=v-y*o;t[4]=-a*c;t[8]=g+m*o;t[1]=m+g*o;t[5]=a*l;t[9]=y-v*o;t[2]=-a*u;t[6]=o;t[10]=a*s}else if(e.order==="ZYX"){var h=a*l,f=a*c,d=o*l,p=o*c;t[0]=s*l;t[4]=d*u-f;t[8]=h*u+p;t[1]=s*c;t[5]=p*u+h;t[9]=f*u-d;t[2]=-u;t[6]=o*s;t[10]=a*s}else if(e.order==="YZX"){var x=a*s,b=a*u,w=o*s,_=o*u;t[0]=s*l;t[4]=_-x*c;t[8]=w*c+b;t[1]=c;t[5]=a*l;t[9]=-o*l;t[2]=-u*l;t[6]=b*c+w;t[10]=x-_*c}else if(e.order==="XZY"){var x=a*s,b=a*u,w=o*s,_=o*u;t[0]=s*l;t[4]=-c;t[8]=u*l;t[1]=x*c+_;t[5]=a*l;t[9]=b*c-w;t[2]=w*c-b;t[6]=o*l;t[10]=_*c+x}t[3]=0;t[7]=0;t[11]=0;t[12]=0;t[13]=0;t[14]=0;t[15]=1;return this},makeRotationFromQuaternion:function(e){return this.compose(Sr,e,Ar)},lookAt:function(e,t,r){var n=this.elements;Cr.subVectors(e,t);if(Cr.lengthSq()===0){Cr.z=1}Cr.normalize();Rr.crossVectors(r,Cr);if(Rr.lengthSq()===0){if(Math.abs(r.z)===1){Cr.x+=1e-4}else{Cr.z+=1e-4}Cr.normalize();Rr.crossVectors(r,Cr)}Rr.normalize();Pr.crossVectors(Cr,Rr);n[0]=Rr.x;n[4]=Pr.x;n[8]=Cr.x;n[1]=Rr.y;n[5]=Pr.y;n[9]=Cr.y;n[2]=Rr.z;n[6]=Pr.z;n[10]=Cr.z;return this},multiply:function(e,t){if(t!==undefined){console.warn("THREE.Matrix4: .multiply() now only accepts one argument. Use .multiplyMatrices( a, b ) instead.");return this.multiplyMatrices(e,t)}return this.multiplyMatrices(this,e)},premultiply:function(e){return this.multiplyMatrices(e,this)},multiplyMatrices:function(e,t){var r=e.elements;var n=t.elements;var i=this.elements;var a=r[0],o=r[4],s=r[8],u=r[12];var l=r[1],c=r[5],h=r[9],f=r[13];var d=r[2],p=r[6],v=r[10],m=r[14];var g=r[3],y=r[7],x=r[11],b=r[15];var w=n[0],_=n[4],T=n[8],E=n[12];var M=n[1],S=n[5],A=n[9],R=n[13];var P=n[2],C=n[6],O=n[10],L=n[14];var I=n[3],D=n[7],N=n[11],F=n[15];i[0]=a*w+o*M+s*P+u*I;i[4]=a*_+o*S+s*C+u*D;i[8]=a*T+o*A+s*O+u*N;i[12]=a*E+o*R+s*L+u*F;i[1]=l*w+c*M+h*P+f*I;i[5]=l*_+c*S+h*C+f*D;i[9]=l*T+c*A+h*O+f*N;i[13]=l*E+c*R+h*L+f*F;i[2]=d*w+p*M+v*P+m*I;i[6]=d*_+p*S+v*C+m*D;i[10]=d*T+p*A+v*O+m*N;i[14]=d*E+p*R+v*L+m*F;i[3]=g*w+y*M+x*P+b*I;i[7]=g*_+y*S+x*C+b*D;i[11]=g*T+y*A+x*O+b*N;i[15]=g*E+y*R+x*L+b*F;return this},multiplyScalar:function(e){var t=this.elements;t[0]*=e;t[4]*=e;t[8]*=e;t[12]*=e;t[1]*=e;t[5]*=e;t[9]*=e;t[13]*=e;t[2]*=e;t[6]*=e;t[10]*=e;t[14]*=e;t[3]*=e;t[7]*=e;t[11]*=e;t[15]*=e;return this},applyToBufferAttribute:function(e){for(var t=0,r=e.count;t<r;t++){Er.x=e.getX(t);Er.y=e.getY(t);Er.z=e.getZ(t);Er.applyMatrix4(this);e.setXYZ(t,Er.x,Er.y,Er.z)}return e},determinant:function(){var e=this.elements;var t=e[0],r=e[4],n=e[8],i=e[12];var a=e[1],o=e[5],s=e[9],u=e[13];var l=e[2],c=e[6],h=e[10],f=e[14];var d=e[3],p=e[7],v=e[11],m=e[15];return d*(+i*s*c-n*u*c-i*o*h+r*u*h+n*o*f-r*s*f)+p*(+t*s*f-t*u*h+i*a*h-n*a*f+n*u*l-i*s*l)+v*(+t*u*c-t*o*f-i*a*c+r*a*f+i*o*l-r*u*l)+m*(-n*o*l-t*s*c+t*o*h+n*a*c-r*a*h+r*s*l)},transpose:function(){var e=this.elements;var t;t=e[1];e[1]=e[4];e[4]=t;t=e[2];e[2]=e[8];e[8]=t;t=e[6];e[6]=e[9];e[9]=t;t=e[3];e[3]=e[12];e[12]=t;t=e[7];e[7]=e[13];e[13]=t;t=e[11];e[11]=e[14];e[14]=t;return this},setPosition:function(e,t,r){var n=this.elements;if(e.isVector3){n[12]=e.x;n[13]=e.y;n[14]=e.z}else{n[12]=e;n[13]=t;n[14]=r}return this},getInverse:function(e,t){var r=this.elements,n=e.elements,i=n[0],a=n[1],o=n[2],s=n[3],u=n[4],l=n[5],c=n[6],h=n[7],f=n[8],d=n[9],p=n[10],v=n[11],m=n[12],g=n[13],y=n[14],x=n[15],b=d*y*h-g*p*h+g*c*v-l*y*v-d*c*x+l*p*x,w=m*p*h-f*y*h-m*c*v+u*y*v+f*c*x-u*p*x,_=f*g*h-m*d*h+m*l*v-u*g*v-f*l*x+u*d*x,T=m*d*c-f*g*c-m*l*p+u*g*p+f*l*y-u*d*y;var E=i*b+a*w+o*_+s*T;if(E===0){var M="THREE.Matrix4: .getInverse() can't invert matrix, determinant is 0";if(t===true){throw new Error(M)}else{console.warn(M)}return this.identity()}var S=1/E;r[0]=b*S;r[1]=(g*p*s-d*y*s-g*o*v+a*y*v+d*o*x-a*p*x)*S;r[2]=(l*y*s-g*c*s+g*o*h-a*y*h-l*o*x+a*c*x)*S;r[3]=(d*c*s-l*p*s-d*o*h+a*p*h+l*o*v-a*c*v)*S;r[4]=w*S;r[5]=(f*y*s-m*p*s+m*o*v-i*y*v-f*o*x+i*p*x)*S;r[6]=(m*c*s-u*y*s-m*o*h+i*y*h+u*o*x-i*c*x)*S;r[7]=(u*p*s-f*c*s+f*o*h-i*p*h-u*o*v+i*c*v)*S;r[8]=_*S;r[9]=(m*d*s-f*g*s-m*a*v+i*g*v+f*a*x-i*d*x)*S;r[10]=(u*g*s-m*l*s+m*a*h-i*g*h-u*a*x+i*l*x)*S;r[11]=(f*l*s-u*d*s-f*a*h+i*d*h+u*a*v-i*l*v)*S;r[12]=T*S;r[13]=(f*g*o-m*d*o+m*a*p-i*g*p-f*a*y+i*d*y)*S;r[14]=(m*l*o-u*g*o-m*a*c+i*g*c+u*a*y-i*l*y)*S;r[15]=(u*d*o-f*l*o+f*a*c-i*d*c-u*a*p+i*l*p)*S;return this},scale:function(e){var t=this.elements;var r=e.x,n=e.y,i=e.z;t[0]*=r;t[4]*=n;t[8]*=i;t[1]*=r;t[5]*=n;t[9]*=i;t[2]*=r;t[6]*=n;t[10]*=i;t[3]*=r;t[7]*=n;t[11]*=i;return this},getMaxScaleOnAxis:function(){var e=this.elements;var t=e[0]*e[0]+e[1]*e[1]+e[2]*e[2];var r=e[4]*e[4]+e[5]*e[5]+e[6]*e[6];var n=e[8]*e[8]+e[9]*e[9]+e[10]*e[10];return Math.sqrt(Math.max(t,r,n))},makeTranslation:function(e,t,r){this.set(1,0,0,e,0,1,0,t,0,0,1,r,0,0,0,1);return this},makeRotationX:function(e){var t=Math.cos(e),r=Math.sin(e);this.set(1,0,0,0,0,t,-r,0,0,r,t,0,0,0,0,1);return this},makeRotationY:function(e){var t=Math.cos(e),r=Math.sin(e);this.set(t,0,r,0,0,1,0,0,-r,0,t,0,0,0,0,1);return this},makeRotationZ:function(e){var t=Math.cos(e),r=Math.sin(e);this.set(t,-r,0,0,r,t,0,0,0,0,1,0,0,0,0,1);return this},makeRotationAxis:function(e,t){var r=Math.cos(t);var n=Math.sin(t);var i=1-r;var a=e.x,o=e.y,s=e.z;var u=i*a,l=i*o;this.set(u*a+r,u*o-n*s,u*s+n*o,0,u*o+n*s,l*o+r,l*s-n*a,0,u*s-n*o,l*s+n*a,i*s*s+r,0,0,0,0,1);return this},makeScale:function(e,t,r){this.set(e,0,0,0,0,t,0,0,0,0,r,0,0,0,0,1);return this},makeShear:function(e,t,r){this.set(1,t,r,0,e,1,r,0,e,t,1,0,0,0,0,1);return this},compose:function(e,t,r){var n=this.elements;var i=t._x,a=t._y,o=t._z,s=t._w;var u=i+i,l=a+a,c=o+o;var h=i*u,f=i*l,d=i*c;var p=a*l,v=a*c,m=o*c;var g=s*u,y=s*l,x=s*c;var b=r.x,w=r.y,_=r.z;n[0]=(1-(p+m))*b;n[1]=(f+x)*b;n[2]=(d-y)*b;n[3]=0;n[4]=(f-x)*w;n[5]=(1-(h+m))*w;n[6]=(v+g)*w;n[7]=0;n[8]=(d+y)*_;n[9]=(v-g)*_;n[10]=(1-(h+p))*_;n[11]=0;n[12]=e.x;n[13]=e.y;n[14]=e.z;n[15]=1;return this},decompose:function(e,t,r){var n=this.elements;var i=Er.set(n[0],n[1],n[2]).length();var a=Er.set(n[4],n[5],n[6]).length();var o=Er.set(n[8],n[9],n[10]).length();var s=this.determinant();if(s<0)i=-i;e.x=n[12];e.y=n[13];e.z=n[14];Mr.copy(this);var u=1/i;var l=1/a;var c=1/o;Mr.elements[0]*=u;Mr.elements[1]*=u;Mr.elements[2]*=u;Mr.elements[4]*=l;Mr.elements[5]*=l;Mr.elements[6]*=l;Mr.elements[8]*=c;Mr.elements[9]*=c;Mr.elements[10]*=c;t.setFromRotationMatrix(Mr);r.x=i;r.y=a;r.z=o;return this},makePerspective:function(e,t,r,n,i,a){if(a===undefined){console.warn("THREE.Matrix4: .makePerspective() has been redefined and has a new signature. Please check the docs.")}var o=this.elements;var s=2*i/(t-e);var u=2*i/(r-n);var l=(t+e)/(t-e);var c=(r+n)/(r-n);var h=-(a+i)/(a-i);var f=-2*a*i/(a-i);o[0]=s;o[4]=0;o[8]=l;o[12]=0;o[1]=0;o[5]=u;o[9]=c;o[13]=0;o[2]=0;o[6]=0;o[10]=h;o[14]=f;o[3]=0;o[7]=0;o[11]=-1;o[15]=0;return this},makeOrthographic:function(e,t,r,n,i,a){var o=this.elements;var s=1/(t-e);var u=1/(r-n);var l=1/(a-i);var c=(t+e)*s;var h=(r+n)*u;var f=(a+i)*l;o[0]=2*s;o[4]=0;o[8]=0;o[12]=-c;o[1]=0;o[5]=2*u;o[9]=0;o[13]=-h;o[2]=0;o[6]=0;o[10]=-2*l;o[14]=-f;o[3]=0;o[7]=0;o[11]=0;o[15]=1;return this},equals:function(e){var t=this.elements;var r=e.elements;for(var n=0;n<16;n++){if(t[n]!==r[n])return false}return true},fromArray:function(e,t){if(t===undefined)t=0;for(var r=0;r<16;r++){this.elements[r]=e[r+t]}return this},toArray:function(e,t){if(e===undefined)e=[];if(t===undefined)t=0;var r=this.elements;e[t]=r[0];e[t+1]=r[1];e[t+2]=r[2];e[t+3]=r[3];e[t+4]=r[4];e[t+5]=r[5];e[t+6]=r[6];e[t+7]=r[7];e[t+8]=r[8];e[t+9]=r[9];e[t+10]=r[10];e[t+11]=r[11];e[t+12]=r[12];e[t+13]=r[13];e[t+14]=r[14];e[t+15]=r[15];return e}});var Lr=new Or;var Ir=new hr;function Dr(e,t,r,n){this._x=e||0;this._y=t||0;this._z=r||0;this._order=n||Dr.DefaultOrder}Dr.RotationOrders=["XYZ","YZX","ZXY","XZY","YXZ","ZYX"];Dr.DefaultOrder="XYZ";Object.defineProperties(Dr.prototype,{x:{get:function(){return this._x},set:function(e){this._x=e;this._onChangeCallback()}},y:{get:function(){return this._y},set:function(e){this._y=e;this._onChangeCallback()}},z:{get:function(){return this._z},set:function(e){this._z=e;this._onChangeCallback()}},order:{get:function(){return this._order},set:function(e){this._order=e;this._onChangeCallback()}}});Object.assign(Dr.prototype,{isEuler:true,set:function(e,t,r,n){this._x=e;this._y=t;this._z=r;this._order=n||this._order;this._onChangeCallback();return this},clone:function(){return new this.constructor(this._x,this._y,this._z,this._order)},copy:function(e){this._x=e._x;this._y=e._y;this._z=e._z;this._order=e._order;this._onChangeCallback();return this},setFromRotationMatrix:function(e,t,r){var n=lr.clamp;var i=e.elements;var a=i[0],o=i[4],s=i[8];var u=i[1],l=i[5],c=i[9];var h=i[2],f=i[6],d=i[10];t=t||this._order;if(t==="XYZ"){this._y=Math.asin(n(s,-1,1));if(Math.abs(s)<.9999999){this._x=Math.atan2(-c,d);this._z=Math.atan2(-o,a)}else{this._x=Math.atan2(f,l);this._z=0}}else if(t==="YXZ"){this._x=Math.asin(-n(c,-1,1));if(Math.abs(c)<.9999999){this._y=Math.atan2(s,d);this._z=Math.atan2(u,l)}else{this._y=Math.atan2(-h,a);this._z=0}}else if(t==="ZXY"){this._x=Math.asin(n(f,-1,1));if(Math.abs(f)<.9999999){this._y=Math.atan2(-h,d);this._z=Math.atan2(-o,l)}else{this._y=0;this._z=Math.atan2(u,a)}}else if(t==="ZYX"){this._y=Math.asin(-n(h,-1,1));if(Math.abs(h)<.9999999){this._x=Math.atan2(f,d);this._z=Math.atan2(u,a)}else{this._x=0;this._z=Math.atan2(-o,l)}}else if(t==="YZX"){this._z=Math.asin(n(u,-1,1));if(Math.abs(u)<.9999999){this._x=Math.atan2(-c,l);this._y=Math.atan2(-h,a)}else{this._x=0;this._y=Math.atan2(s,d)}}else if(t==="XZY"){this._z=Math.asin(-n(o,-1,1));if(Math.abs(o)<.9999999){this._x=Math.atan2(f,l);this._y=Math.atan2(s,a)}else{this._x=Math.atan2(-c,d);this._y=0}}else{console.warn("THREE.Euler: .setFromRotationMatrix() given unsupported order: "+t)}this._order=t;if(r!==false)this._onChangeCallback();return this},setFromQuaternion:function(e,t,r){Lr.makeRotationFromQuaternion(e);return this.setFromRotationMatrix(Lr,t,r)},setFromVector3:function(e,t){return this.set(e.x,e.y,e.z,t||this._order)},reorder:function(e){Ir.setFromEuler(this);return this.setFromQuaternion(Ir,e)},equals:function(e){return e._x===this._x&&e._y===this._y&&e._z===this._z&&e._order===this._order},fromArray:function(e){this._x=e[0];this._y=e[1];this._z=e[2];if(e[3]!==undefined)this._order=e[3];this._onChangeCallback();return this},toArray:function(e,t){if(e===undefined)e=[];if(t===undefined)t=0;e[t]=this._x;e[t+1]=this._y;e[t+2]=this._z;e[t+3]=this._order;return e},toVector3:function(e){if(e){return e.set(this._x,this._y,this._z)}else{return new pr(this._x,this._y,this._z)}},_onChange:function(e){this._onChangeCallback=e;return this},_onChangeCallback:function(){}});function Nr(){this.mask=1|0}Object.assign(Nr.prototype,{set:function(e){this.mask=1<<e|0},enable:function(e){this.mask|=1<<e|0},enableAll:function(){this.mask=4294967295|0},toggle:function(e){this.mask^=1<<e|0},disable:function(e){this.mask&=~(1<<e|0)},disableAll:function(){this.mask=0},test:function(e){return(this.mask&e.mask)!==0}});var Fr=0;var Br=new pr;var Ur=new hr;var kr=new Or;var jr=new pr;var zr=new pr;var Hr=new pr;var Gr=new hr;var Vr=new pr(1,0,0);var Wr=new pr(0,1,0);var qr=new pr(0,0,1);var Xr={type:"added"};var Yr={type:"removed"};function Zr(){Object.defineProperty(this,"id",{value:Fr++});this.uuid=lr.generateUUID();this.name="";this.type="Object3D";this.parent=null;this.children=[];this.up=Zr.DefaultUp.clone();var e=new pr;var t=new Dr;var r=new hr;var n=new pr(1,1,1);function i(){r.setFromEuler(t,false)}function a(){t.setFromQuaternion(r,undefined,false)}t._onChange(i);r._onChange(a);Object.defineProperties(this,{position:{configurable:true,enumerable:true,value:e},rotation:{configurable:true,enumerable:true,value:t},quaternion:{configurable:true,enumerable:true,value:r},scale:{configurable:true,enumerable:true,value:n},modelViewMatrix:{value:new Or},normalMatrix:{value:new mr}});this.matrix=new Or;this.matrixWorld=new Or;this.matrixAutoUpdate=Zr.DefaultMatrixAutoUpdate;this.matrixWorldNeedsUpdate=false;this.layers=new Nr;this.visible=true;this.castShadow=false;this.receiveShadow=false;this.frustumCulled=true;this.renderOrder=0;this.userData={}}Zr.DefaultUp=new pr(0,1,0);Zr.DefaultMatrixAutoUpdate=true;Zr.prototype=Object.assign(Object.create(or.prototype),{constructor:Zr,isObject3D:true,onBeforeRender:function(){},onAfterRender:function(){},applyMatrix:function(e){if(this.matrixAutoUpdate)this.updateMatrix();this.matrix.premultiply(e);this.matrix.decompose(this.position,this.quaternion,this.scale)},applyQuaternion:function(e){this.quaternion.premultiply(e);return this},setRotationFromAxisAngle:function(e,t){this.quaternion.setFromAxisAngle(e,t)},setRotationFromEuler:function(e){this.quaternion.setFromEuler(e,true)},setRotationFromMatrix:function(e){this.quaternion.setFromRotationMatrix(e)},setRotationFromQuaternion:function(e){this.quaternion.copy(e)},rotateOnAxis:function(e,t){Ur.setFromAxisAngle(e,t);this.quaternion.multiply(Ur);return this},rotateOnWorldAxis:function(e,t){Ur.setFromAxisAngle(e,t);this.quaternion.premultiply(Ur);return this},rotateX:function(e){return this.rotateOnAxis(Vr,e)},rotateY:function(e){return this.rotateOnAxis(Wr,e)},rotateZ:function(e){return this.rotateOnAxis(qr,e)},translateOnAxis:function(e,t){Br.copy(e).applyQuaternion(this.quaternion);this.position.add(Br.multiplyScalar(t));return this},translateX:function(e){return this.translateOnAxis(Vr,e)},translateY:function(e){return this.translateOnAxis(Wr,e)},translateZ:function(e){return this.translateOnAxis(qr,e)},localToWorld:function(e){return e.applyMatrix4(this.matrixWorld)},worldToLocal:function(e){return e.applyMatrix4(kr.getInverse(this.matrixWorld))},lookAt:function(e,t,r){if(e.isVector3){jr.copy(e)}else{jr.set(e,t,r)}var n=this.parent;this.updateWorldMatrix(true,false);zr.setFromMatrixPosition(this.matrixWorld);if(this.isCamera||this.isLight){kr.lookAt(zr,jr,this.up)}else{kr.lookAt(jr,zr,this.up)}this.quaternion.setFromRotationMatrix(kr);if(n){kr.extractRotation(n.matrixWorld);Ur.setFromRotationMatrix(kr);this.quaternion.premultiply(Ur.inverse())}},add:function(e){if(arguments.length>1){for(var t=0;t<arguments.length;t++){this.add(arguments[t])}return this}if(e===this){console.error("THREE.Object3D.add: object can't be added as a child of itself.",e);return this}if(e&&e.isObject3D){if(e.parent!==null){e.parent.remove(e)}e.parent=this;this.children.push(e);e.dispatchEvent(Xr)}else{console.error("THREE.Object3D.add: object not an instance of THREE.Object3D.",e)}return this},remove:function(e){if(arguments.length>1){for(var t=0;t<arguments.length;t++){this.remove(arguments[t])}return this}var r=this.children.indexOf(e);if(r!==-1){e.parent=null;this.children.splice(r,1);e.dispatchEvent(Yr)}return this},attach:function(e){this.updateWorldMatrix(true,false);kr.getInverse(this.matrixWorld);if(e.parent!==null){e.parent.updateWorldMatrix(true,false);kr.multiply(e.parent.matrixWorld)}e.applyMatrix(kr);e.updateWorldMatrix(false,false);this.add(e);return this},getObjectById:function(e){return this.getObjectByProperty("id",e)},getObjectByName:function(e){return this.getObjectByProperty("name",e)},getObjectByProperty:function(e,t){if(this[e]===t)return this;for(var r=0,n=this.children.length;r<n;r++){var i=this.children[r];var a=i.getObjectByProperty(e,t);if(a!==undefined){return a}}return undefined},getWorldPosition:function(e){if(e===undefined){console.warn("THREE.Object3D: .getWorldPosition() target is now required");e=new pr}this.updateMatrixWorld(true);return e.setFromMatrixPosition(this.matrixWorld)},getWorldQuaternion:function(e){if(e===undefined){console.warn("THREE.Object3D: .getWorldQuaternion() target is now required");e=new hr}this.updateMatrixWorld(true);this.matrixWorld.decompose(zr,e,Hr);return e},getWorldScale:function(e){if(e===undefined){console.warn("THREE.Object3D: .getWorldScale() target is now required");e=new pr}this.updateMatrixWorld(true);this.matrixWorld.decompose(zr,Gr,e);return e},getWorldDirection:function(e){if(e===undefined){console.warn("THREE.Object3D: .getWorldDirection() target is now required");e=new pr}this.updateMatrixWorld(true);var t=this.matrixWorld.elements;return e.set(t[8],t[9],t[10]).normalize()},raycast:function(){},traverse:function(e){e(this);var t=this.children;for(var r=0,n=t.length;r<n;r++){t[r].traverse(e)}},traverseVisible:function(e){if(this.visible===false)return;e(this);var t=this.children;for(var r=0,n=t.length;r<n;r++){t[r].traverseVisible(e)}},traverseAncestors:function(e){var t=this.parent;if(t!==null){e(t);t.traverseAncestors(e)}},updateMatrix:function(){this.matrix.compose(this.position,this.quaternion,this.scale);this.matrixWorldNeedsUpdate=true},updateMatrixWorld:function(e){if(this.matrixAutoUpdate)this.updateMatrix();if(this.matrixWorldNeedsUpdate||e){if(this.parent===null){this.matrixWorld.copy(this.matrix)}else{this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix)}this.matrixWorldNeedsUpdate=false;e=true}var t=this.children;for(var r=0,n=t.length;r<n;r++){t[r].updateMatrixWorld(e)}},updateWorldMatrix:function(e,t){var r=this.parent;if(e===true&&r!==null){r.updateWorldMatrix(true,false)}if(this.matrixAutoUpdate)this.updateMatrix();if(this.parent===null){this.matrixWorld.copy(this.matrix)}else{this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix)}if(t===true){var n=this.children;for(var i=0,a=n.length;i<a;i++){n[i].updateWorldMatrix(false,true)}}},toJSON:function(r){var e=r===undefined||typeof r==="string";var t={};if(e){r={geometries:{},materials:{},textures:{},images:{},shapes:{}};t.metadata={version:4.5,type:"Object",generator:"Object3D.toJSON"}}var n={};n.uuid=this.uuid;n.type=this.type;if(this.name!=="")n.name=this.name;if(this.castShadow===true)n.castShadow=true;if(this.receiveShadow===true)n.receiveShadow=true;if(this.visible===false)n.visible=false;if(this.frustumCulled===false)n.frustumCulled=false;if(this.renderOrder!==0)n.renderOrder=this.renderOrder;if(JSON.stringify(this.userData)!=="{}")n.userData=this.userData;n.layers=this.layers.mask;n.matrix=this.matrix.toArray();if(this.matrixAutoUpdate===false)n.matrixAutoUpdate=false;if(this.isMesh&&this.drawMode!==Pt)n.drawMode=this.drawMode;function i(e,t){if(e[t.uuid]===undefined){e[t.uuid]=t.toJSON(r)}return t.uuid}if(this.isMesh||this.isLine||this.isPoints){n.geometry=i(r.geometries,this.geometry);var a=this.geometry.parameters;if(a!==undefined&&a.shapes!==undefined){var o=a.shapes;if(Array.isArray(o)){for(var s=0,u=o.length;s<u;s++){var l=o[s];i(r.shapes,l)}}else{i(r.shapes,o)}}}if(this.material!==undefined){if(Array.isArray(this.material)){var c=[];for(var s=0,u=this.material.length;s<u;s++){c.push(i(r.materials,this.material[s]))}n.material=c}else{n.material=i(r.materials,this.material)}}if(this.children.length>0){n.children=[];for(var s=0;s<this.children.length;s++){n.children.push(this.children[s].toJSON(r).object)}}if(e){var h=v(r.geometries);var f=v(r.materials);var d=v(r.textures);var p=v(r.images);var o=v(r.shapes);if(h.length>0)t.geometries=h;if(f.length>0)t.materials=f;if(d.length>0)t.textures=d;if(p.length>0)t.images=p;if(o.length>0)t.shapes=o}t.object=n;return t;function v(e){var t=[];for(var r in e){var n=e[r];delete n.metadata;t.push(n)}return t}},clone:function(e){return(new this.constructor).copy(this,e)},copy:function(e,t){if(t===undefined)t=true;this.name=e.name;this.up.copy(e.up);this.position.copy(e.position);this.quaternion.copy(e.quaternion);this.scale.copy(e.scale);this.matrix.copy(e.matrix);this.matrixWorld.copy(e.matrixWorld);this.matrixAutoUpdate=e.matrixAutoUpdate;this.matrixWorldNeedsUpdate=e.matrixWorldNeedsUpdate;this.layers.mask=e.layers.mask;this.visible=e.visible;this.castShadow=e.castShadow;this.receiveShadow=e.receiveShadow;this.frustumCulled=e.frustumCulled;this.renderOrder=e.renderOrder;this.userData=JSON.parse(JSON.stringify(e.userData));if(t===true){for(var r=0;r<e.children.length;r++){var n=e.children[r];this.add(n.clone())}}return this}});function Jr(){Zr.call(this);this.type="Scene";this.background=null;this.fog=null;this.overrideMaterial=null;this.autoUpdate=true;if(typeof __THREE_DEVTOOLS__!=="undefined"){__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("observe",{detail:this}))}}Jr.prototype=Object.assign(Object.create(Zr.prototype),{constructor:Jr,isScene:true,copy:function(e,t){Zr.prototype.copy.call(this,e,t);if(e.background!==null)this.background=e.background.clone();if(e.fog!==null)this.fog=e.fog.clone();if(e.overrideMaterial!==null)this.overrideMaterial=e.overrideMaterial.clone();this.autoUpdate=e.autoUpdate;this.matrixAutoUpdate=e.matrixAutoUpdate;return this},toJSON:function(e){var t=Zr.prototype.toJSON.call(this,e);if(this.background!==null)t.object.background=this.background.toJSON(e);if(this.fog!==null)t.object.fog=this.fog.toJSON();return t},dispose:function(){this.dispatchEvent({type:"dispose"})}});var Kr=[new pr,new pr,new pr,new pr,new pr,new pr,new pr,new pr];var Qr=new pr;var $r=new pr;var en=new pr;var tn=new pr;var rn=new pr;var nn=new pr;var an=new pr;var on=new pr;var sn=new pr;var un=new pr;var ln=new pr;function cn(e,t){this.min=e!==undefined?e:new pr(+Infinity,+Infinity,+Infinity);this.max=t!==undefined?t:new pr(-Infinity,-Infinity,-Infinity)}Object.assign(cn.prototype,{isBox3:true,set:function(e,t){this.min.copy(e);this.max.copy(t);return this},setFromArray:function(e){var t=+Infinity;var r=+Infinity;var n=+Infinity;var i=-Infinity;var a=-Infinity;var o=-Infinity;for(var s=0,u=e.length;s<u;s+=3){var l=e[s];var c=e[s+1];var h=e[s+2];if(l<t)t=l;if(c<r)r=c;if(h<n)n=h;if(l>i)i=l;if(c>a)a=c;if(h>o)o=h}this.min.set(t,r,n);this.max.set(i,a,o);return this},setFromBufferAttribute:function(e){var t=+Infinity;var r=+Infinity;var n=+Infinity;var i=-Infinity;var a=-Infinity;var o=-Infinity;for(var s=0,u=e.count;s<u;s++){var l=e.getX(s);var c=e.getY(s);var h=e.getZ(s);if(l<t)t=l;if(c<r)r=c;if(h<n)n=h;if(l>i)i=l;if(c>a)a=c;if(h>o)o=h}this.min.set(t,r,n);this.max.set(i,a,o);return this},setFromPoints:function(e){this.makeEmpty();for(var t=0,r=e.length;t<r;t++){this.expandByPoint(e[t])}return this},setFromCenterAndSize:function(e,t){var r=Qr.copy(t).multiplyScalar(.5);this.min.copy(e).sub(r);this.max.copy(e).add(r);return this},setFromObject:function(e){this.makeEmpty();return this.expandByObject(e)},clone:function(){return(new this.constructor).copy(this)},copy:function(e){this.min.copy(e.min);this.max.copy(e.max);return this},makeEmpty:function(){this.min.x=this.min.y=this.min.z=+Infinity;this.max.x=this.max.y=this.max.z=-Infinity;return this},isEmpty:function(){return this.max.x<this.min.x||this.max.y<this.min.y||this.max.z<this.min.z},getCenter:function(e){if(e===undefined){console.warn("THREE.Box3: .getCenter() target is now required");e=new pr}return this.isEmpty()?e.set(0,0,0):e.addVectors(this.min,this.max).multiplyScalar(.5)},getSize:function(e){if(e===undefined){console.warn("THREE.Box3: .getSize() target is now required");e=new pr}return this.isEmpty()?e.set(0,0,0):e.subVectors(this.max,this.min)},expandByPoint:function(e){this.min.min(e);this.max.max(e);return this},expandByVector:function(e){this.min.sub(e);this.max.add(e);return this},expandByScalar:function(e){this.min.addScalar(-e);this.max.addScalar(e);return this},expandByObject:function(e){var t,r;e.updateWorldMatrix(false,false);var n=e.geometry;if(n!==undefined){if(n.isGeometry){var i=n.vertices;for(t=0,r=i.length;t<r;t++){Qr.copy(i[t]);Qr.applyMatrix4(e.matrixWorld);this.expandByPoint(Qr)}}else if(n.isBufferGeometry){var a=n.attributes.position;if(a!==undefined){for(t=0,r=a.count;t<r;t++){Qr.fromBufferAttribute(a,t).applyMatrix4(e.matrixWorld);this.expandByPoint(Qr)}}}}var o=e.children;for(t=0,r=o.length;t<r;t++){this.expandByObject(o[t])}return this},containsPoint:function(e){return e.x<this.min.x||e.x>this.max.x||e.y<this.min.y||e.y>this.max.y||e.z<this.min.z||e.z>this.max.z?false:true},containsBox:function(e){return this.min.x<=e.min.x&&e.max.x<=this.max.x&&this.min.y<=e.min.y&&e.max.y<=this.max.y&&this.min.z<=e.min.z&&e.max.z<=this.max.z},getParameter:function(e,t){if(t===undefined){console.warn("THREE.Box3: .getParameter() target is now required");t=new pr}return t.set((e.x-this.min.x)/(this.max.x-this.min.x),(e.y-this.min.y)/(this.max.y-this.min.y),(e.z-this.min.z)/(this.max.z-this.min.z))},intersectsBox:function(e){return e.max.x<this.min.x||e.min.x>this.max.x||e.max.y<this.min.y||e.min.y>this.max.y||e.max.z<this.min.z||e.min.z>this.max.z?false:true},intersectsSphere:function(e){this.clampPoint(e.center,Qr);return Qr.distanceToSquared(e.center)<=e.radius*e.radius},intersectsPlane:function(e){var t,r;if(e.normal.x>0){t=e.normal.x*this.min.x;r=e.normal.x*this.max.x}else{t=e.normal.x*this.max.x;r=e.normal.x*this.min.x}if(e.normal.y>0){t+=e.normal.y*this.min.y;r+=e.normal.y*this.max.y}else{t+=e.normal.y*this.max.y;r+=e.normal.y*this.min.y}if(e.normal.z>0){t+=e.normal.z*this.min.z;r+=e.normal.z*this.max.z}else{t+=e.normal.z*this.max.z;r+=e.normal.z*this.min.z}return t<=-e.constant&&r>=-e.constant},intersectsTriangle:function(e){if(this.isEmpty()){return false}this.getCenter(on);sn.subVectors(this.max,on);$r.subVectors(e.a,on);en.subVectors(e.b,on);tn.subVectors(e.c,on);rn.subVectors(en,$r);nn.subVectors(tn,en);an.subVectors($r,tn);var t=[0,-rn.z,rn.y,0,-nn.z,nn.y,0,-an.z,an.y,rn.z,0,-rn.x,nn.z,0,-nn.x,an.z,0,-an.x,-rn.y,rn.x,0,-nn.y,nn.x,0,-an.y,an.x,0];if(!hn(t,$r,en,tn,sn)){return false}t=[1,0,0,0,1,0,0,0,1];if(!hn(t,$r,en,tn,sn)){return false}un.crossVectors(rn,nn);t=[un.x,un.y,un.z];return hn(t,$r,en,tn,sn)},clampPoint:function(e,t){if(t===undefined){console.warn("THREE.Box3: .clampPoint() target is now required");t=new pr}return t.copy(e).clamp(this.min,this.max)},distanceToPoint:function(e){var t=Qr.copy(e).clamp(this.min,this.max);return t.sub(e).length()},getBoundingSphere:function(e){if(e===undefined){console.error("THREE.Box3: .getBoundingSphere() target is now required")}this.getCenter(e.center);e.radius=this.getSize(Qr).length()*.5;return e},intersect:function(e){this.min.max(e.min);this.max.min(e.max);if(this.isEmpty())this.makeEmpty();return this},union:function(e){this.min.min(e.min);this.max.max(e.max);return this},applyMatrix4:function(e){if(this.isEmpty())return this;Kr[0].set(this.min.x,this.min.y,this.min.z).applyMatrix4(e);Kr[1].set(this.min.x,this.min.y,this.max.z).applyMatrix4(e);Kr[2].set(this.min.x,this.max.y,this.min.z).applyMatrix4(e);Kr[3].set(this.min.x,this.max.y,this.max.z).applyMatrix4(e);Kr[4].set(this.max.x,this.min.y,this.min.z).applyMatrix4(e);Kr[5].set(this.max.x,this.min.y,this.max.z).applyMatrix4(e);Kr[6].set(this.max.x,this.max.y,this.min.z).applyMatrix4(e);Kr[7].set(this.max.x,this.max.y,this.max.z).applyMatrix4(e);this.setFromPoints(Kr);return this},translate:function(e){this.min.add(e);this.max.add(e);return this},equals:function(e){return e.min.equals(this.min)&&e.max.equals(this.max)}});function hn(e,t,r,n,i){var a,o;for(a=0,o=e.length-3;a<=o;a+=3){ln.fromArray(e,a);var s=i.x*Math.abs(ln.x)+i.y*Math.abs(ln.y)+i.z*Math.abs(ln.z);var u=t.dot(ln);var l=r.dot(ln);var c=n.dot(ln);if(Math.max(-Math.max(u,l,c),Math.min(u,l,c))>s){return false}}return true}var fn=new cn;function dn(e,t){this.center=e!==undefined?e:new pr;this.radius=t!==undefined?t:0}Object.assign(dn.prototype,{set:function(e,t){this.center.copy(e);this.radius=t;return this},setFromPoints:function(e,t){var r=this.center;if(t!==undefined){r.copy(t)}else{fn.setFromPoints(e).getCenter(r)}var n=0;for(var i=0,a=e.length;i<a;i++){n=Math.max(n,r.distanceToSquared(e[i]))}this.radius=Math.sqrt(n);return this},clone:function(){return(new this.constructor).copy(this)},copy:function(e){this.center.copy(e.center);this.radius=e.radius;return this},empty:function(){return this.radius<=0},containsPoint:function(e){return e.distanceToSquared(this.center)<=this.radius*this.radius},distanceToPoint:function(e){return e.distanceTo(this.center)-this.radius},intersectsSphere:function(e){var t=this.radius+e.radius;return e.center.distanceToSquared(this.center)<=t*t},intersectsBox:function(e){return e.intersectsSphere(this)},intersectsPlane:function(e){return Math.abs(e.distanceToPoint(this.center))<=this.radius},clampPoint:function(e,t){var r=this.center.distanceToSquared(e);if(t===undefined){console.warn("THREE.Sphere: .clampPoint() target is now required");t=new pr}t.copy(e);if(r>this.radius*this.radius){t.sub(this.center).normalize();t.multiplyScalar(this.radius).add(this.center)}return t},getBoundingBox:function(e){if(e===undefined){console.warn("THREE.Sphere: .getBoundingBox() target is now required");e=new cn}e.set(this.center,this.center);e.expandByScalar(this.radius);return e},applyMatrix4:function(e){this.center.applyMatrix4(e);this.radius=this.radius*e.getMaxScaleOnAxis();return this},translate:function(e){this.center.add(e);return this},equals:function(e){return e.center.equals(this.center)&&e.radius===this.radius}});var pn=new pr;var vn=new pr;var mn=new pr;var gn=new pr;var yn=new pr;var xn=new pr;var bn=new pr;function wn(e,t){this.origin=e!==undefined?e:new pr;this.direction=t!==undefined?t:new pr}Object.assign(wn.prototype,{set:function(e,t){this.origin.copy(e);this.direction.copy(t);return this},clone:function(){return(new this.constructor).copy(this)},copy:function(e){this.origin.copy(e.origin);this.direction.copy(e.direction);return this},at:function(e,t){if(t===undefined){console.warn("THREE.Ray: .at() target is now required");t=new pr}return t.copy(this.direction).multiplyScalar(e).add(this.origin)},lookAt:function(e){this.direction.copy(e).sub(this.origin).normalize();return this},recast:function(e){this.origin.copy(this.at(e,pn));return this},closestPointToPoint:function(e,t){if(t===undefined){console.warn("THREE.Ray: .closestPointToPoint() target is now required");t=new pr}t.subVectors(e,this.origin);var r=t.dot(this.direction);if(r<0){return t.copy(this.origin)}return t.copy(this.direction).multiplyScalar(r).add(this.origin)},distanceToPoint:function(e){return Math.sqrt(this.distanceSqToPoint(e))},distanceSqToPoint:function(e){var t=pn.subVectors(e,this.origin).dot(this.direction);if(t<0){return this.origin.distanceToSquared(e)}pn.copy(this.direction).multiplyScalar(t).add(this.origin);return pn.distanceToSquared(e)},distanceSqToSegment:function(e,t,r,n){vn.copy(e).add(t).multiplyScalar(.5);mn.copy(t).sub(e).normalize();gn.copy(this.origin).sub(vn);var i=e.distanceTo(t)*.5;var a=-this.direction.dot(mn);var o=gn.dot(this.direction);var s=-gn.dot(mn);var u=gn.lengthSq();var l=Math.abs(1-a*a);var c,h,f,d;if(l>0){c=a*s-o;h=a*o-s;d=i*l;if(c>=0){if(h>=-d){if(h<=d){var p=1/l;c*=p;h*=p;f=c*(c+a*h+2*o)+h*(a*c+h+2*s)+u}else{h=i;c=Math.max(0,-(a*h+o));f=-c*c+h*(h+2*s)+u}}else{h=-i;c=Math.max(0,-(a*h+o));f=-c*c+h*(h+2*s)+u}}else{if(h<=-d){c=Math.max(0,-(-a*i+o));h=c>0?-i:Math.min(Math.max(-i,-s),i);f=-c*c+h*(h+2*s)+u}else if(h<=d){c=0;h=Math.min(Math.max(-i,-s),i);f=h*(h+2*s)+u}else{c=Math.max(0,-(a*i+o));h=c>0?i:Math.min(Math.max(-i,-s),i);f=-c*c+h*(h+2*s)+u}}}else{h=a>0?-i:i;c=Math.max(0,-(a*h+o));f=-c*c+h*(h+2*s)+u}if(r){r.copy(this.direction).multiplyScalar(c).add(this.origin)}if(n){n.copy(mn).multiplyScalar(h).add(vn)}return f},intersectSphere:function(e,t){pn.subVectors(e.center,this.origin);var r=pn.dot(this.direction);var n=pn.dot(pn)-r*r;var i=e.radius*e.radius;if(n>i)return null;var a=Math.sqrt(i-n);var o=r-a;var s=r+a;if(o<0&&s<0)return null;if(o<0)return this.at(s,t);return this.at(o,t)},intersectsSphere:function(e){return this.distanceSqToPoint(e.center)<=e.radius*e.radius},distanceToPlane:function(e){var t=e.normal.dot(this.direction);if(t===0){if(e.distanceToPoint(this.origin)===0){return 0}return null}var r=-(this.origin.dot(e.normal)+e.constant)/t;return r>=0?r:null},intersectPlane:function(e,t){var r=this.distanceToPlane(e);if(r===null){return null}return this.at(r,t)},intersectsPlane:function(e){var t=e.distanceToPoint(this.origin);if(t===0){return true}var r=e.normal.dot(this.direction);if(r*t<0){return true}return false},intersectBox:function(e,t){var r,n,i,a,o,s;var u=1/this.direction.x,l=1/this.direction.y,c=1/this.direction.z;var h=this.origin;if(u>=0){r=(e.min.x-h.x)*u;n=(e.max.x-h.x)*u}else{r=(e.max.x-h.x)*u;n=(e.min.x-h.x)*u}if(l>=0){i=(e.min.y-h.y)*l;a=(e.max.y-h.y)*l}else{i=(e.max.y-h.y)*l;a=(e.min.y-h.y)*l}if(r>a||i>n)return null;if(i>r||r!==r)r=i;if(a<n||n!==n)n=a;if(c>=0){o=(e.min.z-h.z)*c;s=(e.max.z-h.z)*c}else{o=(e.max.z-h.z)*c;s=(e.min.z-h.z)*c}if(r>s||o>n)return null;if(o>r||r!==r)r=o;if(s<n||n!==n)n=s;if(n<0)return null;return this.at(r>=0?r:n,t)},intersectsBox:function(e){return this.intersectBox(e,pn)!==null},intersectTriangle:function(e,t,r,n,i){yn.subVectors(t,e);xn.subVectors(r,e);bn.crossVectors(yn,xn);var a=this.direction.dot(bn);var o;if(a>0){if(n)return null;o=1}else if(a<0){o=-1;a=-a}else{return null}gn.subVectors(this.origin,e);var s=o*this.direction.dot(xn.crossVectors(gn,xn));if(s<0){return null}var u=o*this.direction.dot(yn.cross(gn));if(u<0){return null}if(s+u>a){return null}var l=-o*gn.dot(bn);if(l<0){return null}return this.at(l/a,i)},applyMatrix4:function(e){this.origin.applyMatrix4(e);this.direction.transformDirection(e);return this},equals:function(e){return e.origin.equals(this.origin)&&e.direction.equals(this.direction)}});var _n=new pr;var Tn=new pr;var En=new pr;var Mn=new pr;var Sn=new pr;var An=new pr;var Rn=new pr;var Pn=new pr;var Cn=new pr;var On=new pr;function Ln(e,t,r){this.a=e!==undefined?e:new pr;this.b=t!==undefined?t:new pr;this.c=r!==undefined?r:new pr}Object.assign(Ln,{getNormal:function(e,t,r,n){if(n===undefined){console.warn("THREE.Triangle: .getNormal() target is now required");n=new pr}n.subVectors(r,t);_n.subVectors(e,t);n.cross(_n);var i=n.lengthSq();if(i>0){return n.multiplyScalar(1/Math.sqrt(i))}return n.set(0,0,0)},getBarycoord:function(e,t,r,n,i){_n.subVectors(n,t);Tn.subVectors(r,t);En.subVectors(e,t);var a=_n.dot(_n);var o=_n.dot(Tn);var s=_n.dot(En);var u=Tn.dot(Tn);var l=Tn.dot(En);var c=a*u-o*o;if(i===undefined){console.warn("THREE.Triangle: .getBarycoord() target is now required");i=new pr}if(c===0){return i.set(-2,-1,-1)}var h=1/c;var f=(u*s-o*l)*h;var d=(a*l-o*s)*h;return i.set(1-f-d,d,f)},containsPoint:function(e,t,r,n){Ln.getBarycoord(e,t,r,n,Mn);return Mn.x>=0&&Mn.y>=0&&Mn.x+Mn.y<=1},getUV:function(e,t,r,n,i,a,o,s){this.getBarycoord(e,t,r,n,Mn);s.set(0,0);s.addScaledVector(i,Mn.x);s.addScaledVector(a,Mn.y);s.addScaledVector(o,Mn.z);return s},isFrontFacing:function(e,t,r,n){_n.subVectors(r,t);Tn.subVectors(e,t);return _n.cross(Tn).dot(n)<0?true:false}});Object.assign(Ln.prototype,{set:function(e,t,r){this.a.copy(e);this.b.copy(t);this.c.copy(r);return this},setFromPointsAndIndices:function(e,t,r,n){this.a.copy(e[t]);this.b.copy(e[r]);this.c.copy(e[n]);return this},clone:function(){return(new this.constructor).copy(this)},copy:function(e){this.a.copy(e.a);this.b.copy(e.b);this.c.copy(e.c);return this},getArea:function(){_n.subVectors(this.c,this.b);Tn.subVectors(this.a,this.b);return _n.cross(Tn).length()*.5},getMidpoint:function(e){if(e===undefined){console.warn("THREE.Triangle: .getMidpoint() target is now required");e=new pr}return e.addVectors(this.a,this.b).add(this.c).multiplyScalar(1/3)},getNormal:function(e){return Ln.getNormal(this.a,this.b,this.c,e)},getPlane:function(e){if(e===undefined){console.warn("THREE.Triangle: .getPlane() target is now required");e=new pr}return e.setFromCoplanarPoints(this.a,this.b,this.c)},getBarycoord:function(e,t){return Ln.getBarycoord(e,this.a,this.b,this.c,t)},getUV:function(e,t,r,n,i){return Ln.getUV(e,this.a,this.b,this.c,t,r,n,i)},containsPoint:function(e){return Ln.containsPoint(e,this.a,this.b,this.c)},isFrontFacing:function(e){return Ln.isFrontFacing(this.a,this.b,this.c,e)},intersectsBox:function(e){return e.intersectsTriangle(this)},closestPointToPoint:function(e,t){if(t===undefined){console.warn("THREE.Triangle: .closestPointToPoint() target is now required");t=new pr}var r=this.a,n=this.b,i=this.c;var a,o;Sn.subVectors(n,r);An.subVectors(i,r);Pn.subVectors(e,r);var s=Sn.dot(Pn);var u=An.dot(Pn);if(s<=0&&u<=0){return t.copy(r)}Cn.subVectors(e,n);var l=Sn.dot(Cn);var c=An.dot(Cn);if(l>=0&&c<=l){return t.copy(n)}var h=s*c-l*u;if(h<=0&&s>=0&&l<=0){a=s/(s-l);return t.copy(r).addScaledVector(Sn,a)}On.subVectors(e,i);var f=Sn.dot(On);var d=An.dot(On);if(d>=0&&f<=d){return t.copy(i)}var p=f*u-s*d;if(p<=0&&u>=0&&d<=0){o=u/(u-d);return t.copy(r).addScaledVector(An,o)}var v=l*d-f*c;if(v<=0&&c-l>=0&&f-d>=0){Rn.subVectors(i,n);o=(c-l)/(c-l+(f-d));return t.copy(n).addScaledVector(Rn,o)}var m=1/(v+p+h);a=p*m;o=h*m;return t.copy(r).addScaledVector(Sn,a).addScaledVector(An,o)},equals:function(e){return e.a.equals(this.a)&&e.b.equals(this.b)&&e.c.equals(this.c)}});var In={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};var Dn={h:0,s:0,l:0};var Nn={h:0,s:0,l:0};function Fn(e,t,r){if(t===undefined&&r===undefined){return this.set(e)}return this.setRGB(e,t,r)}function Bn(e,t,r){if(r<0)r+=1;if(r>1)r-=1;if(r<1/6)return e+(t-e)*6*r;if(r<1/2)return t;if(r<2/3)return e+(t-e)*6*(2/3-r);return e}function Un(e){return e<.04045?e*.0773993808:Math.pow(e*.9478672986+.0521327014,2.4)}function kn(e){return e<.0031308?e*12.92:1.055*Math.pow(e,.41666)-.055}Object.assign(Fn.prototype,{isColor:true,r:1,g:1,b:1,set:function(e){if(e&&e.isColor){this.copy(e)}else if(typeof e==="number"){this.setHex(e)}else if(typeof e==="string"){this.setStyle(e)}return this},setScalar:function(e){this.r=e;this.g=e;this.b=e;return this},setHex:function(e){e=Math.floor(e);this.r=(e>>16&255)/255;this.g=(e>>8&255)/255;this.b=(e&255)/255;return this},setRGB:function(e,t,r){this.r=e;this.g=t;this.b=r;return this},setHSL:function(e,t,r){e=lr.euclideanModulo(e,1);t=lr.clamp(t,0,1);r=lr.clamp(r,0,1);if(t===0){this.r=this.g=this.b=r}else{var n=r<=.5?r*(1+t):r+t-r*t;var i=2*r-n;this.r=Bn(i,n,e+1/3);this.g=Bn(i,n,e);this.b=Bn(i,n,e-1/3)}return this},setStyle:function(t){function e(e){if(e===undefined)return;if(parseFloat(e)<1){console.warn("THREE.Color: Alpha component of "+t+" will be ignored.")}}var r;if(r=/^((?:rgb|hsl)a?)\(\s*([^\)]*)\)/.exec(t)){var n;var i=r[1];var a=r[2];switch(i){case"rgb":case"rgba":if(n=/^(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*(,\s*([0-9]*\.?[0-9]+)\s*)?$/.exec(a)){this.r=Math.min(255,parseInt(n[1],10))/255;this.g=Math.min(255,parseInt(n[2],10))/255;this.b=Math.min(255,parseInt(n[3],10))/255;e(n[5]);return this}if(n=/^(\d+)\%\s*,\s*(\d+)\%\s*,\s*(\d+)\%\s*(,\s*([0-9]*\.?[0-9]+)\s*)?$/.exec(a)){this.r=Math.min(100,parseInt(n[1],10))/100;this.g=Math.min(100,parseInt(n[2],10))/100;this.b=Math.min(100,parseInt(n[3],10))/100;e(n[5]);return this}break;case"hsl":case"hsla":if(n=/^([0-9]*\.?[0-9]+)\s*,\s*(\d+)\%\s*,\s*(\d+)\%\s*(,\s*([0-9]*\.?[0-9]+)\s*)?$/.exec(a)){var o=parseFloat(n[1])/360;var s=parseInt(n[2],10)/100;var u=parseInt(n[3],10)/100;e(n[5]);return this.setHSL(o,s,u)}break}}else if(r=/^\#([A-Fa-f0-9]+)$/.exec(t)){var l=r[1];var c=l.length;if(c===3){this.r=parseInt(l.charAt(0)+l.charAt(0),16)/255;this.g=parseInt(l.charAt(1)+l.charAt(1),16)/255;this.b=parseInt(l.charAt(2)+l.charAt(2),16)/255;return this}else if(c===6){this.r=parseInt(l.charAt(0)+l.charAt(1),16)/255;this.g=parseInt(l.charAt(2)+l.charAt(3),16)/255;this.b=parseInt(l.charAt(4)+l.charAt(5),16)/255;return this}}if(t&&t.length>0){var l=In[t];if(l!==undefined){this.setHex(l)}else{console.warn("THREE.Color: Unknown color "+t)}}return this},clone:function(){return new this.constructor(this.r,this.g,this.b)},copy:function(e){this.r=e.r;this.g=e.g;this.b=e.b;return this},copyGammaToLinear:function(e,t){if(t===undefined)t=2;this.r=Math.pow(e.r,t);this.g=Math.pow(e.g,t);this.b=Math.pow(e.b,t);return this},copyLinearToGamma:function(e,t){if(t===undefined)t=2;var r=t>0?1/t:1;this.r=Math.pow(e.r,r);this.g=Math.pow(e.g,r);this.b=Math.pow(e.b,r);return this},convertGammaToLinear:function(e){this.copyGammaToLinear(this,e);return this},convertLinearToGamma:function(e){this.copyLinearToGamma(this,e);return this},copySRGBToLinear:function(e){this.r=Un(e.r);this.g=Un(e.g);this.b=Un(e.b);return this},copyLinearToSRGB:function(e){this.r=kn(e.r);this.g=kn(e.g);this.b=kn(e.b);return this},convertSRGBToLinear:function(){this.copySRGBToLinear(this);return this},convertLinearToSRGB:function(){this.copyLinearToSRGB(this);return this},getHex:function(){return this.r*255<<16^this.g*255<<8^this.b*255<<0},getHexString:function(){return("000000"+this.getHex().toString(16)).slice(-6)},getHSL:function(e){if(e===undefined){console.warn("THREE.Color: .getHSL() target is now required");e={h:0,s:0,l:0}}var t=this.r,r=this.g,n=this.b;var i=Math.max(t,r,n);var a=Math.min(t,r,n);var o,s;var u=(a+i)/2;if(a===i){o=0;s=0}else{var l=i-a;s=u<=.5?l/(i+a):l/(2-i-a);switch(i){case t:o=(r-n)/l+(r<n?6:0);break;case r:o=(n-t)/l+2;break;case n:o=(t-r)/l+4;break}o/=6}e.h=o;e.s=s;e.l=u;return e},getStyle:function(){return"rgb("+(this.r*255|0)+","+(this.g*255|0)+","+(this.b*255|0)+")"},offsetHSL:function(e,t,r){this.getHSL(Dn);Dn.h+=e;Dn.s+=t;Dn.l+=r;this.setHSL(Dn.h,Dn.s,Dn.l);return this},add:function(e){this.r+=e.r;this.g+=e.g;this.b+=e.b;return this},addColors:function(e,t){this.r=e.r+t.r;this.g=e.g+t.g;this.b=e.b+t.b;return this},addScalar:function(e){this.r+=e;this.g+=e;this.b+=e;return this},sub:function(e){this.r=Math.max(0,this.r-e.r);this.g=Math.max(0,this.g-e.g);this.b=Math.max(0,this.b-e.b);return this},multiply:function(e){this.r*=e.r;this.g*=e.g;this.b*=e.b;return this},multiplyScalar:function(e){this.r*=e;this.g*=e;this.b*=e;return this},lerp:function(e,t){this.r+=(e.r-this.r)*t;this.g+=(e.g-this.g)*t;this.b+=(e.b-this.b)*t;return this},lerpHSL:function(e,t){this.getHSL(Dn);e.getHSL(Nn);var r=lr.lerp(Dn.h,Nn.h,t);var n=lr.lerp(Dn.s,Nn.s,t);var i=lr.lerp(Dn.l,Nn.l,t);this.setHSL(r,n,i);return this},equals:function(e){return e.r===this.r&&e.g===this.g&&e.b===this.b},fromArray:function(e,t){if(t===undefined)t=0;this.r=e[t];this.g=e[t+1];this.b=e[t+2];return this},toArray:function(e,t){if(e===undefined)e=[];if(t===undefined)t=0;e[t]=this.r;e[t+1]=this.g;e[t+2]=this.b;return e},toJSON:function(){return this.getHex()}});function jn(e,t,r,n,i,a){this.a=e;this.b=t;this.c=r;this.normal=n&&n.isVector3?n:new pr;this.vertexNormals=Array.isArray(n)?n:[];this.color=i&&i.isColor?i:new Fn;this.vertexColors=Array.isArray(i)?i:[];this.materialIndex=a!==undefined?a:0}Object.assign(jn.prototype,{clone:function(){return(new this.constructor).copy(this)},copy:function(e){this.a=e.a;this.b=e.b;this.c=e.c;this.normal.copy(e.normal);this.color.copy(e.color);this.materialIndex=e.materialIndex;for(var t=0,r=e.vertexNormals.length;t<r;t++){this.vertexNormals[t]=e.vertexNormals[t].clone()}for(var t=0,r=e.vertexColors.length;t<r;t++){this.vertexColors[t]=e.vertexColors[t].clone()}return this}});var zn=0;function Hn(){Object.defineProperty(this,"id",{value:zn++});this.uuid=lr.generateUUID();this.name="";this.type="Material";this.fog=true;this.blending=ve;this.side=D;this.flatShading=false;this.vertexTangents=false;this.vertexColors=p;this.opacity=1;this.transparent=false;this.blendSrc=M;this.blendDst=S;this.blendEquation=be;this.blendSrcAlpha=null;this.blendDstAlpha=null;this.blendEquationAlpha=null;this.depthFunc=Ee;this.depthTest=true;this.depthWrite=true;this.stencilWriteMask=255;this.stencilFunc=ar;this.stencilRef=0;this.stencilFuncMask=255;this.stencilFail=Wt;this.stencilZFail=Wt;this.stencilZPass=Wt;this.stencilWrite=false;this.clippingPlanes=null;this.clipIntersection=false;this.clipShadows=false;this.shadowSide=null;this.colorWrite=true;this.precision=null;this.polygonOffset=false;this.polygonOffsetFactor=0;this.polygonOffsetUnits=0;this.dithering=false;this.alphaTest=0;this.premultipliedAlpha=false;this.visible=true;this.toneMapped=true;this.userData={};this.needsUpdate=true}Hn.prototype=Object.assign(Object.create(or.prototype),{constructor:Hn,isMaterial:true,onBeforeCompile:function(){},setValues:function(e){if(e===undefined)return;for(var t in e){var r=e[t];if(r===undefined){console.warn("THREE.Material: '"+t+"' parameter is undefined.");continue}if(t==="shading"){console.warn("THREE."+this.type+": .shading has been removed. Use the boolean .flatShading instead.");this.flatShading=r===f?true:false;continue}var n=this[t];if(n===undefined){console.warn("THREE."+this.type+": '"+t+"' is not a property of this material.");continue}if(n&&n.isColor){n.set(r)}else if(n&&n.isVector3&&r&&r.isVector3){n.copy(r)}else{this[t]=r}}},toJSON:function(e){var t=e===undefined||typeof e==="string";if(t){e={textures:{},images:{}}}var r={metadata:{version:4.5,type:"Material",generator:"Material.toJSON"}};r.uuid=this.uuid;r.type=this.type;if(this.name!=="")r.name=this.name;if(this.color&&this.color.isColor)r.color=this.color.getHex();if(this.roughness!==undefined)r.roughness=this.roughness;if(this.metalness!==undefined)r.metalness=this.metalness;if(this.sheen&&this.sheen.isColor)r.sheen=this.sheen.getHex();if(this.emissive&&this.emissive.isColor)r.emissive=this.emissive.getHex();if(this.emissiveIntensity&&this.emissiveIntensity!==1)r.emissiveIntensity=this.emissiveIntensity;if(this.specular&&this.specular.isColor)r.specular=this.specular.getHex();if(this.shininess!==undefined)r.shininess=this.shininess;if(this.clearcoat!==undefined)r.clearcoat=this.clearcoat;if(this.clearcoatRoughness!==undefined)r.clearcoatRoughness=this.clearcoatRoughness;if(this.clearcoatNormalMap&&this.clearcoatNormalMap.isTexture){r.clearcoatNormalMap=this.clearcoatNormalMap.toJSON(e).uuid;r.clearcoatNormalScale=this.clearcoatNormalScale.toArray()}if(this.map&&this.map.isTexture)r.map=this.map.toJSON(e).uuid;if(this.matcap&&this.matcap.isTexture)r.matcap=this.matcap.toJSON(e).uuid;if(this.alphaMap&&this.alphaMap.isTexture)r.alphaMap=this.alphaMap.toJSON(e).uuid;if(this.lightMap&&this.lightMap.isTexture)r.lightMap=this.lightMap.toJSON(e).uuid;if(this.aoMap&&this.aoMap.isTexture){r.aoMap=this.aoMap.toJSON(e).uuid;r.aoMapIntensity=this.aoMapIntensity}if(this.bumpMap&&this.bumpMap.isTexture){r.bumpMap=this.bumpMap.toJSON(e).uuid;r.bumpScale=this.bumpScale}if(this.normalMap&&this.normalMap.isTexture){r.normalMap=this.normalMap.toJSON(e).uuid;r.normalMapType=this.normalMapType;r.normalScale=this.normalScale.toArray()}if(this.displacementMap&&this.displacementMap.isTexture){r.displacementMap=this.displacementMap.toJSON(e).uuid;r.displacementScale=this.displacementScale;r.displacementBias=this.displacementBias}if(this.roughnessMap&&this.roughnessMap.isTexture)r.roughnessMap=this.roughnessMap.toJSON(e).uuid;if(this.metalnessMap&&this.metalnessMap.isTexture)r.metalnessMap=this.metalnessMap.toJSON(e).uuid;if(this.emissiveMap&&this.emissiveMap.isTexture)r.emissiveMap=this.emissiveMap.toJSON(e).uuid;if(this.specularMap&&this.specularMap.isTexture)r.specularMap=this.specularMap.toJSON(e).uuid;if(this.envMap&&this.envMap.isTexture){r.envMap=this.envMap.toJSON(e).uuid;r.reflectivity=this.reflectivity;r.refractionRatio=this.refractionRatio;if(this.combine!==undefined)r.combine=this.combine;if(this.envMapIntensity!==undefined)r.envMapIntensity=this.envMapIntensity}if(this.gradientMap&&this.gradientMap.isTexture){r.gradientMap=this.gradientMap.toJSON(e).uuid}if(this.size!==undefined)r.size=this.size;if(this.sizeAttenuation!==undefined)r.sizeAttenuation=this.sizeAttenuation;if(this.blending!==ve)r.blending=this.blending;if(this.flatShading===true)r.flatShading=this.flatShading;if(this.side!==D)r.side=this.side;if(this.vertexColors!==p)r.vertexColors=this.vertexColors;if(this.opacity<1)r.opacity=this.opacity;if(this.transparent===true)r.transparent=this.transparent;r.depthFunc=this.depthFunc;r.depthTest=this.depthTest;r.depthWrite=this.depthWrite;r.stencilWrite=this.stencilWrite;r.stencilWriteMask=this.stencilWriteMask;r.stencilFunc=this.stencilFunc;r.stencilRef=this.stencilRef;r.stencilFuncMask=this.stencilFuncMask;r.stencilFail=this.stencilFail;r.stencilZFail=this.stencilZFail;r.stencilZPass=this.stencilZPass;if(this.rotation&&this.rotation!==0)r.rotation=this.rotation;if(this.polygonOffset===true)r.polygonOffset=true;if(this.polygonOffsetFactor!==0)r.polygonOffsetFactor=this.polygonOffsetFactor;if(this.polygonOffsetUnits!==0)r.polygonOffsetUnits=this.polygonOffsetUnits;if(this.linewidth&&this.linewidth!==1)r.linewidth=this.linewidth;if(this.dashSize!==undefined)r.dashSize=this.dashSize;if(this.gapSize!==undefined)r.gapSize=this.gapSize;if(this.scale!==undefined)r.scale=this.scale;if(this.dithering===true)r.dithering=true;if(this.alphaTest>0)r.alphaTest=this.alphaTest;if(this.premultipliedAlpha===true)r.premultipliedAlpha=this.premultipliedAlpha;if(this.wireframe===true)r.wireframe=this.wireframe;if(this.wireframeLinewidth>1)r.wireframeLinewidth=this.wireframeLinewidth;if(this.wireframeLinecap!=="round")r.wireframeLinecap=this.wireframeLinecap;if(this.wireframeLinejoin!=="round")r.wireframeLinejoin=this.wireframeLinejoin;if(this.morphTargets===true)r.morphTargets=true;if(this.morphNormals===true)r.morphNormals=true;if(this.skinning===true)r.skinning=true;if(this.visible===false)r.visible=false;if(this.toneMapped===false)r.toneMapped=false;if(JSON.stringify(this.userData)!=="{}")r.userData=this.userData;function n(e){var t=[];for(var r in e){var n=e[r];delete n.metadata;t.push(n)}return t}if(t){var i=n(e.textures);var a=n(e.images);if(i.length>0)r.textures=i;if(a.length>0)r.images=a}return r},clone:function(){return(new this.constructor).copy(this)},copy:function(e){this.name=e.name;this.fog=e.fog;this.blending=e.blending;this.side=e.side;this.flatShading=e.flatShading;this.vertexColors=e.vertexColors;this.opacity=e.opacity;this.transparent=e.transparent;this.blendSrc=e.blendSrc;this.blendDst=e.blendDst;this.blendEquation=e.blendEquation;this.blendSrcAlpha=e.blendSrcAlpha;this.blendDstAlpha=e.blendDstAlpha;this.blendEquationAlpha=e.blendEquationAlpha;this.depthFunc=e.depthFunc;this.depthTest=e.depthTest;this.depthWrite=e.depthWrite;this.stencilWrite=e.stencilWrite;this.stencilWriteMask=e.stencilWriteMask;this.stencilFunc=e.stencilFunc;this.stencilRef=e.stencilRef;this.stencilFuncMask=e.stencilFuncMask;this.stencilFail=e.stencilFail;this.stencilZFail=e.stencilZFail;this.stencilZPass=e.stencilZPass;this.colorWrite=e.colorWrite;this.precision=e.precision;this.polygonOffset=e.polygonOffset;this.polygonOffsetFactor=e.polygonOffsetFactor;this.polygonOffsetUnits=e.polygonOffsetUnits;this.dithering=e.dithering;this.alphaTest=e.alphaTest;this.premultipliedAlpha=e.premultipliedAlpha;this.visible=e.visible;this.toneMapped=e.toneMapped;this.userData=JSON.parse(JSON.stringify(e.userData));this.clipShadows=e.clipShadows;this.clipIntersection=e.clipIntersection;var t=e.clippingPlanes,r=null;if(t!==null){var n=t.length;r=new Array(n);for(var i=0;i!==n;++i)r[i]=t[i].clone()}this.clippingPlanes=r;this.shadowSide=e.shadowSide;return this},dispose:function(){this.dispatchEvent({type:"dispose"})}});function Gn(e){Hn.call(this);this.type="MeshBasicMaterial";this.color=new Fn(16777215);this.map=null;this.lightMap=null;this.lightMapIntensity=1;this.aoMap=null;this.aoMapIntensity=1;this.specularMap=null;this.alphaMap=null;this.envMap=null;this.combine=L;this.reflectivity=1;this.refractionRatio=.98;this.wireframe=false;this.wireframeLinewidth=1;this.wireframeLinecap="round";this.wireframeLinejoin="round";this.skinning=false;this.morphTargets=false;this.setValues(e)}Gn.prototype=Object.create(Hn.prototype);Gn.prototype.constructor=Gn;Gn.prototype.isMeshBasicMaterial=true;Gn.prototype.copy=function(e){Hn.prototype.copy.call(this,e);this.color.copy(e.color);this.map=e.map;this.lightMap=e.lightMap;this.lightMapIntensity=e.lightMapIntensity;this.aoMap=e.aoMap;this.aoMapIntensity=e.aoMapIntensity;this.specularMap=e.specularMap;this.alphaMap=e.alphaMap;this.envMap=e.envMap;this.combine=e.combine;this.reflectivity=e.reflectivity;this.refractionRatio=e.refractionRatio;this.wireframe=e.wireframe;this.wireframeLinewidth=e.wireframeLinewidth;this.wireframeLinecap=e.wireframeLinecap;this.wireframeLinejoin=e.wireframeLinejoin;this.skinning=e.skinning;this.morphTargets=e.morphTargets;return this};function Vn(e,t,r){if(Array.isArray(e)){throw new TypeError("THREE.BufferAttribute: array should be a Typed Array.")}this.name="";this.array=e;this.itemSize=t;this.count=e!==undefined?e.length/t:0;this.normalized=r===true;this.dynamic=false;this.updateRange={offset:0,count:-1};this.version=0}Object.defineProperty(Vn.prototype,"needsUpdate",{set:function(e){if(e===true)this.version++}});Object.assign(Vn.prototype,{isBufferAttribute:true,onUploadCallback:function(){},setDynamic:function(e){this.dynamic=e;return this},copy:function(e){this.name=e.name;this.array=new e.array.constructor(e.array);this.itemSize=e.itemSize;this.count=e.count;this.normalized=e.normalized;this.dynamic=e.dynamic;return this},copyAt:function(e,t,r){e*=this.itemSize;r*=t.itemSize;for(var n=0,i=this.itemSize;n<i;n++){this.array[e+n]=t.array[r+n]}return this},copyArray:function(e){this.array.set(e);return this},copyColorsArray:function(e){var t=this.array,r=0;for(var n=0,i=e.length;n<i;n++){var a=e[n];if(a===undefined){console.warn("THREE.BufferAttribute.copyColorsArray(): color is undefined",n);a=new Fn}t[r++]=a.r;t[r++]=a.g;t[r++]=a.b}return this},copyVector2sArray:function(e){var t=this.array,r=0;for(var n=0,i=e.length;n<i;n++){var a=e[n];if(a===undefined){console.warn("THREE.BufferAttribute.copyVector2sArray(): vector is undefined",n);a=new cr}t[r++]=a.x;t[r++]=a.y}return this},copyVector3sArray:function(e){var t=this.array,r=0;for(var n=0,i=e.length;n<i;n++){var a=e[n];if(a===undefined){console.warn("THREE.BufferAttribute.copyVector3sArray(): vector is undefined",n);a=new pr}t[r++]=a.x;t[r++]=a.y;t[r++]=a.z}return this},copyVector4sArray:function(e){var t=this.array,r=0;for(var n=0,i=e.length;n<i;n++){var a=e[n];if(a===undefined){console.warn("THREE.BufferAttribute.copyVector4sArray(): vector is undefined",n);a=new wr}t[r++]=a.x;t[r++]=a.y;t[r++]=a.z;t[r++]=a.w}return this},set:function(e,t){if(t===undefined)t=0;this.array.set(e,t);return this},getX:function(e){return this.array[e*this.itemSize]},setX:function(e,t){this.array[e*this.itemSize]=t;return this},getY:function(e){return this.array[e*this.itemSize+1]},setY:function(e,t){this.array[e*this.itemSize+1]=t;return this},getZ:function(e){return this.array[e*this.itemSize+2]},setZ:function(e,t){this.array[e*this.itemSize+2]=t;return this},getW:function(e){return this.array[e*this.itemSize+3]},setW:function(e,t){this.array[e*this.itemSize+3]=t;return this},setXY:function(e,t,r){e*=this.itemSize;this.array[e+0]=t;this.array[e+1]=r;return this},setXYZ:function(e,t,r,n){e*=this.itemSize;this.array[e+0]=t;this.array[e+1]=r;this.array[e+2]=n;return this},setXYZW:function(e,t,r,n,i){e*=this.itemSize;this.array[e+0]=t;this.array[e+1]=r;this.array[e+2]=n;this.array[e+3]=i;return this},onUpload:function(e){this.onUploadCallback=e;return this},clone:function(){return new this.constructor(this.array,this.itemSize).copy(this)},toJSON:function(){return{itemSize:this.itemSize,type:this.array.constructor.name,array:Array.prototype.slice.call(this.array),normalized:this.normalized}}});function Wn(e,t,r){Vn.call(this,new Int8Array(e),t,r)}Wn.prototype=Object.create(Vn.prototype);Wn.prototype.constructor=Wn;function qn(e,t,r){Vn.call(this,new Uint8Array(e),t,r)}qn.prototype=Object.create(Vn.prototype);qn.prototype.constructor=qn;function Xn(e,t,r){Vn.call(this,new Uint8ClampedArray(e),t,r)}Xn.prototype=Object.create(Vn.prototype);Xn.prototype.constructor=Xn;function Yn(e,t,r){Vn.call(this,new Int16Array(e),t,r)}Yn.prototype=Object.create(Vn.prototype);Yn.prototype.constructor=Yn;function Zn(e,t,r){Vn.call(this,new Uint16Array(e),t,r)}Zn.prototype=Object.create(Vn.prototype);Zn.prototype.constructor=Zn;function Jn(e,t,r){Vn.call(this,new Int32Array(e),t,r)}Jn.prototype=Object.create(Vn.prototype);Jn.prototype.constructor=Jn;function Kn(e,t,r){Vn.call(this,new Uint32Array(e),t,r)}Kn.prototype=Object.create(Vn.prototype);Kn.prototype.constructor=Kn;function Qn(e,t,r){Vn.call(this,new Float32Array(e),t,r)}Qn.prototype=Object.create(Vn.prototype);Qn.prototype.constructor=Qn;function $n(e,t,r){Vn.call(this,new Float64Array(e),t,r)}$n.prototype=Object.create(Vn.prototype);$n.prototype.constructor=$n;function ei(){this.vertices=[];this.normals=[];this.colors=[];this.uvs=[];this.uvs2=[];this.groups=[];this.morphTargets={};this.skinWeights=[];this.skinIndices=[];this.boundingBox=null;this.boundingSphere=null;this.verticesNeedUpdate=false;this.normalsNeedUpdate=false;this.colorsNeedUpdate=false;this.uvsNeedUpdate=false;this.groupsNeedUpdate=false}Object.assign(ei.prototype,{computeGroups:function(e){var t;var r=[];var n=undefined;var i=e.faces;for(var a=0;a<i.length;a++){var o=i[a];if(o.materialIndex!==n){n=o.materialIndex;if(t!==undefined){t.count=a*3-t.start;r.push(t)}t={start:a*3,materialIndex:n}}}if(t!==undefined){t.count=a*3-t.start;r.push(t)}this.groups=r},fromGeometry:function(e){var t=e.faces;var r=e.vertices;var n=e.faceVertexUvs;var i=n[0]&&n[0].length>0;var a=n[1]&&n[1].length>0;var o=e.morphTargets;var s=o.length;var u;if(s>0){u=[];for(var l=0;l<s;l++){u[l]={name:o[l].name,data:[]}}this.morphTargets.position=u}var c=e.morphNormals;var h=c.length;var f;if(h>0){f=[];for(var l=0;l<h;l++){f[l]={name:c[l].name,data:[]}}this.morphTargets.normal=f}var d=e.skinIndices;var p=e.skinWeights;var v=d.length===r.length;var m=p.length===r.length;if(r.length>0&&t.length===0){console.error("THREE.DirectGeometry: Faceless geometries are not supported.")}for(var l=0;l<t.length;l++){var g=t[l];this.vertices.push(r[g.a],r[g.b],r[g.c]);var y=g.vertexNormals;if(y.length===3){this.normals.push(y[0],y[1],y[2])}else{var x=g.normal;this.normals.push(x,x,x)}var b=g.vertexColors;if(b.length===3){this.colors.push(b[0],b[1],b[2])}else{var w=g.color;this.colors.push(w,w,w)}if(i===true){var _=n[0][l];if(_!==undefined){this.uvs.push(_[0],_[1],_[2])}else{console.warn("THREE.DirectGeometry.fromGeometry(): Undefined vertexUv ",l);this.uvs.push(new cr,new cr,new cr)}}if(a===true){var _=n[1][l];if(_!==undefined){this.uvs2.push(_[0],_[1],_[2])}else{console.warn("THREE.DirectGeometry.fromGeometry(): Undefined vertexUv2 ",l);this.uvs2.push(new cr,new cr,new cr)}}for(var T=0;T<s;T++){var E=o[T].vertices;u[T].data.push(E[g.a],E[g.b],E[g.c])}for(var T=0;T<h;T++){var M=c[T].vertexNormals[l];f[T].data.push(M.a,M.b,M.c)}if(v){this.skinIndices.push(d[g.a],d[g.b],d[g.c])}if(m){this.skinWeights.push(p[g.a],p[g.b],p[g.c])}}this.computeGroups(e);this.verticesNeedUpdate=e.verticesNeedUpdate;this.normalsNeedUpdate=e.normalsNeedUpdate;this.colorsNeedUpdate=e.colorsNeedUpdate;this.uvsNeedUpdate=e.uvsNeedUpdate;this.groupsNeedUpdate=e.groupsNeedUpdate;if(e.boundingSphere!==null){this.boundingSphere=e.boundingSphere.clone()}if(e.boundingBox!==null){this.boundingBox=e.boundingBox.clone()}return this}});function ti(e){if(e.length===0)return-Infinity;var t=e[0];for(var r=1,n=e.length;r<n;++r){if(e[r]>t)t=e[r]}return t}var ri=1;var ni=new Or;var ii=new Zr;var ai=new pr;var oi=new cn;var si=new cn;var ui=new pr;function li(){Object.defineProperty(this,"id",{value:ri+=2});this.uuid=lr.generateUUID();this.name="";this.type="BufferGeometry";this.index=null;this.attributes={};this.morphAttributes={};this.groups=[];this.boundingBox=null;this.boundingSphere=null;this.drawRange={start:0,count:Infinity};this.userData={}}li.prototype=Object.assign(Object.create(or.prototype),{constructor:li,isBufferGeometry:true,getIndex:function(){return this.index},setIndex:function(e){if(Array.isArray(e)){this.index=new(ti(e)>65535?Kn:Zn)(e,1)}else{this.index=e}},addAttribute:function(e,t){if(!(t&&t.isBufferAttribute)&&!(t&&t.isInterleavedBufferAttribute)){console.warn("THREE.BufferGeometry: .addAttribute() now expects ( name, attribute ).");return this.addAttribute(e,new Vn(arguments[1],arguments[2]))}if(e==="index"){console.warn("THREE.BufferGeometry.addAttribute: Use .setIndex() for index attribute.");this.setIndex(t);return this}return this.setAttribute(e,t)},getAttribute:function(e){return this.attributes[e]},setAttribute:function(e,t){this.attributes[e]=t;return this},removeAttribute:function(e){delete this.attributes[e];return this},addGroup:function(e,t,r){this.groups.push({start:e,count:t,materialIndex:r!==undefined?r:0})},clearGroups:function(){this.groups=[]},setDrawRange:function(e,t){this.drawRange.start=e;this.drawRange.count=t},applyMatrix:function(e){var t=this.attributes.position;if(t!==undefined){e.applyToBufferAttribute(t);t.needsUpdate=true}var r=this.attributes.normal;if(r!==undefined){var n=(new mr).getNormalMatrix(e);n.applyToBufferAttribute(r);r.needsUpdate=true}var i=this.attributes.tangent;if(i!==undefined){var n=(new mr).getNormalMatrix(e);n.applyToBufferAttribute(i);i.needsUpdate=true}if(this.boundingBox!==null){this.computeBoundingBox()}if(this.boundingSphere!==null){this.computeBoundingSphere()}return this},rotateX:function(e){ni.makeRotationX(e);this.applyMatrix(ni);return this},rotateY:function(e){ni.makeRotationY(e);this.applyMatrix(ni);return this},rotateZ:function(e){ni.makeRotationZ(e);this.applyMatrix(ni);return this},translate:function(e,t,r){ni.makeTranslation(e,t,r);this.applyMatrix(ni);return this},scale:function(e,t,r){ni.makeScale(e,t,r);this.applyMatrix(ni);return this},lookAt:function(e){ii.lookAt(e);ii.updateMatrix();this.applyMatrix(ii.matrix);return this},center:function(){this.computeBoundingBox();this.boundingBox.getCenter(ai).negate();this.translate(ai.x,ai.y,ai.z);return this},setFromObject:function(e){var t=e.geometry;if(e.isPoints||e.isLine){var r=new Qn(t.vertices.length*3,3);var n=new Qn(t.colors.length*3,3);this.addAttribute("position",r.copyVector3sArray(t.vertices));this.addAttribute("color",n.copyColorsArray(t.colors));if(t.lineDistances&&t.lineDistances.length===t.vertices.length){var i=new Qn(t.lineDistances.length,1);this.addAttribute("lineDistance",i.copyArray(t.lineDistances))}if(t.boundingSphere!==null){this.boundingSphere=t.boundingSphere.clone()}if(t.boundingBox!==null){this.boundingBox=t.boundingBox.clone()}}else if(e.isMesh){if(t&&t.isGeometry){this.fromGeometry(t)}}return this},setFromPoints:function(e){var t=[];for(var r=0,n=e.length;r<n;r++){var i=e[r];t.push(i.x,i.y,i.z||0)}this.addAttribute("position",new Qn(t,3));return this},updateFromObject:function(e){var t=e.geometry;if(e.isMesh){var r=t.__directGeometry;if(t.elementsNeedUpdate===true){r=undefined;t.elementsNeedUpdate=false}if(r===undefined){return this.fromGeometry(t)}r.verticesNeedUpdate=t.verticesNeedUpdate;r.normalsNeedUpdate=t.normalsNeedUpdate;r.colorsNeedUpdate=t.colorsNeedUpdate;r.uvsNeedUpdate=t.uvsNeedUpdate;r.groupsNeedUpdate=t.groupsNeedUpdate;t.verticesNeedUpdate=false;t.normalsNeedUpdate=false;t.colorsNeedUpdate=false;t.uvsNeedUpdate=false;t.groupsNeedUpdate=false;t=r}var n;if(t.verticesNeedUpdate===true){n=this.attributes.position;if(n!==undefined){n.copyVector3sArray(t.vertices);n.needsUpdate=true}t.verticesNeedUpdate=false}if(t.normalsNeedUpdate===true){n=this.attributes.normal;if(n!==undefined){n.copyVector3sArray(t.normals);n.needsUpdate=true}t.normalsNeedUpdate=false}if(t.colorsNeedUpdate===true){n=this.attributes.color;if(n!==undefined){n.copyColorsArray(t.colors);n.needsUpdate=true}t.colorsNeedUpdate=false}if(t.uvsNeedUpdate){n=this.attributes.uv;if(n!==undefined){n.copyVector2sArray(t.uvs);n.needsUpdate=true}t.uvsNeedUpdate=false}if(t.lineDistancesNeedUpdate){n=this.attributes.lineDistance;if(n!==undefined){n.copyArray(t.lineDistances);n.needsUpdate=true}t.lineDistancesNeedUpdate=false}if(t.groupsNeedUpdate){t.computeGroups(e.geometry);this.groups=t.groups;t.groupsNeedUpdate=false}return this},fromGeometry:function(e){e.__directGeometry=(new ei).fromGeometry(e);return this.fromDirectGeometry(e.__directGeometry)},fromDirectGeometry:function(e){var t=new Float32Array(e.vertices.length*3);this.addAttribute("position",new Vn(t,3).copyVector3sArray(e.vertices));if(e.normals.length>0){var r=new Float32Array(e.normals.length*3);this.addAttribute("normal",new Vn(r,3).copyVector3sArray(e.normals))}if(e.colors.length>0){var n=new Float32Array(e.colors.length*3);this.addAttribute("color",new Vn(n,3).copyColorsArray(e.colors))}if(e.uvs.length>0){var i=new Float32Array(e.uvs.length*2);this.addAttribute("uv",new Vn(i,2).copyVector2sArray(e.uvs))}if(e.uvs2.length>0){var a=new Float32Array(e.uvs2.length*2);this.addAttribute("uv2",new Vn(a,2).copyVector2sArray(e.uvs2))}this.groups=e.groups;for(var o in e.morphTargets){var s=[];var u=e.morphTargets[o];for(var l=0,c=u.length;l<c;l++){var h=u[l];var f=new Qn(h.data.length*3,3);f.name=h.name;s.push(f.copyVector3sArray(h.data))}this.morphAttributes[o]=s}if(e.skinIndices.length>0){var d=new Qn(e.skinIndices.length*4,4);this.addAttribute("skinIndex",d.copyVector4sArray(e.skinIndices))}if(e.skinWeights.length>0){var p=new Qn(e.skinWeights.length*4,4);this.addAttribute("skinWeight",p.copyVector4sArray(e.skinWeights))}if(e.boundingSphere!==null){this.boundingSphere=e.boundingSphere.clone()}if(e.boundingBox!==null){this.boundingBox=e.boundingBox.clone()}return this},computeBoundingBox:function(){if(this.boundingBox===null){this.boundingBox=new cn}var e=this.attributes.position;var t=this.morphAttributes.position;if(e!==undefined){this.boundingBox.setFromBufferAttribute(e);if(t){for(var r=0,n=t.length;r<n;r++){var i=t[r];oi.setFromBufferAttribute(i);this.boundingBox.expandByPoint(oi.min);this.boundingBox.expandByPoint(oi.max)}}}else{this.boundingBox.makeEmpty()}if(isNaN(this.boundingBox.min.x)||isNaN(this.boundingBox.min.y)||isNaN(this.boundingBox.min.z)){console.error('THREE.BufferGeometry.computeBoundingBox: Computed min/max have NaN values. The "position" attribute is likely to have NaN values.',this)}},computeBoundingSphere:function(){if(this.boundingSphere===null){this.boundingSphere=new dn}var e=this.attributes.position;var t=this.morphAttributes.position;if(e){var r=this.boundingSphere.center;oi.setFromBufferAttribute(e);if(t){for(var n=0,i=t.length;n<i;n++){var a=t[n];si.setFromBufferAttribute(a);oi.expandByPoint(si.min);oi.expandByPoint(si.max)}}oi.getCenter(r);var o=0;for(var n=0,i=e.count;n<i;n++){ui.fromBufferAttribute(e,n);o=Math.max(o,r.distanceToSquared(ui))}if(t){for(var n=0,i=t.length;n<i;n++){var a=t[n];for(var s=0,u=a.count;s<u;s++){ui.fromBufferAttribute(a,s);o=Math.max(o,r.distanceToSquared(ui))}}}this.boundingSphere.radius=Math.sqrt(o);if(isNaN(this.boundingSphere.radius)){console.error('THREE.BufferGeometry.computeBoundingSphere(): Computed radius is NaN. The "position" attribute is likely to have NaN values.',this)}}},computeFaceNormals:function(){},computeVertexNormals:function(){var e=this.index;var t=this.attributes;if(t.position){var r=t.position.array;if(t.normal===undefined){this.addAttribute("normal",new Vn(new Float32Array(r.length),3))}else{var n=t.normal.array;for(var i=0,a=n.length;i<a;i++){n[i]=0}}var o=t.normal.array;var s,u,l;var c=new pr,h=new pr,f=new pr;var d=new pr,p=new pr;if(e){var v=e.array;for(var i=0,a=e.count;i<a;i+=3){s=v[i+0]*3;u=v[i+1]*3;l=v[i+2]*3;c.fromArray(r,s);h.fromArray(r,u);f.fromArray(r,l);d.subVectors(f,h);p.subVectors(c,h);d.cross(p);o[s]+=d.x;o[s+1]+=d.y;o[s+2]+=d.z;o[u]+=d.x;o[u+1]+=d.y;o[u+2]+=d.z;o[l]+=d.x;o[l+1]+=d.y;o[l+2]+=d.z}}else{for(var i=0,a=r.length;i<a;i+=9){c.fromArray(r,i);h.fromArray(r,i+3);f.fromArray(r,i+6);d.subVectors(f,h);p.subVectors(c,h);d.cross(p);o[i]=d.x;o[i+1]=d.y;o[i+2]=d.z;o[i+3]=d.x;o[i+4]=d.y;o[i+5]=d.z;o[i+6]=d.x;o[i+7]=d.y;o[i+8]=d.z}}this.normalizeNormals();t.normal.needsUpdate=true}},merge:function(e,t){if(!(e&&e.isBufferGeometry)){console.error("THREE.BufferGeometry.merge(): geometry not an instance of THREE.BufferGeometry.",e);return}if(t===undefined){t=0;console.warn("THREE.BufferGeometry.merge(): Overwriting original geometry, starting at offset=0. "+"Use BufferGeometryUtils.mergeBufferGeometries() for lossless merge.")}var r=this.attributes;for(var n in r){if(e.attributes[n]===undefined)continue;var i=r[n];var a=i.array;var o=e.attributes[n];var s=o.array;var u=o.itemSize*t;var l=Math.min(s.length,a.length-u);for(var c=0,h=u;c<l;c++,h++){a[h]=s[c]}}return this},normalizeNormals:function(){var e=this.attributes.normal;for(var t=0,r=e.count;t<r;t++){ui.x=e.getX(t);ui.y=e.getY(t);ui.z=e.getZ(t);ui.normalize();e.setXYZ(t,ui.x,ui.y,ui.z)}},toNonIndexed:function(){function e(e,t){var r=e.array;var n=e.itemSize;var i=new r.constructor(t.length*n);var a=0,o=0;for(var s=0,u=t.length;s<u;s++){a=t[s]*n;for(var l=0;l<n;l++){i[o++]=r[a++]}}return new Vn(i,n)}if(this.index===null){console.warn("THREE.BufferGeometry.toNonIndexed(): Geometry is already non-indexed.");return this}var t=new li;var r=this.index.array;var n=this.attributes;for(var i in n){var a=n[i];var o=e(a,r);t.addAttribute(i,o)}var s=this.morphAttributes;for(i in s){var u=[];var l=s[i];for(var c=0,h=l.length;c<h;c++){var a=l[c];var o=e(a,r);u.push(o)}t.morphAttributes[i]=u}var f=this.groups;for(var c=0,d=f.length;c<d;c++){var p=f[c];t.addGroup(p.start,p.count,p.materialIndex)}return t},toJSON:function(){var e={metadata:{version:4.5,type:"BufferGeometry",generator:"BufferGeometry.toJSON"}};e.uuid=this.uuid;e.type=this.type;if(this.name!=="")e.name=this.name;if(Object.keys(this.userData).length>0)e.userData=this.userData;if(this.parameters!==undefined){var t=this.parameters;for(var r in t){if(t[r]!==undefined)e[r]=t[r]}return e}e.data={attributes:{}};var n=this.index;if(n!==null){e.data.index={type:n.array.constructor.name,array:Array.prototype.slice.call(n.array)}}var i=this.attributes;for(var r in i){var a=i[r];var o=a.toJSON();if(a.name!=="")o.name=a.name;e.data.attributes[r]=o}var s={};var u=false;for(var r in this.morphAttributes){var l=this.morphAttributes[r];var c=[];for(var h=0,f=l.length;h<f;h++){var a=l[h];var o=a.toJSON();if(a.name!=="")o.name=a.name;c.push(o)}if(c.length>0){s[r]=c;u=true}}if(u)e.data.morphAttributes=s;var d=this.groups;if(d.length>0){e.data.groups=JSON.parse(JSON.stringify(d))}var p=this.boundingSphere;if(p!==null){e.data.boundingSphere={center:p.center.toArray(),radius:p.radius}}return e},clone:function(){return(new li).copy(this)},copy:function(e){var t,r,n;this.index=null;this.attributes={};this.morphAttributes={};this.groups=[];this.boundingBox=null;this.boundingSphere=null;this.name=e.name;var i=e.index;if(i!==null){this.setIndex(i.clone())}var a=e.attributes;for(t in a){var o=a[t];this.addAttribute(t,o.clone())}var s=e.morphAttributes;for(t in s){var u=[];var l=s[t];for(r=0,n=l.length;r<n;r++){u.push(l[r].clone())}this.morphAttributes[t]=u}var c=e.groups;for(r=0,n=c.length;r<n;r++){var h=c[r];this.addGroup(h.start,h.count,h.materialIndex)}var f=e.boundingBox;if(f!==null){this.boundingBox=f.clone()}var d=e.boundingSphere;if(d!==null){this.boundingSphere=d.clone()}this.drawRange.start=e.drawRange.start;this.drawRange.count=e.drawRange.count;this.userData=e.userData;return this},dispose:function(){this.dispatchEvent({type:"dispose"})}});var ci=new Or;var hi=new wn;var fi=new dn;var di=new pr;var pi=new pr;var vi=new pr;var mi=new pr;var gi=new pr;var yi=new pr;var xi=new pr;var bi=new pr;var wi=new pr;var _i=new cr;var Ti=new cr;var Ei=new cr;var Mi=new pr;var Si=new pr;function Ai(e,t){Zr.call(this);this.type="Mesh";this.geometry=e!==undefined?e:new li;this.material=t!==undefined?t:new Gn({color:Math.random()*16777215});this.drawMode=Pt;this.updateMorphTargets()}Ai.prototype=Object.assign(Object.create(Zr.prototype),{constructor:Ai,isMesh:true,setDrawMode:function(e){this.drawMode=e},copy:function(e){Zr.prototype.copy.call(this,e);this.drawMode=e.drawMode;if(e.morphTargetInfluences!==undefined){this.morphTargetInfluences=e.morphTargetInfluences.slice()}if(e.morphTargetDictionary!==undefined){this.morphTargetDictionary=Object.assign({},e.morphTargetDictionary)}return this},updateMorphTargets:function(){var e=this.geometry;var t,r,n;if(e.isBufferGeometry){var i=e.morphAttributes;var a=Object.keys(i);if(a.length>0){var o=i[a[0]];if(o!==undefined){this.morphTargetInfluences=[];this.morphTargetDictionary={};for(t=0,r=o.length;t<r;t++){n=o[t].name||String(t);this.morphTargetInfluences.push(0);this.morphTargetDictionary[n]=t}}}}else{var s=e.morphTargets;if(s!==undefined&&s.length>0){console.error("THREE.Mesh.updateMorphTargets() no longer supports THREE.Geometry. Use THREE.BufferGeometry instead.")}}},raycast:function(e,t){var r=this.geometry;var n=this.material;var i=this.matrixWorld;if(n===undefined)return;if(r.boundingSphere===null)r.computeBoundingSphere();fi.copy(r.boundingSphere);fi.applyMatrix4(i);if(e.ray.intersectsSphere(fi)===false)return;ci.getInverse(i);hi.copy(e.ray).applyMatrix4(ci);if(r.boundingBox!==null){if(hi.intersectsBox(r.boundingBox)===false)return}var a;if(r.isBufferGeometry){var o,s,u;var l=r.index;var c=r.attributes.position;var h=r.morphAttributes.position;var f=r.attributes.uv;var d=r.attributes.uv2;var p=r.groups;var v=r.drawRange;var m,g,y,x;var b,w;var _,T;if(l!==null){if(Array.isArray(n)){for(m=0,y=p.length;m<y;m++){b=p[m];w=n[b.materialIndex];_=Math.max(b.start,v.start);T=Math.min(b.start+b.count,v.start+v.count);for(g=_,x=T;g<x;g+=3){o=l.getX(g);s=l.getX(g+1);u=l.getX(g+2);a=Pi(this,w,e,hi,c,h,f,d,o,s,u);if(a){a.faceIndex=Math.floor(g/3);a.face.materialIndex=b.materialIndex;t.push(a)}}}}else{_=Math.max(0,v.start);T=Math.min(l.count,v.start+v.count);for(m=_,y=T;m<y;m+=3){o=l.getX(m);s=l.getX(m+1);u=l.getX(m+2);a=Pi(this,n,e,hi,c,h,f,d,o,s,u);if(a){a.faceIndex=Math.floor(m/3);t.push(a)}}}}else if(c!==undefined){if(Array.isArray(n)){for(m=0,y=p.length;m<y;m++){b=p[m];w=n[b.materialIndex];_=Math.max(b.start,v.start);T=Math.min(b.start+b.count,v.start+v.count);for(g=_,x=T;g<x;g+=3){o=g;s=g+1;u=g+2;a=Pi(this,w,e,hi,c,h,f,d,o,s,u);if(a){a.faceIndex=Math.floor(g/3);a.face.materialIndex=b.materialIndex;t.push(a)}}}}else{_=Math.max(0,v.start);T=Math.min(c.count,v.start+v.count);for(m=_,y=T;m<y;m+=3){o=m;s=m+1;u=m+2;a=Pi(this,n,e,hi,c,h,f,d,o,s,u);if(a){a.faceIndex=Math.floor(m/3);t.push(a)}}}}}else if(r.isGeometry){var E,M,S;var A=Array.isArray(n);var R=r.vertices;var P=r.faces;var C;var O=r.faceVertexUvs[0];if(O.length>0)C=O;for(var L=0,I=P.length;L<I;L++){var D=P[L];var N=A?n[D.materialIndex]:n;if(N===undefined)continue;E=R[D.a];M=R[D.b];S=R[D.c];a=Ri(this,N,e,hi,E,M,S,Mi);if(a){if(C&&C[L]){var F=C[L];_i.copy(F[0]);Ti.copy(F[1]);Ei.copy(F[2]);a.uv=Ln.getUV(Mi,E,M,S,_i,Ti,Ei,new cr)}a.face=D;a.faceIndex=L;t.push(a)}}}},clone:function(){return new this.constructor(this.geometry,this.material).copy(this)}});function Ri(e,t,r,n,i,a,o,s){var u;if(t.side===ze){u=n.intersectTriangle(o,a,i,true,s)}else{u=n.intersectTriangle(i,a,o,t.side!==de,s)}if(u===null)return null;Si.copy(s);Si.applyMatrix4(e.matrixWorld);var l=r.ray.origin.distanceTo(Si);if(l<r.near||l>r.far)return null;return{distance:l,point:Si.clone(),object:e}}function Pi(e,t,r,n,i,a,o,s,u,l,c){di.fromBufferAttribute(i,u);pi.fromBufferAttribute(i,l);vi.fromBufferAttribute(i,c);var h=e.morphTargetInfluences;if(t.morphTargets&&a&&h){xi.set(0,0,0);bi.set(0,0,0);wi.set(0,0,0);for(var f=0,d=a.length;f<d;f++){var p=h[f];var v=a[f];if(p===0)continue;mi.fromBufferAttribute(v,u);gi.fromBufferAttribute(v,l);yi.fromBufferAttribute(v,c);xi.addScaledVector(mi.sub(di),p);bi.addScaledVector(gi.sub(pi),p);wi.addScaledVector(yi.sub(vi),p)}di.add(xi);pi.add(bi);vi.add(wi)}var m=Ri(e,t,r,n,di,pi,vi,Mi);if(m){if(o){_i.fromBufferAttribute(o,u);Ti.fromBufferAttribute(o,l);Ei.fromBufferAttribute(o,c);m.uv=Ln.getUV(Mi,di,pi,vi,_i,Ti,Ei,new cr)}if(s){_i.fromBufferAttribute(s,u);Ti.fromBufferAttribute(s,l);Ei.fromBufferAttribute(s,c);m.uv2=Ln.getUV(Mi,di,pi,vi,_i,Ti,Ei,new cr)}var g=new jn(u,l,c);Ln.getNormal(di,pi,vi,g.normal);m.face=g}return m}var Ci=0;var Oi=new Or;var Li=new Zr;var Ii=new pr;function Di(){Object.defineProperty(this,"id",{value:Ci+=2});this.uuid=lr.generateUUID();this.name="";this.type="Geometry";this.vertices=[];this.colors=[];this.faces=[];this.faceVertexUvs=[[]];this.morphTargets=[];this.morphNormals=[];this.skinWeights=[];this.skinIndices=[];this.lineDistances=[];this.boundingBox=null;this.boundingSphere=null;this.elementsNeedUpdate=false;this.verticesNeedUpdate=false;this.uvsNeedUpdate=false;this.normalsNeedUpdate=false;this.colorsNeedUpdate=false;this.lineDistancesNeedUpdate=false;this.groupsNeedUpdate=false}Di.prototype=Object.assign(Object.create(or.prototype),{constructor:Di,isGeometry:true,applyMatrix:function(e){var t=(new mr).getNormalMatrix(e);for(var r=0,n=this.vertices.length;r<n;r++){var i=this.vertices[r];i.applyMatrix4(e)}for(var r=0,n=this.faces.length;r<n;r++){var a=this.faces[r];a.normal.applyMatrix3(t).normalize();for(var o=0,s=a.vertexNormals.length;o<s;o++){a.vertexNormals[o].applyMatrix3(t).normalize()}}if(this.boundingBox!==null){this.computeBoundingBox()}if(this.boundingSphere!==null){this.computeBoundingSphere()}this.verticesNeedUpdate=true;this.normalsNeedUpdate=true;return this},rotateX:function(e){Oi.makeRotationX(e);this.applyMatrix(Oi);return this},rotateY:function(e){Oi.makeRotationY(e);this.applyMatrix(Oi);return this},rotateZ:function(e){Oi.makeRotationZ(e);this.applyMatrix(Oi);return this},translate:function(e,t,r){Oi.makeTranslation(e,t,r);this.applyMatrix(Oi);return this},scale:function(e,t,r){Oi.makeScale(e,t,r);this.applyMatrix(Oi);return this},lookAt:function(e){Li.lookAt(e);Li.updateMatrix();this.applyMatrix(Li.matrix);return this},fromBufferGeometry:function(e){var s=this;var t=e.index!==null?e.index.array:undefined;var r=e.attributes;if(r.position===undefined){console.error("THREE.Geometry.fromBufferGeometry(): Position attribute required for conversion.");return this}var n=r.position.array;var u=r.normal!==undefined?r.normal.array:undefined;var l=r.color!==undefined?r.color.array:undefined;var c=r.uv!==undefined?r.uv.array:undefined;var h=r.uv2!==undefined?r.uv2.array:undefined;if(h!==undefined)this.faceVertexUvs[1]=[];for(var i=0;i<n.length;i+=3){s.vertices.push((new pr).fromArray(n,i));if(l!==undefined){s.colors.push((new Fn).fromArray(l,i))}}function a(e,t,r,n){var i=l===undefined?[]:[s.colors[e].clone(),s.colors[t].clone(),s.colors[r].clone()];var a=u===undefined?[]:[(new pr).fromArray(u,e*3),(new pr).fromArray(u,t*3),(new pr).fromArray(u,r*3)];var o=new jn(e,t,r,a,i,n);s.faces.push(o);if(c!==undefined){s.faceVertexUvs[0].push([(new cr).fromArray(c,e*2),(new cr).fromArray(c,t*2),(new cr).fromArray(c,r*2)])}if(h!==undefined){s.faceVertexUvs[1].push([(new cr).fromArray(h,e*2),(new cr).fromArray(h,t*2),(new cr).fromArray(h,r*2)])}}var o=e.groups;if(o.length>0){for(var i=0;i<o.length;i++){var f=o[i];var d=f.start;var p=f.count;for(var v=d,m=d+p;v<m;v+=3){if(t!==undefined){a(t[v],t[v+1],t[v+2],f.materialIndex)}else{a(v,v+1,v+2,f.materialIndex)}}}}else{if(t!==undefined){for(var i=0;i<t.length;i+=3){a(t[i],t[i+1],t[i+2])}}else{for(var i=0;i<n.length/3;i+=3){a(i,i+1,i+2)}}}this.computeFaceNormals();if(e.boundingBox!==null){this.boundingBox=e.boundingBox.clone()}if(e.boundingSphere!==null){this.boundingSphere=e.boundingSphere.clone()}return this},center:function(){this.computeBoundingBox();this.boundingBox.getCenter(Ii).negate();this.translate(Ii.x,Ii.y,Ii.z);return this},normalize:function(){this.computeBoundingSphere();var e=this.boundingSphere.center;var t=this.boundingSphere.radius;var r=t===0?1:1/t;var n=new Or;n.set(r,0,0,-r*e.x,0,r,0,-r*e.y,0,0,r,-r*e.z,0,0,0,1);this.applyMatrix(n);return this},computeFaceNormals:function(){var e=new pr,t=new pr;for(var r=0,n=this.faces.length;r<n;r++){var i=this.faces[r];var a=this.vertices[i.a];var o=this.vertices[i.b];var s=this.vertices[i.c];e.subVectors(s,o);t.subVectors(a,o);e.cross(t);e.normalize();i.normal.copy(e)}},computeVertexNormals:function(e){if(e===undefined)e=true;var t,r,n,i,a,o;o=new Array(this.vertices.length);for(t=0,r=this.vertices.length;t<r;t++){o[t]=new pr}if(e){var s,u,l;var c=new pr,h=new pr;for(n=0,i=this.faces.length;n<i;n++){a=this.faces[n];s=this.vertices[a.a];u=this.vertices[a.b];l=this.vertices[a.c];c.subVectors(l,u);h.subVectors(s,u);c.cross(h);o[a.a].add(c);o[a.b].add(c);o[a.c].add(c)}}else{this.computeFaceNormals();for(n=0,i=this.faces.length;n<i;n++){a=this.faces[n];o[a.a].add(a.normal);o[a.b].add(a.normal);o[a.c].add(a.normal)}}for(t=0,r=this.vertices.length;t<r;t++){o[t].normalize()}for(n=0,i=this.faces.length;n<i;n++){a=this.faces[n];var f=a.vertexNormals;if(f.length===3){f[0].copy(o[a.a]);f[1].copy(o[a.b]);f[2].copy(o[a.c])}else{f[0]=o[a.a].clone();f[1]=o[a.b].clone();f[2]=o[a.c].clone()}}if(this.faces.length>0){this.normalsNeedUpdate=true}},computeFlatVertexNormals:function(){var e,t,r;this.computeFaceNormals();for(e=0,t=this.faces.length;e<t;e++){r=this.faces[e];var n=r.vertexNormals;if(n.length===3){n[0].copy(r.normal);n[1].copy(r.normal);n[2].copy(r.normal)}else{n[0]=r.normal.clone();n[1]=r.normal.clone();n[2]=r.normal.clone()}}if(this.faces.length>0){this.normalsNeedUpdate=true}},computeMorphNormals:function(){var e,t,r,n,i;for(r=0,n=this.faces.length;r<n;r++){i=this.faces[r];if(!i.__originalFaceNormal){i.__originalFaceNormal=i.normal.clone()}else{i.__originalFaceNormal.copy(i.normal)}if(!i.__originalVertexNormals)i.__originalVertexNormals=[];for(e=0,t=i.vertexNormals.length;e<t;e++){if(!i.__originalVertexNormals[e]){i.__originalVertexNormals[e]=i.vertexNormals[e].clone()}else{i.__originalVertexNormals[e].copy(i.vertexNormals[e])}}}var a=new Di;a.faces=this.faces;for(e=0,t=this.morphTargets.length;e<t;e++){if(!this.morphNormals[e]){this.morphNormals[e]={};this.morphNormals[e].faceNormals=[];this.morphNormals[e].vertexNormals=[];var o=this.morphNormals[e].faceNormals;var s=this.morphNormals[e].vertexNormals;var u,l;for(r=0,n=this.faces.length;r<n;r++){u=new pr;l={a:new pr,b:new pr,c:new pr};o.push(u);s.push(l)}}var c=this.morphNormals[e];a.vertices=this.morphTargets[e].vertices;a.computeFaceNormals();a.computeVertexNormals();var u,l;for(r=0,n=this.faces.length;r<n;r++){i=this.faces[r];u=c.faceNormals[r];l=c.vertexNormals[r];u.copy(i.normal);l.a.copy(i.vertexNormals[0]);l.b.copy(i.vertexNormals[1]);l.c.copy(i.vertexNormals[2])}}for(r=0,n=this.faces.length;r<n;r++){i=this.faces[r];i.normal=i.__originalFaceNormal;i.vertexNormals=i.__originalVertexNormals}},computeBoundingBox:function(){if(this.boundingBox===null){this.boundingBox=new cn}this.boundingBox.setFromPoints(this.vertices)},computeBoundingSphere:function(){if(this.boundingSphere===null){this.boundingSphere=new dn}this.boundingSphere.setFromPoints(this.vertices)},merge:function(e,t,r){if(!(e&&e.isGeometry)){console.error("THREE.Geometry.merge(): geometry not an instance of THREE.Geometry.",e);return}var n,i=this.vertices.length,a=this.vertices,o=e.vertices,s=this.faces,u=e.faces,l=this.colors,c=e.colors;if(r===undefined)r=0;if(t!==undefined){n=(new mr).getNormalMatrix(t)}for(var h=0,f=o.length;h<f;h++){var d=o[h];var p=d.clone();if(t!==undefined)p.applyMatrix4(t);a.push(p)}for(var h=0,f=c.length;h<f;h++){l.push(c[h].clone())}for(h=0,f=u.length;h<f;h++){var v=u[h],m,g,y,x=v.vertexNormals,b=v.vertexColors;m=new jn(v.a+i,v.b+i,v.c+i);m.normal.copy(v.normal);if(n!==undefined){m.normal.applyMatrix3(n).normalize()}for(var w=0,_=x.length;w<_;w++){g=x[w].clone();if(n!==undefined){g.applyMatrix3(n).normalize()}m.vertexNormals.push(g)}m.color.copy(v.color);for(var w=0,_=b.length;w<_;w++){y=b[w];m.vertexColors.push(y.clone())}m.materialIndex=v.materialIndex+r;s.push(m)}for(var h=0,f=e.faceVertexUvs.length;h<f;h++){var T=e.faceVertexUvs[h];if(this.faceVertexUvs[h]===undefined)this.faceVertexUvs[h]=[];for(var w=0,_=T.length;w<_;w++){var E=T[w],M=[];for(var S=0,A=E.length;S<A;S++){M.push(E[S].clone())}this.faceVertexUvs[h].push(M)}}},mergeMesh:function(e){if(!(e&&e.isMesh)){console.error("THREE.Geometry.mergeMesh(): mesh not an instance of THREE.Mesh.",e);return}if(e.matrixAutoUpdate)e.updateMatrix();this.merge(e.geometry,e.matrix)},mergeVertices:function(){var e={};var t=[],r=[];var n,i;var a=4;var o=Math.pow(10,a);var s,u,l;var c,h,f;for(s=0,u=this.vertices.length;s<u;s++){n=this.vertices[s];i=Math.round(n.x*o)+"_"+Math.round(n.y*o)+"_"+Math.round(n.z*o);if(e[i]===undefined){e[i]=s;t.push(this.vertices[s]);r[s]=t.length-1}else{r[s]=r[e[i]]}}var d=[];for(s=0,u=this.faces.length;s<u;s++){l=this.faces[s];l.a=r[l.a];l.b=r[l.b];l.c=r[l.c];c=[l.a,l.b,l.c];for(var p=0;p<3;p++){if(c[p]===c[(p+1)%3]){d.push(s);break}}}for(s=d.length-1;s>=0;s--){var v=d[s];this.faces.splice(v,1);for(h=0,f=this.faceVertexUvs.length;h<f;h++){this.faceVertexUvs[h].splice(v,1)}}var m=this.vertices.length-t.length;this.vertices=t;return m},setFromPoints:function(e){this.vertices=[];for(var t=0,r=e.length;t<r;t++){var n=e[t];this.vertices.push(new pr(n.x,n.y,n.z||0))}return this},sortFacesByMaterialIndex:function(){var e=this.faces;var t=e.length;for(var r=0;r<t;r++){e[r]._id=r}function n(e,t){return e.materialIndex-t.materialIndex}e.sort(n);var i=this.faceVertexUvs[0];var a=this.faceVertexUvs[1];var o,s;if(i&&i.length===t)o=[];if(a&&a.length===t)s=[];for(var r=0;r<t;r++){var u=e[r]._id;if(o)o.push(i[u]);if(s)s.push(a[u])}if(o)this.faceVertexUvs[0]=o;if(s)this.faceVertexUvs[1]=s},toJSON:function(){var e={metadata:{version:4.5,type:"Geometry",generator:"Geometry.toJSON"}};e.uuid=this.uuid;e.type=this.type;if(this.name!=="")e.name=this.name;if(this.parameters!==undefined){var t=this.parameters;for(var r in t){if(t[r]!==undefined)e[r]=t[r]}return e}var n=[];for(var i=0;i<this.vertices.length;i++){var a=this.vertices[i];n.push(a.x,a.y,a.z)}var o=[];var s=[];var u={};var l=[];var c={};var h=[];var f={};for(var i=0;i<this.faces.length;i++){var d=this.faces[i];var p=true;var v=false;var m=this.faceVertexUvs[0][i]!==undefined;var g=d.normal.length()>0;var y=d.vertexNormals.length>0;var x=d.color.r!==1||d.color.g!==1||d.color.b!==1;var b=d.vertexColors.length>0;var w=0;w=M(w,0,0);w=M(w,1,p);w=M(w,2,v);w=M(w,3,m);w=M(w,4,g);w=M(w,5,y);w=M(w,6,x);w=M(w,7,b);o.push(w);o.push(d.a,d.b,d.c);o.push(d.materialIndex);if(m){var _=this.faceVertexUvs[0][i];o.push(R(_[0]),R(_[1]),R(_[2]))}if(g){o.push(S(d.normal))}if(y){var T=d.vertexNormals;o.push(S(T[0]),S(T[1]),S(T[2]))}if(x){o.push(A(d.color))}if(b){var E=d.vertexColors;o.push(A(E[0]),A(E[1]),A(E[2]))}}function M(e,t,r){return r?e|1<<t:e&~(1<<t)}function S(e){var t=e.x.toString()+e.y.toString()+e.z.toString();if(u[t]!==undefined){return u[t]}u[t]=s.length/3;s.push(e.x,e.y,e.z);return u[t]}function A(e){var t=e.r.toString()+e.g.toString()+e.b.toString();if(c[t]!==undefined){return c[t]}c[t]=l.length;l.push(e.getHex());return c[t]}function R(e){var t=e.x.toString()+e.y.toString();if(f[t]!==undefined){return f[t]}f[t]=h.length/2;h.push(e.x,e.y);return f[t]}e.data={};e.data.vertices=n;e.data.normals=s;if(l.length>0)e.data.colors=l;if(h.length>0)e.data.uvs=[h];e.data.faces=o;return e},clone:function(){return(new Di).copy(this)},copy:function(e){var t,r,n,i,a,o;this.vertices=[];this.colors=[];this.faces=[];this.faceVertexUvs=[[]];this.morphTargets=[];this.morphNormals=[];this.skinWeights=[];this.skinIndices=[];this.lineDistances=[];this.boundingBox=null;this.boundingSphere=null;this.name=e.name;var s=e.vertices;for(t=0,r=s.length;t<r;t++){this.vertices.push(s[t].clone())}var u=e.colors;for(t=0,r=u.length;t<r;t++){this.colors.push(u[t].clone())}var l=e.faces;for(t=0,r=l.length;t<r;t++){this.faces.push(l[t].clone())}for(t=0,r=e.faceVertexUvs.length;t<r;t++){var c=e.faceVertexUvs[t];if(this.faceVertexUvs[t]===undefined){this.faceVertexUvs[t]=[]}for(n=0,i=c.length;n<i;n++){var h=c[n],f=[];for(a=0,o=h.length;a<o;a++){var d=h[a];f.push(d.clone())}this.faceVertexUvs[t].push(f)}}var p=e.morphTargets;for(t=0,r=p.length;t<r;t++){var v={};v.name=p[t].name;if(p[t].vertices!==undefined){v.vertices=[];for(n=0,i=p[t].vertices.length;n<i;n++){v.vertices.push(p[t].vertices[n].clone())}}if(p[t].normals!==undefined){v.normals=[];for(n=0,i=p[t].normals.length;n<i;n++){v.normals.push(p[t].normals[n].clone())}}this.morphTargets.push(v)}var m=e.morphNormals;for(t=0,r=m.length;t<r;t++){var g={};if(m[t].vertexNormals!==undefined){g.vertexNormals=[];for(n=0,i=m[t].vertexNormals.length;n<i;n++){var y=m[t].vertexNormals[n];var x={};x.a=y.a.clone();x.b=y.b.clone();x.c=y.c.clone();g.vertexNormals.push(x)}}if(m[t].faceNormals!==undefined){g.faceNormals=[];for(n=0,i=m[t].faceNormals.length;n<i;n++){g.faceNormals.push(m[t].faceNormals[n].clone())}}this.morphNormals.push(g)}var b=e.skinWeights;for(t=0,r=b.length;t<r;t++){this.skinWeights.push(b[t].clone())}var w=e.skinIndices;for(t=0,r=w.length;t<r;t++){this.skinIndices.push(w[t].clone())}var _=e.lineDistances;for(t=0,r=_.length;t<r;t++){this.lineDistances.push(_[t])}var T=e.boundingBox;if(T!==null){this.boundingBox=T.clone()}var E=e.boundingSphere;if(E!==null){this.boundingSphere=E.clone()}this.elementsNeedUpdate=e.elementsNeedUpdate;this.verticesNeedUpdate=e.verticesNeedUpdate;this.uvsNeedUpdate=e.uvsNeedUpdate;this.normalsNeedUpdate=e.normalsNeedUpdate;this.colorsNeedUpdate=e.colorsNeedUpdate;this.lineDistancesNeedUpdate=e.lineDistancesNeedUpdate;this.groupsNeedUpdate=e.groupsNeedUpdate;return this},dispose:function(){this.dispatchEvent({type:"dispose"})}});class Ni extends Di{constructor(e,t,r,n,i,a){super();this.type="BoxGeometry";this.parameters={width:e,height:t,depth:r,widthSegments:n,heightSegments:i,depthSegments:a};this.fromBufferGeometry(new Fi(e,t,r,n,i,a));this.mergeVertices()}}r.CubeGeometry=r.BoxGeometry=Ni;class Fi extends li{constructor(e,t,r,n,i,a){super();this.type="BoxBufferGeometry";this.parameters={width:e,height:t,depth:r,widthSegments:n,heightSegments:i,depthSegments:a};var P=this;e=e||1;t=t||1;r=r||1;n=Math.floor(n)||1;i=Math.floor(i)||1;a=Math.floor(a)||1;var C=[];var O=[];var L=[];var I=[];var D=0;var N=0;o("z","y","x",-1,-1,r,t,e,a,i,0);o("z","y","x",1,-1,r,t,-e,a,i,1);o("x","z","y",1,1,e,r,t,n,a,2);o("x","z","y",1,-1,e,r,-t,n,a,3);o("x","y","z",1,-1,e,t,r,n,i,4);o("x","y","z",-1,-1,e,t,-r,n,i,5);this.setIndex(C);this.addAttribute("position",new Qn(O,3));this.addAttribute("normal",new Qn(L,3));this.addAttribute("uv",new Qn(I,2));function o(e,t,r,n,i,a,o,s,u,l,c){var h=a/u;var f=o/l;var d=a/2;var p=o/2;var v=s/2;var m=u+1;var g=l+1;var y=0;var x=0;var b,w;var _=new pr;for(w=0;w<g;w++){var T=w*f-p;for(b=0;b<m;b++){var E=b*h-d;_[e]=E*n;_[t]=T*i;_[r]=v;O.push(_.x,_.y,_.z);_[e]=0;_[t]=0;_[r]=s>0?1:-1;L.push(_.x,_.y,_.z);I.push(b/u);I.push(1-w/l);y+=1}}for(w=0;w<l;w++){for(b=0;b<u;b++){var M=D+b+m*w;var S=D+b+m*(w+1);var A=D+(b+1)+m*(w+1);var R=D+(b+1)+m*w;C.push(M,S,R);C.push(S,A,R);x+=6}}P.addGroup(N,x,c);N+=x;D+=y}}}r.BoxBufferGeometry=Fi;function Bi(e){var t={};for(var r in e){t[r]={};for(var n in e[r]){var i=e[r][n];if(i&&(i.isColor||i.isMatrix3||i.isMatrix4||i.isVector2||i.isVector3||i.isVector4||i.isTexture)){t[r][n]=i.clone()}else if(Array.isArray(i)){t[r][n]=i.slice()}else{t[r][n]=i}}}return t}function Ui(e){var t={};for(var r=0;r<e.length;r++){var n=Bi(e[r]);for(var i in n){t[i]=n[i]}}return t}var ki={clone:Bi,merge:Ui};r.UniformsUtils=ki;var ji="void main() {\n\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\n}";var zi="void main() {\n\tgl_FragColor = vec4( 1.0, 0.0, 0.0, 1.0 );\n}";function Hi(e){Hn.call(this);this.type="ShaderMaterial";this.defines={};this.uniforms={};this.vertexShader=ji;this.fragmentShader=zi;this.linewidth=1;this.wireframe=false;this.wireframeLinewidth=1;this.fog=false;this.lights=false;this.clipping=false;this.skinning=false;this.morphTargets=false;this.morphNormals=false;this.extensions={derivatives:false,fragDepth:false,drawBuffers:false,shaderTextureLOD:false};this.defaultAttributeValues={color:[1,1,1],uv:[0,0],uv2:[0,0]};this.index0AttributeName=undefined;this.uniformsNeedUpdate=false;if(e!==undefined){if(e.attributes!==undefined){console.error("THREE.ShaderMaterial: attributes should now be defined in THREE.BufferGeometry instead.")}this.setValues(e)}}Hi.prototype=Object.create(Hn.prototype);Hi.prototype.constructor=Hi;Hi.prototype.isShaderMaterial=true;Hi.prototype.copy=function(e){Hn.prototype.copy.call(this,e);this.fragmentShader=e.fragmentShader;this.vertexShader=e.vertexShader;this.uniforms=Bi(e.uniforms);this.defines=Object.assign({},e.defines);this.wireframe=e.wireframe;this.wireframeLinewidth=e.wireframeLinewidth;this.lights=e.lights;this.clipping=e.clipping;this.skinning=e.skinning;this.morphTargets=e.morphTargets;this.morphNormals=e.morphNormals;this.extensions=e.extensions;return this};Hi.prototype.toJSON=function(e){var t=Hn.prototype.toJSON.call(this,e);t.uniforms={};for(var r in this.uniforms){var n=this.uniforms[r];var i=n.value;if(i&&i.isTexture){t.uniforms[r]={type:"t",value:i.toJSON(e).uuid}}else if(i&&i.isColor){t.uniforms[r]={type:"c",value:i.getHex()}}else if(i&&i.isVector2){t.uniforms[r]={type:"v2",value:i.toArray()}}else if(i&&i.isVector3){t.uniforms[r]={type:"v3",value:i.toArray()}}else if(i&&i.isVector4){t.uniforms[r]={type:"v4",value:i.toArray()}}else if(i&&i.isMatrix3){t.uniforms[r]={type:"m3",value:i.toArray()}}else if(i&&i.isMatrix4){t.uniforms[r]={type:"m4",value:i.toArray()}}else{t.uniforms[r]={value:i}}}if(Object.keys(this.defines).length>0)t.defines=this.defines;t.vertexShader=this.vertexShader;t.fragmentShader=this.fragmentShader;var a={};for(var o in this.extensions){if(this.extensions[o]===true)a[o]=true}if(Object.keys(a).length>0)t.extensions=a;return t};function Gi(){Zr.call(this);this.type="Camera";this.matrixWorldInverse=new Or;this.projectionMatrix=new Or;this.projectionMatrixInverse=new Or}Gi.prototype=Object.assign(Object.create(Zr.prototype),{constructor:Gi,isCamera:true,copy:function(e,t){Zr.prototype.copy.call(this,e,t);this.matrixWorldInverse.copy(e.matrixWorldInverse);this.projectionMatrix.copy(e.projectionMatrix);this.projectionMatrixInverse.copy(e.projectionMatrixInverse);return this},getWorldDirection:function(e){if(e===undefined){console.warn("THREE.Camera: .getWorldDirection() target is now required");e=new pr}this.updateMatrixWorld(true);var t=this.matrixWorld.elements;return e.set(-t[8],-t[9],-t[10]).normalize()},updateMatrixWorld:function(e){Zr.prototype.updateMatrixWorld.call(this,e);this.matrixWorldInverse.getInverse(this.matrixWorld)},clone:function(){return(new this.constructor).copy(this)}});function Vi(e,t,r,n){Gi.call(this);this.type="PerspectiveCamera";this.fov=e!==undefined?e:50;this.zoom=1;this.near=r!==undefined?r:.1;this.far=n!==undefined?n:2e3;this.focus=10;this.aspect=t!==undefined?t:1;this.view=null;this.filmGauge=35;this.filmOffset=0;this.updateProjectionMatrix()}Vi.prototype=Object.assign(Object.create(Gi.prototype),{constructor:Vi,isPerspectiveCamera:true,copy:function(e,t){Gi.prototype.copy.call(this,e,t);this.fov=e.fov;this.zoom=e.zoom;this.near=e.near;this.far=e.far;this.focus=e.focus;this.aspect=e.aspect;this.view=e.view===null?null:Object.assign({},e.view);this.filmGauge=e.filmGauge;this.filmOffset=e.filmOffset;return this},setFocalLength:function(e){var t=.5*this.getFilmHeight()/e;this.fov=lr.RAD2DEG*2*Math.atan(t);this.updateProjectionMatrix()},getFocalLength:function(){var e=Math.tan(lr.DEG2RAD*.5*this.fov);return.5*this.getFilmHeight()/e},getEffectiveFOV:function(){return lr.RAD2DEG*2*Math.atan(Math.tan(lr.DEG2RAD*.5*this.fov)/this.zoom)},getFilmWidth:function(){return this.filmGauge*Math.min(this.aspect,1)},getFilmHeight:function(){return this.filmGauge/Math.max(this.aspect,1)},setViewOffset:function(e,t,r,n,i,a){this.aspect=e/t;if(this.view===null){this.view={enabled:true,fullWidth:1,fullHeight:1,offsetX:0,offsetY:0,width:1,height:1}}this.view.enabled=true;this.view.fullWidth=e;this.view.fullHeight=t;this.view.offsetX=r;this.view.offsetY=n;this.view.width=i;this.view.height=a;this.updateProjectionMatrix()},clearViewOffset:function(){if(this.view!==null){this.view.enabled=false}this.updateProjectionMatrix()},updateProjectionMatrix:function(){var e=this.near,t=e*Math.tan(lr.DEG2RAD*.5*this.fov)/this.zoom,r=2*t,n=this.aspect*r,i=-.5*n,a=this.view;if(this.view!==null&&this.view.enabled){var o=a.fullWidth,s=a.fullHeight;i+=a.offsetX*n/o;t-=a.offsetY*r/s;n*=a.width/o;r*=a.height/s}var u=this.filmOffset;if(u!==0)i+=e*u/this.getFilmWidth();this.projectionMatrix.makePerspective(i,i+n,t,t-r,e,this.far);this.projectionMatrixInverse.getInverse(this.projectionMatrix)},toJSON:function(e){var t=Zr.prototype.toJSON.call(this,e);t.object.fov=this.fov;t.object.zoom=this.zoom;t.object.near=this.near;t.object.far=this.far;t.object.focus=this.focus;t.object.aspect=this.aspect;if(this.view!==null)t.object.view=Object.assign({},this.view);t.object.filmGauge=this.filmGauge;t.object.filmOffset=this.filmOffset;return t}});var Wi=90,qi=1;function Xi(e,t,r,n){Zr.call(this);this.type="CubeCamera";var a=new Vi(Wi,qi,e,t);a.up.set(0,-1,0);a.lookAt(new pr(1,0,0));this.add(a);var o=new Vi(Wi,qi,e,t);o.up.set(0,-1,0);o.lookAt(new pr(-1,0,0));this.add(o);var s=new Vi(Wi,qi,e,t);s.up.set(0,0,1);s.lookAt(new pr(0,1,0));this.add(s);var u=new Vi(Wi,qi,e,t);u.up.set(0,0,-1);u.lookAt(new pr(0,-1,0));this.add(u);var l=new Vi(Wi,qi,e,t);l.up.set(0,-1,0);l.lookAt(new pr(0,0,1));this.add(l);var c=new Vi(Wi,qi,e,t);c.up.set(0,-1,0);c.lookAt(new pr(0,0,-1));this.add(c);n=n||{format:Ue,magFilter:ie,minFilter:ie};this.renderTarget=new Yi(r,r,n);this.renderTarget.texture.name="CubeCamera";this.update=function(e,t){if(this.parent===null)this.updateMatrixWorld();var r=e.getRenderTarget();var n=this.renderTarget;var i=n.texture.generateMipmaps;n.texture.generateMipmaps=false;e.setRenderTarget(n,0);e.render(t,a);e.setRenderTarget(n,1);e.render(t,o);e.setRenderTarget(n,2);e.render(t,s);e.setRenderTarget(n,3);e.render(t,u);e.setRenderTarget(n,4);e.render(t,l);n.texture.generateMipmaps=i;e.setRenderTarget(n,5);e.render(t,c);e.setRenderTarget(r)};this.clear=function(e,t,r,n){var i=e.getRenderTarget();var a=this.renderTarget;for(var o=0;o<6;o++){e.setRenderTarget(a,o);e.clear(t,r,n)}e.setRenderTarget(i)}}Xi.prototype=Object.create(Zr.prototype);Xi.prototype.constructor=Xi;function Yi(e,t,r){_r.call(this,e,t,r)}Yi.prototype=Object.create(_r.prototype);Yi.prototype.constructor=Yi;Yi.prototype.isWebGLRenderTargetCube=true;Yi.prototype.fromEquirectangularTexture=function(e,t){this.texture.type=t.type;this.texture.format=t.format;this.texture.encoding=t.encoding;var r=new Jr;var n={uniforms:{tEquirect:{value:null}},vertexShader:["varying vec3 vWorldDirection;","vec3 transformDirection( in vec3 dir, in mat4 matrix ) {","\treturn normalize( ( matrix * vec4( dir, 0.0 ) ).xyz );","}","void main() {","\tvWorldDirection = transformDirection( position, modelMatrix );","\t#include <begin_vertex>","\t#include <project_vertex>","}"].join("\n"),fragmentShader:["uniform sampler2D tEquirect;","varying vec3 vWorldDirection;","#define RECIPROCAL_PI 0.31830988618","#define RECIPROCAL_PI2 0.15915494","void main() {","\tvec3 direction = normalize( vWorldDirection );","\tvec2 sampleUV;","\tsampleUV.y = asin( clamp( direction.y, - 1.0, 1.0 ) ) * RECIPROCAL_PI + 0.5;","\tsampleUV.x = atan( direction.z, direction.x ) * RECIPROCAL_PI2 + 0.5;","\tgl_FragColor = texture2D( tEquirect, sampleUV );","}"].join("\n")};var i=new Hi({type:"CubemapFromEquirect",uniforms:Bi(n.uniforms),vertexShader:n.vertexShader,fragmentShader:n.fragmentShader,side:ze,blending:pe});i.uniforms.tEquirect.value=t;var a=new Ai(new Fi(5,5,5),i);r.add(a);var o=new Xi(1,10,1);o.renderTarget=this;o.renderTarget.texture.name="CubeCameraTexture";o.update(e,r);a.geometry.dispose();a.material.dispose();return this};function Zi(e,t,r,n,i,a,o,s,u,l,c,h){br.call(this,null,a,o,s,u,l,n,i,c,h);this.image={data:e||null,width:t||1,height:r||1};this.magFilter=u!==undefined?u:$;this.minFilter=l!==undefined?l:$;this.generateMipmaps=false;this.flipY=false;this.unpackAlignment=1;this.needsUpdate=true}Zi.prototype=Object.create(br.prototype);Zi.prototype.constructor=Zi;Zi.prototype.isDataTexture=true;var Ji=new pr;var Ki=new pr;var Qi=new mr;function $i(e,t){this.normal=e!==undefined?e:new pr(1,0,0);this.constant=t!==undefined?t:0}Object.assign($i.prototype,{isPlane:true,set:function(e,t){this.normal.copy(e);this.constant=t;return this},setComponents:function(e,t,r,n){this.normal.set(e,t,r);this.constant=n;return this},setFromNormalAndCoplanarPoint:function(e,t){this.normal.copy(e);this.constant=-t.dot(this.normal);return this},setFromCoplanarPoints:function(e,t,r){var n=Ji.subVectors(r,t).cross(Ki.subVectors(e,t)).normalize();this.setFromNormalAndCoplanarPoint(n,e);return this},clone:function(){return(new this.constructor).copy(this)},copy:function(e){this.normal.copy(e.normal);this.constant=e.constant;return this},normalize:function(){var e=1/this.normal.length();this.normal.multiplyScalar(e);this.constant*=e;return this},negate:function(){this.constant*=-1;this.normal.negate();return this},distanceToPoint:function(e){return this.normal.dot(e)+this.constant},distanceToSphere:function(e){return this.distanceToPoint(e.center)-e.radius},projectPoint:function(e,t){if(t===undefined){console.warn("THREE.Plane: .projectPoint() target is now required");t=new pr}return t.copy(this.normal).multiplyScalar(-this.distanceToPoint(e)).add(e)},intersectLine:function(e,t){if(t===undefined){console.warn("THREE.Plane: .intersectLine() target is now required");t=new pr}var r=e.delta(Ji);var n=this.normal.dot(r);if(n===0){if(this.distanceToPoint(e.start)===0){return t.copy(e.start)}return undefined}var i=-(e.start.dot(this.normal)+this.constant)/n;if(i<0||i>1){return undefined}return t.copy(r).multiplyScalar(i).add(e.start)},intersectsLine:function(e){var t=this.distanceToPoint(e.start);var r=this.distanceToPoint(e.end);return t<0&&r>0||r<0&&t>0},intersectsBox:function(e){return e.intersectsPlane(this)},intersectsSphere:function(e){return e.intersectsPlane(this)},coplanarPoint:function(e){if(e===undefined){console.warn("THREE.Plane: .coplanarPoint() target is now required");e=new pr}return e.copy(this.normal).multiplyScalar(-this.constant)},applyMatrix4:function(e,t){var r=t||Qi.getNormalMatrix(e);var n=this.coplanarPoint(Ji).applyMatrix4(e);var i=this.normal.applyMatrix3(r).normalize();this.constant=-n.dot(i);return this},translate:function(e){this.constant-=e.dot(this.normal);return this},equals:function(e){return e.normal.equals(this.normal)&&e.constant===this.constant}});var ea=new dn;var ta=new pr;function ra(e,t,r,n,i,a){this.planes=[e!==undefined?e:new $i,t!==undefined?t:new $i,r!==undefined?r:new $i,n!==undefined?n:new $i,i!==undefined?i:new $i,a!==undefined?a:new $i]}Object.assign(ra.prototype,{set:function(e,t,r,n,i,a){var o=this.planes;o[0].copy(e);o[1].copy(t);o[2].copy(r);o[3].copy(n);o[4].copy(i);o[5].copy(a);return this},clone:function(){return(new this.constructor).copy(this)},copy:function(e){var t=this.planes;for(var r=0;r<6;r++){t[r].copy(e.planes[r])}return this},setFromMatrix:function(e){var t=this.planes;var r=e.elements;var n=r[0],i=r[1],a=r[2],o=r[3];var s=r[4],u=r[5],l=r[6],c=r[7];var h=r[8],f=r[9],d=r[10],p=r[11];var v=r[12],m=r[13],g=r[14],y=r[15];t[0].setComponents(o-n,c-s,p-h,y-v).normalize();t[1].setComponents(o+n,c+s,p+h,y+v).normalize();t[2].setComponents(o+i,c+u,p+f,y+m).normalize();t[3].setComponents(o-i,c-u,p-f,y-m).normalize();t[4].setComponents(o-a,c-l,p-d,y-g).normalize();t[5].setComponents(o+a,c+l,p+d,y+g).normalize();return this},intersectsObject:function(e){var t=e.geometry;if(t.boundingSphere===null)t.computeBoundingSphere();ea.copy(t.boundingSphere).applyMatrix4(e.matrixWorld);return this.intersectsSphere(ea)},intersectsSprite:function(e){ea.center.set(0,0,0);ea.radius=.7071067811865476;ea.applyMatrix4(e.matrixWorld);return this.intersectsSphere(ea)},intersectsSphere:function(e){var t=this.planes;var r=e.center;var n=-e.radius;for(var i=0;i<6;i++){var a=t[i].distanceToPoint(r);if(a<n){return false}}return true},intersectsBox:function(e){var t=this.planes;for(var r=0;r<6;r++){var n=t[r];ta.x=n.normal.x>0?e.max.x:e.min.x;ta.y=n.normal.y>0?e.max.y:e.min.y;ta.z=n.normal.z>0?e.max.z:e.min.z;if(n.distanceToPoint(ta)<0){return false}}return true},containsPoint:function(e){var t=this.planes;for(var r=0;r<6;r++){if(t[r].distanceToPoint(e)<0){return false}}return true}});var na="#ifdef USE_ALPHAMAP\n\tdiffuseColor.a *= texture2D( alphaMap, vUv ).g;\n#endif";var ia="#ifdef USE_ALPHAMAP\n\tuniform sampler2D alphaMap;\n#endif";var aa="#ifdef ALPHATEST\n\tif ( diffuseColor.a < ALPHATEST ) discard;\n#endif";var oa="#ifdef USE_AOMAP\n\tfloat ambientOcclusion = ( texture2D( aoMap, vUv2 ).r - 1.0 ) * aoMapIntensity + 1.0;\n\treflectedLight.indirectDiffuse *= ambientOcclusion;\n\t#if defined( USE_ENVMAP ) && defined( STANDARD )\n\t\tfloat dotNV = saturate( dot( geometry.normal, geometry.viewDir ) );\n\t\treflectedLight.indirectSpecular *= computeSpecularOcclusion( dotNV, ambientOcclusion, material.specularRoughness );\n\t#endif\n#endif";var sa="#ifdef USE_AOMAP\n\tuniform sampler2D aoMap;\n\tuniform float aoMapIntensity;\n#endif";var ua="vec3 transformed = vec3( position );";var la="vec3 objectNormal = vec3( normal );\n#ifdef USE_TANGENT\n\tvec3 objectTangent = vec3( tangent.xyz );\n#endif";var ca="vec2 integrateSpecularBRDF( const in float dotNV, const in float roughness ) {\n\tconst vec4 c0 = vec4( - 1, - 0.0275, - 0.572, 0.022 );\n\tconst vec4 c1 = vec4( 1, 0.0425, 1.04, - 0.04 );\n\tvec4 r = roughness * c0 + c1;\n\tfloat a004 = min( r.x * r.x, exp2( - 9.28 * dotNV ) ) * r.x + r.y;\n\treturn vec2( -1.04, 1.04 ) * a004 + r.zw;\n}\nfloat punctualLightIntensityToIrradianceFactor( const in float lightDistance, const in float cutoffDistance, const in float decayExponent ) {\n#if defined ( PHYSICALLY_CORRECT_LIGHTS )\n\tfloat distanceFalloff = 1.0 / max( pow( lightDistance, decayExponent ), 0.01 );\n\tif( cutoffDistance > 0.0 ) {\n\t\tdistanceFalloff *= pow2( saturate( 1.0 - pow4( lightDistance / cutoffDistance ) ) );\n\t}\n\treturn distanceFalloff;\n#else\n\tif( cutoffDistance > 0.0 && decayExponent > 0.0 ) {\n\t\treturn pow( saturate( -lightDistance / cutoffDistance + 1.0 ), decayExponent );\n\t}\n\treturn 1.0;\n#endif\n}\nvec3 BRDF_Diffuse_Lambert( const in vec3 diffuseColor ) {\n\treturn RECIPROCAL_PI * diffuseColor;\n}\nvec3 F_Schlick( const in vec3 specularColor, const in float dotLH ) {\n\tfloat fresnel = exp2( ( -5.55473 * dotLH - 6.98316 ) * dotLH );\n\treturn ( 1.0 - specularColor ) * fresnel + specularColor;\n}\nvec3 F_Schlick_RoughnessDependent( const in vec3 F0, const in float dotNV, const in float roughness ) {\n\tfloat fresnel = exp2( ( -5.55473 * dotNV - 6.98316 ) * dotNV );\n\tvec3 Fr = max( vec3( 1.0 - roughness ), F0 ) - F0;\n\treturn Fr * fresnel + F0;\n}\nfloat G_GGX_Smith( const in float alpha, const in float dotNL, const in float dotNV ) {\n\tfloat a2 = pow2( alpha );\n\tfloat gl = dotNL + sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNL ) );\n\tfloat gv = dotNV + sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNV ) );\n\treturn 1.0 / ( gl * gv );\n}\nfloat G_GGX_SmithCorrelated( const in float alpha, const in float dotNL, const in float dotNV ) {\n\tfloat a2 = pow2( alpha );\n\tfloat gv = dotNL * sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNV ) );\n\tfloat gl = dotNV * sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNL ) );\n\treturn 0.5 / max( gv + gl, EPSILON );\n}\nfloat D_GGX( const in float alpha, const in float dotNH ) {\n\tfloat a2 = pow2( alpha );\n\tfloat denom = pow2( dotNH ) * ( a2 - 1.0 ) + 1.0;\n\treturn RECIPROCAL_PI * a2 / pow2( denom );\n}\nvec3 BRDF_Specular_GGX( const in IncidentLight incidentLight, const in vec3 viewDir, const in vec3 normal, const in vec3 specularColor, const in float roughness ) {\n\tfloat alpha = pow2( roughness );\n\tvec3 halfDir = normalize( incidentLight.direction + viewDir );\n\tfloat dotNL = saturate( dot( normal, incidentLight.direction ) );\n\tfloat dotNV = saturate( dot( normal, viewDir ) );\n\tfloat dotNH = saturate( dot( normal, halfDir ) );\n\tfloat dotLH = saturate( dot( incidentLight.direction, halfDir ) );\n\tvec3 F = F_Schlick( specularColor, dotLH );\n\tfloat G = G_GGX_SmithCorrelated( alpha, dotNL, dotNV );\n\tfloat D = D_GGX( alpha, dotNH );\n\treturn F * ( G * D );\n}\nvec2 LTC_Uv( const in vec3 N, const in vec3 V, const in float roughness ) {\n\tconst float LUT_SIZE  = 64.0;\n\tconst float LUT_SCALE = ( LUT_SIZE - 1.0 ) / LUT_SIZE;\n\tconst float LUT_BIAS  = 0.5 / LUT_SIZE;\n\tfloat dotNV = saturate( dot( N, V ) );\n\tvec2 uv = vec2( roughness, sqrt( 1.0 - dotNV ) );\n\tuv = uv * LUT_SCALE + LUT_BIAS;\n\treturn uv;\n}\nfloat LTC_ClippedSphereFormFactor( const in vec3 f ) {\n\tfloat l = length( f );\n\treturn max( ( l * l + f.z ) / ( l + 1.0 ), 0.0 );\n}\nvec3 LTC_EdgeVectorFormFactor( const in vec3 v1, const in vec3 v2 ) {\n\tfloat x = dot( v1, v2 );\n\tfloat y = abs( x );\n\tfloat a = 0.8543985 + ( 0.4965155 + 0.0145206 * y ) * y;\n\tfloat b = 3.4175940 + ( 4.1616724 + y ) * y;\n\tfloat v = a / b;\n\tfloat theta_sintheta = ( x > 0.0 ) ? v : 0.5 * inversesqrt( max( 1.0 - x * x, 1e-7 ) ) - v;\n\treturn cross( v1, v2 ) * theta_sintheta;\n}\nvec3 LTC_Evaluate( const in vec3 N, const in vec3 V, const in vec3 P, const in mat3 mInv, const in vec3 rectCoords[ 4 ] ) {\n\tvec3 v1 = rectCoords[ 1 ] - rectCoords[ 0 ];\n\tvec3 v2 = rectCoords[ 3 ] - rectCoords[ 0 ];\n\tvec3 lightNormal = cross( v1, v2 );\n\tif( dot( lightNormal, P - rectCoords[ 0 ] ) < 0.0 ) return vec3( 0.0 );\n\tvec3 T1, T2;\n\tT1 = normalize( V - N * dot( V, N ) );\n\tT2 = - cross( N, T1 );\n\tmat3 mat = mInv * transposeMat3( mat3( T1, T2, N ) );\n\tvec3 coords[ 4 ];\n\tcoords[ 0 ] = mat * ( rectCoords[ 0 ] - P );\n\tcoords[ 1 ] = mat * ( rectCoords[ 1 ] - P );\n\tcoords[ 2 ] = mat * ( rectCoords[ 2 ] - P );\n\tcoords[ 3 ] = mat * ( rectCoords[ 3 ] - P );\n\tcoords[ 0 ] = normalize( coords[ 0 ] );\n\tcoords[ 1 ] = normalize( coords[ 1 ] );\n\tcoords[ 2 ] = normalize( coords[ 2 ] );\n\tcoords[ 3 ] = normalize( coords[ 3 ] );\n\tvec3 vectorFormFactor = vec3( 0.0 );\n\tvectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 0 ], coords[ 1 ] );\n\tvectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 1 ], coords[ 2 ] );\n\tvectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 2 ], coords[ 3 ] );\n\tvectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 3 ], coords[ 0 ] );\n\tfloat result = LTC_ClippedSphereFormFactor( vectorFormFactor );\n\treturn vec3( result );\n}\nvec3 BRDF_Specular_GGX_Environment( const in vec3 viewDir, const in vec3 normal, const in vec3 specularColor, const in float roughness ) {\n\tfloat dotNV = saturate( dot( normal, viewDir ) );\n\tvec2 brdf = integrateSpecularBRDF( dotNV, roughness );\n\treturn specularColor * brdf.x + brdf.y;\n}\nvoid BRDF_Specular_Multiscattering_Environment( const in GeometricContext geometry, const in vec3 specularColor, const in float roughness, inout vec3 singleScatter, inout vec3 multiScatter ) {\n\tfloat dotNV = saturate( dot( geometry.normal, geometry.viewDir ) );\n\tvec3 F = F_Schlick_RoughnessDependent( specularColor, dotNV, roughness );\n\tvec2 brdf = integrateSpecularBRDF( dotNV, roughness );\n\tvec3 FssEss = F * brdf.x + brdf.y;\n\tfloat Ess = brdf.x + brdf.y;\n\tfloat Ems = 1.0 - Ess;\n\tvec3 Favg = specularColor + ( 1.0 - specularColor ) * 0.047619;\tvec3 Fms = FssEss * Favg / ( 1.0 - Ems * Favg );\n\tsingleScatter += FssEss;\n\tmultiScatter += Fms * Ems;\n}\nfloat G_BlinnPhong_Implicit( ) {\n\treturn 0.25;\n}\nfloat D_BlinnPhong( const in float shininess, const in float dotNH ) {\n\treturn RECIPROCAL_PI * ( shininess * 0.5 + 1.0 ) * pow( dotNH, shininess );\n}\nvec3 BRDF_Specular_BlinnPhong( const in IncidentLight incidentLight, const in GeometricContext geometry, const in vec3 specularColor, const in float shininess ) {\n\tvec3 halfDir = normalize( incidentLight.direction + geometry.viewDir );\n\tfloat dotNH = saturate( dot( geometry.normal, halfDir ) );\n\tfloat dotLH = saturate( dot( incidentLight.direction, halfDir ) );\n\tvec3 F = F_Schlick( specularColor, dotLH );\n\tfloat G = G_BlinnPhong_Implicit( );\n\tfloat D = D_BlinnPhong( shininess, dotNH );\n\treturn F * ( G * D );\n}\nfloat GGXRoughnessToBlinnExponent( const in float ggxRoughness ) {\n\treturn ( 2.0 / pow2( ggxRoughness + 0.0001 ) - 2.0 );\n}\nfloat BlinnExponentToGGXRoughness( const in float blinnExponent ) {\n\treturn sqrt( 2.0 / ( blinnExponent + 2.0 ) );\n}\n#if defined( USE_SHEEN )\nfloat D_Charlie(float roughness, float NoH) {\n\tfloat invAlpha  = 1.0 / roughness;\n\tfloat cos2h = NoH * NoH;\n\tfloat sin2h = max(1.0 - cos2h, 0.0078125);\treturn (2.0 + invAlpha) * pow(sin2h, invAlpha * 0.5) / (2.0 * PI);\n}\nfloat V_Neubelt(float NoV, float NoL) {\n\treturn saturate(1.0 / (4.0 * (NoL + NoV - NoL * NoV)));\n}\nvec3 BRDF_Specular_Sheen( const in float roughness, const in vec3 L, const in GeometricContext geometry, vec3 specularColor ) {\n\tvec3 N = geometry.normal;\n\tvec3 V = geometry.viewDir;\n\tvec3 H = normalize( V + L );\n\tfloat dotNH = saturate( dot( N, H ) );\n\treturn specularColor * D_Charlie( roughness, dotNH ) * V_Neubelt( dot(N, V), dot(N, L) );\n}\n#endif";var ha="#ifdef USE_BUMPMAP\n\tuniform sampler2D bumpMap;\n\tuniform float bumpScale;\n\tvec2 dHdxy_fwd() {\n\t\tvec2 dSTdx = dFdx( vUv );\n\t\tvec2 dSTdy = dFdy( vUv );\n\t\tfloat Hll = bumpScale * texture2D( bumpMap, vUv ).x;\n\t\tfloat dBx = bumpScale * texture2D( bumpMap, vUv + dSTdx ).x - Hll;\n\t\tfloat dBy = bumpScale * texture2D( bumpMap, vUv + dSTdy ).x - Hll;\n\t\treturn vec2( dBx, dBy );\n\t}\n\tvec3 perturbNormalArb( vec3 surf_pos, vec3 surf_norm, vec2 dHdxy ) {\n\t\tvec3 vSigmaX = vec3( dFdx( surf_pos.x ), dFdx( surf_pos.y ), dFdx( surf_pos.z ) );\n\t\tvec3 vSigmaY = vec3( dFdy( surf_pos.x ), dFdy( surf_pos.y ), dFdy( surf_pos.z ) );\n\t\tvec3 vN = surf_norm;\n\t\tvec3 R1 = cross( vSigmaY, vN );\n\t\tvec3 R2 = cross( vN, vSigmaX );\n\t\tfloat fDet = dot( vSigmaX, R1 );\n\t\tfDet *= ( float( gl_FrontFacing ) * 2.0 - 1.0 );\n\t\tvec3 vGrad = sign( fDet ) * ( dHdxy.x * R1 + dHdxy.y * R2 );\n\t\treturn normalize( abs( fDet ) * surf_norm - vGrad );\n\t}\n#endif";var fa="#if NUM_CLIPPING_PLANES > 0\n\tvec4 plane;\n\t#pragma unroll_loop\n\tfor ( int i = 0; i < UNION_CLIPPING_PLANES; i ++ ) {\n\t\tplane = clippingPlanes[ i ];\n\t\tif ( dot( vViewPosition, plane.xyz ) > plane.w ) discard;\n\t}\n\t#if UNION_CLIPPING_PLANES < NUM_CLIPPING_PLANES\n\t\tbool clipped = true;\n\t\t#pragma unroll_loop\n\t\tfor ( int i = UNION_CLIPPING_PLANES; i < NUM_CLIPPING_PLANES; i ++ ) {\n\t\t\tplane = clippingPlanes[ i ];\n\t\t\tclipped = ( dot( vViewPosition, plane.xyz ) > plane.w ) && clipped;\n\t\t}\n\t\tif ( clipped ) discard;\n\t#endif\n#endif";var da="#if NUM_CLIPPING_PLANES > 0\n\t#if ! defined( STANDARD ) && ! defined( PHONG ) && ! defined( MATCAP )\n\t\tvarying vec3 vViewPosition;\n\t#endif\n\tuniform vec4 clippingPlanes[ NUM_CLIPPING_PLANES ];\n#endif";var pa="#if NUM_CLIPPING_PLANES > 0 && ! defined( STANDARD ) && ! defined( PHONG ) && ! defined( MATCAP )\n\tvarying vec3 vViewPosition;\n#endif";var va="#if NUM_CLIPPING_PLANES > 0 && ! defined( STANDARD ) && ! defined( PHONG ) && ! defined( MATCAP )\n\tvViewPosition = - mvPosition.xyz;\n#endif";var ma="#ifdef USE_COLOR\n\tdiffuseColor.rgb *= vColor;\n#endif";var ga="#ifdef USE_COLOR\n\tvarying vec3 vColor;\n#endif";var ya="#ifdef USE_COLOR\n\tvarying vec3 vColor;\n#endif";var xa="#ifdef USE_COLOR\n\tvColor.xyz = color.xyz;\n#endif";var ba="#define PI 3.14159265359\n#define PI2 6.28318530718\n#define PI_HALF 1.5707963267949\n#define RECIPROCAL_PI 0.31830988618\n#define RECIPROCAL_PI2 0.15915494\n#define LOG2 1.442695\n#define EPSILON 1e-6\n#ifndef saturate\n#define saturate(a) clamp( a, 0.0, 1.0 )\n#endif\n#define whiteComplement(a) ( 1.0 - saturate( a ) )\nfloat pow2( const in float x ) { return x*x; }\nfloat pow3( const in float x ) { return x*x*x; }\nfloat pow4( const in float x ) { float x2 = x*x; return x2*x2; }\nfloat average( const in vec3 color ) { return dot( color, vec3( 0.3333 ) ); }\nhighp float rand( const in vec2 uv ) {\n\tconst highp float a = 12.9898, b = 78.233, c = 43758.5453;\n\thighp float dt = dot( uv.xy, vec2( a,b ) ), sn = mod( dt, PI );\n\treturn fract(sin(sn) * c);\n}\n#ifdef HIGH_PRECISION\n\tfloat precisionSafeLength( vec3 v ) { return length( v ); }\n#else\n\tfloat max3( vec3 v ) { return max( max( v.x, v.y ), v.z ); }\n\tfloat precisionSafeLength( vec3 v ) {\n\t\tfloat maxComponent = max3( abs( v ) );\n\t\treturn length( v / maxComponent ) * maxComponent;\n\t}\n#endif\nstruct IncidentLight {\n\tvec3 color;\n\tvec3 direction;\n\tbool visible;\n};\nstruct ReflectedLight {\n\tvec3 directDiffuse;\n\tvec3 directSpecular;\n\tvec3 indirectDiffuse;\n\tvec3 indirectSpecular;\n};\nstruct GeometricContext {\n\tvec3 position;\n\tvec3 normal;\n\tvec3 viewDir;\n#ifdef CLEARCOAT\n\tvec3 clearcoatNormal;\n#endif\n};\nvec3 transformDirection( in vec3 dir, in mat4 matrix ) {\n\treturn normalize( ( matrix * vec4( dir, 0.0 ) ).xyz );\n}\nvec3 inverseTransformDirection( in vec3 dir, in mat4 matrix ) {\n\treturn normalize( ( vec4( dir, 0.0 ) * matrix ).xyz );\n}\nvec3 projectOnPlane(in vec3 point, in vec3 pointOnPlane, in vec3 planeNormal ) {\n\tfloat distance = dot( planeNormal, point - pointOnPlane );\n\treturn - distance * planeNormal + point;\n}\nfloat sideOfPlane( in vec3 point, in vec3 pointOnPlane, in vec3 planeNormal ) {\n\treturn sign( dot( point - pointOnPlane, planeNormal ) );\n}\nvec3 linePlaneIntersect( in vec3 pointOnLine, in vec3 lineDirection, in vec3 pointOnPlane, in vec3 planeNormal ) {\n\treturn lineDirection * ( dot( planeNormal, pointOnPlane - pointOnLine ) / dot( planeNormal, lineDirection ) ) + pointOnLine;\n}\nmat3 transposeMat3( const in mat3 m ) {\n\tmat3 tmp;\n\ttmp[ 0 ] = vec3( m[ 0 ].x, m[ 1 ].x, m[ 2 ].x );\n\ttmp[ 1 ] = vec3( m[ 0 ].y, m[ 1 ].y, m[ 2 ].y );\n\ttmp[ 2 ] = vec3( m[ 0 ].z, m[ 1 ].z, m[ 2 ].z );\n\treturn tmp;\n}\nfloat linearToRelativeLuminance( const in vec3 color ) {\n\tvec3 weights = vec3( 0.2126, 0.7152, 0.0722 );\n\treturn dot( weights, color.rgb );\n}\nbool isPerspectiveMatrix( mat4 m ) {\n  return m[ 2 ][ 3 ] == - 1.0;\n}";var wa="#ifdef ENVMAP_TYPE_CUBE_UV\n#define cubeUV_textureSize (1024.0)\nint getFaceFromDirection(vec3 direction) {\n\tvec3 absDirection = abs(direction);\n\tint face = -1;\n\tif( absDirection.x > absDirection.z ) {\n\t\tif(absDirection.x > absDirection.y )\n\t\t\tface = direction.x > 0.0 ? 0 : 3;\n\t\telse\n\t\t\tface = direction.y > 0.0 ? 1 : 4;\n\t}\n\telse {\n\t\tif(absDirection.z > absDirection.y )\n\t\t\tface = direction.z > 0.0 ? 2 : 5;\n\t\telse\n\t\t\tface = direction.y > 0.0 ? 1 : 4;\n\t}\n\treturn face;\n}\n#define cubeUV_maxLods1  (log2(cubeUV_textureSize*0.25) - 1.0)\n#define cubeUV_rangeClamp (exp2((6.0 - 1.0) * 2.0))\nvec2 MipLevelInfo( vec3 vec, float roughnessLevel, float roughness ) {\n\tfloat scale = exp2(cubeUV_maxLods1 - roughnessLevel);\n\tfloat dxRoughness = dFdx(roughness);\n\tfloat dyRoughness = dFdy(roughness);\n\tvec3 dx = dFdx( vec * scale * dxRoughness );\n\tvec3 dy = dFdy( vec * scale * dyRoughness );\n\tfloat d = max( dot( dx, dx ), dot( dy, dy ) );\n\td = clamp(d, 1.0, cubeUV_rangeClamp);\n\tfloat mipLevel = 0.5 * log2(d);\n\treturn vec2(floor(mipLevel), fract(mipLevel));\n}\n#define cubeUV_maxLods2 (log2(cubeUV_textureSize*0.25) - 2.0)\n#define cubeUV_rcpTextureSize (1.0 / cubeUV_textureSize)\nvec2 getCubeUV(vec3 direction, float roughnessLevel, float mipLevel) {\n\tmipLevel = roughnessLevel > cubeUV_maxLods2 - 3.0 ? 0.0 : mipLevel;\n\tfloat a = 16.0 * cubeUV_rcpTextureSize;\n\tvec2 exp2_packed = exp2( vec2( roughnessLevel, mipLevel ) );\n\tvec2 rcp_exp2_packed = vec2( 1.0 ) / exp2_packed;\n\tfloat powScale = exp2_packed.x * exp2_packed.y;\n\tfloat scale = rcp_exp2_packed.x * rcp_exp2_packed.y * 0.25;\n\tfloat mipOffset = 0.75*(1.0 - rcp_exp2_packed.y) * rcp_exp2_packed.x;\n\tbool bRes = mipLevel == 0.0;\n\tscale =  bRes && (scale < a) ? a : scale;\n\tvec3 r;\n\tvec2 offset;\n\tint face = getFaceFromDirection(direction);\n\tfloat rcpPowScale = 1.0 / powScale;\n\tif( face == 0) {\n\t\tr = vec3(direction.x, -direction.z, direction.y);\n\t\toffset = vec2(0.0+mipOffset,0.75 * rcpPowScale);\n\t\toffset.y = bRes && (offset.y < 2.0*a) ? a : offset.y;\n\t}\n\telse if( face == 1) {\n\t\tr = vec3(direction.y, direction.x, direction.z);\n\t\toffset = vec2(scale+mipOffset, 0.75 * rcpPowScale);\n\t\toffset.y = bRes && (offset.y < 2.0*a) ? a : offset.y;\n\t}\n\telse if( face == 2) {\n\t\tr = vec3(direction.z, direction.x, direction.y);\n\t\toffset = vec2(2.0*scale+mipOffset, 0.75 * rcpPowScale);\n\t\toffset.y = bRes && (offset.y < 2.0*a) ? a : offset.y;\n\t}\n\telse if( face == 3) {\n\t\tr = vec3(direction.x, direction.z, direction.y);\n\t\toffset = vec2(0.0+mipOffset,0.5 * rcpPowScale);\n\t\toffset.y = bRes && (offset.y < 2.0*a) ? 0.0 : offset.y;\n\t}\n\telse if( face == 4) {\n\t\tr = vec3(direction.y, direction.x, -direction.z);\n\t\toffset = vec2(scale+mipOffset, 0.5 * rcpPowScale);\n\t\toffset.y = bRes && (offset.y < 2.0*a) ? 0.0 : offset.y;\n\t}\n\telse {\n\t\tr = vec3(direction.z, -direction.x, direction.y);\n\t\toffset = vec2(2.0*scale+mipOffset, 0.5 * rcpPowScale);\n\t\toffset.y = bRes && (offset.y < 2.0*a) ? 0.0 : offset.y;\n\t}\n\tr = normalize(r);\n\tfloat texelOffset = 0.5 * cubeUV_rcpTextureSize;\n\tvec2 s = ( r.yz / abs( r.x ) + vec2( 1.0 ) ) * 0.5;\n\tvec2 base = offset + vec2( texelOffset );\n\treturn base + s * ( scale - 2.0 * texelOffset );\n}\n#define cubeUV_maxLods3 (log2(cubeUV_textureSize*0.25) - 3.0)\nvec4 textureCubeUV( sampler2D envMap, vec3 reflectedDirection, float roughness ) {\n\tfloat roughnessVal = roughness* cubeUV_maxLods3;\n\tfloat r1 = floor(roughnessVal);\n\tfloat r2 = r1 + 1.0;\n\tfloat t = fract(roughnessVal);\n\tvec2 mipInfo = MipLevelInfo(reflectedDirection, r1, roughness);\n\tfloat s = mipInfo.y;\n\tfloat level0 = mipInfo.x;\n\tfloat level1 = level0 + 1.0;\n\tlevel1 = level1 > 5.0 ? 5.0 : level1;\n\tlevel0 += min( floor( s + 0.5 ), 5.0 );\n\tvec2 uv_10 = getCubeUV(reflectedDirection, r1, level0);\n\tvec4 color10 = envMapTexelToLinear(texture2D(envMap, uv_10));\n\tvec2 uv_20 = getCubeUV(reflectedDirection, r2, level0);\n\tvec4 color20 = envMapTexelToLinear(texture2D(envMap, uv_20));\n\tvec4 result = mix(color10, color20, t);\n\treturn vec4(result.rgb, 1.0);\n}\n#endif";var _a="vec3 transformedNormal = objectNormal;\n#ifdef USE_INSTANCING\n\ttransformedNormal = mat3( instanceMatrix ) * transformedNormal;\n#endif\ntransformedNormal = normalMatrix * transformedNormal;\n#ifdef FLIP_SIDED\n\ttransformedNormal = - transformedNormal;\n#endif\n#ifdef USE_TANGENT\n\tvec3 transformedTangent = normalMatrix * objectTangent;\n\t#ifdef FLIP_SIDED\n\t\ttransformedTangent = - transformedTangent;\n\t#endif\n#endif";var Ta="#ifdef USE_DISPLACEMENTMAP\n\tuniform sampler2D displacementMap;\n\tuniform float displacementScale;\n\tuniform float displacementBias;\n#endif";var Ea="#ifdef USE_DISPLACEMENTMAP\n\ttransformed += normalize( objectNormal ) * ( texture2D( displacementMap, vUv ).x * displacementScale + displacementBias );\n#endif";var Ma="#ifdef USE_EMISSIVEMAP\n\tvec4 emissiveColor = texture2D( emissiveMap, vUv );\n\temissiveColor.rgb = emissiveMapTexelToLinear( emissiveColor ).rgb;\n\ttotalEmissiveRadiance *= emissiveColor.rgb;\n#endif";var Sa="#ifdef USE_EMISSIVEMAP\n\tuniform sampler2D emissiveMap;\n#endif";var Aa="gl_FragColor = linearToOutputTexel( gl_FragColor );";var Ra="\nvec4 LinearToLinear( in vec4 value ) {\n\treturn value;\n}\nvec4 GammaToLinear( in vec4 value, in float gammaFactor ) {\n\treturn vec4( pow( value.rgb, vec3( gammaFactor ) ), value.a );\n}\nvec4 LinearToGamma( in vec4 value, in float gammaFactor ) {\n\treturn vec4( pow( value.rgb, vec3( 1.0 / gammaFactor ) ), value.a );\n}\nvec4 sRGBToLinear( in vec4 value ) {\n\treturn vec4( mix( pow( value.rgb * 0.9478672986 + vec3( 0.0521327014 ), vec3( 2.4 ) ), value.rgb * 0.0773993808, vec3( lessThanEqual( value.rgb, vec3( 0.04045 ) ) ) ), value.a );\n}\nvec4 LinearTosRGB( in vec4 value ) {\n\treturn vec4( mix( pow( value.rgb, vec3( 0.41666 ) ) * 1.055 - vec3( 0.055 ), value.rgb * 12.92, vec3( lessThanEqual( value.rgb, vec3( 0.0031308 ) ) ) ), value.a );\n}\nvec4 RGBEToLinear( in vec4 value ) {\n\treturn vec4( value.rgb * exp2( value.a * 255.0 - 128.0 ), 1.0 );\n}\nvec4 LinearToRGBE( in vec4 value ) {\n\tfloat maxComponent = max( max( value.r, value.g ), value.b );\n\tfloat fExp = clamp( ceil( log2( maxComponent ) ), -128.0, 127.0 );\n\treturn vec4( value.rgb / exp2( fExp ), ( fExp + 128.0 ) / 255.0 );\n}\nvec4 RGBMToLinear( in vec4 value, in float maxRange ) {\n\treturn vec4( value.rgb * value.a * maxRange, 1.0 );\n}\nvec4 LinearToRGBM( in vec4 value, in float maxRange ) {\n\tfloat maxRGB = max( value.r, max( value.g, value.b ) );\n\tfloat M = clamp( maxRGB / maxRange, 0.0, 1.0 );\n\tM = ceil( M * 255.0 ) / 255.0;\n\treturn vec4( value.rgb / ( M * maxRange ), M );\n}\nvec4 RGBDToLinear( in vec4 value, in float maxRange ) {\n\treturn vec4( value.rgb * ( ( maxRange / 255.0 ) / value.a ), 1.0 );\n}\nvec4 LinearToRGBD( in vec4 value, in float maxRange ) {\n\tfloat maxRGB = max( value.r, max( value.g, value.b ) );\n\tfloat D = max( maxRange / maxRGB, 1.0 );\n\tD = min( floor( D ) / 255.0, 1.0 );\n\treturn vec4( value.rgb * ( D * ( 255.0 / maxRange ) ), D );\n}\nconst mat3 cLogLuvM = mat3( 0.2209, 0.3390, 0.4184, 0.1138, 0.6780, 0.7319, 0.0102, 0.1130, 0.2969 );\nvec4 LinearToLogLuv( in vec4 value )  {\n\tvec3 Xp_Y_XYZp = cLogLuvM * value.rgb;\n\tXp_Y_XYZp = max( Xp_Y_XYZp, vec3( 1e-6, 1e-6, 1e-6 ) );\n\tvec4 vResult;\n\tvResult.xy = Xp_Y_XYZp.xy / Xp_Y_XYZp.z;\n\tfloat Le = 2.0 * log2(Xp_Y_XYZp.y) + 127.0;\n\tvResult.w = fract( Le );\n\tvResult.z = ( Le - ( floor( vResult.w * 255.0 ) ) / 255.0 ) / 255.0;\n\treturn vResult;\n}\nconst mat3 cLogLuvInverseM = mat3( 6.0014, -2.7008, -1.7996, -1.3320, 3.1029, -5.7721, 0.3008, -1.0882, 5.6268 );\nvec4 LogLuvToLinear( in vec4 value ) {\n\tfloat Le = value.z * 255.0 + value.w;\n\tvec3 Xp_Y_XYZp;\n\tXp_Y_XYZp.y = exp2( ( Le - 127.0 ) / 2.0 );\n\tXp_Y_XYZp.z = Xp_Y_XYZp.y / value.y;\n\tXp_Y_XYZp.x = value.x * Xp_Y_XYZp.z;\n\tvec3 vRGB = cLogLuvInverseM * Xp_Y_XYZp.rgb;\n\treturn vec4( max( vRGB, 0.0 ), 1.0 );\n}";var Pa="#ifdef USE_ENVMAP\n\t#ifdef ENV_WORLDPOS\n\t\tvec3 cameraToVertex = normalize( vWorldPosition - cameraPosition );\n\t\tvec3 worldNormal = inverseTransformDirection( normal, viewMatrix );\n\t\t#ifdef ENVMAP_MODE_REFLECTION\n\t\t\tvec3 reflectVec = reflect( cameraToVertex, worldNormal );\n\t\t#else\n\t\t\tvec3 reflectVec = refract( cameraToVertex, worldNormal, refractionRatio );\n\t\t#endif\n\t#else\n\t\tvec3 reflectVec = vReflect;\n\t#endif\n\t#ifdef ENVMAP_TYPE_CUBE\n\t\tvec4 envColor = textureCube( envMap, vec3( flipEnvMap * reflectVec.x, reflectVec.yz ) );\n\t#elif defined( ENVMAP_TYPE_EQUIREC )\n\t\tvec2 sampleUV;\n\t\treflectVec = normalize( reflectVec );\n\t\tsampleUV.y = asin( clamp( reflectVec.y, - 1.0, 1.0 ) ) * RECIPROCAL_PI + 0.5;\n\t\tsampleUV.x = atan( reflectVec.z, reflectVec.x ) * RECIPROCAL_PI2 + 0.5;\n\t\tvec4 envColor = texture2D( envMap, sampleUV );\n\t#elif defined( ENVMAP_TYPE_SPHERE )\n\t\treflectVec = normalize( reflectVec );\n\t\tvec3 reflectView = normalize( ( viewMatrix * vec4( reflectVec, 0.0 ) ).xyz + vec3( 0.0, 0.0, 1.0 ) );\n\t\tvec4 envColor = texture2D( envMap, reflectView.xy * 0.5 + 0.5 );\n\t#else\n\t\tvec4 envColor = vec4( 0.0 );\n\t#endif\n\tenvColor = envMapTexelToLinear( envColor );\n\t#ifdef ENVMAP_BLENDING_MULTIPLY\n\t\toutgoingLight = mix( outgoingLight, outgoingLight * envColor.xyz, specularStrength * reflectivity );\n\t#elif defined( ENVMAP_BLENDING_MIX )\n\t\toutgoingLight = mix( outgoingLight, envColor.xyz, specularStrength * reflectivity );\n\t#elif defined( ENVMAP_BLENDING_ADD )\n\t\toutgoingLight += envColor.xyz * specularStrength * reflectivity;\n\t#endif\n#endif";var Ca="#ifdef USE_ENVMAP\n\tuniform float envMapIntensity;\n\tuniform float flipEnvMap;\n\tuniform int maxMipLevel;\n\t#ifdef ENVMAP_TYPE_CUBE\n\t\tuniform samplerCube envMap;\n\t#else\n\t\tuniform sampler2D envMap;\n\t#endif\n\t\n#endif";var Oa="#ifdef USE_ENVMAP\n\tuniform float reflectivity;\n\t#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG )\n\t\t#define ENV_WORLDPOS\n\t#endif\n\t#ifdef ENV_WORLDPOS\n\t\tvarying vec3 vWorldPosition;\n\t\tuniform float refractionRatio;\n\t#else\n\t\tvarying vec3 vReflect;\n\t#endif\n#endif";var La="#ifdef USE_ENVMAP\n\t#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) ||defined( PHONG )\n\t\t#define ENV_WORLDPOS\n\t#endif\n\t#ifdef ENV_WORLDPOS\n\t\t\n\t\tvarying vec3 vWorldPosition;\n\t#else\n\t\tvarying vec3 vReflect;\n\t\tuniform float refractionRatio;\n\t#endif\n#endif";var Ia="#ifdef USE_ENVMAP\n\t#ifdef ENV_WORLDPOS\n\t\tvWorldPosition = worldPosition.xyz;\n\t#else\n\t\tvec3 cameraToVertex = normalize( worldPosition.xyz - cameraPosition );\n\t\tvec3 worldNormal = inverseTransformDirection( transformedNormal, viewMatrix );\n\t\t#ifdef ENVMAP_MODE_REFLECTION\n\t\t\tvReflect = reflect( cameraToVertex, worldNormal );\n\t\t#else\n\t\t\tvReflect = refract( cameraToVertex, worldNormal, refractionRatio );\n\t\t#endif\n\t#endif\n#endif";var Da="#ifdef USE_FOG\n\tfogDepth = -mvPosition.z;\n#endif";var Na="#ifdef USE_FOG\n\tvarying float fogDepth;\n#endif";var Fa="#ifdef USE_FOG\n\t#ifdef FOG_EXP2\n\t\tfloat fogFactor = 1.0 - exp( - fogDensity * fogDensity * fogDepth * fogDepth );\n\t#else\n\t\tfloat fogFactor = smoothstep( fogNear, fogFar, fogDepth );\n\t#endif\n\tgl_FragColor.rgb = mix( gl_FragColor.rgb, fogColor, fogFactor );\n#endif";var Ba="#ifdef USE_FOG\n\tuniform vec3 fogColor;\n\tvarying float fogDepth;\n\t#ifdef FOG_EXP2\n\t\tuniform float fogDensity;\n\t#else\n\t\tuniform float fogNear;\n\t\tuniform float fogFar;\n\t#endif\n#endif";var Ua="#ifdef TOON\n\tuniform sampler2D gradientMap;\n\tvec3 getGradientIrradiance( vec3 normal, vec3 lightDirection ) {\n\t\tfloat dotNL = dot( normal, lightDirection );\n\t\tvec2 coord = vec2( dotNL * 0.5 + 0.5, 0.0 );\n\t\t#ifdef USE_GRADIENTMAP\n\t\t\treturn texture2D( gradientMap, coord ).rgb;\n\t\t#else\n\t\t\treturn ( coord.x < 0.7 ) ? vec3( 0.7 ) : vec3( 1.0 );\n\t\t#endif\n\t}\n#endif";var ka="#ifdef USE_LIGHTMAP\n\treflectedLight.indirectDiffuse += PI * texture2D( lightMap, vUv2 ).xyz * lightMapIntensity;\n#endif";var ja="#ifdef USE_LIGHTMAP\n\tuniform sampler2D lightMap;\n\tuniform float lightMapIntensity;\n#endif";var za="vec3 diffuse = vec3( 1.0 );\nGeometricContext geometry;\ngeometry.position = mvPosition.xyz;\ngeometry.normal = normalize( transformedNormal );\ngeometry.viewDir = normalize( -mvPosition.xyz );\nGeometricContext backGeometry;\nbackGeometry.position = geometry.position;\nbackGeometry.normal = -geometry.normal;\nbackGeometry.viewDir = geometry.viewDir;\nvLightFront = vec3( 0.0 );\nvIndirectFront = vec3( 0.0 );\n#ifdef DOUBLE_SIDED\n\tvLightBack = vec3( 0.0 );\n\tvIndirectBack = vec3( 0.0 );\n#endif\nIncidentLight directLight;\nfloat dotNL;\nvec3 directLightColor_Diffuse;\n#if NUM_POINT_LIGHTS > 0\n\t#pragma unroll_loop\n\tfor ( int i = 0; i < NUM_POINT_LIGHTS; i ++ ) {\n\t\tgetPointDirectLightIrradiance( pointLights[ i ], geometry, directLight );\n\t\tdotNL = dot( geometry.normal, directLight.direction );\n\t\tdirectLightColor_Diffuse = PI * directLight.color;\n\t\tvLightFront += saturate( dotNL ) * directLightColor_Diffuse;\n\t\t#ifdef DOUBLE_SIDED\n\t\t\tvLightBack += saturate( -dotNL ) * directLightColor_Diffuse;\n\t\t#endif\n\t}\n#endif\n#if NUM_SPOT_LIGHTS > 0\n\t#pragma unroll_loop\n\tfor ( int i = 0; i < NUM_SPOT_LIGHTS; i ++ ) {\n\t\tgetSpotDirectLightIrradiance( spotLights[ i ], geometry, directLight );\n\t\tdotNL = dot( geometry.normal, directLight.direction );\n\t\tdirectLightColor_Diffuse = PI * directLight.color;\n\t\tvLightFront += saturate( dotNL ) * directLightColor_Diffuse;\n\t\t#ifdef DOUBLE_SIDED\n\t\t\tvLightBack += saturate( -dotNL ) * directLightColor_Diffuse;\n\t\t#endif\n\t}\n#endif\n#if NUM_DIR_LIGHTS > 0\n\t#pragma unroll_loop\n\tfor ( int i = 0; i < NUM_DIR_LIGHTS; i ++ ) {\n\t\tgetDirectionalDirectLightIrradiance( directionalLights[ i ], geometry, directLight );\n\t\tdotNL = dot( geometry.normal, directLight.direction );\n\t\tdirectLightColor_Diffuse = PI * directLight.color;\n\t\tvLightFront += saturate( dotNL ) * directLightColor_Diffuse;\n\t\t#ifdef DOUBLE_SIDED\n\t\t\tvLightBack += saturate( -dotNL ) * directLightColor_Diffuse;\n\t\t#endif\n\t}\n#endif\n#if NUM_HEMI_LIGHTS > 0\n\t#pragma unroll_loop\n\tfor ( int i = 0; i < NUM_HEMI_LIGHTS; i ++ ) {\n\t\tvIndirectFront += getHemisphereLightIrradiance( hemisphereLights[ i ], geometry );\n\t\t#ifdef DOUBLE_SIDED\n\t\t\tvIndirectBack += getHemisphereLightIrradiance( hemisphereLights[ i ], backGeometry );\n\t\t#endif\n\t}\n#endif";var Ha="uniform bool receiveShadow;\nuniform vec3 ambientLightColor;\nuniform vec3 lightProbe[ 9 ];\nvec3 shGetIrradianceAt( in vec3 normal, in vec3 shCoefficients[ 9 ] ) {\n\tfloat x = normal.x, y = normal.y, z = normal.z;\n\tvec3 result = shCoefficients[ 0 ] * 0.886227;\n\tresult += shCoefficients[ 1 ] * 2.0 * 0.511664 * y;\n\tresult += shCoefficients[ 2 ] * 2.0 * 0.511664 * z;\n\tresult += shCoefficients[ 3 ] * 2.0 * 0.511664 * x;\n\tresult += shCoefficients[ 4 ] * 2.0 * 0.429043 * x * y;\n\tresult += shCoefficients[ 5 ] * 2.0 * 0.429043 * y * z;\n\tresult += shCoefficients[ 6 ] * ( 0.743125 * z * z - 0.247708 );\n\tresult += shCoefficients[ 7 ] * 2.0 * 0.429043 * x * z;\n\tresult += shCoefficients[ 8 ] * 0.429043 * ( x * x - y * y );\n\treturn result;\n}\nvec3 getLightProbeIrradiance( const in vec3 lightProbe[ 9 ], const in GeometricContext geometry ) {\n\tvec3 worldNormal = inverseTransformDirection( geometry.normal, viewMatrix );\n\tvec3 irradiance = shGetIrradianceAt( worldNormal, lightProbe );\n\treturn irradiance;\n}\nvec3 getAmbientLightIrradiance( const in vec3 ambientLightColor ) {\n\tvec3 irradiance = ambientLightColor;\n\t#ifndef PHYSICALLY_CORRECT_LIGHTS\n\t\tirradiance *= PI;\n\t#endif\n\treturn irradiance;\n}\n#if NUM_DIR_LIGHTS > 0\n\tstruct DirectionalLight {\n\t\tvec3 direction;\n\t\tvec3 color;\n\t\tint shadow;\n\t\tfloat shadowBias;\n\t\tfloat shadowRadius;\n\t\tvec2 shadowMapSize;\n\t};\n\tuniform DirectionalLight directionalLights[ NUM_DIR_LIGHTS ];\n\tvoid getDirectionalDirectLightIrradiance( const in DirectionalLight directionalLight, const in GeometricContext geometry, out IncidentLight directLight ) {\n\t\tdirectLight.color = directionalLight.color;\n\t\tdirectLight.direction = directionalLight.direction;\n\t\tdirectLight.visible = true;\n\t}\n#endif\n#if NUM_POINT_LIGHTS > 0\n\tstruct PointLight {\n\t\tvec3 position;\n\t\tvec3 color;\n\t\tfloat distance;\n\t\tfloat decay;\n\t\tint shadow;\n\t\tfloat shadowBias;\n\t\tfloat shadowRadius;\n\t\tvec2 shadowMapSize;\n\t\tfloat shadowCameraNear;\n\t\tfloat shadowCameraFar;\n\t};\n\tuniform PointLight pointLights[ NUM_POINT_LIGHTS ];\n\tvoid getPointDirectLightIrradiance( const in PointLight pointLight, const in GeometricContext geometry, out IncidentLight directLight ) {\n\t\tvec3 lVector = pointLight.position - geometry.position;\n\t\tdirectLight.direction = normalize( lVector );\n\t\tfloat lightDistance = length( lVector );\n\t\tdirectLight.color = pointLight.color;\n\t\tdirectLight.color *= punctualLightIntensityToIrradianceFactor( lightDistance, pointLight.distance, pointLight.decay );\n\t\tdirectLight.visible = ( directLight.color != vec3( 0.0 ) );\n\t}\n#endif\n#if NUM_SPOT_LIGHTS > 0\n\tstruct SpotLight {\n\t\tvec3 position;\n\t\tvec3 direction;\n\t\tvec3 color;\n\t\tfloat distance;\n\t\tfloat decay;\n\t\tfloat coneCos;\n\t\tfloat penumbraCos;\n\t\tint shadow;\n\t\tfloat shadowBias;\n\t\tfloat shadowRadius;\n\t\tvec2 shadowMapSize;\n\t};\n\tuniform SpotLight spotLights[ NUM_SPOT_LIGHTS ];\n\tvoid getSpotDirectLightIrradiance( const in SpotLight spotLight, const in GeometricContext geometry, out IncidentLight directLight  ) {\n\t\tvec3 lVector = spotLight.position - geometry.position;\n\t\tdirectLight.direction = normalize( lVector );\n\t\tfloat lightDistance = length( lVector );\n\t\tfloat angleCos = dot( directLight.direction, spotLight.direction );\n\t\tif ( angleCos > spotLight.coneCos ) {\n\t\t\tfloat spotEffect = smoothstep( spotLight.coneCos, spotLight.penumbraCos, angleCos );\n\t\t\tdirectLight.color = spotLight.color;\n\t\t\tdirectLight.color *= spotEffect * punctualLightIntensityToIrradianceFactor( lightDistance, spotLight.distance, spotLight.decay );\n\t\t\tdirectLight.visible = true;\n\t\t} else {\n\t\t\tdirectLight.color = vec3( 0.0 );\n\t\t\tdirectLight.visible = false;\n\t\t}\n\t}\n#endif\n#if NUM_RECT_AREA_LIGHTS > 0\n\tstruct RectAreaLight {\n\t\tvec3 color;\n\t\tvec3 position;\n\t\tvec3 halfWidth;\n\t\tvec3 halfHeight;\n\t};\n\tuniform sampler2D ltc_1;\tuniform sampler2D ltc_2;\n\tuniform RectAreaLight rectAreaLights[ NUM_RECT_AREA_LIGHTS ];\n#endif\n#if NUM_HEMI_LIGHTS > 0\n\tstruct HemisphereLight {\n\t\tvec3 direction;\n\t\tvec3 skyColor;\n\t\tvec3 groundColor;\n\t};\n\tuniform HemisphereLight hemisphereLights[ NUM_HEMI_LIGHTS ];\n\tvec3 getHemisphereLightIrradiance( const in HemisphereLight hemiLight, const in GeometricContext geometry ) {\n\t\tfloat dotNL = dot( geometry.normal, hemiLight.direction );\n\t\tfloat hemiDiffuseWeight = 0.5 * dotNL + 0.5;\n\t\tvec3 irradiance = mix( hemiLight.groundColor, hemiLight.skyColor, hemiDiffuseWeight );\n\t\t#ifndef PHYSICALLY_CORRECT_LIGHTS\n\t\t\tirradiance *= PI;\n\t\t#endif\n\t\treturn irradiance;\n\t}\n#endif";var Ga="#if defined( USE_ENVMAP )\n\t#ifdef ENVMAP_MODE_REFRACTION\n\t\tuniform float refractionRatio;\n\t#endif\n\tvec3 getLightProbeIndirectIrradiance( const in GeometricContext geometry, const in int maxMIPLevel ) {\n\t\tvec3 worldNormal = inverseTransformDirection( geometry.normal, viewMatrix );\n\t\t#ifdef ENVMAP_TYPE_CUBE\n\t\t\tvec3 queryVec = vec3( flipEnvMap * worldNormal.x, worldNormal.yz );\n\t\t\t#ifdef TEXTURE_LOD_EXT\n\t\t\t\tvec4 envMapColor = textureCubeLodEXT( envMap, queryVec, float( maxMIPLevel ) );\n\t\t\t#else\n\t\t\t\tvec4 envMapColor = textureCube( envMap, queryVec, float( maxMIPLevel ) );\n\t\t\t#endif\n\t\t\tenvMapColor.rgb = envMapTexelToLinear( envMapColor ).rgb;\n\t\t#elif defined( ENVMAP_TYPE_CUBE_UV )\n\t\t\tvec3 queryVec = vec3( flipEnvMap * worldNormal.x, worldNormal.yz );\n\t\t\tvec4 envMapColor = textureCubeUV( envMap, queryVec, 1.0 );\n\t\t#else\n\t\t\tvec4 envMapColor = vec4( 0.0 );\n\t\t#endif\n\t\treturn PI * envMapColor.rgb * envMapIntensity;\n\t}\n\tfloat getSpecularMIPLevel( const in float roughness, const in int maxMIPLevel ) {\n\t\tfloat maxMIPLevelScalar = float( maxMIPLevel );\n\t\tfloat sigma = PI * roughness * roughness / ( 1.0 + roughness );\n\t\tfloat desiredMIPLevel = maxMIPLevelScalar + log2( sigma );\n\t\treturn clamp( desiredMIPLevel, 0.0, maxMIPLevelScalar );\n\t}\n\tvec3 getLightProbeIndirectRadiance( const in vec3 viewDir, const in vec3 normal, const in float roughness, const in int maxMIPLevel ) {\n\t\t#ifdef ENVMAP_MODE_REFLECTION\n\t\t  vec3 reflectVec = reflect( -viewDir, normal );\n\t\t  reflectVec = normalize( mix( reflectVec, normal, roughness * roughness) );\n\t\t#else\n\t\t  vec3 reflectVec = refract( -viewDir, normal, refractionRatio );\n\t\t#endif\n\t\treflectVec = inverseTransformDirection( reflectVec, viewMatrix );\n\t\tfloat specularMIPLevel = getSpecularMIPLevel( roughness, maxMIPLevel );\n\t\t#ifdef ENVMAP_TYPE_CUBE\n\t\t\tvec3 queryReflectVec = vec3( flipEnvMap * reflectVec.x, reflectVec.yz );\n\t\t\t#ifdef TEXTURE_LOD_EXT\n\t\t\t\tvec4 envMapColor = textureCubeLodEXT( envMap, queryReflectVec, specularMIPLevel );\n\t\t\t#else\n\t\t\t\tvec4 envMapColor = textureCube( envMap, queryReflectVec, specularMIPLevel );\n\t\t\t#endif\n\t\t\tenvMapColor.rgb = envMapTexelToLinear( envMapColor ).rgb;\n\t\t#elif defined( ENVMAP_TYPE_CUBE_UV )\n\t\t\tvec3 queryReflectVec = vec3( flipEnvMap * reflectVec.x, reflectVec.yz );\n\t\t\tvec4 envMapColor = textureCubeUV( envMap, queryReflectVec, roughness );\n\t\t#elif defined( ENVMAP_TYPE_EQUIREC )\n\t\t\tvec2 sampleUV;\n\t\t\tsampleUV.y = asin( clamp( reflectVec.y, - 1.0, 1.0 ) ) * RECIPROCAL_PI + 0.5;\n\t\t\tsampleUV.x = atan( reflectVec.z, reflectVec.x ) * RECIPROCAL_PI2 + 0.5;\n\t\t\t#ifdef TEXTURE_LOD_EXT\n\t\t\t\tvec4 envMapColor = texture2DLodEXT( envMap, sampleUV, specularMIPLevel );\n\t\t\t#else\n\t\t\t\tvec4 envMapColor = texture2D( envMap, sampleUV, specularMIPLevel );\n\t\t\t#endif\n\t\t\tenvMapColor.rgb = envMapTexelToLinear( envMapColor ).rgb;\n\t\t#elif defined( ENVMAP_TYPE_SPHERE )\n\t\t\tvec3 reflectView = normalize( ( viewMatrix * vec4( reflectVec, 0.0 ) ).xyz + vec3( 0.0,0.0,1.0 ) );\n\t\t\t#ifdef TEXTURE_LOD_EXT\n\t\t\t\tvec4 envMapColor = texture2DLodEXT( envMap, reflectView.xy * 0.5 + 0.5, specularMIPLevel );\n\t\t\t#else\n\t\t\t\tvec4 envMapColor = texture2D( envMap, reflectView.xy * 0.5 + 0.5, specularMIPLevel );\n\t\t\t#endif\n\t\t\tenvMapColor.rgb = envMapTexelToLinear( envMapColor ).rgb;\n\t\t#endif\n\t\treturn envMapColor.rgb * envMapIntensity;\n\t}\n#endif";var Va="BlinnPhongMaterial material;\nmaterial.diffuseColor = diffuseColor.rgb;\nmaterial.specularColor = specular;\nmaterial.specularShininess = shininess;\nmaterial.specularStrength = specularStrength;";var Wa="varying vec3 vViewPosition;\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n#endif\nstruct BlinnPhongMaterial {\n\tvec3\tdiffuseColor;\n\tvec3\tspecularColor;\n\tfloat\tspecularShininess;\n\tfloat\tspecularStrength;\n};\nvoid RE_Direct_BlinnPhong( const in IncidentLight directLight, const in GeometricContext geometry, const in BlinnPhongMaterial material, inout ReflectedLight reflectedLight ) {\n\t#ifdef TOON\n\t\tvec3 irradiance = getGradientIrradiance( geometry.normal, directLight.direction ) * directLight.color;\n\t#else\n\t\tfloat dotNL = saturate( dot( geometry.normal, directLight.direction ) );\n\t\tvec3 irradiance = dotNL * directLight.color;\n\t#endif\n\t#ifndef PHYSICALLY_CORRECT_LIGHTS\n\t\tirradiance *= PI;\n\t#endif\n\treflectedLight.directDiffuse += irradiance * BRDF_Diffuse_Lambert( material.diffuseColor );\n\treflectedLight.directSpecular += irradiance * BRDF_Specular_BlinnPhong( directLight, geometry, material.specularColor, material.specularShininess ) * material.specularStrength;\n}\nvoid RE_IndirectDiffuse_BlinnPhong( const in vec3 irradiance, const in GeometricContext geometry, const in BlinnPhongMaterial material, inout ReflectedLight reflectedLight ) {\n\treflectedLight.indirectDiffuse += irradiance * BRDF_Diffuse_Lambert( material.diffuseColor );\n}\n#define RE_Direct\t\t\t\tRE_Direct_BlinnPhong\n#define RE_IndirectDiffuse\t\tRE_IndirectDiffuse_BlinnPhong\n#define Material_LightProbeLOD( material )\t(0)";var qa="PhysicalMaterial material;\nmaterial.diffuseColor = diffuseColor.rgb * ( 1.0 - metalnessFactor );\nmaterial.specularRoughness = clamp( roughnessFactor, 0.04, 1.0 );\n#ifdef REFLECTIVITY\n\tmaterial.specularColor = mix( vec3( MAXIMUM_SPECULAR_COEFFICIENT * pow2( reflectivity ) ), diffuseColor.rgb, metalnessFactor );\n#else\n\tmaterial.specularColor = mix( vec3( DEFAULT_SPECULAR_COEFFICIENT ), diffuseColor.rgb, metalnessFactor );\n#endif\n#ifdef CLEARCOAT\n\tmaterial.clearcoat = saturate( clearcoat );\tmaterial.clearcoatRoughness = clamp( clearcoatRoughness, 0.04, 1.0 );\n#endif\n#ifdef USE_SHEEN\n\tmaterial.sheenColor = sheen;\n#endif";var Xa="struct PhysicalMaterial {\n\tvec3\tdiffuseColor;\n\tfloat\tspecularRoughness;\n\tvec3\tspecularColor;\n#ifdef CLEARCOAT\n\tfloat clearcoat;\n\tfloat clearcoatRoughness;\n#endif\n#ifdef USE_SHEEN\n\tvec3 sheenColor;\n#endif\n};\n#define MAXIMUM_SPECULAR_COEFFICIENT 0.16\n#define DEFAULT_SPECULAR_COEFFICIENT 0.04\nfloat clearcoatDHRApprox( const in float roughness, const in float dotNL ) {\n\treturn DEFAULT_SPECULAR_COEFFICIENT + ( 1.0 - DEFAULT_SPECULAR_COEFFICIENT ) * ( pow( 1.0 - dotNL, 5.0 ) * pow( 1.0 - roughness, 2.0 ) );\n}\n#if NUM_RECT_AREA_LIGHTS > 0\n\tvoid RE_Direct_RectArea_Physical( const in RectAreaLight rectAreaLight, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {\n\t\tvec3 normal = geometry.normal;\n\t\tvec3 viewDir = geometry.viewDir;\n\t\tvec3 position = geometry.position;\n\t\tvec3 lightPos = rectAreaLight.position;\n\t\tvec3 halfWidth = rectAreaLight.halfWidth;\n\t\tvec3 halfHeight = rectAreaLight.halfHeight;\n\t\tvec3 lightColor = rectAreaLight.color;\n\t\tfloat roughness = material.specularRoughness;\n\t\tvec3 rectCoords[ 4 ];\n\t\trectCoords[ 0 ] = lightPos + halfWidth - halfHeight;\t\trectCoords[ 1 ] = lightPos - halfWidth - halfHeight;\n\t\trectCoords[ 2 ] = lightPos - halfWidth + halfHeight;\n\t\trectCoords[ 3 ] = lightPos + halfWidth + halfHeight;\n\t\tvec2 uv = LTC_Uv( normal, viewDir, roughness );\n\t\tvec4 t1 = texture2D( ltc_1, uv );\n\t\tvec4 t2 = texture2D( ltc_2, uv );\n\t\tmat3 mInv = mat3(\n\t\t\tvec3( t1.x, 0, t1.y ),\n\t\t\tvec3(    0, 1,    0 ),\n\t\t\tvec3( t1.z, 0, t1.w )\n\t\t);\n\t\tvec3 fresnel = ( material.specularColor * t2.x + ( vec3( 1.0 ) - material.specularColor ) * t2.y );\n\t\treflectedLight.directSpecular += lightColor * fresnel * LTC_Evaluate( normal, viewDir, position, mInv, rectCoords );\n\t\treflectedLight.directDiffuse += lightColor * material.diffuseColor * LTC_Evaluate( normal, viewDir, position, mat3( 1.0 ), rectCoords );\n\t}\n#endif\nvoid RE_Direct_Physical( const in IncidentLight directLight, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {\n\tfloat dotNL = saturate( dot( geometry.normal, directLight.direction ) );\n\tvec3 irradiance = dotNL * directLight.color;\n\t#ifndef PHYSICALLY_CORRECT_LIGHTS\n\t\tirradiance *= PI;\n\t#endif\n\t#ifdef CLEARCOAT\n\t\tfloat ccDotNL = saturate( dot( geometry.clearcoatNormal, directLight.direction ) );\n\t\tvec3 ccIrradiance = ccDotNL * directLight.color;\n\t\t#ifndef PHYSICALLY_CORRECT_LIGHTS\n\t\t\tccIrradiance *= PI;\n\t\t#endif\n\t\tfloat clearcoatDHR = material.clearcoat * clearcoatDHRApprox( material.clearcoatRoughness, ccDotNL );\n\t\treflectedLight.directSpecular += ccIrradiance * material.clearcoat * BRDF_Specular_GGX( directLight, geometry.viewDir, geometry.clearcoatNormal, vec3( DEFAULT_SPECULAR_COEFFICIENT ), material.clearcoatRoughness );\n\t#else\n\t\tfloat clearcoatDHR = 0.0;\n\t#endif\n\t#ifdef USE_SHEEN\n\t\treflectedLight.directSpecular += ( 1.0 - clearcoatDHR ) * irradiance * BRDF_Specular_Sheen(\n\t\t\tmaterial.specularRoughness,\n\t\t\tdirectLight.direction,\n\t\t\tgeometry,\n\t\t\tmaterial.sheenColor\n\t\t);\n\t#else\n\t\treflectedLight.directSpecular += ( 1.0 - clearcoatDHR ) * irradiance * BRDF_Specular_GGX( directLight, geometry.viewDir, geometry.normal, material.specularColor, material.specularRoughness);\n\t#endif\n\treflectedLight.directDiffuse += ( 1.0 - clearcoatDHR ) * irradiance * BRDF_Diffuse_Lambert( material.diffuseColor );\n}\nvoid RE_IndirectDiffuse_Physical( const in vec3 irradiance, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {\n\treflectedLight.indirectDiffuse += irradiance * BRDF_Diffuse_Lambert( material.diffuseColor );\n}\nvoid RE_IndirectSpecular_Physical( const in vec3 radiance, const in vec3 irradiance, const in vec3 clearcoatRadiance, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight) {\n\t#ifdef CLEARCOAT\n\t\tfloat ccDotNV = saturate( dot( geometry.clearcoatNormal, geometry.viewDir ) );\n\t\treflectedLight.indirectSpecular += clearcoatRadiance * material.clearcoat * BRDF_Specular_GGX_Environment( geometry.viewDir, geometry.clearcoatNormal, vec3( DEFAULT_SPECULAR_COEFFICIENT ), material.clearcoatRoughness );\n\t\tfloat ccDotNL = ccDotNV;\n\t\tfloat clearcoatDHR = material.clearcoat * clearcoatDHRApprox( material.clearcoatRoughness, ccDotNL );\n\t#else\n\t\tfloat clearcoatDHR = 0.0;\n\t#endif\n\tfloat clearcoatInv = 1.0 - clearcoatDHR;\n\tvec3 singleScattering = vec3( 0.0 );\n\tvec3 multiScattering = vec3( 0.0 );\n\tvec3 cosineWeightedIrradiance = irradiance * RECIPROCAL_PI;\n\tBRDF_Specular_Multiscattering_Environment( geometry, material.specularColor, material.specularRoughness, singleScattering, multiScattering );\n\tvec3 diffuse = material.diffuseColor * ( 1.0 - ( singleScattering + multiScattering ) );\n\treflectedLight.indirectSpecular += clearcoatInv * radiance * singleScattering;\n\treflectedLight.indirectSpecular += multiScattering * cosineWeightedIrradiance;\n\treflectedLight.indirectDiffuse += diffuse * cosineWeightedIrradiance;\n}\n#define RE_Direct\t\t\t\tRE_Direct_Physical\n#define RE_Direct_RectArea\t\tRE_Direct_RectArea_Physical\n#define RE_IndirectDiffuse\t\tRE_IndirectDiffuse_Physical\n#define RE_IndirectSpecular\t\tRE_IndirectSpecular_Physical\nfloat computeSpecularOcclusion( const in float dotNV, const in float ambientOcclusion, const in float roughness ) {\n\treturn saturate( pow( dotNV + ambientOcclusion, exp2( - 16.0 * roughness - 1.0 ) ) - 1.0 + ambientOcclusion );\n}";var Ya="\nGeometricContext geometry;\ngeometry.position = - vViewPosition;\ngeometry.normal = normal;\ngeometry.viewDir = normalize( vViewPosition );\n#ifdef CLEARCOAT\n\tgeometry.clearcoatNormal = clearcoatNormal;\n#endif\nIncidentLight directLight;\n#if ( NUM_POINT_LIGHTS > 0 ) && defined( RE_Direct )\n\tPointLight pointLight;\n\t#pragma unroll_loop\n\tfor ( int i = 0; i < NUM_POINT_LIGHTS; i ++ ) {\n\t\tpointLight = pointLights[ i ];\n\t\tgetPointDirectLightIrradiance( pointLight, geometry, directLight );\n\t\t#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_POINT_LIGHT_SHADOWS )\n\t\tdirectLight.color *= all( bvec3( pointLight.shadow, directLight.visible, receiveShadow ) ) ? getPointShadow( pointShadowMap[ i ], pointLight.shadowMapSize, pointLight.shadowBias, pointLight.shadowRadius, vPointShadowCoord[ i ], pointLight.shadowCameraNear, pointLight.shadowCameraFar ) : 1.0;\n\t\t#endif\n\t\tRE_Direct( directLight, geometry, material, reflectedLight );\n\t}\n#endif\n#if ( NUM_SPOT_LIGHTS > 0 ) && defined( RE_Direct )\n\tSpotLight spotLight;\n\t#pragma unroll_loop\n\tfor ( int i = 0; i < NUM_SPOT_LIGHTS; i ++ ) {\n\t\tspotLight = spotLights[ i ];\n\t\tgetSpotDirectLightIrradiance( spotLight, geometry, directLight );\n\t\t#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS )\n\t\tdirectLight.color *= all( bvec3( spotLight.shadow, directLight.visible, receiveShadow ) ) ? getShadow( spotShadowMap[ i ], spotLight.shadowMapSize, spotLight.shadowBias, spotLight.shadowRadius, vSpotShadowCoord[ i ] ) : 1.0;\n\t\t#endif\n\t\tRE_Direct( directLight, geometry, material, reflectedLight );\n\t}\n#endif\n#if ( NUM_DIR_LIGHTS > 0 ) && defined( RE_Direct )\n\tDirectionalLight directionalLight;\n\t#pragma unroll_loop\n\tfor ( int i = 0; i < NUM_DIR_LIGHTS; i ++ ) {\n\t\tdirectionalLight = directionalLights[ i ];\n\t\tgetDirectionalDirectLightIrradiance( directionalLight, geometry, directLight );\n\t\t#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_DIR_LIGHT_SHADOWS )\n\t\tdirectLight.color *= all( bvec3( directionalLight.shadow, directLight.visible, receiveShadow ) ) ? getShadow( directionalShadowMap[ i ], directionalLight.shadowMapSize, directionalLight.shadowBias, directionalLight.shadowRadius, vDirectionalShadowCoord[ i ] ) : 1.0;\n\t\t#endif\n\t\tRE_Direct( directLight, geometry, material, reflectedLight );\n\t}\n#endif\n#if ( NUM_RECT_AREA_LIGHTS > 0 ) && defined( RE_Direct_RectArea )\n\tRectAreaLight rectAreaLight;\n\t#pragma unroll_loop\n\tfor ( int i = 0; i < NUM_RECT_AREA_LIGHTS; i ++ ) {\n\t\trectAreaLight = rectAreaLights[ i ];\n\t\tRE_Direct_RectArea( rectAreaLight, geometry, material, reflectedLight );\n\t}\n#endif\n#if defined( RE_IndirectDiffuse )\n\tvec3 iblIrradiance = vec3( 0.0 );\n\tvec3 irradiance = getAmbientLightIrradiance( ambientLightColor );\n\tirradiance += getLightProbeIrradiance( lightProbe, geometry );\n\t#if ( NUM_HEMI_LIGHTS > 0 )\n\t\t#pragma unroll_loop\n\t\tfor ( int i = 0; i < NUM_HEMI_LIGHTS; i ++ ) {\n\t\t\tirradiance += getHemisphereLightIrradiance( hemisphereLights[ i ], geometry );\n\t\t}\n\t#endif\n#endif\n#if defined( RE_IndirectSpecular )\n\tvec3 radiance = vec3( 0.0 );\n\tvec3 clearcoatRadiance = vec3( 0.0 );\n#endif";var Za="#if defined( RE_IndirectDiffuse )\n\t#ifdef USE_LIGHTMAP\n\t\tvec3 lightMapIrradiance = texture2D( lightMap, vUv2 ).xyz * lightMapIntensity;\n\t\t#ifndef PHYSICALLY_CORRECT_LIGHTS\n\t\t\tlightMapIrradiance *= PI;\n\t\t#endif\n\t\tirradiance += lightMapIrradiance;\n\t#endif\n\t#if defined( USE_ENVMAP ) && defined( STANDARD ) && defined( ENVMAP_TYPE_CUBE_UV )\n\t\tiblIrradiance += getLightProbeIndirectIrradiance( geometry, maxMipLevel );\n\t#endif\n#endif\n#if defined( USE_ENVMAP ) && defined( RE_IndirectSpecular )\n\tradiance += getLightProbeIndirectRadiance( geometry.viewDir, geometry.normal, material.specularRoughness, maxMipLevel );\n\t#ifdef CLEARCOAT\n\t\tclearcoatRadiance += getLightProbeIndirectRadiance( geometry.viewDir, geometry.clearcoatNormal, material.clearcoatRoughness, maxMipLevel );\n\t#endif\n#endif";var Ja="#if defined( RE_IndirectDiffuse )\n\tRE_IndirectDiffuse( irradiance, geometry, material, reflectedLight );\n#endif\n#if defined( RE_IndirectSpecular )\n\tRE_IndirectSpecular( radiance, iblIrradiance, clearcoatRadiance, geometry, material, reflectedLight );\n#endif";var Ka="#if defined( USE_LOGDEPTHBUF ) && defined( USE_LOGDEPTHBUF_EXT )\n\tgl_FragDepthEXT = vIsPerspective == 1.0 ? log2( vFragDepth ) * logDepthBufFC * 0.5 : gl_FragCoord.z;\n#endif";var Qa="#if defined( USE_LOGDEPTHBUF ) && defined( USE_LOGDEPTHBUF_EXT )\n\tuniform float logDepthBufFC;\n\tvarying float vFragDepth;\n\tvarying float vIsPerspective;\n#endif";var $a="#ifdef USE_LOGDEPTHBUF\n\t#ifdef USE_LOGDEPTHBUF_EXT\n\t\tvarying float vFragDepth;\n\t\tvarying float vIsPerspective;\n\t#else\n\t\tuniform float logDepthBufFC;\n\t#endif\n#endif";var eo="#ifdef USE_LOGDEPTHBUF\n\t#ifdef USE_LOGDEPTHBUF_EXT\n\t\tvFragDepth = 1.0 + gl_Position.w;\n\t\tvIsPerspective = float( isPerspectiveMatrix( projectionMatrix ) );\n\t#else\n\t\tif ( isPerspectiveMatrix( projectionMatrix ) ) {\n\t\t\tgl_Position.z = log2( max( EPSILON, gl_Position.w + 1.0 ) ) * logDepthBufFC - 1.0;\n\t\t\tgl_Position.z *= gl_Position.w;\n\t\t}\n\t#endif\n#endif";var to="#ifdef USE_MAP\n\tvec4 texelColor = texture2D( map, vUv );\n\ttexelColor = mapTexelToLinear( texelColor );\n\tdiffuseColor *= texelColor;\n#endif";var ro="#ifdef USE_MAP\n\tuniform sampler2D map;\n#endif";var no="#ifdef USE_MAP\n\tvec2 uv = ( uvTransform * vec3( gl_PointCoord.x, 1.0 - gl_PointCoord.y, 1 ) ).xy;\n\tvec4 mapTexel = texture2D( map, uv );\n\tdiffuseColor *= mapTexelToLinear( mapTexel );\n#endif";var io="#ifdef USE_MAP\n\tuniform mat3 uvTransform;\n\tuniform sampler2D map;\n#endif";var ao="float metalnessFactor = metalness;\n#ifdef USE_METALNESSMAP\n\tvec4 texelMetalness = texture2D( metalnessMap, vUv );\n\tmetalnessFactor *= texelMetalness.b;\n#endif";var oo="#ifdef USE_METALNESSMAP\n\tuniform sampler2D metalnessMap;\n#endif";var so="#ifdef USE_MORPHNORMALS\n\tobjectNormal += ( morphNormal0 - normal ) * morphTargetInfluences[ 0 ];\n\tobjectNormal += ( morphNormal1 - normal ) * morphTargetInfluences[ 1 ];\n\tobjectNormal += ( morphNormal2 - normal ) * morphTargetInfluences[ 2 ];\n\tobjectNormal += ( morphNormal3 - normal ) * morphTargetInfluences[ 3 ];\n#endif";var uo="#ifdef USE_MORPHTARGETS\n\t#ifndef USE_MORPHNORMALS\n\tuniform float morphTargetInfluences[ 8 ];\n\t#else\n\tuniform float morphTargetInfluences[ 4 ];\n\t#endif\n#endif";var lo="#ifdef USE_MORPHTARGETS\n\ttransformed += ( morphTarget0 - position ) * morphTargetInfluences[ 0 ];\n\ttransformed += ( morphTarget1 - position ) * morphTargetInfluences[ 1 ];\n\ttransformed += ( morphTarget2 - position ) * morphTargetInfluences[ 2 ];\n\ttransformed += ( morphTarget3 - position ) * morphTargetInfluences[ 3 ];\n\t#ifndef USE_MORPHNORMALS\n\ttransformed += ( morphTarget4 - position ) * morphTargetInfluences[ 4 ];\n\ttransformed += ( morphTarget5 - position ) * morphTargetInfluences[ 5 ];\n\ttransformed += ( morphTarget6 - position ) * morphTargetInfluences[ 6 ];\n\ttransformed += ( morphTarget7 - position ) * morphTargetInfluences[ 7 ];\n\t#endif\n#endif";var co="#ifdef FLAT_SHADED\n\tvec3 fdx = vec3( dFdx( vViewPosition.x ), dFdx( vViewPosition.y ), dFdx( vViewPosition.z ) );\n\tvec3 fdy = vec3( dFdy( vViewPosition.x ), dFdy( vViewPosition.y ), dFdy( vViewPosition.z ) );\n\tvec3 normal = normalize( cross( fdx, fdy ) );\n#else\n\tvec3 normal = normalize( vNormal );\n\t#ifdef DOUBLE_SIDED\n\t\tnormal = normal * ( float( gl_FrontFacing ) * 2.0 - 1.0 );\n\t#endif\n\t#ifdef USE_TANGENT\n\t\tvec3 tangent = normalize( vTangent );\n\t\tvec3 bitangent = normalize( vBitangent );\n\t\t#ifdef DOUBLE_SIDED\n\t\t\ttangent = tangent * ( float( gl_FrontFacing ) * 2.0 - 1.0 );\n\t\t\tbitangent = bitangent * ( float( gl_FrontFacing ) * 2.0 - 1.0 );\n\t\t#endif\n\t#endif\n#endif\nvec3 geometryNormal = normal;";var ho="#ifdef OBJECTSPACE_NORMALMAP\n\tnormal = texture2D( normalMap, vUv ).xyz * 2.0 - 1.0;\n\t#ifdef FLIP_SIDED\n\t\tnormal = - normal;\n\t#endif\n\t#ifdef DOUBLE_SIDED\n\t\tnormal = normal * ( float( gl_FrontFacing ) * 2.0 - 1.0 );\n\t#endif\n\tnormal = normalize( normalMatrix * normal );\n#elif defined( TANGENTSPACE_NORMALMAP )\n\t#ifdef USE_TANGENT\n\t\tmat3 vTBN = mat3( tangent, bitangent, normal );\n\t\tvec3 mapN = texture2D( normalMap, vUv ).xyz * 2.0 - 1.0;\n\t\tmapN.xy = normalScale * mapN.xy;\n\t\tnormal = normalize( vTBN * mapN );\n\t#else\n\t\tnormal = perturbNormal2Arb( -vViewPosition, normal, normalScale, normalMap );\n\t#endif\n#elif defined( USE_BUMPMAP )\n\tnormal = perturbNormalArb( -vViewPosition, normal, dHdxy_fwd() );\n#endif";var fo="#ifdef USE_NORMALMAP\n\tuniform sampler2D normalMap;\n\tuniform vec2 normalScale;\n#endif\n#ifdef OBJECTSPACE_NORMALMAP\n\tuniform mat3 normalMatrix;\n#endif\n#if ! defined ( USE_TANGENT ) && ( defined ( TANGENTSPACE_NORMALMAP ) || defined ( USE_CLEARCOAT_NORMALMAP ) )\n\tvec3 perturbNormal2Arb( vec3 eye_pos, vec3 surf_norm, vec2 normalScale, in sampler2D normalMap ) {\n\t\tvec3 q0 = vec3( dFdx( eye_pos.x ), dFdx( eye_pos.y ), dFdx( eye_pos.z ) );\n\t\tvec3 q1 = vec3( dFdy( eye_pos.x ), dFdy( eye_pos.y ), dFdy( eye_pos.z ) );\n\t\tvec2 st0 = dFdx( vUv.st );\n\t\tvec2 st1 = dFdy( vUv.st );\n\t\tfloat scale = sign( st1.t * st0.s - st0.t * st1.s );\n\t\tvec3 S = normalize( ( q0 * st1.t - q1 * st0.t ) * scale );\n\t\tvec3 T = normalize( ( - q0 * st1.s + q1 * st0.s ) * scale );\n\t\tvec3 N = normalize( surf_norm );\n\t\tvec3 mapN = texture2D( normalMap, vUv ).xyz * 2.0 - 1.0;\n\t\tmapN.xy *= normalScale;\n\t\t#ifdef DOUBLE_SIDED\n\t\t\tbool frontFacing = dot( cross( S, T ), N ) > 0.0;\n\t\t\tmapN.xy *= ( float( frontFacing ) * 2.0 - 1.0 );\n\t\t#else\n\t\t\tmapN.xy *= ( float( gl_FrontFacing ) * 2.0 - 1.0 );\n\t\t#endif\n\t\tmat3 tsn = mat3( S, T, N );\n\t\treturn normalize( tsn * mapN );\n\t}\n#endif";var po="#ifdef CLEARCOAT\n\tvec3 clearcoatNormal = geometryNormal;\n#endif";var vo="#ifdef USE_CLEARCOAT_NORMALMAP\n\t#ifdef USE_TANGENT\n\t\tmat3 vTBN = mat3( tangent, bitangent, clearcoatNormal );\n\t\tvec3 mapN = texture2D( normalMap, vUv ).xyz * 2.0 - 1.0;\n\t\tmapN.xy = clearcoatNormalScale * mapN.xy;\n\t\tclearcoatNormal = normalize( vTBN * mapN );\n\t#else\n\t\tclearcoatNormal = perturbNormal2Arb( - vViewPosition, clearcoatNormal, clearcoatNormalScale, clearcoatNormalMap );\n\t#endif\n#endif";var mo="#ifdef USE_CLEARCOAT_NORMALMAP\n\tuniform sampler2D clearcoatNormalMap;\n\tuniform vec2 clearcoatNormalScale;\n#endif";var go="vec3 packNormalToRGB( const in vec3 normal ) {\n\treturn normalize( normal ) * 0.5 + 0.5;\n}\nvec3 unpackRGBToNormal( const in vec3 rgb ) {\n\treturn 2.0 * rgb.xyz - 1.0;\n}\nconst float PackUpscale = 256. / 255.;const float UnpackDownscale = 255. / 256.;\nconst vec3 PackFactors = vec3( 256. * 256. * 256., 256. * 256.,  256. );\nconst vec4 UnpackFactors = UnpackDownscale / vec4( PackFactors, 1. );\nconst float ShiftRight8 = 1. / 256.;\nvec4 packDepthToRGBA( const in float v ) {\n\tvec4 r = vec4( fract( v * PackFactors ), v );\n\tr.yzw -= r.xyz * ShiftRight8;\treturn r * PackUpscale;\n}\nfloat unpackRGBAToDepth( const in vec4 v ) {\n\treturn dot( v, UnpackFactors );\n}\nvec4 encodeHalfRGBA ( vec2 v ) {\n\tvec4 encoded = vec4( 0.0 );\n\tconst vec2 offset = vec2( 1.0 / 255.0, 0.0 );\n\tencoded.xy = vec2( v.x, fract( v.x * 255.0 ) );\n\tencoded.xy = encoded.xy - ( encoded.yy * offset );\n\tencoded.zw = vec2( v.y, fract( v.y * 255.0 ) );\n\tencoded.zw = encoded.zw - ( encoded.ww * offset );\n\treturn encoded;\n}\nvec2 decodeHalfRGBA( vec4 v ) {\n\treturn vec2( v.x + ( v.y / 255.0 ), v.z + ( v.w / 255.0 ) );\n}\nfloat viewZToOrthographicDepth( const in float viewZ, const in float near, const in float far ) {\n\treturn ( viewZ + near ) / ( near - far );\n}\nfloat orthographicDepthToViewZ( const in float linearClipZ, const in float near, const in float far ) {\n\treturn linearClipZ * ( near - far ) - near;\n}\nfloat viewZToPerspectiveDepth( const in float viewZ, const in float near, const in float far ) {\n\treturn (( near + viewZ ) * far ) / (( far - near ) * viewZ );\n}\nfloat perspectiveDepthToViewZ( const in float invClipZ, const in float near, const in float far ) {\n\treturn ( near * far ) / ( ( far - near ) * invClipZ - far );\n}";var yo="#ifdef PREMULTIPLIED_ALPHA\n\tgl_FragColor.rgb *= gl_FragColor.a;\n#endif";var xo="vec4 mvPosition = vec4( transformed, 1.0 );\n#ifdef USE_INSTANCING\n\tmvPosition = instanceMatrix * mvPosition;\n#endif\nmvPosition = modelViewMatrix * mvPosition;\ngl_Position = projectionMatrix * mvPosition;";var bo="#ifdef DITHERING\n\tgl_FragColor.rgb = dithering( gl_FragColor.rgb );\n#endif";var wo="#ifdef DITHERING\n\tvec3 dithering( vec3 color ) {\n\t\tfloat grid_position = rand( gl_FragCoord.xy );\n\t\tvec3 dither_shift_RGB = vec3( 0.25 / 255.0, -0.25 / 255.0, 0.25 / 255.0 );\n\t\tdither_shift_RGB = mix( 2.0 * dither_shift_RGB, -2.0 * dither_shift_RGB, grid_position );\n\t\treturn color + dither_shift_RGB;\n\t}\n#endif";var _o="float roughnessFactor = roughness;\n#ifdef USE_ROUGHNESSMAP\n\tvec4 texelRoughness = texture2D( roughnessMap, vUv );\n\troughnessFactor *= texelRoughness.g;\n#endif";var To="#ifdef USE_ROUGHNESSMAP\n\tuniform sampler2D roughnessMap;\n#endif";var Eo="#ifdef USE_SHADOWMAP\n\t#if NUM_DIR_LIGHT_SHADOWS > 0\n\t\tuniform sampler2D directionalShadowMap[ NUM_DIR_LIGHT_SHADOWS ];\n\t\tvarying vec4 vDirectionalShadowCoord[ NUM_DIR_LIGHT_SHADOWS ];\n\t#endif\n\t#if NUM_SPOT_LIGHT_SHADOWS > 0\n\t\tuniform sampler2D spotShadowMap[ NUM_SPOT_LIGHT_SHADOWS ];\n\t\tvarying vec4 vSpotShadowCoord[ NUM_SPOT_LIGHT_SHADOWS ];\n\t#endif\n\t#if NUM_POINT_LIGHT_SHADOWS > 0\n\t\tuniform sampler2D pointShadowMap[ NUM_POINT_LIGHT_SHADOWS ];\n\t\tvarying vec4 vPointShadowCoord[ NUM_POINT_LIGHT_SHADOWS ];\n\t#endif\n\tfloat texture2DCompare( sampler2D depths, vec2 uv, float compare ) {\n\t\treturn step( compare, unpackRGBAToDepth( texture2D( depths, uv ) ) );\n\t}\n\tvec2 texture2DDistribution( sampler2D shadow, vec2 uv ) {\n\t\treturn decodeHalfRGBA( texture2D( shadow, uv ) );\n\t}\n\tfloat VSMShadow (sampler2D shadow, vec2 uv, float compare ){\n\t\tfloat occlusion = 1.0;\n\t\tvec2 distribution = texture2DDistribution( shadow, uv );\n\t\tfloat hard_shadow = step( compare , distribution.x );\n\t\tif (hard_shadow != 1.0 ) {\n\t\t\tfloat distance = compare - distribution.x ;\n\t\t\tfloat variance = max( 0.00000, distribution.y * distribution.y );\n\t\t\tfloat softness_probability = variance / (variance + distance * distance );\t\t\tsoftness_probability = clamp( ( softness_probability - 0.3 ) / ( 0.95 - 0.3 ), 0.0, 1.0 );\t\t\tocclusion = clamp( max( hard_shadow, softness_probability ), 0.0, 1.0 );\n\t\t}\n\t\treturn occlusion;\n\t}\n\tfloat texture2DShadowLerp( sampler2D depths, vec2 size, vec2 uv, float compare ) {\n\t\tconst vec2 offset = vec2( 0.0, 1.0 );\n\t\tvec2 texelSize = vec2( 1.0 ) / size;\n\t\tvec2 centroidUV = ( floor( uv * size - 0.5 ) + 0.5 ) * texelSize;\n\t\tfloat lb = texture2DCompare( depths, centroidUV + texelSize * offset.xx, compare );\n\t\tfloat lt = texture2DCompare( depths, centroidUV + texelSize * offset.xy, compare );\n\t\tfloat rb = texture2DCompare( depths, centroidUV + texelSize * offset.yx, compare );\n\t\tfloat rt = texture2DCompare( depths, centroidUV + texelSize * offset.yy, compare );\n\t\tvec2 f = fract( uv * size + 0.5 );\n\t\tfloat a = mix( lb, lt, f.y );\n\t\tfloat b = mix( rb, rt, f.y );\n\t\tfloat c = mix( a, b, f.x );\n\t\treturn c;\n\t}\n\tfloat getShadow( sampler2D shadowMap, vec2 shadowMapSize, float shadowBias, float shadowRadius, vec4 shadowCoord ) {\n\t\tfloat shadow = 1.0;\n\t\tshadowCoord.xyz /= shadowCoord.w;\n\t\tshadowCoord.z += shadowBias;\n\t\tbvec4 inFrustumVec = bvec4 ( shadowCoord.x >= 0.0, shadowCoord.x <= 1.0, shadowCoord.y >= 0.0, shadowCoord.y <= 1.0 );\n\t\tbool inFrustum = all( inFrustumVec );\n\t\tbvec2 frustumTestVec = bvec2( inFrustum, shadowCoord.z <= 1.0 );\n\t\tbool frustumTest = all( frustumTestVec );\n\t\tif ( frustumTest ) {\n\t\t#if defined( SHADOWMAP_TYPE_PCF )\n\t\t\tvec2 texelSize = vec2( 1.0 ) / shadowMapSize;\n\t\t\tfloat dx0 = - texelSize.x * shadowRadius;\n\t\t\tfloat dy0 = - texelSize.y * shadowRadius;\n\t\t\tfloat dx1 = + texelSize.x * shadowRadius;\n\t\t\tfloat dy1 = + texelSize.y * shadowRadius;\n\t\t\tfloat dx2 = dx0 / 2.0;\n\t\t\tfloat dy2 = dy0 / 2.0;\n\t\t\tfloat dx3 = dx1 / 2.0;\n\t\t\tfloat dy3 = dy1 / 2.0;\n\t\t\tshadow = (\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, dy0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, dy0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, dy2 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy2 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, dy2 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy, shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, dy3 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy3 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, dy3 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, dy1 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy1 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, dy1 ), shadowCoord.z )\n\t\t\t) * ( 1.0 / 17.0 );\n\t\t#elif defined( SHADOWMAP_TYPE_PCF_SOFT )\n\t\t\tvec2 texelSize = vec2( 1.0 ) / shadowMapSize;\n\t\t\tfloat dx0 = - texelSize.x * shadowRadius;\n\t\t\tfloat dy0 = - texelSize.y * shadowRadius;\n\t\t\tfloat dx1 = + texelSize.x * shadowRadius;\n\t\t\tfloat dy1 = + texelSize.y * shadowRadius;\n\t\t\tshadow = (\n\t\t\t\ttexture2DShadowLerp( shadowMap, shadowMapSize, shadowCoord.xy + vec2( dx0, dy0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DShadowLerp( shadowMap, shadowMapSize, shadowCoord.xy + vec2( 0.0, dy0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DShadowLerp( shadowMap, shadowMapSize, shadowCoord.xy + vec2( dx1, dy0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DShadowLerp( shadowMap, shadowMapSize, shadowCoord.xy + vec2( dx0, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DShadowLerp( shadowMap, shadowMapSize, shadowCoord.xy, shadowCoord.z ) +\n\t\t\t\ttexture2DShadowLerp( shadowMap, shadowMapSize, shadowCoord.xy + vec2( dx1, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DShadowLerp( shadowMap, shadowMapSize, shadowCoord.xy + vec2( dx0, dy1 ), shadowCoord.z ) +\n\t\t\t\ttexture2DShadowLerp( shadowMap, shadowMapSize, shadowCoord.xy + vec2( 0.0, dy1 ), shadowCoord.z ) +\n\t\t\t\ttexture2DShadowLerp( shadowMap, shadowMapSize, shadowCoord.xy + vec2( dx1, dy1 ), shadowCoord.z )\n\t\t\t) * ( 1.0 / 9.0 );\n\t\t#elif defined( SHADOWMAP_TYPE_VSM )\n\t\t\tshadow = VSMShadow( shadowMap, shadowCoord.xy, shadowCoord.z );\n\t\t#else\n\t\t\tshadow = texture2DCompare( shadowMap, shadowCoord.xy, shadowCoord.z );\n\t\t#endif\n\t\t}\n\t\treturn shadow;\n\t}\n\tvec2 cubeToUV( vec3 v, float texelSizeY ) {\n\t\tvec3 absV = abs( v );\n\t\tfloat scaleToCube = 1.0 / max( absV.x, max( absV.y, absV.z ) );\n\t\tabsV *= scaleToCube;\n\t\tv *= scaleToCube * ( 1.0 - 2.0 * texelSizeY );\n\t\tvec2 planar = v.xy;\n\t\tfloat almostATexel = 1.5 * texelSizeY;\n\t\tfloat almostOne = 1.0 - almostATexel;\n\t\tif ( absV.z >= almostOne ) {\n\t\t\tif ( v.z > 0.0 )\n\t\t\t\tplanar.x = 4.0 - v.x;\n\t\t} else if ( absV.x >= almostOne ) {\n\t\t\tfloat signX = sign( v.x );\n\t\t\tplanar.x = v.z * signX + 2.0 * signX;\n\t\t} else if ( absV.y >= almostOne ) {\n\t\t\tfloat signY = sign( v.y );\n\t\t\tplanar.x = v.x + 2.0 * signY + 2.0;\n\t\t\tplanar.y = v.z * signY - 2.0;\n\t\t}\n\t\treturn vec2( 0.125, 0.25 ) * planar + vec2( 0.375, 0.75 );\n\t}\n\tfloat getPointShadow( sampler2D shadowMap, vec2 shadowMapSize, float shadowBias, float shadowRadius, vec4 shadowCoord, float shadowCameraNear, float shadowCameraFar ) {\n\t\tvec2 texelSize = vec2( 1.0 ) / ( shadowMapSize * vec2( 4.0, 2.0 ) );\n\t\tvec3 lightToPosition = shadowCoord.xyz;\n\t\tfloat dp = ( length( lightToPosition ) - shadowCameraNear ) / ( shadowCameraFar - shadowCameraNear );\t\tdp += shadowBias;\n\t\tvec3 bd3D = normalize( lightToPosition );\n\t\t#if defined( SHADOWMAP_TYPE_PCF ) || defined( SHADOWMAP_TYPE_PCF_SOFT ) || defined( SHADOWMAP_TYPE_VSM )\n\t\t\tvec2 offset = vec2( - 1, 1 ) * shadowRadius * texelSize.y;\n\t\t\treturn (\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.xyy, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.yyy, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.xyx, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.yyx, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.xxy, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.yxy, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.xxx, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.yxx, texelSize.y ), dp )\n\t\t\t) * ( 1.0 / 9.0 );\n\t\t#else\n\t\t\treturn texture2DCompare( shadowMap, cubeToUV( bd3D, texelSize.y ), dp );\n\t\t#endif\n\t}\n#endif";var Mo="#ifdef USE_SHADOWMAP\n\t#if NUM_DIR_LIGHT_SHADOWS > 0\n\t\tuniform mat4 directionalShadowMatrix[ NUM_DIR_LIGHT_SHADOWS ];\n\t\tvarying vec4 vDirectionalShadowCoord[ NUM_DIR_LIGHT_SHADOWS ];\n\t#endif\n\t#if NUM_SPOT_LIGHT_SHADOWS > 0\n\t\tuniform mat4 spotShadowMatrix[ NUM_SPOT_LIGHT_SHADOWS ];\n\t\tvarying vec4 vSpotShadowCoord[ NUM_SPOT_LIGHT_SHADOWS ];\n\t#endif\n\t#if NUM_POINT_LIGHT_SHADOWS > 0\n\t\tuniform mat4 pointShadowMatrix[ NUM_POINT_LIGHT_SHADOWS ];\n\t\tvarying vec4 vPointShadowCoord[ NUM_POINT_LIGHT_SHADOWS ];\n\t#endif\n#endif";var So="#ifdef USE_SHADOWMAP\n\t#if NUM_DIR_LIGHT_SHADOWS > 0\n\t#pragma unroll_loop\n\tfor ( int i = 0; i < NUM_DIR_LIGHT_SHADOWS; i ++ ) {\n\t\tvDirectionalShadowCoord[ i ] = directionalShadowMatrix[ i ] * worldPosition;\n\t}\n\t#endif\n\t#if NUM_SPOT_LIGHT_SHADOWS > 0\n\t#pragma unroll_loop\n\tfor ( int i = 0; i < NUM_SPOT_LIGHT_SHADOWS; i ++ ) {\n\t\tvSpotShadowCoord[ i ] = spotShadowMatrix[ i ] * worldPosition;\n\t}\n\t#endif\n\t#if NUM_POINT_LIGHT_SHADOWS > 0\n\t#pragma unroll_loop\n\tfor ( int i = 0; i < NUM_POINT_LIGHT_SHADOWS; i ++ ) {\n\t\tvPointShadowCoord[ i ] = pointShadowMatrix[ i ] * worldPosition;\n\t}\n\t#endif\n#endif";var Ao="float getShadowMask() {\n\tfloat shadow = 1.0;\n\t#ifdef USE_SHADOWMAP\n\t#if NUM_DIR_LIGHT_SHADOWS > 0\n\tDirectionalLight directionalLight;\n\t#pragma unroll_loop\n\tfor ( int i = 0; i < NUM_DIR_LIGHT_SHADOWS; i ++ ) {\n\t\tdirectionalLight = directionalLights[ i ];\n\t\tshadow *= all( bvec2( directionalLight.shadow, receiveShadow ) ) ? getShadow( directionalShadowMap[ i ], directionalLight.shadowMapSize, directionalLight.shadowBias, directionalLight.shadowRadius, vDirectionalShadowCoord[ i ] ) : 1.0;\n\t}\n\t#endif\n\t#if NUM_SPOT_LIGHT_SHADOWS > 0\n\tSpotLight spotLight;\n\t#pragma unroll_loop\n\tfor ( int i = 0; i < NUM_SPOT_LIGHT_SHADOWS; i ++ ) {\n\t\tspotLight = spotLights[ i ];\n\t\tshadow *= all( bvec2( spotLight.shadow, receiveShadow ) ) ? getShadow( spotShadowMap[ i ], spotLight.shadowMapSize, spotLight.shadowBias, spotLight.shadowRadius, vSpotShadowCoord[ i ] ) : 1.0;\n\t}\n\t#endif\n\t#if NUM_POINT_LIGHT_SHADOWS > 0\n\tPointLight pointLight;\n\t#pragma unroll_loop\n\tfor ( int i = 0; i < NUM_POINT_LIGHT_SHADOWS; i ++ ) {\n\t\tpointLight = pointLights[ i ];\n\t\tshadow *= all( bvec2( pointLight.shadow, receiveShadow ) ) ? getPointShadow( pointShadowMap[ i ], pointLight.shadowMapSize, pointLight.shadowBias, pointLight.shadowRadius, vPointShadowCoord[ i ], pointLight.shadowCameraNear, pointLight.shadowCameraFar ) : 1.0;\n\t}\n\t#endif\n\t#endif\n\treturn shadow;\n}";var Ro="#ifdef USE_SKINNING\n\tmat4 boneMatX = getBoneMatrix( skinIndex.x );\n\tmat4 boneMatY = getBoneMatrix( skinIndex.y );\n\tmat4 boneMatZ = getBoneMatrix( skinIndex.z );\n\tmat4 boneMatW = getBoneMatrix( skinIndex.w );\n#endif";var Po="#ifdef USE_SKINNING\n\tuniform mat4 bindMatrix;\n\tuniform mat4 bindMatrixInverse;\n\t#ifdef BONE_TEXTURE\n\t\tuniform highp sampler2D boneTexture;\n\t\tuniform int boneTextureSize;\n\t\tmat4 getBoneMatrix( const in float i ) {\n\t\t\tfloat j = i * 4.0;\n\t\t\tfloat x = mod( j, float( boneTextureSize ) );\n\t\t\tfloat y = floor( j / float( boneTextureSize ) );\n\t\t\tfloat dx = 1.0 / float( boneTextureSize );\n\t\t\tfloat dy = 1.0 / float( boneTextureSize );\n\t\t\ty = dy * ( y + 0.5 );\n\t\t\tvec4 v1 = texture2D( boneTexture, vec2( dx * ( x + 0.5 ), y ) );\n\t\t\tvec4 v2 = texture2D( boneTexture, vec2( dx * ( x + 1.5 ), y ) );\n\t\t\tvec4 v3 = texture2D( boneTexture, vec2( dx * ( x + 2.5 ), y ) );\n\t\t\tvec4 v4 = texture2D( boneTexture, vec2( dx * ( x + 3.5 ), y ) );\n\t\t\tmat4 bone = mat4( v1, v2, v3, v4 );\n\t\t\treturn bone;\n\t\t}\n\t#else\n\t\tuniform mat4 boneMatrices[ MAX_BONES ];\n\t\tmat4 getBoneMatrix( const in float i ) {\n\t\t\tmat4 bone = boneMatrices[ int(i) ];\n\t\t\treturn bone;\n\t\t}\n\t#endif\n#endif";var Co="#ifdef USE_SKINNING\n\tvec4 skinVertex = bindMatrix * vec4( transformed, 1.0 );\n\tvec4 skinned = vec4( 0.0 );\n\tskinned += boneMatX * skinVertex * skinWeight.x;\n\tskinned += boneMatY * skinVertex * skinWeight.y;\n\tskinned += boneMatZ * skinVertex * skinWeight.z;\n\tskinned += boneMatW * skinVertex * skinWeight.w;\n\ttransformed = ( bindMatrixInverse * skinned ).xyz;\n#endif";var Oo="#ifdef USE_SKINNING\n\tmat4 skinMatrix = mat4( 0.0 );\n\tskinMatrix += skinWeight.x * boneMatX;\n\tskinMatrix += skinWeight.y * boneMatY;\n\tskinMatrix += skinWeight.z * boneMatZ;\n\tskinMatrix += skinWeight.w * boneMatW;\n\tskinMatrix  = bindMatrixInverse * skinMatrix * bindMatrix;\n\tobjectNormal = vec4( skinMatrix * vec4( objectNormal, 0.0 ) ).xyz;\n\t#ifdef USE_TANGENT\n\t\tobjectTangent = vec4( skinMatrix * vec4( objectTangent, 0.0 ) ).xyz;\n\t#endif\n#endif";var Lo="float specularStrength;\n#ifdef USE_SPECULARMAP\n\tvec4 texelSpecular = texture2D( specularMap, vUv );\n\tspecularStrength = texelSpecular.r;\n#else\n\tspecularStrength = 1.0;\n#endif";var Io="#ifdef USE_SPECULARMAP\n\tuniform sampler2D specularMap;\n#endif";var Do="#if defined( TONE_MAPPING )\n\tgl_FragColor.rgb = toneMapping( gl_FragColor.rgb );\n#endif";var No="#ifndef saturate\n#define saturate(a) clamp( a, 0.0, 1.0 )\n#endif\nuniform float toneMappingExposure;\nuniform float toneMappingWhitePoint;\nvec3 LinearToneMapping( vec3 color ) {\n\treturn toneMappingExposure * color;\n}\nvec3 ReinhardToneMapping( vec3 color ) {\n\tcolor *= toneMappingExposure;\n\treturn saturate( color / ( vec3( 1.0 ) + color ) );\n}\n#define Uncharted2Helper( x ) max( ( ( x * ( 0.15 * x + 0.10 * 0.50 ) + 0.20 * 0.02 ) / ( x * ( 0.15 * x + 0.50 ) + 0.20 * 0.30 ) ) - 0.02 / 0.30, vec3( 0.0 ) )\nvec3 Uncharted2ToneMapping( vec3 color ) {\n\tcolor *= toneMappingExposure;\n\treturn saturate( Uncharted2Helper( color ) / Uncharted2Helper( vec3( toneMappingWhitePoint ) ) );\n}\nvec3 OptimizedCineonToneMapping( vec3 color ) {\n\tcolor *= toneMappingExposure;\n\tcolor = max( vec3( 0.0 ), color - 0.004 );\n\treturn pow( ( color * ( 6.2 * color + 0.5 ) ) / ( color * ( 6.2 * color + 1.7 ) + 0.06 ), vec3( 2.2 ) );\n}\nvec3 ACESFilmicToneMapping( vec3 color ) {\n\tcolor *= toneMappingExposure;\n\treturn saturate( ( color * ( 2.51 * color + 0.03 ) ) / ( color * ( 2.43 * color + 0.59 ) + 0.14 ) );\n}";var Fo="#ifdef USE_UV\n\tvarying vec2 vUv;\n#endif";var Bo="#ifdef USE_UV\n\tvarying vec2 vUv;\n\tuniform mat3 uvTransform;\n#endif";var Uo="#ifdef USE_UV\n\tvUv = ( uvTransform * vec3( uv, 1 ) ).xy;\n#endif";var ko="#if defined( USE_LIGHTMAP ) || defined( USE_AOMAP )\n\tvarying vec2 vUv2;\n#endif";var jo="#if defined( USE_LIGHTMAP ) || defined( USE_AOMAP )\n\tattribute vec2 uv2;\n\tvarying vec2 vUv2;\n#endif";var zo="#if defined( USE_LIGHTMAP ) || defined( USE_AOMAP )\n\tvUv2 = uv2;\n#endif";var Ho="#if defined( USE_ENVMAP ) || defined( DISTANCE ) || defined ( USE_SHADOWMAP )\n\tvec4 worldPosition = vec4( transformed, 1.0 );\n\t#ifdef USE_INSTANCING\n\t\tworldPosition = instanceMatrix * worldPosition;\n\t#endif\n\tworldPosition = modelMatrix * worldPosition;\n#endif";var Go="uniform sampler2D t2D;\nvarying vec2 vUv;\nvoid main() {\n\tvec4 texColor = texture2D( t2D, vUv );\n\tgl_FragColor = mapTexelToLinear( texColor );\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n}";var Vo="varying vec2 vUv;\nuniform mat3 uvTransform;\nvoid main() {\n\tvUv = ( uvTransform * vec3( uv, 1 ) ).xy;\n\tgl_Position = vec4( position.xy, 1.0, 1.0 );\n}";var Wo="uniform samplerCube tCube;\nuniform float tFlip;\nuniform float opacity;\nvarying vec3 vWorldDirection;\nvoid main() {\n\tvec4 texColor = textureCube( tCube, vec3( tFlip * vWorldDirection.x, vWorldDirection.yz ) );\n\tgl_FragColor = mapTexelToLinear( texColor );\n\tgl_FragColor.a *= opacity;\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n}";var qo="varying vec3 vWorldDirection;\n#include <common>\nvoid main() {\n\tvWorldDirection = transformDirection( position, modelMatrix );\n\t#include <begin_vertex>\n\t#include <project_vertex>\n\tgl_Position.z = gl_Position.w;\n}";var Xo="#if DEPTH_PACKING == 3200\n\tuniform float opacity;\n#endif\n#include <common>\n#include <packing>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( 1.0 );\n\t#if DEPTH_PACKING == 3200\n\t\tdiffuseColor.a = opacity;\n\t#endif\n\t#include <map_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <logdepthbuf_fragment>\n\t#if DEPTH_PACKING == 3200\n\t\tgl_FragColor = vec4( vec3( 1.0 - gl_FragCoord.z ), opacity );\n\t#elif DEPTH_PACKING == 3201\n\t\tgl_FragColor = packDepthToRGBA( gl_FragCoord.z );\n\t#endif\n}";var Yo="#include <common>\n#include <uv_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <skinbase_vertex>\n\t#ifdef USE_DISPLACEMENTMAP\n\t\t#include <beginnormal_vertex>\n\t\t#include <morphnormal_vertex>\n\t\t#include <skinnormal_vertex>\n\t#endif\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n}";var Zo="#define DISTANCE\nuniform vec3 referencePosition;\nuniform float nearDistance;\nuniform float farDistance;\nvarying vec3 vWorldPosition;\n#include <common>\n#include <packing>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main () {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( 1.0 );\n\t#include <map_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\tfloat dist = length( vWorldPosition - referencePosition );\n\tdist = ( dist - nearDistance ) / ( farDistance - nearDistance );\n\tdist = saturate( dist );\n\tgl_FragColor = packDepthToRGBA( dist );\n}";var Jo="#define DISTANCE\nvarying vec3 vWorldPosition;\n#include <common>\n#include <uv_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <skinbase_vertex>\n\t#ifdef USE_DISPLACEMENTMAP\n\t\t#include <beginnormal_vertex>\n\t\t#include <morphnormal_vertex>\n\t\t#include <skinnormal_vertex>\n\t#endif\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <worldpos_vertex>\n\t#include <clipping_planes_vertex>\n\tvWorldPosition = worldPosition.xyz;\n}";var Ko="uniform sampler2D tEquirect;\nvarying vec3 vWorldDirection;\n#include <common>\nvoid main() {\n\tvec3 direction = normalize( vWorldDirection );\n\tvec2 sampleUV;\n\tsampleUV.y = asin( clamp( direction.y, - 1.0, 1.0 ) ) * RECIPROCAL_PI + 0.5;\n\tsampleUV.x = atan( direction.z, direction.x ) * RECIPROCAL_PI2 + 0.5;\n\tvec4 texColor = texture2D( tEquirect, sampleUV );\n\tgl_FragColor = mapTexelToLinear( texColor );\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n}";var Qo="varying vec3 vWorldDirection;\n#include <common>\nvoid main() {\n\tvWorldDirection = transformDirection( position, modelMatrix );\n\t#include <begin_vertex>\n\t#include <project_vertex>\n}";var $o="uniform vec3 diffuse;\nuniform float opacity;\nuniform float dashSize;\nuniform float totalSize;\nvarying float vLineDistance;\n#include <common>\n#include <color_pars_fragment>\n#include <fog_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tif ( mod( vLineDistance, totalSize ) > dashSize ) {\n\t\tdiscard;\n\t}\n\tvec3 outgoingLight = vec3( 0.0 );\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <logdepthbuf_fragment>\n\t#include <color_fragment>\n\toutgoingLight = diffuseColor.rgb;\n\tgl_FragColor = vec4( outgoingLight, diffuseColor.a );\n\t#include <premultiplied_alpha_fragment>\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n}";var es="uniform float scale;\nattribute float lineDistance;\nvarying float vLineDistance;\n#include <common>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <color_vertex>\n\tvLineDistance = scale * lineDistance;\n\tvec4 mvPosition = modelViewMatrix * vec4( position, 1.0 );\n\tgl_Position = projectionMatrix * mvPosition;\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <fog_vertex>\n}";var ts="uniform vec3 diffuse;\nuniform float opacity;\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n#endif\n#include <common>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <uv2_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <envmap_common_pars_fragment>\n#include <envmap_pars_fragment>\n#include <fog_pars_fragment>\n#include <specularmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <specularmap_fragment>\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\t#ifdef USE_LIGHTMAP\n\t\treflectedLight.indirectDiffuse += texture2D( lightMap, vUv2 ).xyz * lightMapIntensity;\n\t#else\n\t\treflectedLight.indirectDiffuse += vec3( 1.0 );\n\t#endif\n\t#include <aomap_fragment>\n\treflectedLight.indirectDiffuse *= diffuseColor.rgb;\n\tvec3 outgoingLight = reflectedLight.indirectDiffuse;\n\t#include <envmap_fragment>\n\tgl_FragColor = vec4( outgoingLight, diffuseColor.a );\n\t#include <premultiplied_alpha_fragment>\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n}";var rs="#include <common>\n#include <uv_pars_vertex>\n#include <uv2_pars_vertex>\n#include <envmap_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <uv2_vertex>\n\t#include <color_vertex>\n\t#include <skinbase_vertex>\n\t#ifdef USE_ENVMAP\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#endif\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <worldpos_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <envmap_vertex>\n\t#include <fog_vertex>\n}";var ns="uniform vec3 diffuse;\nuniform vec3 emissive;\nuniform float opacity;\nvarying vec3 vLightFront;\nvarying vec3 vIndirectFront;\n#ifdef DOUBLE_SIDED\n\tvarying vec3 vLightBack;\n\tvarying vec3 vIndirectBack;\n#endif\n#include <common>\n#include <packing>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <uv2_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <emissivemap_pars_fragment>\n#include <envmap_common_pars_fragment>\n#include <envmap_pars_fragment>\n#include <bsdfs>\n#include <lights_pars_begin>\n#include <fog_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <shadowmask_pars_fragment>\n#include <specularmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\tvec3 totalEmissiveRadiance = emissive;\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <specularmap_fragment>\n\t#include <emissivemap_fragment>\n\treflectedLight.indirectDiffuse = getAmbientLightIrradiance( ambientLightColor );\n\t#ifdef DOUBLE_SIDED\n\t\treflectedLight.indirectDiffuse += ( gl_FrontFacing ) ? vIndirectFront : vIndirectBack;\n\t#else\n\t\treflectedLight.indirectDiffuse += vIndirectFront;\n\t#endif\n\t#include <lightmap_fragment>\n\treflectedLight.indirectDiffuse *= BRDF_Diffuse_Lambert( diffuseColor.rgb );\n\t#ifdef DOUBLE_SIDED\n\t\treflectedLight.directDiffuse = ( gl_FrontFacing ) ? vLightFront : vLightBack;\n\t#else\n\t\treflectedLight.directDiffuse = vLightFront;\n\t#endif\n\treflectedLight.directDiffuse *= BRDF_Diffuse_Lambert( diffuseColor.rgb ) * getShadowMask();\n\t#include <aomap_fragment>\n\tvec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + totalEmissiveRadiance;\n\t#include <envmap_fragment>\n\tgl_FragColor = vec4( outgoingLight, diffuseColor.a );\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}";var is="#define LAMBERT\nvarying vec3 vLightFront;\nvarying vec3 vIndirectFront;\n#ifdef DOUBLE_SIDED\n\tvarying vec3 vLightBack;\n\tvarying vec3 vIndirectBack;\n#endif\n#include <common>\n#include <uv_pars_vertex>\n#include <uv2_pars_vertex>\n#include <envmap_pars_vertex>\n#include <bsdfs>\n#include <lights_pars_begin>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <shadowmap_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <uv2_vertex>\n\t#include <color_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <worldpos_vertex>\n\t#include <envmap_vertex>\n\t#include <lights_lambert_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n}";var as="#define MATCAP\nuniform vec3 diffuse;\nuniform float opacity;\nuniform sampler2D matcap;\nvarying vec3 vViewPosition;\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n#endif\n#include <common>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <fog_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\tvec3 viewDir = normalize( vViewPosition );\n\tvec3 x = normalize( vec3( viewDir.z, 0.0, - viewDir.x ) );\n\tvec3 y = cross( viewDir, x );\n\tvec2 uv = vec2( dot( x, normal ), dot( y, normal ) ) * 0.495 + 0.5;\n\t#ifdef USE_MATCAP\n\t\tvec4 matcapColor = texture2D( matcap, uv );\n\t\tmatcapColor = matcapTexelToLinear( matcapColor );\n\t#else\n\t\tvec4 matcapColor = vec4( 1.0 );\n\t#endif\n\tvec3 outgoingLight = diffuseColor.rgb * matcapColor.rgb;\n\tgl_FragColor = vec4( outgoingLight, diffuseColor.a );\n\t#include <premultiplied_alpha_fragment>\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n}";var os="#define MATCAP\nvarying vec3 vViewPosition;\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n#endif\n#include <common>\n#include <uv_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#ifndef FLAT_SHADED\n\t\tvNormal = normalize( transformedNormal );\n\t#endif\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <fog_vertex>\n\tvViewPosition = - mvPosition.xyz;\n}";var ss="#define PHONG\nuniform vec3 diffuse;\nuniform vec3 emissive;\nuniform vec3 specular;\nuniform float shininess;\nuniform float opacity;\n#include <common>\n#include <packing>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <uv2_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <emissivemap_pars_fragment>\n#include <envmap_common_pars_fragment>\n#include <envmap_pars_fragment>\n#include <gradientmap_pars_fragment>\n#include <fog_pars_fragment>\n#include <bsdfs>\n#include <lights_pars_begin>\n#include <lights_phong_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <specularmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\tvec3 totalEmissiveRadiance = emissive;\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <specularmap_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\t#include <emissivemap_fragment>\n\t#include <lights_phong_fragment>\n\t#include <lights_fragment_begin>\n\t#include <lights_fragment_maps>\n\t#include <lights_fragment_end>\n\t#include <aomap_fragment>\n\tvec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + reflectedLight.directSpecular + reflectedLight.indirectSpecular + totalEmissiveRadiance;\n\t#include <envmap_fragment>\n\tgl_FragColor = vec4( outgoingLight, diffuseColor.a );\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}";var us="#define PHONG\nvarying vec3 vViewPosition;\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n#endif\n#include <common>\n#include <uv_pars_vertex>\n#include <uv2_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <envmap_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <shadowmap_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <uv2_vertex>\n\t#include <color_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n#ifndef FLAT_SHADED\n\tvNormal = normalize( transformedNormal );\n#endif\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\tvViewPosition = - mvPosition.xyz;\n\t#include <worldpos_vertex>\n\t#include <envmap_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n}";var ls="#define STANDARD\n#ifdef PHYSICAL\n\t#define REFLECTIVITY\n\t#define CLEARCOAT\n\t#define TRANSPARENCY\n#endif\nuniform vec3 diffuse;\nuniform vec3 emissive;\nuniform float roughness;\nuniform float metalness;\nuniform float opacity;\n#ifdef TRANSPARENCY\n\tuniform float transparency;\n#endif\n#ifdef REFLECTIVITY\n\tuniform float reflectivity;\n#endif\n#ifdef CLEARCOAT\n\tuniform float clearcoat;\n\tuniform float clearcoatRoughness;\n#endif\n#ifdef USE_SHEEN\n\tuniform vec3 sheen;\n#endif\nvarying vec3 vViewPosition;\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n\t#ifdef USE_TANGENT\n\t\tvarying vec3 vTangent;\n\t\tvarying vec3 vBitangent;\n\t#endif\n#endif\n#include <common>\n#include <packing>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <uv2_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <emissivemap_pars_fragment>\n#include <bsdfs>\n#include <cube_uv_reflection_fragment>\n#include <envmap_common_pars_fragment>\n#include <envmap_physical_pars_fragment>\n#include <fog_pars_fragment>\n#include <lights_pars_begin>\n#include <lights_physical_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <clearcoat_normalmap_pars_fragment>\n#include <roughnessmap_pars_fragment>\n#include <metalnessmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\tvec3 totalEmissiveRadiance = emissive;\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <roughnessmap_fragment>\n\t#include <metalnessmap_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\t#include <clearcoat_normal_fragment_begin>\n\t#include <clearcoat_normal_fragment_maps>\n\t#include <emissivemap_fragment>\n\t#include <lights_physical_fragment>\n\t#include <lights_fragment_begin>\n\t#include <lights_fragment_maps>\n\t#include <lights_fragment_end>\n\t#include <aomap_fragment>\n\tvec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + reflectedLight.directSpecular + reflectedLight.indirectSpecular + totalEmissiveRadiance;\n\t#ifdef TRANSPARENCY\n\t\tdiffuseColor.a *= saturate( 1. - transparency + linearToRelativeLuminance( reflectedLight.directSpecular + reflectedLight.indirectSpecular ) );\n\t#endif\n\tgl_FragColor = vec4( outgoingLight, diffuseColor.a );\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}";var cs="#define STANDARD\nvarying vec3 vViewPosition;\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n\t#ifdef USE_TANGENT\n\t\tvarying vec3 vTangent;\n\t\tvarying vec3 vBitangent;\n\t#endif\n#endif\n#include <common>\n#include <uv_pars_vertex>\n#include <uv2_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <shadowmap_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <uv2_vertex>\n\t#include <color_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n#ifndef FLAT_SHADED\n\tvNormal = normalize( transformedNormal );\n\t#ifdef USE_TANGENT\n\t\tvTangent = normalize( transformedTangent );\n\t\tvBitangent = normalize( cross( vNormal, vTangent ) * tangent.w );\n\t#endif\n#endif\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\tvViewPosition = - mvPosition.xyz;\n\t#include <worldpos_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n}";var hs="#define NORMAL\nuniform float opacity;\n#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( TANGENTSPACE_NORMALMAP )\n\tvarying vec3 vViewPosition;\n#endif\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n\t#ifdef USE_TANGENT\n\t\tvarying vec3 vTangent;\n\t\tvarying vec3 vBitangent;\n\t#endif\n#endif\n#include <packing>\n#include <uv_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\t#include <logdepthbuf_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\tgl_FragColor = vec4( packNormalToRGB( normal ), opacity );\n}";var fs="#define NORMAL\n#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( TANGENTSPACE_NORMALMAP )\n\tvarying vec3 vViewPosition;\n#endif\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n\t#ifdef USE_TANGENT\n\t\tvarying vec3 vTangent;\n\t\tvarying vec3 vBitangent;\n\t#endif\n#endif\n#include <uv_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n#ifndef FLAT_SHADED\n\tvNormal = normalize( transformedNormal );\n\t#ifdef USE_TANGENT\n\t\tvTangent = normalize( transformedTangent );\n\t\tvBitangent = normalize( cross( vNormal, vTangent ) * tangent.w );\n\t#endif\n#endif\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( TANGENTSPACE_NORMALMAP )\n\tvViewPosition = - mvPosition.xyz;\n#endif\n}";var ds="uniform vec3 diffuse;\nuniform float opacity;\n#include <common>\n#include <color_pars_fragment>\n#include <map_particle_pars_fragment>\n#include <fog_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec3 outgoingLight = vec3( 0.0 );\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <logdepthbuf_fragment>\n\t#include <map_particle_fragment>\n\t#include <color_fragment>\n\t#include <alphatest_fragment>\n\toutgoingLight = diffuseColor.rgb;\n\tgl_FragColor = vec4( outgoingLight, diffuseColor.a );\n\t#include <premultiplied_alpha_fragment>\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n}";var ps="uniform float size;\nuniform float scale;\n#include <common>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <color_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <project_vertex>\n\tgl_PointSize = size;\n\t#ifdef USE_SIZEATTENUATION\n\t\tbool isPerspective = isPerspectiveMatrix( projectionMatrix );\n\t\tif ( isPerspective ) gl_PointSize *= ( scale / - mvPosition.z );\n\t#endif\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <worldpos_vertex>\n\t#include <fog_vertex>\n}";var vs="uniform vec3 color;\nuniform float opacity;\n#include <common>\n#include <packing>\n#include <fog_pars_fragment>\n#include <bsdfs>\n#include <lights_pars_begin>\n#include <shadowmap_pars_fragment>\n#include <shadowmask_pars_fragment>\nvoid main() {\n\tgl_FragColor = vec4( color, opacity * ( 1.0 - getShadowMask() ) );\n\t#include <fog_fragment>\n}";var ms="#include <fog_pars_vertex>\n#include <shadowmap_pars_vertex>\nvoid main() {\n\t#include <begin_vertex>\n\t#include <project_vertex>\n\t#include <worldpos_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n}";var gs="uniform vec3 diffuse;\nuniform float opacity;\n#include <common>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <fog_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec3 outgoingLight = vec3( 0.0 );\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <alphatest_fragment>\n\toutgoingLight = diffuseColor.rgb;\n\tgl_FragColor = vec4( outgoingLight, diffuseColor.a );\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n}";var ys="uniform float rotation;\nuniform vec2 center;\n#include <common>\n#include <uv_pars_vertex>\n#include <fog_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\tvec4 mvPosition = modelViewMatrix * vec4( 0.0, 0.0, 0.0, 1.0 );\n\tvec2 scale;\n\tscale.x = length( vec3( modelMatrix[ 0 ].x, modelMatrix[ 0 ].y, modelMatrix[ 0 ].z ) );\n\tscale.y = length( vec3( modelMatrix[ 1 ].x, modelMatrix[ 1 ].y, modelMatrix[ 1 ].z ) );\n\t#ifndef USE_SIZEATTENUATION\n\t\tbool isPerspective = isPerspectiveMatrix( projectionMatrix );\n\t\tif ( isPerspective ) scale *= - mvPosition.z;\n\t#endif\n\tvec2 alignedPosition = ( position.xy - ( center - vec2( 0.5 ) ) ) * scale;\n\tvec2 rotatedPosition;\n\trotatedPosition.x = cos( rotation ) * alignedPosition.x - sin( rotation ) * alignedPosition.y;\n\trotatedPosition.y = sin( rotation ) * alignedPosition.x + cos( rotation ) * alignedPosition.y;\n\tmvPosition.xy += rotatedPosition;\n\tgl_Position = projectionMatrix * mvPosition;\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <fog_vertex>\n}";var xs={alphamap_fragment:na,alphamap_pars_fragment:ia,alphatest_fragment:aa,aomap_fragment:oa,aomap_pars_fragment:sa,begin_vertex:ua,beginnormal_vertex:la,bsdfs:ca,bumpmap_pars_fragment:ha,clipping_planes_fragment:fa,clipping_planes_pars_fragment:da,clipping_planes_pars_vertex:pa,clipping_planes_vertex:va,color_fragment:ma,color_pars_fragment:ga,color_pars_vertex:ya,color_vertex:xa,common:ba,cube_uv_reflection_fragment:wa,defaultnormal_vertex:_a,displacementmap_pars_vertex:Ta,displacementmap_vertex:Ea,emissivemap_fragment:Ma,emissivemap_pars_fragment:Sa,encodings_fragment:Aa,encodings_pars_fragment:Ra,envmap_fragment:Pa,envmap_common_pars_fragment:Ca,envmap_pars_fragment:Oa,envmap_pars_vertex:La,envmap_physical_pars_fragment:Ga,envmap_vertex:Ia,fog_vertex:Da,fog_pars_vertex:Na,fog_fragment:Fa,fog_pars_fragment:Ba,gradientmap_pars_fragment:Ua,lightmap_fragment:ka,lightmap_pars_fragment:ja,lights_lambert_vertex:za,lights_pars_begin:Ha,lights_phong_fragment:Va,lights_phong_pars_fragment:Wa,lights_physical_fragment:qa,lights_physical_pars_fragment:Xa,lights_fragment_begin:Ya,lights_fragment_maps:Za,lights_fragment_end:Ja,logdepthbuf_fragment:Ka,logdepthbuf_pars_fragment:Qa,logdepthbuf_pars_vertex:$a,logdepthbuf_vertex:eo,map_fragment:to,map_pars_fragment:ro,map_particle_fragment:no,map_particle_pars_fragment:io,metalnessmap_fragment:ao,metalnessmap_pars_fragment:oo,morphnormal_vertex:so,morphtarget_pars_vertex:uo,morphtarget_vertex:lo,normal_fragment_begin:co,normal_fragment_maps:ho,normalmap_pars_fragment:fo,clearcoat_normal_fragment_begin:po,clearcoat_normal_fragment_maps:vo,clearcoat_normalmap_pars_fragment:mo,packing:go,premultiplied_alpha_fragment:yo,project_vertex:xo,dithering_fragment:bo,dithering_pars_fragment:wo,roughnessmap_fragment:_o,roughnessmap_pars_fragment:To,shadowmap_pars_fragment:Eo,shadowmap_pars_vertex:Mo,shadowmap_vertex:So,shadowmask_pars_fragment:Ao,skinbase_vertex:Ro,skinning_pars_vertex:Po,skinning_vertex:Co,skinnormal_vertex:Oo,specularmap_fragment:Lo,specularmap_pars_fragment:Io,tonemapping_fragment:Do,tonemapping_pars_fragment:No,uv_pars_fragment:Fo,uv_pars_vertex:Bo,uv_vertex:Uo,uv2_pars_fragment:ko,uv2_pars_vertex:jo,uv2_vertex:zo,worldpos_vertex:Ho,background_frag:Go,background_vert:Vo,cube_frag:Wo,cube_vert:qo,depth_frag:Xo,depth_vert:Yo,distanceRGBA_frag:Zo,distanceRGBA_vert:Jo,equirect_frag:Ko,equirect_vert:Qo,linedashed_frag:$o,linedashed_vert:es,meshbasic_frag:ts,meshbasic_vert:rs,meshlambert_frag:ns,meshlambert_vert:is,meshmatcap_frag:as,meshmatcap_vert:os,meshphong_frag:ss,meshphong_vert:us,meshphysical_frag:ls,meshphysical_vert:cs,normal_frag:hs,normal_vert:fs,points_frag:ds,points_vert:ps,shadow_frag:vs,shadow_vert:ms,sprite_frag:gs,sprite_vert:ys};r.ShaderChunk=xs;var bs={common:{diffuse:{value:new Fn(15658734)},opacity:{value:1},map:{value:null},uvTransform:{value:new mr},alphaMap:{value:null}},specularmap:{specularMap:{value:null}},envmap:{envMap:{value:null},flipEnvMap:{value:-1},reflectivity:{value:1},refractionRatio:{value:.98},maxMipLevel:{value:0}},aomap:{aoMap:{value:null},aoMapIntensity:{value:1}},lightmap:{lightMap:{value:null},lightMapIntensity:{value:1}},emissivemap:{emissiveMap:{value:null}},bumpmap:{bumpMap:{value:null},bumpScale:{value:1}},normalmap:{normalMap:{value:null},normalScale:{value:new cr(1,1)}},displacementmap:{displacementMap:{value:null},displacementScale:{value:1},displacementBias:{value:0}},roughnessmap:{roughnessMap:{value:null}},metalnessmap:{metalnessMap:{value:null}},gradientmap:{gradientMap:{value:null}},fog:{fogDensity:{value:25e-5},fogNear:{value:1},fogFar:{value:2e3},fogColor:{value:new Fn(16777215)}},lights:{ambientLightColor:{value:[]},lightProbe:{value:[]},directionalLights:{value:[],properties:{direction:{},color:{},shadow:{},shadowBias:{},shadowRadius:{},shadowMapSize:{}}},directionalShadowMap:{value:[]},directionalShadowMatrix:{value:[]},spotLights:{value:[],properties:{color:{},position:{},direction:{},distance:{},coneCos:{},penumbraCos:{},decay:{},shadow:{},shadowBias:{},shadowRadius:{},shadowMapSize:{}}},spotShadowMap:{value:[]},spotShadowMatrix:{value:[]},pointLights:{value:[],properties:{color:{},position:{},decay:{},distance:{},shadow:{},shadowBias:{},shadowRadius:{},shadowMapSize:{},shadowCameraNear:{},shadowCameraFar:{}}},pointShadowMap:{value:[]},pointShadowMatrix:{value:[]},hemisphereLights:{value:[],properties:{direction:{},skyColor:{},groundColor:{}}},rectAreaLights:{value:[],properties:{color:{},position:{},width:{},height:{}}}},points:{diffuse:{value:new Fn(15658734)},opacity:{value:1},size:{value:1},scale:{value:1},map:{value:null},uvTransform:{value:new mr}},sprite:{diffuse:{value:new Fn(15658734)},opacity:{value:1},center:{value:new cr(.5,.5)},rotation:{value:0},map:{value:null},uvTransform:{value:new mr}}};r.UniformsLib=bs;var ws={basic:{uniforms:Ui([bs.common,bs.specularmap,bs.envmap,bs.aomap,bs.lightmap,bs.fog]),vertexShader:xs.meshbasic_vert,fragmentShader:xs.meshbasic_frag},lambert:{uniforms:Ui([bs.common,bs.specularmap,bs.envmap,bs.aomap,bs.lightmap,bs.emissivemap,bs.fog,bs.lights,{emissive:{value:new Fn(0)}}]),vertexShader:xs.meshlambert_vert,fragmentShader:xs.meshlambert_frag},phong:{uniforms:Ui([bs.common,bs.specularmap,bs.envmap,bs.aomap,bs.lightmap,bs.emissivemap,bs.bumpmap,bs.normalmap,bs.displacementmap,bs.gradientmap,bs.fog,bs.lights,{emissive:{value:new Fn(0)},specular:{value:new Fn(1118481)},shininess:{value:30}}]),vertexShader:xs.meshphong_vert,fragmentShader:xs.meshphong_frag},standard:{uniforms:Ui([bs.common,bs.envmap,bs.aomap,bs.lightmap,bs.emissivemap,bs.bumpmap,bs.normalmap,bs.displacementmap,bs.roughnessmap,bs.metalnessmap,bs.fog,bs.lights,{emissive:{value:new Fn(0)},roughness:{value:.5},metalness:{value:.5},envMapIntensity:{value:1}}]),vertexShader:xs.meshphysical_vert,fragmentShader:xs.meshphysical_frag},matcap:{uniforms:Ui([bs.common,bs.bumpmap,bs.normalmap,bs.displacementmap,bs.fog,{matcap:{value:null}}]),vertexShader:xs.meshmatcap_vert,fragmentShader:xs.meshmatcap_frag},points:{uniforms:Ui([bs.points,bs.fog]),vertexShader:xs.points_vert,fragmentShader:xs.points_frag},dashed:{uniforms:Ui([bs.common,bs.fog,{scale:{value:1},dashSize:{value:1},totalSize:{value:2}}]),vertexShader:xs.linedashed_vert,fragmentShader:xs.linedashed_frag},depth:{uniforms:Ui([bs.common,bs.displacementmap]),vertexShader:xs.depth_vert,fragmentShader:xs.depth_frag},normal:{uniforms:Ui([bs.common,bs.bumpmap,bs.normalmap,bs.displacementmap,{opacity:{value:1}}]),vertexShader:xs.normal_vert,fragmentShader:xs.normal_frag},sprite:{uniforms:Ui([bs.sprite,bs.fog]),vertexShader:xs.sprite_vert,fragmentShader:xs.sprite_frag},background:{uniforms:{uvTransform:{value:new mr},t2D:{value:null}},vertexShader:xs.background_vert,fragmentShader:xs.background_frag},cube:{uniforms:{tCube:{value:null},tFlip:{value:-1},opacity:{value:1}},vertexShader:xs.cube_vert,fragmentShader:xs.cube_frag},equirect:{uniforms:{tEquirect:{value:null}},vertexShader:xs.equirect_vert,fragmentShader:xs.equirect_frag},distanceRGBA:{uniforms:Ui([bs.common,bs.displacementmap,{referencePosition:{value:new pr},nearDistance:{value:1},farDistance:{value:1e3}}]),vertexShader:xs.distanceRGBA_vert,fragmentShader:xs.distanceRGBA_frag},shadow:{uniforms:Ui([bs.lights,bs.fog,{color:{value:new Fn(0)},opacity:{value:1}}]),vertexShader:xs.shadow_vert,fragmentShader:xs.shadow_frag}};r.ShaderLib=ws;ws.physical={uniforms:Ui([ws.standard.uniforms,{transparency:{value:0},clearcoat:{value:0},clearcoatRoughness:{value:0},sheen:{value:new Fn(0)},clearcoatNormalScale:{value:new cr(1,1)},clearcoatNormalMap:{value:null}}]),vertexShader:xs.meshphysical_vert,fragmentShader:xs.meshphysical_frag};function _s(){var r=null;var n=false;var i=null;function a(e,t){if(n===false)return;i(e,t);r.requestAnimationFrame(a)}return{start:function(){if(n===true)return;if(i===null)return;r.requestAnimationFrame(a);n=true},stop:function(){n=false},setAnimationLoop:function(e){i=e},setContext:function(e){r=e}}}function Ts(o){var n=new WeakMap;function i(e,t){var r=e.array;var n=e.dynamic?35048:35044;var i=o.createBuffer();o.bindBuffer(t,i);o.bufferData(t,r,n);e.onUploadCallback();var a=5126;if(r instanceof Float32Array){a=5126}else if(r instanceof Float64Array){console.warn("THREE.WebGLAttributes: Unsupported data buffer format: Float64Array.")}else if(r instanceof Uint16Array){a=5123}else if(r instanceof Int16Array){a=5122}else if(r instanceof Uint32Array){a=5125}else if(r instanceof Int32Array){a=5124}else if(r instanceof Int8Array){a=5120}else if(r instanceof Uint8Array){a=5121}return{buffer:i,type:a,bytesPerElement:r.BYTES_PER_ELEMENT,version:e.version}}function a(e,t,r){var n=t.array;var i=t.updateRange;o.bindBuffer(r,e);if(t.dynamic===false){o.bufferData(r,n,35044)}else if(i.count===-1){o.bufferSubData(r,0,n)}else if(i.count===0){console.error("THREE.WebGLObjects.updateBuffer: dynamic THREE.BufferAttribute marked as needsUpdate but updateRange.count is 0, ensure you are using set methods or updating manually.")}else{o.bufferSubData(r,i.offset*n.BYTES_PER_ELEMENT,n.subarray(i.offset,i.offset+i.count));i.count=-1}}function e(e){if(e.isInterleavedBufferAttribute)e=e.data;return n.get(e)}function t(e){if(e.isInterleavedBufferAttribute)e=e.data;var t=n.get(e);if(t){o.deleteBuffer(t.buffer);n.delete(e)}}function r(e,t){if(e.isInterleavedBufferAttribute)e=e.data;var r=n.get(e);if(r===undefined){n.set(e,i(e,t))}else if(r.version<e.version){a(r.buffer,e,t);r.version=e.version}}return{get:e,remove:t,update:r}}function Es(e,t,r,n){Di.call(this);this.type="PlaneGeometry";this.parameters={width:e,height:t,widthSegments:r,heightSegments:n};this.fromBufferGeometry(new Ms(e,t,r,n));this.mergeVertices()}Es.prototype=Object.create(Di.prototype);Es.prototype.constructor=Es;function Ms(e,t,r,n){li.call(this);this.type="PlaneBufferGeometry";this.parameters={width:e,height:t,widthSegments:r,heightSegments:n};e=e||1;t=t||1;var i=e/2;var a=t/2;var o=Math.floor(r)||1;var s=Math.floor(n)||1;var u=o+1;var l=s+1;var c=e/o;var h=t/s;var f,d;var p=[];var v=[];var m=[];var g=[];for(d=0;d<l;d++){var y=d*h-a;for(f=0;f<u;f++){var x=f*c-i;v.push(x,-y,0);m.push(0,0,1);g.push(f/o);g.push(1-d/s)}}for(d=0;d<s;d++){for(f=0;f<o;f++){var b=f+u*d;var w=f+u*(d+1);var _=f+1+u*(d+1);var T=f+1+u*d;p.push(b,w,T);p.push(w,_,T)}}this.setIndex(p);this.addAttribute("position",new Qn(v,3));this.addAttribute("normal",new Qn(m,3));this.addAttribute("uv",new Qn(g,2))}Ms.prototype=Object.create(li.prototype);Ms.prototype.constructor=Ms;function Ss(u,r,l,n){var c=new Fn(0);var h=0;var f;var d;var p=null;var v=0;function e(e,t,r,n){var i=t.background;var a=u.vr;var o=a.getSession&&a.getSession();if(o&&o.environmentBlendMode==="additive"){i=null}if(i===null){m(c,h);p=null;v=0}else if(i&&i.isColor){m(i,1);n=true;p=null;v=0}if(u.autoClear||n){u.clear(u.autoClearColor,u.autoClearDepth,u.autoClearStencil)}if(i&&(i.isCubeTexture||i.isWebGLRenderTargetCube)){if(d===undefined){d=new Ai(new Fi(1,1,1),new Hi({type:"BackgroundCubeMaterial",uniforms:Bi(ws.cube.uniforms),vertexShader:ws.cube.vertexShader,fragmentShader:ws.cube.fragmentShader,side:ze,depthTest:false,depthWrite:false,fog:false}));d.geometry.removeAttribute("normal");d.geometry.removeAttribute("uv");d.onBeforeRender=function(e,t,r){this.matrixWorld.copyPosition(r.matrixWorld)};Object.defineProperty(d.material,"map",{get:function(){return this.uniforms.tCube.value}});l.update(d)}var s=i.isWebGLRenderTargetCube?i.texture:i;d.material.uniforms.tCube.value=s;d.material.uniforms.tFlip.value=i.isWebGLRenderTargetCube?1:-1;if(p!==i||v!==s.version){d.material.needsUpdate=true;p=i;v=s.version}e.unshift(d,d.geometry,d.material,0,0,null)}else if(i&&i.isTexture){if(f===undefined){f=new Ai(new Ms(2,2),new Hi({type:"BackgroundMaterial",uniforms:Bi(ws.background.uniforms),vertexShader:ws.background.vertexShader,fragmentShader:ws.background.fragmentShader,side:D,depthTest:false,depthWrite:false,fog:false}));f.geometry.removeAttribute("normal");Object.defineProperty(f.material,"map",{get:function(){return this.uniforms.t2D.value}});l.update(f)}f.material.uniforms.t2D.value=i;if(i.matrixAutoUpdate===true){i.updateMatrix()}f.material.uniforms.uvTransform.value.copy(i.matrix);if(p!==i||v!==i.version){f.material.needsUpdate=true;p=i;v=i.version}e.unshift(f,f.geometry,f.material,0,0,null)}}function m(e,t){r.buffers.color.setClear(e.r,e.g,e.b,t,n)}return{getClearColor:function(){return c},setClearColor:function(e,t){c.set(e);h=t!==undefined?t:1;m(c,h)},getClearAlpha:function(){return h},setClearAlpha:function(e){h=e;m(c,h)},render:e}}function As(o,s,u,l){var c;function e(e){c=e}function t(e,t){o.drawArrays(c,e,t);u.update(t,c)}function r(e,t,r,n){if(n===0)return;var i,a;if(l.isWebGL2){i=o;a="drawArraysInstanced"}else{i=s.get("ANGLE_instanced_arrays");a="drawArraysInstancedANGLE";if(i===null){console.error("THREE.WebGLBufferRenderer: using THREE.InstancedBufferGeometry but hardware does not support extension ANGLE_instanced_arrays.");return}}i[a](c,t,r,n);u.update(r,c,n)}this.setMode=e;this.render=t;this.renderInstances=r}function Rs(t,r,e){var n;function i(){if(n!==undefined)return n;var e=r.get("EXT_texture_filter_anisotropic");if(e!==null){n=t.getParameter(e.MAX_TEXTURE_MAX_ANISOTROPY_EXT)}else{n=0}return n}function a(e){if(e==="highp"){if(t.getShaderPrecisionFormat(35633,36338).precision>0&&t.getShaderPrecisionFormat(35632,36338).precision>0){return"highp"}e="mediump"}if(e==="mediump"){if(t.getShaderPrecisionFormat(35633,36337).precision>0&&t.getShaderPrecisionFormat(35632,36337).precision>0){return"mediump"}}return"lowp"}var o=typeof WebGL2RenderingContext!=="undefined"&&t instanceof WebGL2RenderingContext;var s=e.precision!==undefined?e.precision:"highp";var u=a(s);if(u!==s){console.warn("THREE.WebGLRenderer:",s,"not supported, using",u,"instead.");s=u}var l=e.logarithmicDepthBuffer===true;var c=t.getParameter(34930);var h=t.getParameter(35660);var f=t.getParameter(3379);var d=t.getParameter(34076);var p=t.getParameter(34921);var v=t.getParameter(36347);var m=t.getParameter(36348);var g=t.getParameter(36349);var y=h>0;var x=o||!!r.get("OES_texture_float");var b=y&&x;var w=o?t.getParameter(36183):0;return{isWebGL2:o,getMaxAnisotropy:i,getMaxPrecision:a,precision:s,logarithmicDepthBuffer:l,maxTextures:c,maxVertexTextures:h,maxTextureSize:f,maxCubemapSize:d,maxAttributes:p,maxVertexUniforms:v,maxVaryings:m,maxFragmentUniforms:g,vertexTextures:y,floatFragmentTextures:x,floatVertexTextures:b,maxSamples:w}}function Ps(){var c=this,h=null,f=0,d=false,p=false,v=new $i,m=new mr,g={value:null,needsUpdate:false};this.uniform=g;this.numPlanes=0;this.numIntersection=0;this.init=function(e,t,r){var n=e.length!==0||t||f!==0||d;d=t;h=x(e,r,0);f=e.length;return n};this.beginShadows=function(){p=true;x(null)};this.endShadows=function(){p=false;y()};this.setState=function(e,t,r,n,i,a){if(!d||e===null||e.length===0||p&&!r){if(p){x(null)}else{y()}}else{var o=p?0:f,s=o*4,u=i.clippingState||null;g.value=u;u=x(e,n,s,a);for(var l=0;l!==s;++l){u[l]=h[l]}i.clippingState=u;this.numIntersection=t?this.numPlanes:0;this.numPlanes+=o}};function y(){if(g.value!==h){g.value=h;g.needsUpdate=f>0}c.numPlanes=f;c.numIntersection=0}function x(e,t,r,n){var i=e!==null?e.length:0,a=null;if(i!==0){a=g.value;if(n!==true||a===null){var o=r+i*4,s=t.matrixWorldInverse;m.getNormalMatrix(s);if(a===null||a.length<o){a=new Float32Array(o)}for(var u=0,l=r;u!==i;++u,l+=4){v.copy(e[u]).applyMatrix4(s,m);v.normal.toArray(a,l);a[l+3]=v.constant}}g.value=a;g.needsUpdate=true}c.numPlanes=i;return a}}function Cs(r){var n={};return{get:function(e){if(n[e]!==undefined){return n[e]}var t;switch(e){case"WEBGL_depth_texture":t=r.getExtension("WEBGL_depth_texture")||r.getExtension("MOZ_WEBGL_depth_texture")||r.getExtension("WEBKIT_WEBGL_depth_texture");break;case"EXT_texture_filter_anisotropic":t=r.getExtension("EXT_texture_filter_anisotropic")||r.getExtension("MOZ_EXT_texture_filter_anisotropic")||r.getExtension("WEBKIT_EXT_texture_filter_anisotropic");break;case"WEBGL_compressed_texture_s3tc":t=r.getExtension("WEBGL_compressed_texture_s3tc")||r.getExtension("MOZ_WEBGL_compressed_texture_s3tc")||r.getExtension("WEBKIT_WEBGL_compressed_texture_s3tc");break;case"WEBGL_compressed_texture_pvrtc":t=r.getExtension("WEBGL_compressed_texture_pvrtc")||r.getExtension("WEBKIT_WEBGL_compressed_texture_pvrtc");break;default:t=r.getExtension(e)}if(t===null){console.warn("THREE.WebGLRenderer: "+e+" extension not supported.")}n[e]=t;return t}}}function Os(e,d,a){var o=new WeakMap;var p=new WeakMap;function s(e){var t=e.target;var r=o.get(t);if(r.index!==null){d.remove(r.index)}for(var n in r.attributes){d.remove(r.attributes[n])}t.removeEventListener("dispose",s);o.delete(t);var i=p.get(r);if(i){d.remove(i);p.delete(r)}a.memory.geometries--}function t(e,t){var r=o.get(t);if(r)return r;t.addEventListener("dispose",s);if(t.isBufferGeometry){r=t}else if(t.isGeometry){if(t._bufferGeometry===undefined){t._bufferGeometry=(new li).setFromObject(e)}r=t._bufferGeometry}o.set(t,r);a.memory.geometries++;return r}function r(e){var t=e.index;var r=e.attributes;if(t!==null){d.update(t,34963)}for(var n in r){d.update(r[n],34962)}var i=e.morphAttributes;for(var n in i){var a=i[n];for(var o=0,s=a.length;o<s;o++){d.update(a[o],34962)}}}function n(e){var t=[];var r=e.index;var n=e.attributes.position;var i=0;if(r!==null){var a=r.array;i=r.version;for(var o=0,s=a.length;o<s;o+=3){var u=a[o+0];var l=a[o+1];var c=a[o+2];t.push(u,l,l,c,c,u)}}else{var a=n.array;i=n.version;for(var o=0,s=a.length/3-1;o<s;o+=3){var u=o+0;var l=o+1;var c=o+2;t.push(u,l,l,c,c,u)}}var h=new(ti(t)>65535?Kn:Zn)(t,1);h.version=i;d.update(h,34963);var f=p.get(e);if(f)d.remove(f);p.set(e,h)}function i(e){var t=p.get(e);if(t){var r=e.index;if(r!==null){if(t.version<r.version){n(e)}}}else{n(e)}return p.get(e)}return{get:t,update:r,getWireframeAttribute:i}}function Ls(o,s,u,l){var c;function e(e){c=e}var h,f;function t(e){h=e.type;f=e.bytesPerElement}function r(e,t){o.drawElements(c,t,h,e*f);u.update(t,c)}function n(e,t,r,n){if(n===0)return;var i,a;if(l.isWebGL2){i=o;a="drawElementsInstanced"}else{i=s.get("ANGLE_instanced_arrays");a="drawElementsInstancedANGLE";if(i===null){console.error("THREE.WebGLIndexedBufferRenderer: using THREE.InstancedBufferGeometry but hardware does not support extension ANGLE_instanced_arrays.");return}}i[a](c,r,h,t*f,n);u.update(r,c,n)}this.setMode=e;this.setIndex=t;this.render=r;this.renderInstances=n}function Is(e){var t={geometries:0,textures:0};var n={frame:0,calls:0,triangles:0,points:0,lines:0};function r(e,t,r){r=r||1;n.calls++;switch(t){case 4:n.triangles+=r*(e/3);break;case 5:case 6:n.triangles+=r*(e-2);break;case 1:n.lines+=r*(e/2);break;case 3:n.lines+=r*(e-1);break;case 2:n.lines+=r*e;break;case 0:n.points+=r*e;break;default:console.error("THREE.WebGLInfo: Unknown draw mode:",t);break}}function i(){n.frame++;n.calls=0;n.triangles=0;n.points=0;n.lines=0}return{memory:t,render:n,programs:null,autoReset:true,reset:i,update:r}}function Ds(e,t){return Math.abs(t[1])-Math.abs(e[1])}function Ns(d){var p={};var v=new Float32Array(8);function e(e,t,r,n){var i=e.morphTargetInfluences;var a=i.length;var o=p[t.id];if(o===undefined){o=[];for(var s=0;s<a;s++){o[s]=[s,0]}p[t.id]=o}var u=r.morphTargets&&t.morphAttributes.position;var l=r.morphNormals&&t.morphAttributes.normal;for(var s=0;s<a;s++){var c=o[s];if(c[1]!==0){if(u)t.removeAttribute("morphTarget"+s);if(l)t.removeAttribute("morphNormal"+s)}}for(var s=0;s<a;s++){var c=o[s];c[0]=s;c[1]=i[s]}o.sort(Ds);for(var s=0;s<8;s++){var c=o[s];if(c){var h=c[0];var f=c[1];if(f){if(u)t.addAttribute("morphTarget"+s,u[h]);if(l)t.addAttribute("morphNormal"+s,l[h]);v[s]=f;continue}}v[s]=0}n.getUniforms().setValue(d,"morphTargetInfluences",v)}return{update:e}}function Fs(e,i,a,o){var s={};function t(e){var t=o.render.frame;var r=e.geometry;var n=i.get(e,r);if(s[n.id]!==t){if(r.isGeometry){n.updateFromObject(e)}i.update(n);s[n.id]=t}if(e.isInstancedMesh){a.update(e.instanceMatrix,34962)}return n}function r(){s={}}return{update:t,dispose:r}}function Bs(e,t,r,n,i,a,o,s,u,l){e=e!==undefined?e:[];t=t!==undefined?t:G;o=o!==undefined?o:Ue;br.call(this,e,t,r,n,i,a,o,s,u,l);this.flipY=false}Bs.prototype=Object.create(br.prototype);Bs.prototype.constructor=Bs;Bs.prototype.isCubeTexture=true;Object.defineProperty(Bs.prototype,"images",{get:function(){return this.image},set:function(e){this.image=e}});function Us(e,t,r,n){br.call(this,null);this.image={data:e||null,width:t||1,height:r||1,depth:n||1};this.magFilter=$;this.minFilter=$;this.wrapR=K;this.generateMipmaps=false;this.flipY=false;this.needsUpdate=true}Us.prototype=Object.create(br.prototype);Us.prototype.constructor=Us;Us.prototype.isDataTexture2DArray=true;function ks(e,t,r,n){br.call(this,null);this.image={data:e||null,width:t||1,height:r||1,depth:n||1};this.magFilter=$;this.minFilter=$;this.wrapR=K;this.generateMipmaps=false;this.flipY=false;this.needsUpdate=true}ks.prototype=Object.create(br.prototype);ks.prototype.constructor=ks;ks.prototype.isDataTexture3D=true;var js=new br;var zs=new Us;var Hs=new ks;var Gs=new Bs;var Vs=[];var Ws=[];var qs=new Float32Array(16);var Xs=new Float32Array(9);var Ys=new Float32Array(4);function Zs(e,t,r){var n=e[0];if(n<=0||n>0)return e;var i=t*r,a=Vs[i];if(a===undefined){a=new Float32Array(i);Vs[i]=a}if(t!==0){n.toArray(a,0);for(var o=1,s=0;o!==t;++o){s+=r;e[o].toArray(a,s)}}return a}function Js(e,t){if(e.length!==t.length)return false;for(var r=0,n=e.length;r<n;r++){if(e[r]!==t[r])return false}return true}function Ks(e,t){for(var r=0,n=t.length;r<n;r++){e[r]=t[r]}}function Qs(e,t){var r=Ws[t];if(r===undefined){r=new Int32Array(t);Ws[t]=r}for(var n=0;n!==t;++n)r[n]=e.allocateTextureUnit();return r}function $s(e,t){var r=this.cache;if(r[0]===t)return;e.uniform1f(this.addr,t);r[0]=t}function eu(e,t){var r=this.cache;if(t.x!==undefined){if(r[0]!==t.x||r[1]!==t.y){e.uniform2f(this.addr,t.x,t.y);r[0]=t.x;r[1]=t.y}}else{if(Js(r,t))return;e.uniform2fv(this.addr,t);Ks(r,t)}}function tu(e,t){var r=this.cache;if(t.x!==undefined){if(r[0]!==t.x||r[1]!==t.y||r[2]!==t.z){e.uniform3f(this.addr,t.x,t.y,t.z);r[0]=t.x;r[1]=t.y;r[2]=t.z}}else if(t.r!==undefined){if(r[0]!==t.r||r[1]!==t.g||r[2]!==t.b){e.uniform3f(this.addr,t.r,t.g,t.b);r[0]=t.r;r[1]=t.g;r[2]=t.b}}else{if(Js(r,t))return;e.uniform3fv(this.addr,t);Ks(r,t)}}function ru(e,t){var r=this.cache;if(t.x!==undefined){if(r[0]!==t.x||r[1]!==t.y||r[2]!==t.z||r[3]!==t.w){e.uniform4f(this.addr,t.x,t.y,t.z,t.w);r[0]=t.x;r[1]=t.y;r[2]=t.z;r[3]=t.w}}else{if(Js(r,t))return;e.uniform4fv(this.addr,t);Ks(r,t)}}function nu(e,t){var r=this.cache;var n=t.elements;if(n===undefined){if(Js(r,t))return;e.uniformMatrix2fv(this.addr,false,t);Ks(r,t)}else{if(Js(r,n))return;Ys.set(n);e.uniformMatrix2fv(this.addr,false,Ys);Ks(r,n)}}function iu(e,t){var r=this.cache;var n=t.elements;if(n===undefined){if(Js(r,t))return;e.uniformMatrix3fv(this.addr,false,t);Ks(r,t)}else{if(Js(r,n))return;Xs.set(n);e.uniformMatrix3fv(this.addr,false,Xs);Ks(r,n)}}function au(e,t){var r=this.cache;var n=t.elements;if(n===undefined){if(Js(r,t))return;e.uniformMatrix4fv(this.addr,false,t);Ks(r,t)}else{if(Js(r,n))return;qs.set(n);e.uniformMatrix4fv(this.addr,false,qs);Ks(r,n)}}function ou(e,t,r){var n=this.cache;var i=r.allocateTextureUnit();if(n[0]!==i){e.uniform1i(this.addr,i);n[0]=i}r.safeSetTexture2D(t||js,i)}function su(e,t,r){var n=this.cache;var i=r.allocateTextureUnit();if(n[0]!==i){e.uniform1i(this.addr,i);n[0]=i}r.setTexture2DArray(t||zs,i)}function uu(e,t,r){var n=this.cache;var i=r.allocateTextureUnit();if(n[0]!==i){e.uniform1i(this.addr,i);n[0]=i}r.setTexture3D(t||Hs,i)}function lu(e,t,r){var n=this.cache;var i=r.allocateTextureUnit();if(n[0]!==i){e.uniform1i(this.addr,i);n[0]=i}r.safeSetTextureCube(t||Gs,i)}function cu(e,t){var r=this.cache;if(r[0]===t)return;e.uniform1i(this.addr,t);r[0]=t}function hu(e,t){var r=this.cache;if(Js(r,t))return;e.uniform2iv(this.addr,t);Ks(r,t)}function fu(e,t){var r=this.cache;if(Js(r,t))return;e.uniform3iv(this.addr,t);Ks(r,t)}function du(e,t){var r=this.cache;if(Js(r,t))return;e.uniform4iv(this.addr,t);Ks(r,t)}function pu(e){switch(e){case 5126:return $s;case 35664:return eu;case 35665:return tu;case 35666:return ru;case 35674:return nu;case 35675:return iu;case 35676:return au;case 35678:case 36198:return ou;case 35679:return uu;case 35680:return lu;case 36289:return su;case 5124:case 35670:return cu;case 35667:case 35671:return hu;case 35668:case 35672:return fu;case 35669:case 35673:return du}}function vu(e,t){e.uniform1fv(this.addr,t)}function mu(e,t){e.uniform1iv(this.addr,t)}function gu(e,t){e.uniform2iv(this.addr,t)}function yu(e,t){e.uniform3iv(this.addr,t)}function xu(e,t){e.uniform4iv(this.addr,t)}function bu(e,t){var r=Zs(t,this.size,2);e.uniform2fv(this.addr,r)}function wu(e,t){var r=Zs(t,this.size,3);e.uniform3fv(this.addr,r)}function _u(e,t){var r=Zs(t,this.size,4);e.uniform4fv(this.addr,r)}function Tu(e,t){var r=Zs(t,this.size,4);e.uniformMatrix2fv(this.addr,false,r)}function Eu(e,t){var r=Zs(t,this.size,9);e.uniformMatrix3fv(this.addr,false,r)}function Mu(e,t){var r=Zs(t,this.size,16);e.uniformMatrix4fv(this.addr,false,r)}function Su(e,t,r){var n=t.length;var i=Qs(r,n);e.uniform1iv(this.addr,i);for(var a=0;a!==n;++a){r.safeSetTexture2D(t[a]||js,i[a])}}function Au(e,t,r){var n=t.length;var i=Qs(r,n);e.uniform1iv(this.addr,i);for(var a=0;a!==n;++a){r.safeSetTextureCube(t[a]||Gs,i[a])}}function Ru(e){switch(e){case 5126:return vu;case 35664:return bu;case 35665:return wu;case 35666:return _u;case 35674:return Tu;case 35675:return Eu;case 35676:return Mu;case 35678:return Su;case 35680:return Au;case 5124:case 35670:return mu;case 35667:case 35671:return gu;case 35668:case 35672:return yu;case 35669:case 35673:return xu}}function Pu(e,t,r){this.id=e;this.addr=r;this.cache=[];this.setValue=pu(t.type)}function Cu(e,t,r){this.id=e;this.addr=r;this.cache=[];this.size=t.size;this.setValue=Ru(t.type)}Cu.prototype.updateCache=function(e){var t=this.cache;if(e instanceof Float32Array&&t.length!==e.length){this.cache=new Float32Array(e.length)}Ks(t,e)};function Ou(e){this.id=e;this.seq=[];this.map={}}Ou.prototype.setValue=function(e,t,r){var n=this.seq;for(var i=0,a=n.length;i!==a;++i){var o=n[i];o.setValue(e,t[o.id],r)}};var Lu=/([\w\d_]+)(\])?(\[|\.)?/g;function Iu(e,t){e.seq.push(t);e.map[t.id]=t}function Du(e,t,r){var n=e.name,i=n.length;Lu.lastIndex=0;while(true){var a=Lu.exec(n),o=Lu.lastIndex,s=a[1],u=a[2]==="]",l=a[3];if(u)s=s|0;if(l===undefined||l==="["&&o+2===i){Iu(r,l===undefined?new Pu(s,e,t):new Cu(s,e,t));break}else{var c=r.map,h=c[s];if(h===undefined){h=new Ou(s);Iu(r,h)}r=h}}}function Nu(e,t){this.seq=[];this.map={};var r=e.getProgramParameter(t,35718);for(var n=0;n<r;++n){var i=e.getActiveUniform(t,n),a=e.getUniformLocation(t,i.name);Du(i,a,this)}}Nu.prototype.setValue=function(e,t,r,n){var i=this.map[t];if(i!==undefined)i.setValue(e,r,n)};Nu.prototype.setOptional=function(e,t,r){var n=t[r];if(n!==undefined)this.setValue(e,r,n)};Nu.upload=function(e,t,r,n){for(var i=0,a=t.length;i!==a;++i){var o=t[i],s=r[o.id];if(s.needsUpdate!==false){o.setValue(e,s.value,n)}}};Nu.seqWithValue=function(e,t){var r=[];for(var n=0,i=e.length;n!==i;++n){var a=e[n];if(a.id in t)r.push(a)}return r};function Fu(e,t,r){var n=e.createShader(t);e.shaderSource(n,r);e.compileShader(n);return n}var Bu=0;function Uu(e){var t=e.split("\n");for(var r=0;r<t.length;r++){t[r]=r+1+": "+t[r]}return t.join("\n")}function ku(e){switch(e){case Lt:return["Linear","( value )"];case It:return["sRGB","( value )"];case Nt:return["RGBE","( value )"];case Bt:return["RGBM","( value, 7.0 )"];case Ut:return["RGBM","( value, 16.0 )"];case kt:return["RGBD","( value, 256.0 )"];case Dt:return["Gamma","( value, float( GAMMA_FACTOR ) )"];case Ft:return["LogLuv","( value )"];default:throw new Error("unsupported encoding: "+e)}}function ju(e,t,r){var n=e.getShaderParameter(t,35713);var i=e.getShaderInfoLog(t).trim();if(n&&i==="")return"";var a=e.getShaderSource(t);return"THREE.WebGLShader: gl.getShaderInfoLog() "+r+"\n"+i+Uu(a)}function zu(e,t){var r=ku(t);return"vec4 "+e+"( vec4 value ) { return "+r[0]+"ToLinear"+r[1]+"; }"}function Hu(e,t){var r=ku(t);return"vec4 "+e+"( vec4 value ) { return LinearTo"+r[0]+r[1]+"; }"}function Gu(e,t){var r;switch(t){case He:r="Linear";break;case U:r="Reinhard";break;case k:r="Uncharted2";break;case j:r="OptimizedCineon";break;case z:r="ACESFilmic";break;default:throw new Error("unsupported toneMapping: "+t)}return"vec3 "+e+"( vec3 color ) { return "+r+"ToneMapping( color ); }"}function Vu(e,t,r){e=e||{};var n=[e.derivatives||t.envMapCubeUV||t.bumpMap||t.tangentSpaceNormalMap||t.clearcoatNormalMap||t.flatShading?"#extension GL_OES_standard_derivatives : enable":"",(e.fragDepth||t.logarithmicDepthBuffer)&&r.get("EXT_frag_depth")?"#extension GL_EXT_frag_depth : enable":"",e.drawBuffers&&r.get("WEBGL_draw_buffers")?"#extension GL_EXT_draw_buffers : require":"",(e.shaderTextureLOD||t.envMap)&&r.get("EXT_shader_texture_lod")?"#extension GL_EXT_shader_texture_lod : enable":""];return n.filter(Xu).join("\n")}function Wu(e){var t=[];for(var r in e){var n=e[r];if(n===false)continue;t.push("#define "+r+" "+n)}return t.join("\n")}function qu(e,t){var r={};var n=e.getProgramParameter(t,35721);for(var i=0;i<n;i++){var a=e.getActiveAttrib(t,i);var o=a.name;r[o]=e.getAttribLocation(t,o)}return r}function Xu(e){return e!==""}function Yu(e,t){return e.replace(/NUM_DIR_LIGHTS/g,t.numDirLights).replace(/NUM_SPOT_LIGHTS/g,t.numSpotLights).replace(/NUM_RECT_AREA_LIGHTS/g,t.numRectAreaLights).replace(/NUM_POINT_LIGHTS/g,t.numPointLights).replace(/NUM_HEMI_LIGHTS/g,t.numHemiLights).replace(/NUM_DIR_LIGHT_SHADOWS/g,t.numDirLightShadows).replace(/NUM_SPOT_LIGHT_SHADOWS/g,t.numSpotLightShadows).replace(/NUM_POINT_LIGHT_SHADOWS/g,t.numPointLightShadows)}function Zu(e,t){return e.replace(/NUM_CLIPPING_PLANES/g,t.numClippingPlanes).replace(/UNION_CLIPPING_PLANES/g,t.numClippingPlanes-t.numClipIntersection)}var Ju=/^[ \t]*#include +<([\w\d./]+)>/gm;function Ku(e){return e.replace(Ju,Qu)}function Qu(e,t){var r=xs[t];if(r===undefined){throw new Error("Can not resolve #include <"+t+">")}return Ku(r)}var $u=/#pragma unroll_loop[\s]+?for \( int i \= (\d+)\; i < (\d+)\; i \+\+ \) \{([\s\S]+?)(?=\})\}/g;function el(e){return e.replace($u,tl)}function tl(e,t,r,n){var i="";for(var a=parseInt(t);a<parseInt(r);a++){i+=n.replace(/\[ i \]/g,"[ "+a+" ]").replace(/UNROLLED_LOOP_INDEX/g,a)}return i}function rl(e){var t="precision "+e.precision+" float;\nprecision "+e.precision+" int;";if(e.precision==="highp"){t+="\n#define HIGH_PRECISION"}else if(e.precision==="mediump"){t+="\n#define MEDIUM_PRECISION"}else if(e.precision==="lowp"){t+="\n#define LOW_PRECISION"}return t}function nl(e){var t="SHADOWMAP_TYPE_BASIC";if(e.shadowMapType===c){t="SHADOWMAP_TYPE_PCF"}else if(e.shadowMapType===h){t="SHADOWMAP_TYPE_PCF_SOFT"}else if(e.shadowMapType===I){t="SHADOWMAP_TYPE_VSM"}return t}function il(e,t){var r="ENVMAP_TYPE_CUBE";if(e.envMap){switch(t.envMap.mapping){case G:case V:r="ENVMAP_TYPE_CUBE";break;case Y:case Z:r="ENVMAP_TYPE_CUBE_UV";break;case W:case q:r="ENVMAP_TYPE_EQUIREC";break;case X:r="ENVMAP_TYPE_SPHERE";break}}return r}function al(e,t){var r="ENVMAP_MODE_REFLECTION";if(e.envMap){switch(t.envMap.mapping){case V:case q:r="ENVMAP_MODE_REFRACTION";break}}return r}function ol(e,t){var r="ENVMAP_BLENDING_MULTIPLY";if(e.envMap){switch(t.combine){case L:r="ENVMAP_BLENDING_MULTIPLY";break;case N:r="ENVMAP_BLENDING_MIX";break;case F:r="ENVMAP_BLENDING_ADD";break}}return r}function sl(e,t,r,n,i,a){var o=e.getContext();var s=n.defines;var u=i.vertexShader;var l=i.fragmentShader;var c=nl(a);var h=il(a,n);var f=al(a,n);var d=ol(a,n);var p=e.gammaFactor>0?e.gammaFactor:1;var v=a.isWebGL2?"":Vu(n.extensions,a,t);var m=Wu(s);var g=o.createProgram();var y,x;var b=e.getRenderTarget();var w=b&&b.isWebGLMultiviewRenderTarget?b.numViews:0;if(n.isRawShaderMaterial){y=[m].filter(Xu).join("\n");if(y.length>0){y+="\n"}x=[v,m].filter(Xu).join("\n");if(x.length>0){x+="\n"}}else{y=[rl(a),"#define SHADER_NAME "+i.name,m,a.instancing?"#define USE_INSTANCING":"",a.supportsVertexTextures?"#define VERTEX_TEXTURES":"","#define GAMMA_FACTOR "+p,"#define MAX_BONES "+a.maxBones,a.useFog&&a.fog?"#define USE_FOG":"",a.useFog&&a.fogExp2?"#define FOG_EXP2":"",a.map?"#define USE_MAP":"",a.envMap?"#define USE_ENVMAP":"",a.envMap?"#define "+f:"",a.lightMap?"#define USE_LIGHTMAP":"",a.aoMap?"#define USE_AOMAP":"",a.emissiveMap?"#define USE_EMISSIVEMAP":"",a.bumpMap?"#define USE_BUMPMAP":"",a.normalMap?"#define USE_NORMALMAP":"",a.normalMap&&a.objectSpaceNormalMap?"#define OBJECTSPACE_NORMALMAP":"",a.normalMap&&a.tangentSpaceNormalMap?"#define TANGENTSPACE_NORMALMAP":"",a.clearcoatNormalMap?"#define USE_CLEARCOAT_NORMALMAP":"",a.displacementMap&&a.supportsVertexTextures?"#define USE_DISPLACEMENTMAP":"",a.specularMap?"#define USE_SPECULARMAP":"",a.roughnessMap?"#define USE_ROUGHNESSMAP":"",a.metalnessMap?"#define USE_METALNESSMAP":"",a.alphaMap?"#define USE_ALPHAMAP":"",a.vertexTangents?"#define USE_TANGENT":"",a.vertexColors?"#define USE_COLOR":"",a.vertexUvs?"#define USE_UV":"",a.flatShading?"#define FLAT_SHADED":"",a.skinning?"#define USE_SKINNING":"",a.useVertexTexture?"#define BONE_TEXTURE":"",a.morphTargets?"#define USE_MORPHTARGETS":"",a.morphNormals&&a.flatShading===false?"#define USE_MORPHNORMALS":"",a.doubleSided?"#define DOUBLE_SIDED":"",a.flipSided?"#define FLIP_SIDED":"",a.shadowMapEnabled?"#define USE_SHADOWMAP":"",a.shadowMapEnabled?"#define "+c:"",a.sizeAttenuation?"#define USE_SIZEATTENUATION":"",a.logarithmicDepthBuffer?"#define USE_LOGDEPTHBUF":"",a.logarithmicDepthBuffer&&(a.isWebGL2||t.get("EXT_frag_depth"))?"#define USE_LOGDEPTHBUF_EXT":"","uniform mat4 modelMatrix;","uniform mat4 modelViewMatrix;","uniform mat4 projectionMatrix;","uniform mat4 viewMatrix;","uniform mat3 normalMatrix;","uniform vec3 cameraPosition;","#ifdef USE_INSTANCING"," attribute mat4 instanceMatrix;","#endif","attribute vec3 position;","attribute vec3 normal;","attribute vec2 uv;","#ifdef USE_TANGENT","\tattribute vec4 tangent;","#endif","#ifdef USE_COLOR","\tattribute vec3 color;","#endif","#ifdef USE_MORPHTARGETS","\tattribute vec3 morphTarget0;","\tattribute vec3 morphTarget1;","\tattribute vec3 morphTarget2;","\tattribute vec3 morphTarget3;","\t#ifdef USE_MORPHNORMALS","\t\tattribute vec3 morphNormal0;","\t\tattribute vec3 morphNormal1;","\t\tattribute vec3 morphNormal2;","\t\tattribute vec3 morphNormal3;","\t#else","\t\tattribute vec3 morphTarget4;","\t\tattribute vec3 morphTarget5;","\t\tattribute vec3 morphTarget6;","\t\tattribute vec3 morphTarget7;","\t#endif","#endif","#ifdef USE_SKINNING","\tattribute vec4 skinIndex;","\tattribute vec4 skinWeight;","#endif","\n"].filter(Xu).join("\n");x=[v,rl(a),"#define SHADER_NAME "+i.name,m,a.alphaTest?"#define ALPHATEST "+a.alphaTest+(a.alphaTest%1?"":".0"):"","#define GAMMA_FACTOR "+p,a.useFog&&a.fog?"#define USE_FOG":"",a.useFog&&a.fogExp2?"#define FOG_EXP2":"",a.map?"#define USE_MAP":"",a.matcap?"#define USE_MATCAP":"",a.envMap?"#define USE_ENVMAP":"",a.envMap?"#define "+h:"",a.envMap?"#define "+f:"",a.envMap?"#define "+d:"",a.lightMap?"#define USE_LIGHTMAP":"",a.aoMap?"#define USE_AOMAP":"",a.emissiveMap?"#define USE_EMISSIVEMAP":"",a.bumpMap?"#define USE_BUMPMAP":"",a.normalMap?"#define USE_NORMALMAP":"",a.normalMap&&a.objectSpaceNormalMap?"#define OBJECTSPACE_NORMALMAP":"",a.normalMap&&a.tangentSpaceNormalMap?"#define TANGENTSPACE_NORMALMAP":"",a.clearcoatNormalMap?"#define USE_CLEARCOAT_NORMALMAP":"",a.specularMap?"#define USE_SPECULARMAP":"",a.roughnessMap?"#define USE_ROUGHNESSMAP":"",a.metalnessMap?"#define USE_METALNESSMAP":"",a.alphaMap?"#define USE_ALPHAMAP":"",a.sheen?"#define USE_SHEEN":"",a.vertexTangents?"#define USE_TANGENT":"",a.vertexColors?"#define USE_COLOR":"",a.vertexUvs?"#define USE_UV":"",a.gradientMap?"#define USE_GRADIENTMAP":"",a.flatShading?"#define FLAT_SHADED":"",a.doubleSided?"#define DOUBLE_SIDED":"",a.flipSided?"#define FLIP_SIDED":"",a.shadowMapEnabled?"#define USE_SHADOWMAP":"",a.shadowMapEnabled?"#define "+c:"",a.premultipliedAlpha?"#define PREMULTIPLIED_ALPHA":"",a.physicallyCorrectLights?"#define PHYSICALLY_CORRECT_LIGHTS":"",a.logarithmicDepthBuffer?"#define USE_LOGDEPTHBUF":"",a.logarithmicDepthBuffer&&(a.isWebGL2||t.get("EXT_frag_depth"))?"#define USE_LOGDEPTHBUF_EXT":"",((n.extensions?n.extensions.shaderTextureLOD:false)||a.envMap)&&(a.isWebGL2||t.get("EXT_shader_texture_lod"))?"#define TEXTURE_LOD_EXT":"","uniform mat4 viewMatrix;","uniform vec3 cameraPosition;",a.toneMapping!==B?"#define TONE_MAPPING":"",a.toneMapping!==B?xs["tonemapping_pars_fragment"]:"",a.toneMapping!==B?Gu("toneMapping",a.toneMapping):"",a.dithering?"#define DITHERING":"",a.outputEncoding||a.mapEncoding||a.matcapEncoding||a.envMapEncoding||a.emissiveMapEncoding?xs["encodings_pars_fragment"]:"",a.mapEncoding?zu("mapTexelToLinear",a.mapEncoding):"",a.matcapEncoding?zu("matcapTexelToLinear",a.matcapEncoding):"",a.envMapEncoding?zu("envMapTexelToLinear",a.envMapEncoding):"",a.emissiveMapEncoding?zu("emissiveMapTexelToLinear",a.emissiveMapEncoding):"",a.outputEncoding?Hu("linearToOutputTexel",a.outputEncoding):"",a.depthPacking?"#define DEPTH_PACKING "+n.depthPacking:"","\n"].filter(Xu).join("\n")}u=Ku(u);u=Yu(u,a);u=Zu(u,a);l=Ku(l);l=Yu(l,a);l=Zu(l,a);u=el(u);l=el(l);if(a.isWebGL2&&!n.isRawShaderMaterial){var _=false;var T=/^\s*#version\s+300\s+es\s*\n/;if(n.isShaderMaterial&&u.match(T)!==null&&l.match(T)!==null){_=true;u=u.replace(T,"");l=l.replace(T,"")}y=["#version 300 es\n","#define attribute in","#define varying out","#define texture2D texture"].join("\n")+"\n"+y;x=["#version 300 es\n","#define varying in",_?"":"out highp vec4 pc_fragColor;",_?"":"#define gl_FragColor pc_fragColor","#define gl_FragDepthEXT gl_FragDepth","#define texture2D texture","#define textureCube texture","#define texture2DProj textureProj","#define texture2DLodEXT textureLod","#define texture2DProjLodEXT textureProjLod","#define textureCubeLodEXT textureLod","#define texture2DGradEXT textureGrad","#define texture2DProjGradEXT textureProjGrad","#define textureCubeGradEXT textureGrad"].join("\n")+"\n"+x;if(w>0){y=y.replace("#version 300 es\n",["#version 300 es\n","#extension GL_OVR_multiview2 : require","layout(num_views = "+w+") in;","#define VIEW_ID gl_ViewID_OVR"].join("\n"));y=y.replace(["uniform mat4 modelViewMatrix;","uniform mat4 projectionMatrix;","uniform mat4 viewMatrix;","uniform mat3 normalMatrix;"].join("\n"),["uniform mat4 modelViewMatrices["+w+"];","uniform mat4 projectionMatrices["+w+"];","uniform mat4 viewMatrices["+w+"];","uniform mat3 normalMatrices["+w+"];","#define modelViewMatrix modelViewMatrices[VIEW_ID]","#define projectionMatrix projectionMatrices[VIEW_ID]","#define viewMatrix viewMatrices[VIEW_ID]","#define normalMatrix normalMatrices[VIEW_ID]"].join("\n"));x=x.replace("#version 300 es\n",["#version 300 es\n","#extension GL_OVR_multiview2 : require","#define VIEW_ID gl_ViewID_OVR"].join("\n"));x=x.replace("uniform mat4 viewMatrix;",["uniform mat4 viewMatrices["+w+"];","#define viewMatrix viewMatrices[VIEW_ID]"].join("\n"))}}var E=y+u;var M=x+l;var S=Fu(o,35633,E);var A=Fu(o,35632,M);o.attachShader(g,S);o.attachShader(g,A);if(n.index0AttributeName!==undefined){o.bindAttribLocation(g,0,n.index0AttributeName)}else if(a.morphTargets===true){o.bindAttribLocation(g,0,"position")}o.linkProgram(g);if(e.debug.checkShaderErrors){var R=o.getProgramInfoLog(g).trim();var P=o.getShaderInfoLog(S).trim();var C=o.getShaderInfoLog(A).trim();var O=true;var L=true;if(o.getProgramParameter(g,35714)===false){O=false;var I=ju(o,S,"vertex");var D=ju(o,A,"fragment");console.error("THREE.WebGLProgram: shader error: ",o.getError(),"35715",o.getProgramParameter(g,35715),"gl.getProgramInfoLog",R,I,D)}else if(R!==""){console.warn("THREE.WebGLProgram: gl.getProgramInfoLog()",R)}else if(P===""||C===""){L=false}if(L){this.diagnostics={runnable:O,material:n,programLog:R,vertexShader:{log:P,prefix:y},fragmentShader:{log:C,prefix:x}}}}o.deleteShader(S);o.deleteShader(A);var N;this.getUniforms=function(){if(N===undefined){N=new Nu(o,g)}return N};var F;this.getAttributes=function(){if(F===undefined){F=qu(o,g)}return F};this.destroy=function(){o.deleteProgram(g);this.program=undefined};this.name=i.name;this.id=Bu++;this.code=r;this.usedTimes=1;this.program=g;this.vertexShader=S;this.fragmentShader=A;this.numMultiviewViews=w;return this}function ul(f,u,d){var l=[];var p={MeshDepthMaterial:"depth",MeshDistanceMaterial:"distanceRGBA",MeshNormalMaterial:"normal",MeshBasicMaterial:"basic",MeshLambertMaterial:"lambert",MeshPhongMaterial:"phong",MeshToonMaterial:"phong",MeshStandardMaterial:"physical",MeshPhysicalMaterial:"physical",MeshMatcapMaterial:"matcap",LineBasicMaterial:"basic",LineDashedMaterial:"dashed",PointsMaterial:"points",ShadowMaterial:"shadow",SpriteMaterial:"sprite"};var a=["precision","supportsVertexTextures","instancing","map","mapEncoding","matcap","matcapEncoding","envMap","envMapMode","envMapEncoding","lightMap","aoMap","emissiveMap","emissiveMapEncoding","bumpMap","normalMap","objectSpaceNormalMap","tangentSpaceNormalMap","clearcoatNormalMap","displacementMap","specularMap","roughnessMap","metalnessMap","gradientMap","alphaMap","combine","vertexColors","vertexTangents","fog","useFog","fogExp2","flatShading","sizeAttenuation","logarithmicDepthBuffer","skinning","maxBones","useVertexTexture","morphTargets","morphNormals","maxMorphTargets","maxMorphNormals","premultipliedAlpha","numDirLights","numPointLights","numSpotLights","numHemiLights","numRectAreaLights","shadowMapEnabled","shadowMapType","toneMapping","physicallyCorrectLights","alphaTest","doubleSided","flipSided","numClippingPlanes","numClipIntersection","depthPacking","dithering","sheen"];function v(e){var t=e.skeleton;var r=t.bones;if(d.floatVertexTextures){return 1024}else{var n=d.maxVertexUniforms;var i=Math.floor((n-20)/4);var a=Math.min(i,r.length);if(a<r.length){console.warn("THREE.WebGLRenderer: Skeleton has "+r.length+" bones. This GPU supports "+a+".");return 0}return a}}function m(e,t){var r;if(!e){r=Lt}else if(e.isTexture){r=e.encoding}else if(e.isWebGLRenderTarget){console.warn("THREE.WebGLPrograms.getTextureEncodingFromMap: don't use render targets as textures. Use their .texture property instead.");r=e.texture.encoding}if(r===Lt&&t){r=Dt}return r}this.getParameters=function(e,t,r,n,i,a,o){var s=p[e.type];var u=o.isSkinnedMesh?v(o):0;var l=d.precision;if(e.precision!==null){l=d.getMaxPrecision(e.precision);if(l!==e.precision){console.warn("THREE.WebGLProgram.getParameters:",e.precision,"not supported, using",l,"instead.")}}var c=f.getRenderTarget();var h={isWebGL2:d.isWebGL2,shaderID:s,precision:l,instancing:o.isInstancedMesh===true,supportsVertexTextures:d.vertexTextures,outputEncoding:m(!c?null:c.texture,f.gammaOutput),map:!!e.map,mapEncoding:m(e.map,f.gammaInput),matcap:!!e.matcap,matcapEncoding:m(e.matcap,f.gammaInput),envMap:!!e.envMap,envMapMode:e.envMap&&e.envMap.mapping,envMapEncoding:m(e.envMap,f.gammaInput),envMapCubeUV:!!e.envMap&&(e.envMap.mapping===Y||e.envMap.mapping===Z),lightMap:!!e.lightMap,aoMap:!!e.aoMap,emissiveMap:!!e.emissiveMap,emissiveMapEncoding:m(e.emissiveMap,f.gammaInput),bumpMap:!!e.bumpMap,normalMap:!!e.normalMap,objectSpaceNormalMap:e.normalMapType===Gt,tangentSpaceNormalMap:e.normalMapType===Ht,clearcoatNormalMap:!!e.clearcoatNormalMap,displacementMap:!!e.displacementMap,roughnessMap:!!e.roughnessMap,metalnessMap:!!e.metalnessMap,specularMap:!!e.specularMap,alphaMap:!!e.alphaMap,gradientMap:!!e.gradientMap,sheen:!!e.sheen,combine:e.combine,vertexTangents:e.normalMap&&e.vertexTangents,vertexColors:e.vertexColors,vertexUvs:!!e.map||!!e.bumpMap||!!e.normalMap||!!e.specularMap||!!e.alphaMap||!!e.emissiveMap||!!e.roughnessMap||!!e.metalnessMap||!!e.clearcoatNormalMap,fog:!!n,useFog:e.fog,fogExp2:n&&n.isFogExp2,flatShading:e.flatShading,sizeAttenuation:e.sizeAttenuation,logarithmicDepthBuffer:d.logarithmicDepthBuffer,skinning:e.skinning&&u>0,maxBones:u,useVertexTexture:d.floatVertexTextures,morphTargets:e.morphTargets,morphNormals:e.morphNormals,maxMorphTargets:f.maxMorphTargets,maxMorphNormals:f.maxMorphNormals,numDirLights:t.directional.length,numPointLights:t.point.length,numSpotLights:t.spot.length,numRectAreaLights:t.rectArea.length,numHemiLights:t.hemi.length,numDirLightShadows:t.directionalShadowMap.length,numPointLightShadows:t.pointShadowMap.length,numSpotLightShadows:t.spotShadowMap.length,numClippingPlanes:i,numClipIntersection:a,dithering:e.dithering,shadowMapEnabled:f.shadowMap.enabled&&r.length>0,shadowMapType:f.shadowMap.type,toneMapping:e.toneMapped?f.toneMapping:B,physicallyCorrectLights:f.physicallyCorrectLights,premultipliedAlpha:e.premultipliedAlpha,alphaTest:e.alphaTest,doubleSided:e.side===de,flipSided:e.side===ze,depthPacking:e.depthPacking!==undefined?e.depthPacking:false};return h};this.getProgramCode=function(e,t){var r=[];if(t.shaderID){r.push(t.shaderID)}else{r.push(e.fragmentShader);r.push(e.vertexShader)}if(e.defines!==undefined){for(var n in e.defines){r.push(n);r.push(e.defines[n])}}for(var i=0;i<a.length;i++){r.push(t[a[i]])}r.push(e.onBeforeCompile.toString());r.push(f.gammaOutput);r.push(f.gammaFactor);return r.join()};this.acquireProgram=function(e,t,r,n){var i;for(var a=0,o=l.length;a<o;a++){var s=l[a];if(s.code===n){i=s;++i.usedTimes;break}}if(i===undefined){i=new sl(f,u,n,e,t,r);l.push(i)}return i};this.releaseProgram=function(e){if(--e.usedTimes===0){var t=l.indexOf(e);l[t]=l[l.length-1];l.pop();e.destroy()}};this.programs=l}function ll(){var n=new WeakMap;function e(e){var t=n.get(e);if(t===undefined){t={};n.set(e,t)}return t}function t(e){n.delete(e)}function r(e,t,r){n.get(e)[t]=r}function i(){n=new WeakMap}return{get:e,remove:t,update:r,dispose:i}}function cl(e,t){if(e.groupOrder!==t.groupOrder){return e.groupOrder-t.groupOrder}else if(e.renderOrder!==t.renderOrder){return e.renderOrder-t.renderOrder}else if(e.program!==t.program){return e.program.id-t.program.id}else if(e.material.id!==t.material.id){return e.material.id-t.material.id}else if(e.z!==t.z){return e.z-t.z}else{return e.id-t.id}}function hl(e,t){if(e.groupOrder!==t.groupOrder){return e.groupOrder-t.groupOrder}else if(e.renderOrder!==t.renderOrder){return e.renderOrder-t.renderOrder}else if(e.z!==t.z){return t.z-e.z}else{return e.id-t.id}}function fl(){var s=[];var u=0;var l=[];var c=[];var h={id:-1};function e(){u=0;l.length=0;c.length=0}function f(e,t,r,n,i,a){var o=s[u];if(o===undefined){o={id:e.id,object:e,geometry:t,material:r,program:r.program||h,groupOrder:n,renderOrder:e.renderOrder,z:i,group:a};s[u]=o}else{o.id=e.id;o.object=e;o.geometry=t;o.material=r;o.program=r.program||h;o.groupOrder=n;o.renderOrder=e.renderOrder;o.z=i;o.group=a}u++;return o}function t(e,t,r,n,i,a){var o=f(e,t,r,n,i,a);(r.transparent===true?c:l).push(o)}function r(e,t,r,n,i,a){var o=f(e,t,r,n,i,a);(r.transparent===true?c:l).unshift(o)}function n(){if(l.length>1)l.sort(cl);if(c.length>1)c.sort(hl)}return{opaque:l,transparent:c,init:e,push:t,unshift:r,sort:n}}function dl(){var i=new WeakMap;function a(e){var t=e.target;t.removeEventListener("dispose",a);i.delete(t)}function e(e,t){var r=i.get(e);var n;if(r===undefined){n=new fl;i.set(e,new WeakMap);i.get(e).set(t,n);e.addEventListener("dispose",a)}else{n=r.get(t);if(n===undefined){n=new fl;r.set(t,n)}}return n}function t(){i=new WeakMap}return{get:e,dispose:t}}function pl(){var r={};return{get:function(e){if(r[e.id]!==undefined){return r[e.id]}var t;switch(e.type){case"DirectionalLight":t={direction:new pr,color:new Fn,shadow:false,shadowBias:0,shadowRadius:1,shadowMapSize:new cr};break;case"SpotLight":t={position:new pr,direction:new pr,color:new Fn,distance:0,coneCos:0,penumbraCos:0,decay:0,shadow:false,shadowBias:0,shadowRadius:1,shadowMapSize:new cr};break;case"PointLight":t={position:new pr,color:new Fn,distance:0,decay:0,shadow:false,shadowBias:0,shadowRadius:1,shadowMapSize:new cr,shadowCameraNear:1,shadowCameraFar:1e3};break;case"HemisphereLight":t={direction:new pr,skyColor:new Fn,groundColor:new Fn};break;case"RectAreaLight":t={color:new Fn,position:new pr,halfWidth:new pr,halfHeight:new pr};break}r[e.id]=t;return t}}}var vl=0;function ml(e,t){return(t.castShadow?1:0)-(e.castShadow?1:0)}function gl(){var S=new pl;var A={version:0,hash:{directionalLength:-1,pointLength:-1,spotLength:-1,rectAreaLength:-1,hemiLength:-1,numDirectionalShadows:-1,numPointShadows:-1,numSpotShadows:-1},ambient:[0,0,0],probe:[],directional:[],directionalShadowMap:[],directionalShadowMatrix:[],spot:[],spotShadowMap:[],spotShadowMatrix:[],rectArea:[],point:[],pointShadowMap:[],pointShadowMatrix:[],hemi:[],numDirectionalShadows:-1,numPointShadows:-1,numSpotShadows:-1};for(var e=0;e<9;e++)A.probe.push(new pr);var R=new pr;var P=new Or;var C=new Or;function t(e,t,r){var n=0,i=0,a=0;for(var o=0;o<9;o++)A.probe[o].set(0,0,0);var s=0;var u=0;var l=0;var c=0;var h=0;var f=0;var d=0;var p=0;var v=r.matrixWorldInverse;e.sort(ml);for(var o=0,m=e.length;o<m;o++){var g=e[o];var y=g.color;var x=g.intensity;var b=g.distance;var w=g.shadow&&g.shadow.map?g.shadow.map.texture:null;if(g.isAmbientLight){n+=y.r*x;i+=y.g*x;a+=y.b*x}else if(g.isLightProbe){for(var _=0;_<9;_++){A.probe[_].addScaledVector(g.sh.coefficients[_],x)}}else if(g.isDirectionalLight){var T=S.get(g);T.color.copy(g.color).multiplyScalar(g.intensity);T.direction.setFromMatrixPosition(g.matrixWorld);R.setFromMatrixPosition(g.target.matrixWorld);T.direction.sub(R);T.direction.transformDirection(v);T.shadow=g.castShadow;if(g.castShadow){var E=g.shadow;T.shadowBias=E.bias;T.shadowRadius=E.radius;T.shadowMapSize=E.mapSize;A.directionalShadowMap[s]=w;A.directionalShadowMatrix[s]=g.shadow.matrix;f++}A.directional[s]=T;s++}else if(g.isSpotLight){var T=S.get(g);T.position.setFromMatrixPosition(g.matrixWorld);T.position.applyMatrix4(v);T.color.copy(y).multiplyScalar(x);T.distance=b;T.direction.setFromMatrixPosition(g.matrixWorld);R.setFromMatrixPosition(g.target.matrixWorld);T.direction.sub(R);T.direction.transformDirection(v);T.coneCos=Math.cos(g.angle);T.penumbraCos=Math.cos(g.angle*(1-g.penumbra));T.decay=g.decay;T.shadow=g.castShadow;if(g.castShadow){var E=g.shadow;T.shadowBias=E.bias;T.shadowRadius=E.radius;T.shadowMapSize=E.mapSize;A.spotShadowMap[l]=w;A.spotShadowMatrix[l]=g.shadow.matrix;p++}A.spot[l]=T;l++}else if(g.isRectAreaLight){var T=S.get(g);T.color.copy(y).multiplyScalar(x);T.position.setFromMatrixPosition(g.matrixWorld);T.position.applyMatrix4(v);C.identity();P.copy(g.matrixWorld);P.premultiply(v);C.extractRotation(P);T.halfWidth.set(g.width*.5,0,0);T.halfHeight.set(0,g.height*.5,0);T.halfWidth.applyMatrix4(C);T.halfHeight.applyMatrix4(C);A.rectArea[c]=T;c++}else if(g.isPointLight){var T=S.get(g);T.position.setFromMatrixPosition(g.matrixWorld);T.position.applyMatrix4(v);T.color.copy(g.color).multiplyScalar(g.intensity);T.distance=g.distance;T.decay=g.decay;T.shadow=g.castShadow;if(g.castShadow){var E=g.shadow;T.shadowBias=E.bias;T.shadowRadius=E.radius;T.shadowMapSize=E.mapSize;T.shadowCameraNear=E.camera.near;T.shadowCameraFar=E.camera.far;A.pointShadowMap[u]=w;A.pointShadowMatrix[u]=g.shadow.matrix;d++}A.point[u]=T;u++}else if(g.isHemisphereLight){var T=S.get(g);T.direction.setFromMatrixPosition(g.matrixWorld);T.direction.transformDirection(v);T.direction.normalize();T.skyColor.copy(g.color).multiplyScalar(x);T.groundColor.copy(g.groundColor).multiplyScalar(x);A.hemi[h]=T;h++}}A.ambient[0]=n;A.ambient[1]=i;A.ambient[2]=a;var M=A.hash;if(M.directionalLength!==s||M.pointLength!==u||M.spotLength!==l||M.rectAreaLength!==c||M.hemiLength!==h||M.numDirectionalShadows!==f||M.numPointShadows!==d||M.numSpotShadows!==p){A.directional.length=s;A.spot.length=l;A.rectArea.length=c;A.point.length=u;A.hemi.length=h;A.directionalShadowMap.length=f;A.pointShadowMap.length=d;A.spotShadowMap.length=p;A.directionalShadowMatrix.length=f;A.pointShadowMatrix.length=d;A.spotShadowMatrix.length=p;M.directionalLength=s;M.pointLength=u;M.spotLength=l;M.rectAreaLength=c;M.hemiLength=h;M.numDirectionalShadows=f;M.numPointShadows=d;M.numSpotShadows=p;A.version=vl++}}return{setup:t,state:A}}function yl(){var t=new gl;var r=[];var n=[];function e(){r.length=0;n.length=0}function i(e){r.push(e)}function a(e){n.push(e)}function o(e){t.setup(r,n,e)}var s={lightsArray:r,shadowsArray:n,lights:t};return{init:e,state:s,setupLights:o,pushLight:i,pushShadow:a}}function xl(){var n=new WeakMap;function i(e){var t=e.target;t.removeEventListener("dispose",i);n.delete(t)}function e(e,t){var r;if(n.has(e)===false){r=new yl;n.set(e,new WeakMap);n.get(e).set(t,r);e.addEventListener("dispose",i)}else{if(n.get(e).has(t)===false){r=new yl;n.get(e).set(t,r)}else{r=n.get(e).get(t)}}return r}function t(){n=new WeakMap}return{get:e,dispose:t}}function bl(e){Hn.call(this);this.type="MeshDepthMaterial";this.depthPacking=jt;this.skinning=false;this.morphTargets=false;this.map=null;this.alphaMap=null;this.displacementMap=null;this.displacementScale=1;this.displacementBias=0;this.wireframe=false;this.wireframeLinewidth=1;this.fog=false;this.setValues(e)}bl.prototype=Object.create(Hn.prototype);bl.prototype.constructor=bl;bl.prototype.isMeshDepthMaterial=true;bl.prototype.copy=function(e){Hn.prototype.copy.call(this,e);this.depthPacking=e.depthPacking;this.skinning=e.skinning;this.morphTargets=e.morphTargets;this.map=e.map;this.alphaMap=e.alphaMap;this.displacementMap=e.displacementMap;this.displacementScale=e.displacementScale;this.displacementBias=e.displacementBias;this.wireframe=e.wireframe;this.wireframeLinewidth=e.wireframeLinewidth;return this};function wl(e){Hn.call(this);this.type="MeshDistanceMaterial";this.referencePosition=new pr;this.nearDistance=1;this.farDistance=1e3;this.skinning=false;this.morphTargets=false;this.map=null;this.alphaMap=null;this.displacementMap=null;this.displacementScale=1;this.displacementBias=0;this.fog=false;this.setValues(e)}wl.prototype=Object.create(Hn.prototype);wl.prototype.constructor=wl;wl.prototype.isMeshDistanceMaterial=true;wl.prototype.copy=function(e){Hn.prototype.copy.call(this,e);this.referencePosition.copy(e.referencePosition);this.nearDistance=e.nearDistance;this.farDistance=e.farDistance;this.skinning=e.skinning;this.morphTargets=e.morphTargets;this.map=e.map;this.alphaMap=e.alphaMap;this.displacementMap=e.displacementMap;this.displacementScale=e.displacementScale;this.displacementBias=e.displacementBias;return this};var _l="uniform sampler2D shadow_pass;\nuniform vec2 resolution;\nuniform float radius;\n#include <packing>\nvoid main() {\n  float mean = 0.0;\n  float squared_mean = 0.0;\n  \n\tfloat depth = unpackRGBAToDepth( texture2D( shadow_pass, ( gl_FragCoord.xy  ) / resolution ) );\n  for ( float i = -1.0; i < 1.0 ; i += SAMPLE_RATE) {\n    #ifdef HORIZONAL_PASS\n      vec2 distribution = decodeHalfRGBA ( texture2D( shadow_pass, ( gl_FragCoord.xy + vec2( i, 0.0 ) * radius ) / resolution ) );\n      mean += distribution.x;\n      squared_mean += distribution.y * distribution.y + distribution.x * distribution.x;\n    #else\n      float depth = unpackRGBAToDepth( texture2D( shadow_pass, ( gl_FragCoord.xy + vec2( 0.0,  i )  * radius ) / resolution ) );\n      mean += depth;\n      squared_mean += depth * depth;\n    #endif\n  }\n  mean = mean * HALF_SAMPLE_RATE;\n  squared_mean = squared_mean * HALF_SAMPLE_RATE;\n  float std_dev = pow( squared_mean - mean * mean, 0.5 );\n  gl_FragColor = encodeHalfRGBA( vec2( mean, std_dev ) );\n}";var Tl="void main() {\n\tgl_Position = vec4( position, 1.0 );\n}";function El(g,y,m){var x=new ra,b=new cr,w=new cr,_=new wr,T=1,E=2,e=(T|E)+1,M=new Array(e),S=new Array(e),A={};var R={0:ze,1:D,2:de};var n=new Hi({defines:{SAMPLE_RATE:2/8,HALF_SAMPLE_RATE:1/8},uniforms:{shadow_pass:{value:null},resolution:{value:new cr},radius:{value:4}},vertexShader:Tl,fragmentShader:_l});var i=n.clone();i.defines.HORIZONAL_PASS=1;var t=new li;t.addAttribute("position",new Vn(new Float32Array([-1,-1,.5,3,-1,.5,-1,3,.5]),3));var a=new Ai(t,n);for(var r=0;r!==e;++r){var o=(r&T)!==0;var s=(r&E)!==0;var u=new bl({depthPacking:zt,morphTargets:o,skinning:s});M[r]=u;var l=new wl({morphTargets:o,skinning:s});S[r]=l}var P=this;this.enabled=false;this.autoUpdate=true;this.needsUpdate=false;this.type=c;this.render=function(e,t,r){if(P.enabled===false)return;if(P.autoUpdate===false&&P.needsUpdate===false)return;if(e.length===0)return;var n=g.getRenderTarget();var i=g.getActiveCubeFace();var a=g.getActiveMipmapLevel();var o=g.state;o.setBlending(pe);o.buffers.color.setClear(1,1,1,1);o.buffers.depth.setTest(true);o.setScissorTest(false);for(var s=0,u=e.length;s<u;s++){var l=e[s];var c=l.shadow;if(c===undefined){console.warn("THREE.WebGLShadowMap:",l,"has no shadow.");continue}b.copy(c.mapSize);var h=c.getFrameExtents();b.multiply(h);w.copy(c.mapSize);if(b.x>m||b.y>m){console.warn("THREE.WebGLShadowMap:",l,"has shadow exceeding max texture size, reducing");if(b.x>m){w.x=Math.floor(m/h.x);b.x=w.x*h.x;c.mapSize.x=w.x}if(b.y>m){w.y=Math.floor(m/h.y);b.y=w.y*h.y;c.mapSize.y=w.y}}if(c.map===null&&!c.isPointLightShadow&&this.type===I){var f={minFilter:ie,magFilter:ie,format:qe};c.map=new _r(b.x,b.y,f);c.map.texture.name=l.name+".shadowMap";c.mapPass=new _r(b.x,b.y,f);c.camera.updateProjectionMatrix()}if(c.map===null){var f={minFilter:$,magFilter:$,format:qe};c.map=new _r(b.x,b.y,f);c.map.texture.name=l.name+".shadowMap";c.camera.updateProjectionMatrix()}g.setRenderTarget(c.map);g.clear();var d=c.getViewportCount();for(var p=0;p<d;p++){var v=c.getViewport(p);_.set(w.x*v.x,w.y*v.y,w.x*v.z,w.y*v.w);o.viewport(_);c.updateMatrices(l,r,p);x=c.getFrustum();L(t,r,c.camera,l,this.type)}if(!c.isPointLightShadow&&this.type===I){C(c,r)}}P.needsUpdate=false;g.setRenderTarget(n,i,a)};function C(e,t){var r=y.update(a);n.uniforms.shadow_pass.value=e.map.texture;n.uniforms.resolution.value=e.mapSize;n.uniforms.radius.value=e.radius;g.setRenderTarget(e.mapPass);g.clear();g.renderBufferDirect(t,null,r,n,a,null);i.uniforms.shadow_pass.value=e.mapPass.texture;i.uniforms.resolution.value=e.mapSize;i.uniforms.radius.value=e.radius;g.setRenderTarget(e.map);g.clear();g.renderBufferDirect(t,null,r,i,a,null)}function O(e,t,r,n,i,a){var o=e.geometry;var s=null;var u=M;var l=e.customDepthMaterial;if(r.isPointLight){u=S;l=e.customDistanceMaterial}if(!l){var c=false;if(t.morphTargets){if(o&&o.isBufferGeometry){c=o.morphAttributes&&o.morphAttributes.position&&o.morphAttributes.position.length>0}else if(o&&o.isGeometry){c=o.morphTargets&&o.morphTargets.length>0}}if(e.isSkinnedMesh&&t.skinning===false){console.warn("THREE.WebGLShadowMap: THREE.SkinnedMesh with material.skinning set to false:",e)}var h=e.isSkinnedMesh&&t.skinning;var f=0;if(c)f|=T;if(h)f|=E;s=u[f]}else{s=l}if(g.localClippingEnabled&&t.clipShadows===true&&t.clippingPlanes.length!==0){var d=s.uuid,p=t.uuid;var v=A[d];if(v===undefined){v={};A[d]=v}var m=v[p];if(m===undefined){m=s.clone();v[p]=m}s=m}s.visible=t.visible;s.wireframe=t.wireframe;if(a===I){s.side=t.shadowSide!=null?t.shadowSide:t.side}else{s.side=t.shadowSide!=null?t.shadowSide:R[t.side]}s.clipShadows=t.clipShadows;s.clippingPlanes=t.clippingPlanes;s.clipIntersection=t.clipIntersection;s.wireframeLinewidth=t.wireframeLinewidth;s.linewidth=t.linewidth;if(r.isPointLight&&s.isMeshDistanceMaterial){s.referencePosition.setFromMatrixPosition(r.matrixWorld);s.nearDistance=n;s.farDistance=i}return s}function L(e,t,r,n,i){if(e.visible===false)return;var a=e.layers.test(t.layers);if(a&&(e.isMesh||e.isLine||e.isPoints)){if((e.castShadow||e.receiveShadow&&i===I)&&(!e.frustumCulled||x.intersectsObject(e))){e.modelViewMatrix.multiplyMatrices(r.matrixWorldInverse,e.matrixWorld);var o=y.update(e);var s=e.material;if(Array.isArray(s)){var u=o.groups;for(var l=0,c=u.length;l<c;l++){var h=u[l];var f=s[h.materialIndex];if(f&&f.visible){var d=O(e,f,n,r.near,r.far,i);g.renderBufferDirect(r,null,o,d,e,h)}}}else if(s.visible){var d=O(e,s,n,r.near,r.far,i);g.renderBufferDirect(r,null,o,d,e,null)}}}var p=e.children;for(var v=0,m=p.length;v<m;v++){L(p[v],t,r,n,i)}}}function Ml(c,n,u,i){function e(){var t=false;var a=new wr;var r=null;var o=new wr(0,0,0,0);return{setMask:function(e){if(r!==e&&!t){c.colorMask(e,e,e,e);r=e}},setLocked:function(e){t=e},setClear:function(e,t,r,n,i){if(i===true){e*=n;t*=n;r*=n}a.set(e,t,r,n);if(o.equals(a)===false){c.clearColor(e,t,r,n);o.copy(a)}},reset:function(){t=false;r=null;o.set(-1,0,0,0)}}}function t(){var t=false;var r=null;var n=null;var i=null;return{setTest:function(e){if(e){W(2929)}else{q(2929)}},setMask:function(e){if(r!==e&&!t){c.depthMask(e);r=e}},setFunc:function(e){if(n!==e){if(e){switch(e){case we:c.depthFunc(512);break;case _e:c.depthFunc(519);break;case Te:c.depthFunc(513);break;case Ee:c.depthFunc(515);break;case Me:c.depthFunc(514);break;case Se:c.depthFunc(518);break;case Ae:c.depthFunc(516);break;case Re:c.depthFunc(517);break;default:c.depthFunc(515)}}else{c.depthFunc(515)}n=e}},setLocked:function(e){t=e},setClear:function(e){if(i!==e){c.clearDepth(e);i=e}},reset:function(){t=false;r=null;n=null;i=null}}}function r(){var t=false;var r=null;var n=null;var i=null;var a=null;var o=null;var s=null;var u=null;var l=null;return{setTest:function(e){if(!t){if(e){W(2960)}else{q(2960)}}},setMask:function(e){if(r!==e&&!t){c.stencilMask(e);r=e}},setFunc:function(e,t,r){if(n!==e||i!==t||a!==r){c.stencilFunc(e,t,r);n=e;i=t;a=r}},setOp:function(e,t,r){if(o!==e||s!==t||u!==r){c.stencilOp(e,t,r);o=e;s=t;u=r}},setLocked:function(e){t=e},setClear:function(e){if(l!==e){c.clearStencil(e);l=e}},reset:function(){t=false;r=null;n=null;i=null;a=null;o=null;s=null;u=null;l=null}}}var a=new e;var o=new t;var s=new r;var l=c.getParameter(34921);var h=new Uint8Array(l);var f=new Uint8Array(l);var d=new Uint8Array(l);var p={};var v=null;var m=null;var g=null;var y=null;var x=null;var b=null;var w=null;var _=null;var T=null;var E=null;var M=false;var S=null;var A=null;var R=null;var P=null;var C=null;var O=c.getParameter(35661);var L=false;var I=0;var D=c.getParameter(7938);if(D.indexOf("WebGL")!==-1){I=parseFloat(/^WebGL\ ([0-9])/.exec(D)[1]);L=I>=1}else if(D.indexOf("OpenGL ES")!==-1){I=parseFloat(/^OpenGL\ ES\ ([0-9])/.exec(D)[1]);L=I>=2}var N=null;var F={};var B=new wr;var U=new wr;function k(e,t,r){var n=new Uint8Array(4);var i=c.createTexture();c.bindTexture(e,i);c.texParameteri(e,10241,9728);c.texParameteri(e,10240,9728);for(var a=0;a<r;a++){c.texImage2D(t+a,0,6408,1,1,0,6408,5121,n)}return i}var j={};j[3553]=k(3553,3553,1);j[34067]=k(34067,34069,6);a.setClear(0,0,0,1);o.setClear(1);s.setClear(0);W(2929);o.setFunc(Ee);K(false);Q(he);W(2884);Z(pe);function z(){for(var e=0,t=h.length;e<t;e++){h[e]=0}}function H(e){G(e,0)}function G(e,t){h[e]=1;if(f[e]===0){c.enableVertexAttribArray(e);f[e]=1}if(d[e]!==t){var r=i.isWebGL2?c:n.get("ANGLE_instanced_arrays");r[i.isWebGL2?"vertexAttribDivisor":"vertexAttribDivisorANGLE"](e,t);d[e]=t}}function V(){for(var e=0,t=f.length;e!==t;++e){if(f[e]!==h[e]){c.disableVertexAttribArray(e);f[e]=0}}}function W(e){if(p[e]!==true){c.enable(e);p[e]=true}}function q(e){if(p[e]!==false){c.disable(e);p[e]=false}}function X(){if(v===null){v=[];if(n.get("WEBGL_compressed_texture_pvrtc")||n.get("WEBGL_compressed_texture_s3tc")||n.get("WEBGL_compressed_texture_etc1")||n.get("WEBGL_compressed_texture_astc")){var e=c.getParameter(34467);for(var t=0;t<e.length;t++){v.push(e[t])}}}return v}function Y(e){if(m!==e){c.useProgram(e);m=e;return true}return false}function Z(e,t,r,n,i,a,o,s){if(e===pe){if(g){q(3042);g=false}return}if(!g){W(3042);g=true}if(e!==xe){if(e!==y||s!==M){if(x!==be||_!==be){c.blendEquation(32774);x=be;_=be}if(s){switch(e){case ve:c.blendFuncSeparate(1,771,1,771);break;case me:c.blendFunc(1,1);break;case ge:c.blendFuncSeparate(0,0,769,771);break;case ye:c.blendFuncSeparate(0,768,0,770);break;default:console.error("THREE.WebGLState: Invalid blending: ",e);break}}else{switch(e){case ve:c.blendFuncSeparate(770,771,1,771);break;case me:c.blendFunc(770,1);break;case ge:c.blendFunc(0,769);break;case ye:c.blendFunc(0,768);break;default:console.error("THREE.WebGLState: Invalid blending: ",e);break}}b=null;w=null;T=null;E=null;y=e;M=s}return}i=i||t;a=a||r;o=o||n;if(t!==x||i!==_){c.blendEquationSeparate(u.convert(t),u.convert(i));x=t;_=i}if(r!==b||n!==w||a!==T||o!==E){c.blendFuncSeparate(u.convert(r),u.convert(n),u.convert(a),u.convert(o));b=r;w=n;T=a;E=o}y=e;M=null}function J(e,t){e.side===de?q(2884):W(2884);var r=e.side===ze;if(t)r=!r;K(r);e.blending===ve&&e.transparent===false?Z(pe):Z(e.blending,e.blendEquation,e.blendSrc,e.blendDst,e.blendEquationAlpha,e.blendSrcAlpha,e.blendDstAlpha,e.premultipliedAlpha);o.setFunc(e.depthFunc);o.setTest(e.depthTest);o.setMask(e.depthWrite);a.setMask(e.colorWrite);var n=e.stencilWrite;s.setTest(n);if(n){s.setMask(e.stencilWriteMask);s.setFunc(e.stencilFunc,e.stencilRef,e.stencilFuncMask);s.setOp(e.stencilFail,e.stencilZFail,e.stencilZPass)}ee(e.polygonOffset,e.polygonOffsetFactor,e.polygonOffsetUnits)}function K(e){if(S!==e){if(e){c.frontFace(2304)}else{c.frontFace(2305)}S=e}}function Q(e){if(e!==ce){W(2884);if(e!==A){if(e===he){c.cullFace(1029)}else if(e===fe){c.cullFace(1028)}else{c.cullFace(1032)}}}else{q(2884)}A=e}function $(e){if(e!==R){if(L)c.lineWidth(e);R=e}}function ee(e,t,r){if(e){W(32823);if(P!==t||C!==r){c.polygonOffset(t,r);P=t;C=r}}else{q(32823)}}function te(e){if(e){W(3089)}else{q(3089)}}function re(e){if(e===undefined)e=33984+O-1;if(N!==e){c.activeTexture(e);N=e}}function ne(e,t){if(N===null){re()}var r=F[N];if(r===undefined){r={type:undefined,texture:undefined};F[N]=r}if(r.type!==e||r.texture!==t){c.bindTexture(e,t||j[e]);r.type=e;r.texture=t}}function ie(){try{c.compressedTexImage2D.apply(c,arguments)}catch(e){console.error("THREE.WebGLState:",e)}}function ae(){try{c.texImage2D.apply(c,arguments)}catch(e){console.error("THREE.WebGLState:",e)}}function oe(){try{c.texImage3D.apply(c,arguments)}catch(e){console.error("THREE.WebGLState:",e)}}function se(e){if(B.equals(e)===false){c.scissor(e.x,e.y,e.z,e.w);B.copy(e)}}function ue(e){if(U.equals(e)===false){c.viewport(e.x,e.y,e.z,e.w);U.copy(e)}}function le(){for(var e=0;e<f.length;e++){if(f[e]===1){c.disableVertexAttribArray(e);f[e]=0}}p={};v=null;N=null;F={};m=null;y=null;S=null;A=null;a.reset();o.reset();s.reset()}return{buffers:{color:a,depth:o,stencil:s},initAttributes:z,enableAttribute:H,enableAttributeAndDivisor:G,disableUnusedAttributes:V,enable:W,disable:q,getCompressedTextureFormats:X,useProgram:Y,setBlending:Z,setMaterial:J,setFlipSided:K,setCullFace:Q,setLineWidth:$,setPolygonOffset:ee,setScissorTest:te,activeTexture:re,bindTexture:ne,compressedTexImage2D:ie,texImage2D:ae,texImage3D:oe,scissor:se,viewport:ue,reset:le}}function Sl(x,b,w,_,T,E,M){var r=new WeakMap;var c;var n=typeof OffscreenCanvas!=="undefined"&&new OffscreenCanvas(1,1).getContext("2d")!==null;function h(e,t){return n?new OffscreenCanvas(e,t):document.createElementNS("http://www.w3.org/1999/xhtml","canvas")}function m(e,t,r,n){var i=1;if(e.width>n||e.height>n){i=n/Math.max(e.width,e.height)}if(i<1||t===true){if(typeof HTMLImageElement!=="undefined"&&e instanceof HTMLImageElement||typeof HTMLCanvasElement!=="undefined"&&e instanceof HTMLCanvasElement||typeof ImageBitmap!=="undefined"&&e instanceof ImageBitmap){var a=t?lr.floorPowerOfTwo:Math.floor;var o=a(i*e.width);var s=a(i*e.height);if(c===undefined)c=h(o,s);var u=r?h(o,s):c;u.width=o;u.height=s;var l=u.getContext("2d");l.drawImage(e,0,0,o,s);console.warn("THREE.WebGLRenderer: Texture has been resized from ("+e.width+"x"+e.height+") to ("+o+"x"+s+").");return u}else{if("data"in e){console.warn("THREE.WebGLRenderer: Image in DataTexture is too big ("+e.width+"x"+e.height+").")}return e}}return e}function S(e){return lr.isPowerOfTwo(e.width)&&lr.isPowerOfTwo(e.height)}function p(e){if(T.isWebGL2)return false;return e.wrapS!==K||e.wrapT!==K||e.minFilter!==$&&e.minFilter!==ie}function A(e,t){return e.generateMipmaps&&t&&e.minFilter!==$&&e.minFilter!==ie}function R(e,t,r,n){x.generateMipmap(e);var i=_.get(t);i.__maxMipLevel=Math.log(Math.max(r,n))*Math.LOG2E}function P(e,t){if(!T.isWebGL2)return e;var r=e;if(e===6403){if(t===5126)r=33326;if(t===5131)r=33325;if(t===5121)r=33321}if(e===6407){if(t===5126)r=34837;if(t===5131)r=34843;if(t===5121)r=32849}if(e===6408){if(t===5126)r=34836;if(t===5131)r=34842;if(t===5121)r=32856}if(r===33325||r===33326||r===34842||r===34836){b.get("EXT_color_buffer_float")}else if(r===34843||r===34837){console.warn("THREE.WebGLRenderer: Floating point textures with RGB format not supported. Please use RGBA instead.")}return r}function i(e){if(e===$||e===ee||e===re){return 9728}return 9729}function a(e){var t=e.target;t.removeEventListener("dispose",a);o(t);if(t.isVideoTexture){r.delete(t)}M.memory.textures--}function C(e){var t=e.target;t.removeEventListener("dispose",C);s(t);M.memory.textures--}function o(e){var t=_.get(e);if(t.__webglInit===undefined)return;x.deleteTexture(t.__webglTexture);_.remove(e)}function s(e){var t=_.get(e);var r=_.get(e.texture);if(!e)return;if(r.__webglTexture!==undefined){x.deleteTexture(r.__webglTexture)}if(e.depthTexture){e.depthTexture.dispose()}if(e.isWebGLRenderTargetCube){for(var n=0;n<6;n++){x.deleteFramebuffer(t.__webglFramebuffer[n]);if(t.__webglDepthbuffer)x.deleteRenderbuffer(t.__webglDepthbuffer[n])}}else{x.deleteFramebuffer(t.__webglFramebuffer);if(t.__webglDepthbuffer)x.deleteRenderbuffer(t.__webglDepthbuffer)}if(e.isWebGLMultiviewRenderTarget){x.deleteTexture(t.__webglColorTexture);x.deleteTexture(t.__webglDepthStencilTexture);M.memory.textures-=2;for(var n=0,i=t.__webglViewFramebuffers.length;n<i;n++){x.deleteFramebuffer(t.__webglViewFramebuffers[n])}}_.remove(e.texture);_.remove(e)}var t=0;function e(){t=0}function u(){var e=t;if(e>=T.maxTextures){console.warn("THREE.WebGLTextures: Trying to use "+e+" texture units while this GPU supports only "+T.maxTextures)}t+=1;return e}function l(e,t){var r=_.get(e);if(e.isVideoTexture)z(e);if(e.version>0&&r.__version!==e.version){var n=e.image;if(n===undefined){console.warn("THREE.WebGLRenderer: Texture marked for update but image is undefined")}else if(n.complete===false){console.warn("THREE.WebGLRenderer: Texture marked for update but image is incomplete")}else{L(r,e,t);return}}w.activeTexture(33984+t);w.bindTexture(3553,r.__webglTexture)}function f(e,t){var r=_.get(e);if(e.version>0&&r.__version!==e.version){L(r,e,t);return}w.activeTexture(33984+t);w.bindTexture(35866,r.__webglTexture)}function d(e,t){var r=_.get(e);if(e.version>0&&r.__version!==e.version){L(r,e,t);return}w.activeTexture(33984+t);w.bindTexture(32879,r.__webglTexture)}function v(e,t){if(e.image.length!==6)return;var r=_.get(e);if(e.version>0&&r.__version!==e.version){y(r,e);w.activeTexture(33984+t);w.bindTexture(34067,r.__webglTexture);x.pixelStorei(37440,e.flipY);var n=e&&e.isCompressedTexture;var i=e.image[0]&&e.image[0].isDataTexture;var a=[];for(var o=0;o<6;o++){if(!n&&!i){a[o]=m(e.image[o],false,true,T.maxCubemapSize)}else{a[o]=i?e.image[o].image:e.image[o]}}var s=a[0],u=S(s)||T.isWebGL2,l=E.convert(e.format),c=E.convert(e.type),h=P(l,c);O(34067,e,u);var f;if(n){for(var o=0;o<6;o++){f=a[o].mipmaps;for(var d=0;d<f.length;d++){var p=f[d];if(e.format!==qe&&e.format!==Ue){if(w.getCompressedTextureFormats().indexOf(l)>-1){w.compressedTexImage2D(34069+o,d,h,p.width,p.height,0,p.data)}else{console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .setTextureCube()")}}else{w.texImage2D(34069+o,d,h,p.width,p.height,0,l,c,p.data)}}}r.__maxMipLevel=f.length-1}else{f=e.mipmaps;for(var o=0;o<6;o++){if(i){w.texImage2D(34069+o,0,h,a[o].width,a[o].height,0,l,c,a[o].data);for(var d=0;d<f.length;d++){var p=f[d];var v=p.image[o].image;w.texImage2D(34069+o,d+1,h,v.width,v.height,0,l,c,v.data)}}else{w.texImage2D(34069+o,0,h,l,c,a[o]);for(var d=0;d<f.length;d++){var p=f[d];w.texImage2D(34069+o,d+1,h,l,c,p.image[o])}}}r.__maxMipLevel=f.length}if(A(e,u)){R(34067,e,s.width,s.height)}r.__version=e.version;if(e.onUpdate)e.onUpdate(e)}else{w.activeTexture(33984+t);w.bindTexture(34067,r.__webglTexture)}}function g(e,t){w.activeTexture(33984+t);w.bindTexture(34067,_.get(e).__webglTexture)}function O(e,t,r){var n;if(r){x.texParameteri(e,10242,E.convert(t.wrapS));x.texParameteri(e,10243,E.convert(t.wrapT));if(e===32879||e===35866){x.texParameteri(e,32882,E.convert(t.wrapR))}x.texParameteri(e,10240,E.convert(t.magFilter));x.texParameteri(e,10241,E.convert(t.minFilter))}else{x.texParameteri(e,10242,33071);x.texParameteri(e,10243,33071);if(e===32879||e===35866){x.texParameteri(e,32882,33071)}if(t.wrapS!==K||t.wrapT!==K){console.warn("THREE.WebGLRenderer: Texture is not power of two. Texture.wrapS and Texture.wrapT should be set to THREE.ClampToEdgeWrapping.")}x.texParameteri(e,10240,i(t.magFilter));x.texParameteri(e,10241,i(t.minFilter));if(t.minFilter!==$&&t.minFilter!==ie){console.warn("THREE.WebGLRenderer: Texture is not power of two. Texture.minFilter should be set to THREE.NearestFilter or THREE.LinearFilter.")}}n=b.get("EXT_texture_filter_anisotropic");if(n){if(t.type===Ve&&b.get("OES_texture_float_linear")===null)return;if(t.type===We&&(T.isWebGL2||b.get("OES_texture_half_float_linear"))===null)return;if(t.anisotropy>1||_.get(t).__currentAnisotropy){x.texParameterf(e,n.TEXTURE_MAX_ANISOTROPY_EXT,Math.min(t.anisotropy,T.getMaxAnisotropy()));_.get(t).__currentAnisotropy=t.anisotropy}}}function y(e,t){if(e.__webglInit===undefined){e.__webglInit=true;t.addEventListener("dispose",a);e.__webglTexture=x.createTexture();M.memory.textures++}}function L(e,t,r){var n=3553;if(t.isDataTexture2DArray)n=35866;if(t.isDataTexture3D)n=32879;y(e,t);w.activeTexture(33984+r);w.bindTexture(n,e.__webglTexture);x.pixelStorei(37440,t.flipY);x.pixelStorei(37441,t.premultiplyAlpha);x.pixelStorei(3317,t.unpackAlignment);var i=p(t)&&S(t.image)===false;var a=m(t.image,i,false,T.maxTextureSize);var o=S(a)||T.isWebGL2,s=E.convert(t.format),u=E.convert(t.type),l=P(s,u);O(n,t,o);var c,h=t.mipmaps;if(t.isDepthTexture){l=6402;if(t.type===Ve){if(!T.isWebGL2)throw new Error("Float Depth Texture only supported in WebGL2.0");l=36012}else if(T.isWebGL2){l=33189}if(t.format===Ye&&l===6402){if(t.type!==Ce&&t.type!==Le){console.warn("THREE.WebGLRenderer: Use UnsignedShortType or UnsignedIntType for DepthFormat DepthTexture.");t.type=Ce;u=E.convert(t.type)}}if(t.format===Ze){l=34041;if(t.type!==Fe){console.warn("THREE.WebGLRenderer: Use UnsignedInt248Type for DepthStencilFormat DepthTexture.");t.type=Fe;u=E.convert(t.type)}}w.texImage2D(3553,0,l,a.width,a.height,0,s,u,null)}else if(t.isDataTexture){if(h.length>0&&o){for(var f=0,d=h.length;f<d;f++){c=h[f];w.texImage2D(3553,f,l,c.width,c.height,0,s,u,c.data)}t.generateMipmaps=false;e.__maxMipLevel=h.length-1}else{w.texImage2D(3553,0,l,a.width,a.height,0,s,u,a.data);e.__maxMipLevel=0}}else if(t.isCompressedTexture){for(var f=0,d=h.length;f<d;f++){c=h[f];if(t.format!==qe&&t.format!==Ue){if(w.getCompressedTextureFormats().indexOf(s)>-1){w.compressedTexImage2D(3553,f,l,c.width,c.height,0,c.data)}else{console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .uploadTexture()")}}else{w.texImage2D(3553,f,l,c.width,c.height,0,s,u,c.data)}}e.__maxMipLevel=h.length-1}else if(t.isDataTexture2DArray){w.texImage3D(35866,0,l,a.width,a.height,a.depth,0,s,u,a.data);e.__maxMipLevel=0}else if(t.isDataTexture3D){w.texImage3D(32879,0,l,a.width,a.height,a.depth,0,s,u,a.data);e.__maxMipLevel=0}else{if(h.length>0&&o){for(var f=0,d=h.length;f<d;f++){c=h[f];w.texImage2D(3553,f,l,s,u,c)}t.generateMipmaps=false;e.__maxMipLevel=h.length-1}else{w.texImage2D(3553,0,l,s,u,a);e.__maxMipLevel=0}}if(A(t,o)){R(3553,t,a.width,a.height)}e.__version=t.version;if(t.onUpdate)t.onUpdate(t)}function I(e,t,r,n){var i=E.convert(t.texture.format);var a=E.convert(t.texture.type);var o=P(i,a);w.texImage2D(n,0,o,t.width,t.height,0,i,a,null);x.bindFramebuffer(36160,e);x.framebufferTexture2D(36160,r,n,_.get(t.texture).__webglTexture,0);x.bindFramebuffer(36160,null)}function D(e,t,r){x.bindRenderbuffer(36161,e);if(t.depthBuffer&&!t.stencilBuffer){if(r){var n=j(t);x.renderbufferStorageMultisample(36161,n,33189,t.width,t.height)}else{x.renderbufferStorage(36161,33189,t.width,t.height)}x.framebufferRenderbuffer(36160,36096,36161,e)}else if(t.depthBuffer&&t.stencilBuffer){if(r){var n=j(t);x.renderbufferStorageMultisample(36161,n,35056,t.width,t.height)}else{x.renderbufferStorage(36161,34041,t.width,t.height)}x.framebufferRenderbuffer(36160,33306,36161,e)}else{var i=E.convert(t.texture.format);var a=E.convert(t.texture.type);var o=P(i,a);if(r){var n=j(t);x.renderbufferStorageMultisample(36161,n,o,t.width,t.height)}else{x.renderbufferStorage(36161,o,t.width,t.height)}}x.bindRenderbuffer(36161,null)}function N(e,t){var r=t&&t.isWebGLRenderTargetCube;if(r)throw new Error("Depth Texture with cube render targets is not supported");x.bindFramebuffer(36160,e);if(!(t.depthTexture&&t.depthTexture.isDepthTexture)){throw new Error("renderTarget.depthTexture must be an instance of THREE.DepthTexture")}if(!_.get(t.depthTexture).__webglTexture||t.depthTexture.image.width!==t.width||t.depthTexture.image.height!==t.height){t.depthTexture.image.width=t.width;t.depthTexture.image.height=t.height;t.depthTexture.needsUpdate=true}l(t.depthTexture,0);var n=_.get(t.depthTexture).__webglTexture;if(t.depthTexture.format===Ye){x.framebufferTexture2D(36160,36096,3553,n,0)}else if(t.depthTexture.format===Ze){x.framebufferTexture2D(36160,33306,3553,n,0)}else{throw new Error("Unknown depthTexture format")}}function F(e){var t=_.get(e);var r=e.isWebGLRenderTargetCube===true;if(e.depthTexture){if(r)throw new Error("target.depthTexture not supported in Cube render targets");N(t.__webglFramebuffer,e)}else{if(r){t.__webglDepthbuffer=[];for(var n=0;n<6;n++){x.bindFramebuffer(36160,t.__webglFramebuffer[n]);t.__webglDepthbuffer[n]=x.createRenderbuffer();D(t.__webglDepthbuffer[n],e)}}else{x.bindFramebuffer(36160,t.__webglFramebuffer);t.__webglDepthbuffer=x.createRenderbuffer();D(t.__webglDepthbuffer,e)}}x.bindFramebuffer(36160,null)}function B(e){var t=_.get(e);var r=_.get(e.texture);e.addEventListener("dispose",C);r.__webglTexture=x.createTexture();M.memory.textures++;var n=e.isWebGLRenderTargetCube===true;var i=e.isWebGLMultisampleRenderTarget===true;var a=e.isWebGLMultiviewRenderTarget===true;var o=S(e)||T.isWebGL2;if(n){t.__webglFramebuffer=[];for(var s=0;s<6;s++){t.__webglFramebuffer[s]=x.createFramebuffer()}}else{t.__webglFramebuffer=x.createFramebuffer();if(i){if(T.isWebGL2){t.__webglMultisampledFramebuffer=x.createFramebuffer();t.__webglColorRenderbuffer=x.createRenderbuffer();x.bindRenderbuffer(36161,t.__webglColorRenderbuffer);var u=E.convert(e.texture.format);var l=E.convert(e.texture.type);var c=P(u,l);var h=j(e);x.renderbufferStorageMultisample(36161,h,c,e.width,e.height);x.bindFramebuffer(36160,t.__webglMultisampledFramebuffer);x.framebufferRenderbuffer(36160,36064,36161,t.__webglColorRenderbuffer);x.bindRenderbuffer(36161,null);if(e.depthBuffer){t.__webglDepthRenderbuffer=x.createRenderbuffer();D(t.__webglDepthRenderbuffer,e,true)}x.bindFramebuffer(36160,null)}else{console.warn("THREE.WebGLRenderer: WebGLMultisampleRenderTarget can only be used with WebGL2.")}}else if(a){var f=e.width;var d=e.height;var p=e.numViews;x.bindFramebuffer(36160,t.__webglFramebuffer);var v=b.get("OVR_multiview2");M.memory.textures+=2;var m=x.createTexture();x.bindTexture(35866,m);x.texParameteri(35866,10240,9728);x.texParameteri(35866,10241,9728);x.texImage3D(35866,0,32856,f,d,p,0,6408,5121,null);v.framebufferTextureMultiviewOVR(36160,36064,m,0,0,p);var g=x.createTexture();x.bindTexture(35866,g);x.texParameteri(35866,10240,9728);x.texParameteri(35866,10241,9728);x.texImage3D(35866,0,35056,f,d,p,0,34041,34042,null);v.framebufferTextureMultiviewOVR(36160,33306,g,0,0,p);var y=new Array(p);for(var s=0;s<p;++s){y[s]=x.createFramebuffer();x.bindFramebuffer(36160,y[s]);x.framebufferTextureLayer(36160,36064,m,0,s)}t.__webglColorTexture=m;t.__webglDepthStencilTexture=g;t.__webglViewFramebuffers=y;x.bindFramebuffer(36160,null);x.bindTexture(35866,null)}}if(n){w.bindTexture(34067,r.__webglTexture);O(34067,e.texture,o);for(var s=0;s<6;s++){I(t.__webglFramebuffer[s],e,36064,34069+s)}if(A(e.texture,o)){R(34067,e.texture,e.width,e.height)}w.bindTexture(34067,null)}else if(!a){w.bindTexture(3553,r.__webglTexture);O(3553,e.texture,o);I(t.__webglFramebuffer,e,36064,3553);if(A(e.texture,o)){R(3553,e.texture,e.width,e.height)}w.bindTexture(3553,null)}if(e.depthBuffer){F(e)}}function U(e){var t=e.texture;var r=S(e)||T.isWebGL2;if(A(t,r)){var n=e.isWebGLRenderTargetCube?34067:3553;var i=_.get(t).__webglTexture;w.bindTexture(n,i);R(n,t,e.width,e.height);w.bindTexture(n,null)}}function k(e){if(e.isWebGLMultisampleRenderTarget){if(T.isWebGL2){var t=_.get(e);x.bindFramebuffer(36008,t.__webglMultisampledFramebuffer);x.bindFramebuffer(36009,t.__webglFramebuffer);var r=e.width;var n=e.height;var i=16384;if(e.depthBuffer)i|=256;if(e.stencilBuffer)i|=1024;x.blitFramebuffer(0,0,r,n,0,0,r,n,i,9728)}else{console.warn("THREE.WebGLRenderer: WebGLMultisampleRenderTarget can only be used with WebGL2.")}}}function j(e){return T.isWebGL2&&e.isWebGLMultisampleRenderTarget?Math.min(T.maxSamples,e.samples):0}function z(e){var t=M.render.frame;if(r.get(e)!==t){r.set(e,t);e.update()}}var H=false;var G=false;function V(e,t){if(e&&e.isWebGLRenderTarget){if(H===false){console.warn("THREE.WebGLTextures.safeSetTexture2D: don't use render targets as textures. Use their .texture property instead.");H=true}e=e.texture}l(e,t)}function W(e,t){if(e&&e.isWebGLRenderTargetCube){if(G===false){console.warn("THREE.WebGLTextures.safeSetTextureCube: don't use cube render targets as textures. Use their .texture property instead.");G=true}e=e.texture}if(e&&e.isCubeTexture||Array.isArray(e.image)&&e.image.length===6){v(e,t)}else{g(e,t)}}this.allocateTextureUnit=u;this.resetTextureUnits=e;this.setTexture2D=l;this.setTexture2DArray=f;this.setTexture3D=d;this.setTextureCube=v;this.setTextureCubeDynamic=g;this.setupRenderTarget=B;this.updateRenderTargetMipmap=U;this.updateMultisampleRenderTarget=k;this.safeSetTexture2D=V;this.safeSetTextureCube=W}function Al(e,r,n){function t(e){var t;if(e===J)return 10497;if(e===K)return 33071;if(e===Q)return 33648;if(e===$)return 9728;if(e===ee)return 9984;if(e===re)return 9986;if(e===ie)return 9729;if(e===ae)return 9985;if(e===se)return 9987;if(e===Ge)return 5121;if(e===Ie)return 32819;if(e===De)return 32820;if(e===Ne)return 33635;if(e===le)return 5120;if(e===Pe)return 5122;if(e===Ce)return 5123;if(e===Oe)return 5124;if(e===Le)return 5125;if(e===Ve)return 5126;if(e===We){if(n.isWebGL2)return 5131;t=r.get("OES_texture_half_float");if(t!==null)return t.HALF_FLOAT_OES}if(e===Be)return 6406;if(e===Ue)return 6407;if(e===qe)return 6408;if(e===ke)return 6409;if(e===je)return 6410;if(e===Ye)return 6402;if(e===Ze)return 34041;if(e===Je)return 6403;if(e===be)return 32774;if(e===m)return 32778;if(e===y)return 32779;if(e===w)return 0;if(e===_)return 1;if(e===T)return 768;if(e===E)return 769;if(e===M)return 770;if(e===S)return 771;if(e===A)return 772;if(e===R)return 773;if(e===P)return 774;if(e===C)return 775;if(e===O)return 776;if(e===Ke||e===Qe||e===$e||e===et){t=r.get("WEBGL_compressed_texture_s3tc");if(t!==null){if(e===Ke)return t.COMPRESSED_RGB_S3TC_DXT1_EXT;if(e===Qe)return t.COMPRESSED_RGBA_S3TC_DXT1_EXT;if(e===$e)return t.COMPRESSED_RGBA_S3TC_DXT3_EXT;if(e===et)return t.COMPRESSED_RGBA_S3TC_DXT5_EXT}}if(e===tt||e===rt||e===nt||e===it){t=r.get("WEBGL_compressed_texture_pvrtc");if(t!==null){if(e===tt)return t.COMPRESSED_RGB_PVRTC_4BPPV1_IMG;if(e===rt)return t.COMPRESSED_RGB_PVRTC_2BPPV1_IMG;if(e===nt)return t.COMPRESSED_RGBA_PVRTC_4BPPV1_IMG;if(e===it)return t.COMPRESSED_RGBA_PVRTC_2BPPV1_IMG}}if(e===at){t=r.get("WEBGL_compressed_texture_etc1");if(t!==null)return t.COMPRESSED_RGB_ETC1_WEBGL}if(e===ot||e===st||e===ut||e===lt||e===ct||e===ht||e===ft||e===dt||e===pt||e===vt||e===mt||e===gt||e===yt||e===xt){t=r.get("WEBGL_compressed_texture_astc");if(t!==null){return e}}if(e===x||e===b){if(n.isWebGL2){if(e===x)return 32775;if(e===b)return 32776}t=r.get("EXT_blend_minmax");if(t!==null){if(e===x)return t.MIN_EXT;if(e===b)return t.MAX_EXT}}if(e===Fe){if(n.isWebGL2)return 34042;t=r.get("WEBGL_depth_texture");if(t!==null)return t.UNSIGNED_INT_24_8_WEBGL}return 0}return{convert:t}}function Rl(e,t,r,n){_r.call(this,e,t,n);this.depthBuffer=false;this.stencilBuffer=false;this.numViews=r}Rl.prototype=Object.assign(Object.create(_r.prototype),{constructor:Rl,isWebGLMultiviewRenderTarget:true,copy:function(e){_r.prototype.copy.call(this,e);this.numViews=e.numViews;return this},setNumViews:function(e){if(this.numViews!==e){this.numViews=e;this.dispose()}return this}});function Pl(r,f){var n=2;var i=r.extensions;var d=r.properties;var p,a;var o,s,u,v;var l;var c=0;function e(){if(l===undefined){var e=i.get("OVR_multiview2");l=e!==null&&f.getContextAttributes().antialias===false;if(l){c=f.getParameter(e.MAX_VIEWS_OVR);p=new Rl(0,0,n);v=new cr;s=[];o=[];u=[];for(var t=0;t<c;t++){s[t]=new Or;o[t]=new mr}}}return l}function h(e){if(e.isArrayCamera)return e.cameras;u[0]=e;return u}function t(e,t){var r=h(e);for(var n=0;n<r.length;n++){s[n].copy(r[n].projectionMatrix)}t.setValue(f,"projectionMatrices",s)}function m(e,t){var r=h(e);for(var n=0;n<r.length;n++){s[n].copy(r[n].matrixWorldInverse)}t.setValue(f,"viewMatrices",s)}function g(e,t,r){var n=h(t);for(var i=0;i<n.length;i++){s[i].multiplyMatrices(n[i].matrixWorldInverse,e.matrixWorld);o[i].getNormalMatrix(s[i])}r.setValue(f,"modelViewMatrices",s);r.setValue(f,"normalMatrices",o)}function y(e){if(e.isArrayCamera===undefined)return true;var t=e.cameras;if(t.length>c)return false;for(var r=1,n=t.length;r<n;r++){if(t[0].viewport.z!==t[r].viewport.z||t[0].viewport.w!==t[r].viewport.w)return false}return true}function x(e){if(a){v.set(a.width,a.height)}else{r.getDrawingBufferSize(v)}if(e.isArrayCamera){var t=e.cameras[0].viewport;p.setSize(t.z,t.w);p.setNumViews(e.cameras.length)}else{p.setSize(v.x,v.y);p.setNumViews(n)}}function b(e){if(y(e)===false)return;a=r.getRenderTarget();x(e);r.setRenderTarget(p)}function w(e){if(p!==r.getRenderTarget())return;r.setRenderTarget(a);_(e)}function _(e){var t=p;var r=t.numViews;var n=d.get(t).__webglViewFramebuffers;var i=t.width;var a=t.height;if(e.isArrayCamera){for(var o=0;o<r;o++){var s=e.cameras[o].viewport;var u=s.x;var l=s.y;var c=u+s.z;var h=l+s.w;f.bindFramebuffer(36008,n[o]);f.blitFramebuffer(0,0,i,a,u,l,c,h,16384,9728)}}else{f.bindFramebuffer(36008,n[0]);f.blitFramebuffer(0,0,i,a,0,0,v.x,v.y,16384,9728)}}this.isAvailable=e;this.attachCamera=b;this.detachCamera=w;this.updateCameraProjectionMatricesUniform=t;this.updateCameraViewMatricesUniform=m;this.updateObjectMatricesUniforms=g}function Cl(){Zr.call(this);this.type="Group"}Cl.prototype=Object.assign(Object.create(Zr.prototype),{constructor:Cl,isGroup:true});function Ol(e){Vi.call(this);this.cameras=e||[]}Ol.prototype=Object.assign(Object.create(Vi.prototype),{constructor:Ol,isArrayCamera:true});var Ll=new pr;var Il=new pr;function Dl(e,t,r){Ll.setFromMatrixPosition(t.matrixWorld);Il.setFromMatrixPosition(r.matrixWorld);var n=Ll.distanceTo(Il);var i=t.projectionMatrix.elements;var a=r.projectionMatrix.elements;var o=i[14]/(i[10]-1);var s=i[14]/(i[10]+1);var u=(i[9]+1)/i[5];var l=(i[9]-1)/i[5];var c=(i[8]-1)/i[0];var h=(a[8]+1)/a[0];var f=o*c;var d=o*h;var p=n/(-c+h);var v=p*-c;t.matrixWorld.decompose(e.position,e.quaternion,e.scale);e.translateX(v);e.translateZ(p);e.matrixWorld.compose(e.position,e.quaternion,e.scale);e.matrixWorldInverse.getInverse(e.matrixWorld);var m=o+p;var g=s+p;var y=f-v;var x=d+(n-v);var b=u*s/g*m;var w=l*s/g*m;e.projectionMatrix.makePerspective(y,x,b,w,m,g)}function Nl(t){var r,n;var i=this;var u=null;var l=null;var c=null;var a=[];var h=new Or;var f=new Or;var o=1;var d="local-floor";if(typeof window!=="undefined"&&"VRFrameData"in window){l=new window.VRFrameData;window.addEventListener("vrdisplaypresentchange",e,false)}var p=new Or;var v=new hr;var m=new pr;var g=new Vi;g.viewport=new wr;g.layers.enable(1);var y=new Vi;y.viewport=new wr;y.layers.enable(2);var x=new Ol([g,y]);x.layers.enable(1);x.layers.enable(2);function b(){return u!==null&&u.isPresenting===true}var s=new cr,w;function e(){if(b()){var e=u.getEyeParameters("left");r=2*e.renderWidth*o;n=e.renderHeight*o;w=t.getPixelRatio();t.getSize(s);t.setDrawingBufferSize(r,n,1);g.viewport.set(0,0,r/2,n);y.viewport.set(r/2,0,r/2,n);S.start();i.dispatchEvent({type:"sessionstart"})}else{if(i.enabled){t.setDrawingBufferSize(s.width,s.height,w)}S.stop();i.dispatchEvent({type:"sessionend"})}}var _=[];function T(e){var t=navigator.getGamepads&&navigator.getGamepads();for(var r=0,n=0,i=t.length;r<i;r++){var a=t[r];if(a&&(a.id==="Daydream Controller"||a.id==="Gear VR Controller"||a.id==="Oculus Go Controller"||a.id==="OpenVR Gamepad"||a.id.startsWith("Oculus Touch")||a.id.startsWith("HTC Vive Focus")||a.id.startsWith("Spatial Controller"))){if(n===e)return a;n++}}}function E(){for(var e=0;e<a.length;e++){var t=a[e];var r=T(e);if(r!==undefined&&r.pose!==undefined){if(r.pose===null)return;var n=r.pose;if(n.hasPosition===false)t.position.set(.2,-.6,-.05);if(n.position!==null)t.position.fromArray(n.position);if(n.orientation!==null)t.quaternion.fromArray(n.orientation);t.matrix.compose(t.position,t.quaternion,t.scale);t.matrix.premultiply(h);t.matrix.decompose(t.position,t.quaternion,t.scale);t.matrixWorldNeedsUpdate=true;t.visible=true;var i=r.id==="Daydream Controller"?0:1;if(_[e]===undefined)_[e]=false;if(_[e]!==r.buttons[i].pressed){_[e]=r.buttons[i].pressed;if(_[e]===true){t.dispatchEvent({type:"selectstart"})}else{t.dispatchEvent({type:"selectend"});t.dispatchEvent({type:"select"})}}}else{t.visible=false}}}function M(e,t){if(t!==null&&t.length===4){e.set(t[0]*r,t[1]*n,t[2]*r,t[3]*n)}}this.enabled=false;this.getController=function(e){var t=a[e];if(t===undefined){t=new Cl;t.matrixAutoUpdate=false;t.visible=false;a[e]=t}return t};this.getDevice=function(){return u};this.setDevice=function(e){if(e!==undefined)u=e;S.setContext(e)};this.setFramebufferScaleFactor=function(e){o=e};this.setReferenceSpaceType=function(e){d=e};this.setPoseTarget=function(e){if(e!==undefined)c=e};this.getCamera=function(e){var t=d==="local-floor"?1.6:0;if(b()===false){e.position.set(0,t,0);e.rotation.set(0,0,0);return e}u.depthNear=e.near;u.depthFar=e.far;u.getFrameData(l);if(d==="local-floor"){var r=u.stageParameters;if(r){h.fromArray(r.sittingToStandingTransform)}else{h.makeTranslation(0,t,0)}}var n=l.pose;var i=c!==null?c:e;i.matrix.copy(h);i.matrix.decompose(i.position,i.quaternion,i.scale);if(n.orientation!==null){v.fromArray(n.orientation);i.quaternion.multiply(v)}if(n.position!==null){v.setFromRotationMatrix(h);m.fromArray(n.position);m.applyQuaternion(v);i.position.add(m)}i.updateMatrixWorld();g.near=e.near;y.near=e.near;g.far=e.far;y.far=e.far;g.matrixWorldInverse.fromArray(l.leftViewMatrix);y.matrixWorldInverse.fromArray(l.rightViewMatrix);f.getInverse(h);if(d==="local-floor"){g.matrixWorldInverse.multiply(f);y.matrixWorldInverse.multiply(f)}var a=i.parent;if(a!==null){p.getInverse(a.matrixWorld);g.matrixWorldInverse.multiply(p);y.matrixWorldInverse.multiply(p)}g.matrixWorld.getInverse(g.matrixWorldInverse);y.matrixWorld.getInverse(y.matrixWorldInverse);g.projectionMatrix.fromArray(l.leftProjectionMatrix);y.projectionMatrix.fromArray(l.rightProjectionMatrix);Dl(x,g,y);var o=u.getLayers();if(o.length){var s=o[0];M(g.viewport,s.leftBounds);M(y.viewport,s.rightBounds)}E();return x};this.getStandingMatrix=function(){return h};this.isPresenting=b;var S=new _s;this.setAnimationLoop=function(e){S.setAnimationLoop(e);if(b())S.start()};this.submitFrame=function(){if(b())u.submitFrame()};this.dispose=function(){if(typeof window!=="undefined"){window.removeEventListener("vrdisplaypresentchange",e)}};this.setFrameOfReferenceType=function(){console.warn("THREE.WebVRManager: setFrameOfReferenceType() has been deprecated.")}}Object.assign(Nl.prototype,or.prototype);function Fl(f,t){var r=this;var d=null;var p=null;var n="local-floor";var v=null;var m=[];var g=[];function o(){return d!==null&&p!==null}var s=new Vi;s.layers.enable(1);s.viewport=new wr;var u=new Vi;u.layers.enable(2);u.viewport=new wr;var y=new Ol([s,u]);y.layers.enable(1);y.layers.enable(2);this.enabled=false;this.getController=function(e){var t=m[e];if(t===undefined){t=new Cl;t.matrixAutoUpdate=false;t.visible=false;m[e]=t}return t};function i(e){for(var t=0;t<m.length;t++){if(g[t]===e.inputSource){m[t].dispatchEvent({type:e.type})}}}function a(){f.setFramebuffer(null);f.setRenderTarget(f.getRenderTarget());h.stop();r.dispatchEvent({type:"sessionend"})}function l(e){p=e;h.setContext(d);h.start();r.dispatchEvent({type:"sessionstart"})}this.setFramebufferScaleFactor=function(){};this.setReferenceSpaceType=function(e){n=e};this.getSession=function(){return d};this.setSession=function(e){d=e;if(d!==null){d.addEventListener("select",i);d.addEventListener("selectstart",i);d.addEventListener("selectend",i);d.addEventListener("end",a);d.updateRenderState({baseLayer:new XRWebGLLayer(d,t)});d.requestReferenceSpace(n).then(l);g=d.inputSources;d.addEventListener("inputsourceschange",function(){g=d.inputSources;console.log(g);for(var e=0;e<m.length;e++){var t=m[e];t.userData.inputSource=g[e]}})}};function c(e,t){if(t===null){e.matrixWorld.copy(e.matrix)}else{e.matrixWorld.multiplyMatrices(t.matrixWorld,e.matrix)}e.matrixWorldInverse.getInverse(e.matrixWorld)}this.getCamera=function(e){if(o()){var t=e.parent;var r=y.cameras;c(y,t);for(var n=0;n<r.length;n++){c(r[n],t)}e.matrixWorld.copy(y.matrixWorld);var i=e.children;for(var n=0,a=i.length;n<a;n++){i[n].updateMatrixWorld(true)}Dl(y,s,u);return y}return e};this.isPresenting=o;var x=null;function e(e,t){v=t.getViewerPose(p);if(v!==null){var r=v.views;var n=d.renderState.baseLayer;f.setFramebuffer(n.framebuffer);for(var i=0;i<r.length;i++){var a=r[i];var o=n.getViewport(a);var s=a.transform.inverse.matrix;var u=y.cameras[i];u.matrix.fromArray(s).getInverse(u.matrix);u.projectionMatrix.fromArray(a.projectionMatrix);u.viewport.set(o.x,o.y,o.width,o.height);if(i===0){y.matrix.copy(u.matrix)}}}for(var i=0;i<m.length;i++){var l=m[i];var c=g[i];if(c){var h=t.getPose(c.targetRaySpace,p);if(h!==null){l.matrix.fromArray(h.transform.matrix);l.matrix.decompose(l.position,l.rotation,l.scale);l.visible=true;continue}}l.visible=false}if(x)x(e)}var h=new _s;h.setAnimationLoop(e);this.setAnimationLoop=function(e){x=e};this.dispose=function(){};this.getStandingMatrix=function(){console.warn("THREE.WebXRManager: getStandingMatrix() is no longer needed.");return new Or};this.getDevice=function(){console.warn("THREE.WebXRManager: getDevice() has been deprecated.")};this.setDevice=function(){console.warn("THREE.WebXRManager: setDevice() has been deprecated.")};this.setFrameOfReferenceType=function(){console.warn("THREE.WebXRManager: setFrameOfReferenceType() has been deprecated.")};this.submitFrame=function(){}}Object.assign(Fl.prototype,or.prototype);function Bl(e){e=e||{};var n=e.canvas!==undefined?e.canvas:document.createElementNS("http://www.w3.org/1999/xhtml","canvas"),t=e.context!==undefined?e.context:null,r=e.alpha!==undefined?e.alpha:false,i=e.depth!==undefined?e.depth:true,a=e.stencil!==undefined?e.stencil:true,o=e.antialias!==undefined?e.antialias:false,s=e.premultipliedAlpha!==undefined?e.premultipliedAlpha:true,u=e.preserveDrawingBuffer!==undefined?e.preserveDrawingBuffer:false,l=e.powerPreference!==undefined?e.powerPreference:"default",c=e.failIfMajorPerformanceCaveat!==undefined?e.failIfMajorPerformanceCaveat:false;var d=null;var x=null;this.domElement=n;this.debug={checkShaderErrors:true};this.autoClear=true;this.autoClearColor=true;this.autoClearDepth=true;this.autoClearStencil=true;this.sortObjects=true;this.clippingPlanes=[];this.localClippingEnabled=false;this.gammaFactor=2;this.gammaInput=false;this.gammaOutput=false;this.physicallyCorrectLights=false;this.toneMapping=He;this.toneMappingExposure=1;this.toneMappingWhitePoint=1;this.maxMorphTargets=8;this.maxMorphNormals=4;var b=this,h=false,f=null,p=0,v=0,m=null,g=null,w=-1,T={geometry:null,program:null,wireframe:false},_=null,y=null,E=new wr,M=new wr,S=null,A=n.width,R=n.height,P=1,C=new wr(0,0,A,R),O=new wr(0,0,A,R),L=false,I=new ra,D=new Ps,N=false,F=false,B=new Or,U=new pr;function k(){return m===null?P:1}var j;try{var z={alpha:r,depth:i,stencil:a,antialias:o,premultipliedAlpha:s,preserveDrawingBuffer:u,powerPreference:l,failIfMajorPerformanceCaveat:c,xrCompatible:true};n.addEventListener("webglcontextlost",le,false);n.addEventListener("webglcontextrestored",ce,false);j=t||n.getContext("webgl",z)||n.getContext("experimental-webgl",z);if(j===null){if(n.getContext("webgl")!==null){throw new Error("Error creating WebGL context with your selected attributes.")}else{throw new Error("Error creating WebGL context.")}}if(j.getShaderPrecisionFormat===undefined){j.getShaderPrecisionFormat=function(){return{rangeMin:1,rangeMax:1,precision:1}}}}catch(e){console.error("THREE.WebGLRenderer: "+e.message);throw e}var H,G,V,W;var q,X,Y,Z,J;var K,Q,$;var ee,te,re,ne;var ie;function ae(){H=new Cs(j);G=new Rs(j,H,e);if(G.isWebGL2===false){H.get("WEBGL_depth_texture");H.get("OES_texture_float");H.get("OES_texture_half_float");H.get("OES_texture_half_float_linear");H.get("OES_standard_derivatives");H.get("OES_element_index_uint");H.get("ANGLE_instanced_arrays")}H.get("OES_texture_float_linear");ie=new Al(j,H,G);V=new Ml(j,H,ie,G);V.scissor(M.copy(O).multiplyScalar(P).floor());V.viewport(E.copy(C).multiplyScalar(P).floor());W=new Is(j);q=new ll;X=new Sl(j,H,V,q,G,ie,W);Y=new Ts(j);Z=new Os(j,Y,W);J=new Fs(j,Z,Y,W);te=new Ns(j);K=new ul(b,H,G);Q=new dl;$=new xl;ee=new Ss(b,V,J,s);re=new As(j,H,W,G);ne=new Ls(j,H,W,G);W.programs=K.programs;b.capabilities=G;b.extensions=H;b.properties=q;b.renderLists=Q;b.state=V;b.info=W}ae();var oe=typeof navigator!=="undefined"&&"xr"in navigator&&"supportsSession"in navigator.xr?new Fl(b,j):new Nl(b);this.vr=oe;var se=new Pl(b,j);var ue=new El(b,J,G.maxTextureSize);this.shadowMap=ue;this.getContext=function(){return j};this.getContextAttributes=function(){return j.getContextAttributes()};this.forceContextLoss=function(){var e=H.get("WEBGL_lose_context");if(e)e.loseContext()};this.forceContextRestore=function(){var e=H.get("WEBGL_lose_context");if(e)e.restoreContext()};this.getPixelRatio=function(){return P};this.setPixelRatio=function(e){if(e===undefined)return;P=e;this.setSize(A,R,false)};this.getSize=function(e){if(e===undefined){console.warn("WebGLRenderer: .getsize() now requires a Vector2 as an argument");e=new cr}return e.set(A,R)};this.setSize=function(e,t,r){if(oe.isPresenting()){console.warn("THREE.WebGLRenderer: Can't change size while VR device is presenting.");return}A=e;R=t;n.width=Math.floor(e*P);n.height=Math.floor(t*P);if(r!==false){n.style.width=e+"px";n.style.height=t+"px"}this.setViewport(0,0,e,t)};this.getDrawingBufferSize=function(e){if(e===undefined){console.warn("WebGLRenderer: .getdrawingBufferSize() now requires a Vector2 as an argument");e=new cr}return e.set(A*P,R*P).floor()};this.setDrawingBufferSize=function(e,t,r){A=e;R=t;P=r;n.width=Math.floor(e*r);n.height=Math.floor(t*r);this.setViewport(0,0,e,t)};this.getCurrentViewport=function(e){if(e===undefined){console.warn("WebGLRenderer: .getCurrentViewport() now requires a Vector4 as an argument");e=new wr}return e.copy(E)};this.getViewport=function(e){return e.copy(C)};this.setViewport=function(e,t,r,n){if(e.isVector4){C.set(e.x,e.y,e.z,e.w)}else{C.set(e,t,r,n)}V.viewport(E.copy(C).multiplyScalar(P).floor())};this.getScissor=function(e){return e.copy(O)};this.setScissor=function(e,t,r,n){if(e.isVector4){O.set(e.x,e.y,e.z,e.w)}else{O.set(e,t,r,n)}V.scissor(M.copy(O).multiplyScalar(P).floor())};this.getScissorTest=function(){return L};this.setScissorTest=function(e){V.setScissorTest(L=e)};this.getClearColor=function(){return ee.getClearColor()};this.setClearColor=function(){ee.setClearColor.apply(ee,arguments)};this.getClearAlpha=function(){return ee.getClearAlpha()};this.setClearAlpha=function(){ee.setClearAlpha.apply(ee,arguments)};this.clear=function(e,t,r){var n=0;if(e===undefined||e)n|=16384;if(t===undefined||t)n|=256;if(r===undefined||r)n|=1024;j.clear(n)};this.clearColor=function(){this.clear(true,false,false)};this.clearDepth=function(){this.clear(false,true,false)};this.clearStencil=function(){this.clear(false,false,true)};this.dispose=function(){n.removeEventListener("webglcontextlost",le,false);n.removeEventListener("webglcontextrestored",ce,false);Q.dispose();$.dispose();q.dispose();J.dispose();oe.dispose();ye.stop()};function le(e){e.preventDefault();console.log("THREE.WebGLRenderer: Context Lost.");h=true}function ce(){console.log("THREE.WebGLRenderer: Context Restored.");h=false;ae()}function he(e){var t=e.target;t.removeEventListener("dispose",he);fe(t)}function fe(e){de(e);q.remove(e)}function de(e){var t=q.get(e).program;e.program=undefined;if(t!==undefined){K.releaseProgram(t)}}function pe(e,t){e.render(function(e){b.renderBufferImmediate(e,t)})}this.renderBufferImmediate=function(e,t){V.initAttributes();var r=q.get(e);if(e.hasPositions&&!r.position)r.position=j.createBuffer();if(e.hasNormals&&!r.normal)r.normal=j.createBuffer();if(e.hasUvs&&!r.uv)r.uv=j.createBuffer();if(e.hasColors&&!r.color)r.color=j.createBuffer();var n=t.getAttributes();if(e.hasPositions){j.bindBuffer(34962,r.position);j.bufferData(34962,e.positionArray,35048);V.enableAttribute(n.position);j.vertexAttribPointer(n.position,3,5126,false,0,0)}if(e.hasNormals){j.bindBuffer(34962,r.normal);j.bufferData(34962,e.normalArray,35048);V.enableAttribute(n.normal);j.vertexAttribPointer(n.normal,3,5126,false,0,0)}if(e.hasUvs){j.bindBuffer(34962,r.uv);j.bufferData(34962,e.uvArray,35048);V.enableAttribute(n.uv);j.vertexAttribPointer(n.uv,2,5126,false,0,0)}if(e.hasColors){j.bindBuffer(34962,r.color);j.bufferData(34962,e.colorArray,35048);V.enableAttribute(n.color);j.vertexAttribPointer(n.color,3,5126,false,0,0)}V.disableUnusedAttributes();j.drawArrays(4,0,e.count);e.count=0};this.renderBufferDirect=function(e,t,r,n,i,a){var o=i.isMesh&&i.matrixWorld.determinant()<0;V.setMaterial(n,o);var s=Te(e,t,n,i);var u=false;if(T.geometry!==r.id||T.program!==s.id||T.wireframe!==(n.wireframe===true)){T.geometry=r.id;T.program=s.id;T.wireframe=n.wireframe===true;u=true}if(i.morphTargetInfluences){te.update(i,r,n,s);u=true}var l=r.index;var c=r.attributes.position;var h=1;if(n.wireframe===true){l=Z.getWireframeAttribute(r);h=2}var f;var d=re;if(l!==null){f=Y.get(l);d=ne;d.setIndex(f)}if(u){ve(i,r,n,s);if(l!==null){j.bindBuffer(34963,f.buffer)}}var p=Infinity;if(l!==null){p=l.count}else if(c!==undefined){p=c.count}var v=r.drawRange.start*h;var m=r.drawRange.count*h;var g=a!==null?a.start*h:0;var y=a!==null?a.count*h:Infinity;var x=Math.max(v,g);var b=Math.min(p,v+m,g+y)-1;var w=Math.max(0,b-x+1);if(w===0)return;if(i.isMesh){if(n.wireframe===true){V.setLineWidth(n.wireframeLinewidth*k());d.setMode(1)}else{switch(i.drawMode){case Pt:d.setMode(4);break;case Ct:d.setMode(5);break;case Ot:d.setMode(6);break}}}else if(i.isLine){var _=n.linewidth;if(_===undefined)_=1;V.setLineWidth(_*k());if(i.isLineSegments){d.setMode(1)}else if(i.isLineLoop){d.setMode(2)}else{d.setMode(3)}}else if(i.isPoints){d.setMode(0)}else if(i.isSprite){d.setMode(4)}if(i.isInstancedMesh){d.renderInstances(r,x,w,i.count)}else if(r.isInstancedBufferGeometry){d.renderInstances(r,x,w,r.maxInstancedCount)}else{d.render(x,w)}};function ve(e,t,r,n){if(G.isWebGL2===false&&(e.isInstancedMesh||t.isInstancedBufferGeometry)){if(H.get("ANGLE_instanced_arrays")===null)return}V.initAttributes();var i=t.attributes;var a=n.getAttributes();var o=r.defaultAttributeValues;for(var s in a){var u=a[s];if(u>=0){var l=i[s];if(l!==undefined){var c=l.normalized;var h=l.itemSize;var f=Y.get(l);if(f===undefined)continue;var d=f.buffer;var p=f.type;var v=f.bytesPerElement;if(l.isInterleavedBufferAttribute){var m=l.data;var g=m.stride;var y=l.offset;if(m&&m.isInstancedInterleavedBuffer){V.enableAttributeAndDivisor(u,m.meshPerAttribute);if(t.maxInstancedCount===undefined){t.maxInstancedCount=m.meshPerAttribute*m.count}}else{V.enableAttribute(u)}j.bindBuffer(34962,d);j.vertexAttribPointer(u,h,p,c,g*v,y*v)}else{if(l.isInstancedBufferAttribute){V.enableAttributeAndDivisor(u,l.meshPerAttribute);if(t.maxInstancedCount===undefined){t.maxInstancedCount=l.meshPerAttribute*l.count}}else{V.enableAttribute(u)}j.bindBuffer(34962,d);j.vertexAttribPointer(u,h,p,c,0,0)}}else if(s==="instanceMatrix"){var f=Y.get(e.instanceMatrix);if(f===undefined)continue;var d=f.buffer;var p=f.type;V.enableAttributeAndDivisor(u+0,1);V.enableAttributeAndDivisor(u+1,1);V.enableAttributeAndDivisor(u+2,1);V.enableAttributeAndDivisor(u+3,1);j.bindBuffer(34962,d);j.vertexAttribPointer(u+0,4,p,false,64,0);j.vertexAttribPointer(u+1,4,p,false,64,16);j.vertexAttribPointer(u+2,4,p,false,64,32);j.vertexAttribPointer(u+3,4,p,false,64,48)}else if(o!==undefined){var x=o[s];if(x!==undefined){switch(x.length){case 2:j.vertexAttrib2fv(u,x);break;case 3:j.vertexAttrib3fv(u,x);break;case 4:j.vertexAttrib4fv(u,x);break;default:j.vertexAttrib1fv(u,x)}}}}}V.disableUnusedAttributes()}this.compile=function(r,e){x=$.get(r,e);x.init();r.traverse(function(e){if(e.isLight){x.pushLight(e);if(e.castShadow){x.pushShadow(e)}}});x.setupLights(e);r.traverse(function(e){if(e.material){if(Array.isArray(e.material)){for(var t=0;t<e.material.length;t++){_e(e.material[t],r.fog,e)}}else{_e(e.material,r.fog,e)}}})};var me=null;function ge(e){if(oe.isPresenting())return;if(me)me(e)}var ye=new _s;ye.setAnimationLoop(ge);if(typeof window!=="undefined")ye.setContext(window);this.setAnimationLoop=function(e){me=e;oe.setAnimationLoop(e);ye.start()};this.render=function(e,t){var r,n;if(arguments[2]!==undefined){console.warn("THREE.WebGLRenderer.render(): the renderTarget argument has been removed. Use .setRenderTarget() instead.");r=arguments[2]}if(arguments[3]!==undefined){console.warn("THREE.WebGLRenderer.render(): the forceClear argument has been removed. Use .clear() instead.");n=arguments[3]}if(!(t&&t.isCamera)){console.error("THREE.WebGLRenderer.render: camera is not an instance of THREE.Camera.");return}if(h)return;T.geometry=null;T.program=null;T.wireframe=false;w=-1;_=null;if(e.autoUpdate===true)e.updateMatrixWorld();if(t.parent===null)t.updateMatrixWorld();if(oe.enabled){t=oe.getCamera(t)}x=$.get(e,t);x.init();e.onBeforeRender(b,e,t,r||m);B.multiplyMatrices(t.projectionMatrix,t.matrixWorldInverse);I.setFromMatrix(B);F=this.localClippingEnabled;N=D.init(this.clippingPlanes,F,t);d=Q.get(e,t);d.init();xe(e,t,0,b.sortObjects);if(b.sortObjects===true){d.sort()}if(N)D.beginShadows();var i=x.state.shadowsArray;ue.render(i,e,t);x.setupLights(t);if(N)D.endShadows();if(this.info.autoReset)this.info.reset();if(r!==undefined){this.setRenderTarget(r)}if(oe.enabled&&se.isAvailable()){se.attachCamera(t)}ee.render(d,e,t,n);var a=d.opaque;var o=d.transparent;if(e.overrideMaterial){var s=e.overrideMaterial;if(a.length)be(a,e,t,s);if(o.length)be(o,e,t,s)}else{if(a.length)be(a,e,t);if(o.length)be(o,e,t)}e.onAfterRender(b,e,t);if(m!==null){X.updateRenderTargetMipmap(m);X.updateMultisampleRenderTarget(m)}V.buffers.depth.setTest(true);V.buffers.depth.setMask(true);V.buffers.color.setMask(true);V.setPolygonOffset(false);if(oe.enabled){if(se.isAvailable()){se.detachCamera(t)}oe.submitFrame()}d=null;x=null};function xe(e,t,r,n){if(e.visible===false)return;var i=e.layers.test(t.layers);if(i){if(e.isGroup){r=e.renderOrder}else if(e.isLOD){if(e.autoUpdate===true)e.update(t)}else if(e.isLight){x.pushLight(e);if(e.castShadow){x.pushShadow(e)}}else if(e.isSprite){if(!e.frustumCulled||I.intersectsSprite(e)){if(n){U.setFromMatrixPosition(e.matrixWorld).applyMatrix4(B)}var a=J.update(e);var o=e.material;if(o.visible){d.push(e,a,o,r,U.z,null)}}}else if(e.isImmediateRenderObject){if(n){U.setFromMatrixPosition(e.matrixWorld).applyMatrix4(B)}d.push(e,null,e.material,r,U.z,null)}else if(e.isMesh||e.isLine||e.isPoints){if(e.isSkinnedMesh){if(e.skeleton.frame!==W.render.frame){e.skeleton.update();e.skeleton.frame=W.render.frame}}if(!e.frustumCulled||I.intersectsObject(e)){if(n){U.setFromMatrixPosition(e.matrixWorld).applyMatrix4(B)}var a=J.update(e);var o=e.material;if(Array.isArray(o)){var s=a.groups;for(var u=0,l=s.length;u<l;u++){var c=s[u];var h=o[c.materialIndex];if(h&&h.visible){d.push(e,a,h,r,U.z,c)}}}else if(o.visible){d.push(e,a,o,r,U.z,null)}}}}var f=e.children;for(var u=0,l=f.length;u<l;u++){xe(f[u],t,r,n)}}function be(e,t,r,n){for(var i=0,a=e.length;i<a;i++){var o=e[i];var s=o.object;var u=o.geometry;var l=n===undefined?o.material:n;var c=o.group;if(r.isArrayCamera){y=r;if(oe.enabled&&se.isAvailable()){we(s,t,r,u,l,c)}else{var h=r.cameras;for(var f=0,d=h.length;f<d;f++){var p=h[f];if(s.layers.test(p.layers)){V.viewport(E.copy(p.viewport));x.setupLights(p);we(s,t,p,u,l,c)}}}}else{y=null;we(s,t,r,u,l,c)}}}function we(e,t,r,n,i,a){e.onBeforeRender(b,t,r,n,i,a);x=$.get(t,y||r);e.modelViewMatrix.multiplyMatrices(r.matrixWorldInverse,e.matrixWorld);e.normalMatrix.getNormalMatrix(e.modelViewMatrix);if(e.isImmediateRenderObject){V.setMaterial(i);var o=Te(r,t.fog,i,e);T.geometry=null;T.program=null;T.wireframe=false;pe(e,o)}else{b.renderBufferDirect(r,t.fog,n,i,e,a)}e.onAfterRender(b,t,r,n,i,a);x=$.get(t,y||r)}function _e(e,t,r){var n=q.get(e);var i=x.state.lights;var a=x.state.shadowsArray;var o=i.state.version;var s=K.getParameters(e,i.state,a,t,D.numPlanes,D.numIntersection,r);var u=K.getProgramCode(e,s);var l=n.program;var c=true;if(l===undefined){e.addEventListener("dispose",he)}else if(l.code!==u){de(e)}else if(n.lightsStateVersion!==o){n.lightsStateVersion=o;c=false}else if(s.shaderID!==undefined){return}else{c=false}if(c){if(s.shaderID){var h=ws[s.shaderID];n.shader={name:e.type,uniforms:Bi(h.uniforms),vertexShader:h.vertexShader,fragmentShader:h.fragmentShader}}else{n.shader={name:e.type,uniforms:e.uniforms,vertexShader:e.vertexShader,fragmentShader:e.fragmentShader}}e.onBeforeCompile(n.shader,b);u=K.getProgramCode(e,s);l=K.acquireProgram(e,n.shader,s,u);n.program=l;e.program=l}var f=l.getAttributes();if(e.morphTargets){e.numSupportedMorphTargets=0;for(var d=0;d<b.maxMorphTargets;d++){if(f["morphTarget"+d]>=0){e.numSupportedMorphTargets++}}}if(e.morphNormals){e.numSupportedMorphNormals=0;for(var d=0;d<b.maxMorphNormals;d++){if(f["morphNormal"+d]>=0){e.numSupportedMorphNormals++}}}var p=n.shader.uniforms;if(!e.isShaderMaterial&&!e.isRawShaderMaterial||e.clipping===true){n.numClippingPlanes=D.numPlanes;n.numIntersection=D.numIntersection;p.clippingPlanes=D.uniform}n.fog=t;n.needsLights=je(e);n.lightsStateVersion=o;if(n.needsLights){p.ambientLightColor.value=i.state.ambient;p.lightProbe.value=i.state.probe;p.directionalLights.value=i.state.directional;p.spotLights.value=i.state.spot;p.rectAreaLights.value=i.state.rectArea;p.pointLights.value=i.state.point;p.hemisphereLights.value=i.state.hemi;p.directionalShadowMap.value=i.state.directionalShadowMap;p.directionalShadowMatrix.value=i.state.directionalShadowMatrix;p.spotShadowMap.value=i.state.spotShadowMap;p.spotShadowMatrix.value=i.state.spotShadowMatrix;p.pointShadowMap.value=i.state.pointShadowMap;p.pointShadowMatrix.value=i.state.pointShadowMatrix}var v=n.program.getUniforms(),m=Nu.seqWithValue(v.seq,p);n.uniformsList=m}function Te(e,t,r,n){X.resetTextureUnits();var i=q.get(r);var a=x.state.lights;if(N){if(F||e!==_){var o=e===_&&r.id===w;D.setState(r.clippingPlanes,r.clipIntersection,r.clipShadows,e,i,o)}}if(r.needsUpdate===false){if(i.program===undefined){r.needsUpdate=true}else if(r.fog&&i.fog!==t){r.needsUpdate=true}else if(i.needsLights&&i.lightsStateVersion!==a.state.version){r.needsUpdate=true}else if(i.numClippingPlanes!==undefined&&(i.numClippingPlanes!==D.numPlanes||i.numIntersection!==D.numIntersection)){r.needsUpdate=true}}if(r.needsUpdate){_e(r,t,n);r.needsUpdate=false}var s=false;var u=false;var l=false;var c=i.program,h=c.getUniforms(),f=i.shader.uniforms;if(V.useProgram(c.program)){s=true;u=true;l=true}if(r.id!==w){w=r.id;u=true}if(s||_!==e){if(c.numMultiviewViews>0){se.updateCameraProjectionMatricesUniform(e,h)}else{h.setValue(j,"projectionMatrix",e.projectionMatrix)}if(G.logarithmicDepthBuffer){h.setValue(j,"logDepthBufFC",2/(Math.log(e.far+1)/Math.LN2))}if(_!==e){_=e;u=true;l=true}if(r.isShaderMaterial||r.isMeshPhongMaterial||r.isMeshStandardMaterial||r.envMap){var d=h.map.cameraPosition;if(d!==undefined){d.setValue(j,U.setFromMatrixPosition(e.matrixWorld))}}if(r.isMeshPhongMaterial||r.isMeshLambertMaterial||r.isMeshBasicMaterial||r.isMeshStandardMaterial||r.isShaderMaterial||r.skinning){if(c.numMultiviewViews>0){se.updateCameraViewMatricesUniform(e,h)}else{h.setValue(j,"viewMatrix",e.matrixWorldInverse)}}}if(r.skinning){h.setOptional(j,n,"bindMatrix");h.setOptional(j,n,"bindMatrixInverse");var p=n.skeleton;if(p){var v=p.bones;if(G.floatVertexTextures){if(p.boneTexture===undefined){var m=Math.sqrt(v.length*4);m=lr.ceilPowerOfTwo(m);m=Math.max(m,4);var g=new Float32Array(m*m*4);g.set(p.boneMatrices);var y=new Zi(g,m,m,qe,Ve);p.boneMatrices=g;p.boneTexture=y;p.boneTextureSize=m}h.setValue(j,"boneTexture",p.boneTexture,X);h.setValue(j,"boneTextureSize",p.boneTextureSize)}else{h.setOptional(j,p,"boneMatrices")}}}if(u||i.receiveShadow!==n.receiveShadow){i.receiveShadow=n.receiveShadow;h.setValue(j,"receiveShadow",n.receiveShadow)}if(u){h.setValue(j,"toneMappingExposure",b.toneMappingExposure);h.setValue(j,"toneMappingWhitePoint",b.toneMappingWhitePoint);if(i.needsLights){ke(f,l)}if(t&&r.fog){Pe(f,t)}if(r.isMeshBasicMaterial){Ee(f,r)}else if(r.isMeshLambertMaterial){Ee(f,r);Ce(f,r)}else if(r.isMeshPhongMaterial){Ee(f,r);if(r.isMeshToonMaterial){Le(f,r)}else{Oe(f,r)}}else if(r.isMeshStandardMaterial){Ee(f,r);if(r.isMeshPhysicalMaterial){De(f,r)}else{Ie(f,r)}}else if(r.isMeshMatcapMaterial){Ee(f,r);Ne(f,r)}else if(r.isMeshDepthMaterial){Ee(f,r);Fe(f,r)}else if(r.isMeshDistanceMaterial){Ee(f,r);Be(f,r)}else if(r.isMeshNormalMaterial){Ee(f,r);Ue(f,r)}else if(r.isLineBasicMaterial){Me(f,r);if(r.isLineDashedMaterial){Se(f,r)}}else if(r.isPointsMaterial){Ae(f,r)}else if(r.isSpriteMaterial){Re(f,r)}else if(r.isShadowMaterial){f.color.value.copy(r.color);f.opacity.value=r.opacity}if(f.ltc_1!==undefined)f.ltc_1.value=bs.LTC_1;if(f.ltc_2!==undefined)f.ltc_2.value=bs.LTC_2;Nu.upload(j,i.uniformsList,f,X)}if(r.isShaderMaterial&&r.uniformsNeedUpdate===true){Nu.upload(j,i.uniformsList,f,X);r.uniformsNeedUpdate=false}if(r.isSpriteMaterial){h.setValue(j,"center",n.center)}if(c.numMultiviewViews>0){se.updateObjectMatricesUniforms(n,e,h)}else{h.setValue(j,"modelViewMatrix",n.modelViewMatrix);h.setValue(j,"normalMatrix",n.normalMatrix)}h.setValue(j,"modelMatrix",n.matrixWorld);return c}function Ee(e,t){e.opacity.value=t.opacity;if(t.color){e.diffuse.value.copy(t.color)}if(t.emissive){e.emissive.value.copy(t.emissive).multiplyScalar(t.emissiveIntensity)}if(t.map){e.map.value=t.map}if(t.alphaMap){e.alphaMap.value=t.alphaMap}if(t.specularMap){e.specularMap.value=t.specularMap}if(t.envMap){e.envMap.value=t.envMap;e.flipEnvMap.value=t.envMap.isCubeTexture?-1:1;e.reflectivity.value=t.reflectivity;e.refractionRatio.value=t.refractionRatio;e.maxMipLevel.value=q.get(t.envMap).__maxMipLevel}if(t.lightMap){e.lightMap.value=t.lightMap;e.lightMapIntensity.value=t.lightMapIntensity}if(t.aoMap){e.aoMap.value=t.aoMap;e.aoMapIntensity.value=t.aoMapIntensity}var r;if(t.map){r=t.map}else if(t.specularMap){r=t.specularMap}else if(t.displacementMap){r=t.displacementMap}else if(t.normalMap){r=t.normalMap}else if(t.bumpMap){r=t.bumpMap}else if(t.roughnessMap){r=t.roughnessMap}else if(t.metalnessMap){r=t.metalnessMap}else if(t.alphaMap){r=t.alphaMap}else if(t.emissiveMap){r=t.emissiveMap}if(r!==undefined){if(r.isWebGLRenderTarget){r=r.texture}if(r.matrixAutoUpdate===true){r.updateMatrix()}e.uvTransform.value.copy(r.matrix)}}function Me(e,t){e.diffuse.value.copy(t.color);e.opacity.value=t.opacity}function Se(e,t){e.dashSize.value=t.dashSize;e.totalSize.value=t.dashSize+t.gapSize;e.scale.value=t.scale}function Ae(e,t){e.diffuse.value.copy(t.color);e.opacity.value=t.opacity;e.size.value=t.size*P;e.scale.value=R*.5;e.map.value=t.map;if(t.map!==null){if(t.map.matrixAutoUpdate===true){t.map.updateMatrix()}e.uvTransform.value.copy(t.map.matrix)}}function Re(e,t){e.diffuse.value.copy(t.color);e.opacity.value=t.opacity;e.rotation.value=t.rotation;e.map.value=t.map;if(t.map!==null){if(t.map.matrixAutoUpdate===true){t.map.updateMatrix()}e.uvTransform.value.copy(t.map.matrix)}}function Pe(e,t){e.fogColor.value.copy(t.color);if(t.isFog){e.fogNear.value=t.near;e.fogFar.value=t.far}else if(t.isFogExp2){e.fogDensity.value=t.density}}function Ce(e,t){if(t.emissiveMap){e.emissiveMap.value=t.emissiveMap}}function Oe(e,t){e.specular.value.copy(t.specular);e.shininess.value=Math.max(t.shininess,1e-4);if(t.emissiveMap){e.emissiveMap.value=t.emissiveMap}if(t.bumpMap){e.bumpMap.value=t.bumpMap;e.bumpScale.value=t.bumpScale;if(t.side===ze)e.bumpScale.value*=-1}if(t.normalMap){e.normalMap.value=t.normalMap;e.normalScale.value.copy(t.normalScale);if(t.side===ze)e.normalScale.value.negate()}if(t.displacementMap){e.displacementMap.value=t.displacementMap;e.displacementScale.value=t.displacementScale;e.displacementBias.value=t.displacementBias}}function Le(e,t){Oe(e,t);if(t.gradientMap){e.gradientMap.value=t.gradientMap}}function Ie(e,t){e.roughness.value=t.roughness;e.metalness.value=t.metalness;if(t.roughnessMap){e.roughnessMap.value=t.roughnessMap}if(t.metalnessMap){e.metalnessMap.value=t.metalnessMap}if(t.emissiveMap){e.emissiveMap.value=t.emissiveMap}if(t.bumpMap){e.bumpMap.value=t.bumpMap;e.bumpScale.value=t.bumpScale;if(t.side===ze)e.bumpScale.value*=-1}if(t.normalMap){e.normalMap.value=t.normalMap;e.normalScale.value.copy(t.normalScale);if(t.side===ze)e.normalScale.value.negate()}if(t.displacementMap){e.displacementMap.value=t.displacementMap;e.displacementScale.value=t.displacementScale;e.displacementBias.value=t.displacementBias}if(t.envMap){e.envMapIntensity.value=t.envMapIntensity}}function De(e,t){Ie(e,t);e.reflectivity.value=t.reflectivity;e.clearcoat.value=t.clearcoat;e.clearcoatRoughness.value=t.clearcoatRoughness;if(t.sheen)e.sheen.value.copy(t.sheen);if(t.clearcoatNormalMap){e.clearcoatNormalScale.value.copy(t.clearcoatNormalScale);e.clearcoatNormalMap.value=t.clearcoatNormalMap;if(t.side===ze){e.clearcoatNormalScale.value.negate()}}e.transparency.value=t.transparency}function Ne(e,t){if(t.matcap){e.matcap.value=t.matcap}if(t.bumpMap){e.bumpMap.value=t.bumpMap;e.bumpScale.value=t.bumpScale;if(t.side===ze)e.bumpScale.value*=-1}if(t.normalMap){e.normalMap.value=t.normalMap;e.normalScale.value.copy(t.normalScale);if(t.side===ze)e.normalScale.value.negate()}if(t.displacementMap){e.displacementMap.value=t.displacementMap;e.displacementScale.value=t.displacementScale;e.displacementBias.value=t.displacementBias}}function Fe(e,t){if(t.displacementMap){e.displacementMap.value=t.displacementMap;e.displacementScale.value=t.displacementScale;e.displacementBias.value=t.displacementBias}}function Be(e,t){if(t.displacementMap){e.displacementMap.value=t.displacementMap;e.displacementScale.value=t.displacementScale;e.displacementBias.value=t.displacementBias}e.referencePosition.value.copy(t.referencePosition);e.nearDistance.value=t.nearDistance;e.farDistance.value=t.farDistance}function Ue(e,t){if(t.bumpMap){e.bumpMap.value=t.bumpMap;e.bumpScale.value=t.bumpScale;if(t.side===ze)e.bumpScale.value*=-1}if(t.normalMap){e.normalMap.value=t.normalMap;e.normalScale.value.copy(t.normalScale);if(t.side===ze)e.normalScale.value.negate()}if(t.displacementMap){e.displacementMap.value=t.displacementMap;e.displacementScale.value=t.displacementScale;e.displacementBias.value=t.displacementBias}}function ke(e,t){e.ambientLightColor.needsUpdate=t;e.lightProbe.needsUpdate=t;e.directionalLights.needsUpdate=t;e.pointLights.needsUpdate=t;e.spotLights.needsUpdate=t;e.rectAreaLights.needsUpdate=t;e.hemisphereLights.needsUpdate=t}function je(e){return e.isMeshLambertMaterial||e.isMeshPhongMaterial||e.isMeshStandardMaterial||e.isShadowMaterial||e.isShaderMaterial&&e.lights===true}this.setFramebuffer=function(e){if(f!==e)j.bindFramebuffer(36160,e);f=e};this.getActiveCubeFace=function(){return p};this.getActiveMipmapLevel=function(){return v};this.getRenderTarget=function(){return m};this.setRenderTarget=function(e,t,r){m=e;p=t;v=r;if(e&&q.get(e).__webglFramebuffer===undefined){X.setupRenderTarget(e)}var n=f;var i=false;if(e){var a=q.get(e).__webglFramebuffer;if(e.isWebGLRenderTargetCube){n=a[t||0];i=true}else if(e.isWebGLMultisampleRenderTarget){n=q.get(e).__webglMultisampledFramebuffer}else{n=a}E.copy(e.viewport);M.copy(e.scissor);S=e.scissorTest}else{E.copy(C).multiplyScalar(P).floor();M.copy(O).multiplyScalar(P).floor();S=L}if(g!==n){j.bindFramebuffer(36160,n);g=n}V.viewport(E);V.scissor(M);V.setScissorTest(S);if(i){var o=q.get(e.texture);j.framebufferTexture2D(36160,36064,34069+(t||0),o.__webglTexture,r||0)}};this.readRenderTargetPixels=function(e,t,r,n,i,a,o){if(!(e&&e.isWebGLRenderTarget)){console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not THREE.WebGLRenderTarget.");return}var s=q.get(e).__webglFramebuffer;if(e.isWebGLRenderTargetCube&&o!==undefined){s=s[o]}if(s){var u=false;if(s!==g){j.bindFramebuffer(36160,s);u=true}try{var l=e.texture;var c=l.format;var h=l.type;if(c!==qe&&ie.convert(c)!==j.getParameter(35739)){console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not in RGBA or implementation defined format.");return}if(h!==Ge&&ie.convert(h)!==j.getParameter(35738)&&!(h===Ve&&(G.isWebGL2||H.get("OES_texture_float")||H.get("WEBGL_color_buffer_float")))&&!(h===We&&(G.isWebGL2?H.get("EXT_color_buffer_float"):H.get("EXT_color_buffer_half_float")))){console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not in UnsignedByteType or implementation defined type.");return}if(j.checkFramebufferStatus(36160)===36053){if(t>=0&&t<=e.width-n&&r>=0&&r<=e.height-i){j.readPixels(t,r,n,i,ie.convert(c),ie.convert(h),a)}}else{console.error("THREE.WebGLRenderer.readRenderTargetPixels: readPixels from renderTarget failed. Framebuffer not complete.")}}finally{if(u){j.bindFramebuffer(36160,g)}}}};this.copyFramebufferToTexture=function(e,t,r){var n=t.image.width;var i=t.image.height;var a=ie.convert(t.format);X.setTexture2D(t,0);j.copyTexImage2D(3553,r||0,a,e.x,e.y,n,i,0)};this.copyTextureToTexture=function(e,t,r,n){var i=t.image.width;var a=t.image.height;var o=ie.convert(r.format);var s=ie.convert(r.type);X.setTexture2D(r,0);if(t.isDataTexture){j.texSubImage2D(3553,n||0,e.x,e.y,i,a,o,s,t.image.data)}else{j.texSubImage2D(3553,n||0,e.x,e.y,o,s,t.image)}};if(typeof __THREE_DEVTOOLS__!=="undefined"){__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("observe",{detail:this}))}}function Ul(e,t){this.name="";this.color=new Fn(e);this.density=t!==undefined?t:25e-5}Object.assign(Ul.prototype,{isFogExp2:true,clone:function(){return new Ul(this.color,this.density)},toJSON:function(){return{type:"FogExp2",color:this.color.getHex(),density:this.density}}});function kl(e,t,r){this.name="";this.color=new Fn(e);this.near=t!==undefined?t:1;this.far=r!==undefined?r:1e3}Object.assign(kl.prototype,{isFog:true,clone:function(){return new kl(this.color,this.near,this.far)},toJSON:function(){return{type:"Fog",color:this.color.getHex(),near:this.near,far:this.far}}});function jl(e,t){this.array=e;this.stride=t;this.count=e!==undefined?e.length/t:0;this.dynamic=false;this.updateRange={offset:0,count:-1};this.version=0}Object.defineProperty(jl.prototype,"needsUpdate",{set:function(e){if(e===true)this.version++}});Object.assign(jl.prototype,{isInterleavedBuffer:true,onUploadCallback:function(){},setDynamic:function(e){this.dynamic=e;return this},copy:function(e){this.array=new e.array.constructor(e.array);this.count=e.count;this.stride=e.stride;this.dynamic=e.dynamic;return this},copyAt:function(e,t,r){e*=this.stride;r*=t.stride;for(var n=0,i=this.stride;n<i;n++){this.array[e+n]=t.array[r+n]}return this},set:function(e,t){if(t===undefined)t=0;this.array.set(e,t);return this},clone:function(){return(new this.constructor).copy(this)},onUpload:function(e){this.onUploadCallback=e;return this}});function zl(e,t,r,n){this.data=e;this.itemSize=t;this.offset=r;this.normalized=n===true}Object.defineProperties(zl.prototype,{count:{get:function(){return this.data.count}},array:{get:function(){return this.data.array}}});Object.assign(zl.prototype,{isInterleavedBufferAttribute:true,setX:function(e,t){this.data.array[e*this.data.stride+this.offset]=t;return this},setY:function(e,t){this.data.array[e*this.data.stride+this.offset+1]=t;return this},setZ:function(e,t){this.data.array[e*this.data.stride+this.offset+2]=t;return this},setW:function(e,t){this.data.array[e*this.data.stride+this.offset+3]=t;return this},getX:function(e){return this.data.array[e*this.data.stride+this.offset]},getY:function(e){return this.data.array[e*this.data.stride+this.offset+1]},getZ:function(e){return this.data.array[e*this.data.stride+this.offset+2]},getW:function(e){return this.data.array[e*this.data.stride+this.offset+3]},setXY:function(e,t,r){e=e*this.data.stride+this.offset;this.data.array[e+0]=t;this.data.array[e+1]=r;return this},setXYZ:function(e,t,r,n){e=e*this.data.stride+this.offset;this.data.array[e+0]=t;this.data.array[e+1]=r;this.data.array[e+2]=n;return this},setXYZW:function(e,t,r,n,i){e=e*this.data.stride+this.offset;this.data.array[e+0]=t;this.data.array[e+1]=r;this.data.array[e+2]=n;this.data.array[e+3]=i;return this}});function Hl(e){Hn.call(this);this.type="SpriteMaterial";this.color=new Fn(16777215);this.map=null;this.rotation=0;this.sizeAttenuation=true;this.transparent=true;this.setValues(e)}Hl.prototype=Object.create(Hn.prototype);Hl.prototype.constructor=Hl;Hl.prototype.isSpriteMaterial=true;Hl.prototype.copy=function(e){Hn.prototype.copy.call(this,e);this.color.copy(e.color);this.map=e.map;this.rotation=e.rotation;this.sizeAttenuation=e.sizeAttenuation;return this};var Gl;var Vl=new pr;var Wl=new pr;var ql=new pr;var Xl=new cr;var Yl=new cr;var Zl=new Or;var Jl=new pr;var Kl=new pr;var Ql=new pr;var $l=new cr;var ec=new cr;var tc=new cr;function rc(e){Zr.call(this);this.type="Sprite";if(Gl===undefined){Gl=new li;var t=new Float32Array([-.5,-.5,0,0,0,.5,-.5,0,1,0,.5,.5,0,1,1,-.5,.5,0,0,1]);var r=new jl(t,5);Gl.setIndex([0,1,2,0,2,3]);Gl.addAttribute("position",new zl(r,3,0,false));Gl.addAttribute("uv",new zl(r,2,3,false))}this.geometry=Gl;this.material=e!==undefined?e:new Hl;this.center=new cr(.5,.5)}rc.prototype=Object.assign(Object.create(Zr.prototype),{constructor:rc,isSprite:true,raycast:function(e,t){if(e.camera===null){console.error('THREE.Sprite: "Raycaster.camera" needs to be set in order to raycast against sprites.')}Wl.setFromMatrixScale(this.matrixWorld);Zl.copy(e.camera.matrixWorld);this.modelViewMatrix.multiplyMatrices(e.camera.matrixWorldInverse,this.matrixWorld);ql.setFromMatrixPosition(this.modelViewMatrix);if(e.camera.isPerspectiveCamera&&this.material.sizeAttenuation===false){Wl.multiplyScalar(-ql.z)}var r=this.material.rotation;var n,i;if(r!==0){i=Math.cos(r);n=Math.sin(r)}var a=this.center;nc(Jl.set(-.5,-.5,0),ql,a,Wl,n,i);nc(Kl.set(.5,-.5,0),ql,a,Wl,n,i);nc(Ql.set(.5,.5,0),ql,a,Wl,n,i);$l.set(0,0);ec.set(1,0);tc.set(1,1);var o=e.ray.intersectTriangle(Jl,Kl,Ql,false,Vl);if(o===null){nc(Kl.set(-.5,.5,0),ql,a,Wl,n,i);ec.set(0,1);o=e.ray.intersectTriangle(Jl,Ql,Kl,false,Vl);if(o===null){return}}var s=e.ray.origin.distanceTo(Vl);if(s<e.near||s>e.far)return;t.push({distance:s,point:Vl.clone(),uv:Ln.getUV(Vl,Jl,Kl,Ql,$l,ec,tc,new cr),face:null,object:this})},clone:function(){return new this.constructor(this.material).copy(this)},copy:function(e){Zr.prototype.copy.call(this,e);if(e.center!==undefined)this.center.copy(e.center);return this}});function nc(e,t,r,n,i,a){Xl.subVectors(e,r).addScalar(.5).multiply(n);if(i!==undefined){Yl.x=a*Xl.x-i*Xl.y;Yl.y=i*Xl.x+a*Xl.y}else{Yl.copy(Xl)}e.copy(t);e.x+=Yl.x;e.y+=Yl.y;e.applyMatrix4(Zl)}var ic=new pr;var ac=new pr;function oc(){Zr.call(this);this.type="LOD";Object.defineProperties(this,{levels:{enumerable:true,value:[]}});this.autoUpdate=true}oc.prototype=Object.assign(Object.create(Zr.prototype),{constructor:oc,isLOD:true,copy:function(e){Zr.prototype.copy.call(this,e,false);var t=e.levels;for(var r=0,n=t.length;r<n;r++){var i=t[r];this.addLevel(i.object.clone(),i.distance)}return this},addLevel:function(e,t){if(t===undefined)t=0;t=Math.abs(t);var r=this.levels;for(var n=0;n<r.length;n++){if(t<r[n].distance){break}}r.splice(n,0,{distance:t,object:e});this.add(e);return this},getObjectForDistance:function(e){var t=this.levels;for(var r=1,n=t.length;r<n;r++){if(e<t[r].distance){break}}return t[r-1].object},raycast:function(e,t){ic.setFromMatrixPosition(this.matrixWorld);var r=e.ray.origin.distanceTo(ic);this.getObjectForDistance(r).raycast(e,t)},update:function(e){var t=this.levels;if(t.length>1){ic.setFromMatrixPosition(e.matrixWorld);ac.setFromMatrixPosition(this.matrixWorld);var r=ic.distanceTo(ac);t[0].object.visible=true;for(var n=1,i=t.length;n<i;n++){if(r>=t[n].distance){t[n-1].object.visible=false;t[n].object.visible=true}else{break}}for(;n<i;n++){t[n].object.visible=false}}},toJSON:function(e){var t=Zr.prototype.toJSON.call(this,e);t.object.levels=[];var r=this.levels;for(var n=0,i=r.length;n<i;n++){var a=r[n];t.object.levels.push({object:a.object.uuid,distance:a.distance})}return t}});function sc(e,t){if(e&&e.isGeometry){console.error("THREE.SkinnedMesh no longer supports THREE.Geometry. Use THREE.BufferGeometry instead.")}Ai.call(this,e,t);this.type="SkinnedMesh";this.bindMode="attached";this.bindMatrix=new Or;this.bindMatrixInverse=new Or}sc.prototype=Object.assign(Object.create(Ai.prototype),{constructor:sc,isSkinnedMesh:true,bind:function(e,t){this.skeleton=e;if(t===undefined){this.updateMatrixWorld(true);this.skeleton.calculateInverses();t=this.matrixWorld}this.bindMatrix.copy(t);this.bindMatrixInverse.getInverse(t)},pose:function(){this.skeleton.pose()},normalizeSkinWeights:function(){var e=new wr;var t=this.geometry.attributes.skinWeight;for(var r=0,n=t.count;r<n;r++){e.x=t.getX(r);e.y=t.getY(r);e.z=t.getZ(r);e.w=t.getW(r);var i=1/e.manhattanLength();if(i!==Infinity){e.multiplyScalar(i)}else{e.set(1,0,0,0)}t.setXYZW(r,e.x,e.y,e.z,e.w)}},updateMatrixWorld:function(e){Ai.prototype.updateMatrixWorld.call(this,e);if(this.bindMode==="attached"){this.bindMatrixInverse.getInverse(this.matrixWorld)}else if(this.bindMode==="detached"){this.bindMatrixInverse.getInverse(this.bindMatrix)}else{console.warn("THREE.SkinnedMesh: Unrecognized bindMode: "+this.bindMode)}},clone:function(){return new this.constructor(this.geometry,this.material).copy(this)}});var uc=new Or;var lc=new Or;function cc(e,t){e=e||[];this.bones=e.slice(0);this.boneMatrices=new Float32Array(this.bones.length*16);this.frame=-1;if(t===undefined){this.calculateInverses()}else{if(this.bones.length===t.length){this.boneInverses=t.slice(0)}else{console.warn("THREE.Skeleton boneInverses is the wrong length.");this.boneInverses=[];for(var r=0,n=this.bones.length;r<n;r++){this.boneInverses.push(new Or)}}}}Object.assign(cc.prototype,{calculateInverses:function(){this.boneInverses=[];for(var e=0,t=this.bones.length;e<t;e++){var r=new Or;if(this.bones[e]){r.getInverse(this.bones[e].matrixWorld)}this.boneInverses.push(r)}},pose:function(){var e,t,r;for(t=0,r=this.bones.length;t<r;t++){e=this.bones[t];if(e){e.matrixWorld.getInverse(this.boneInverses[t])}}for(t=0,r=this.bones.length;t<r;t++){e=this.bones[t];if(e){if(e.parent&&e.parent.isBone){e.matrix.getInverse(e.parent.matrixWorld);e.matrix.multiply(e.matrixWorld)}else{e.matrix.copy(e.matrixWorld)}e.matrix.decompose(e.position,e.quaternion,e.scale)}}},update:function(){var e=this.bones;var t=this.boneInverses;var r=this.boneMatrices;var n=this.boneTexture;for(var i=0,a=e.length;i<a;i++){var o=e[i]?e[i].matrixWorld:lc;uc.multiplyMatrices(o,t[i]);uc.toArray(r,i*16)}if(n!==undefined){n.needsUpdate=true}},clone:function(){return new cc(this.bones,this.boneInverses)},getBoneByName:function(e){for(var t=0,r=this.bones.length;t<r;t++){var n=this.bones[t];if(n.name===e){return n}}return undefined}});function hc(){Zr.call(this);this.type="Bone"}hc.prototype=Object.assign(Object.create(Zr.prototype),{constructor:hc,isBone:true});function fc(e,t,r){Ai.call(this,e,t);this.instanceMatrix=new Vn(new Float32Array(r*16),16);this.count=r}fc.prototype=Object.assign(Object.create(Ai.prototype),{constructor:fc,isInstancedMesh:true,raycast:function(){},setMatrixAt:function(e,t){t.toArray(this.instanceMatrix.array,e*16)},updateMorphTargets:function(){}});function dc(e){Hn.call(this);this.type="LineBasicMaterial";this.color=new Fn(16777215);this.linewidth=1;this.linecap="round";this.linejoin="round";this.setValues(e)}dc.prototype=Object.create(Hn.prototype);dc.prototype.constructor=dc;dc.prototype.isLineBasicMaterial=true;dc.prototype.copy=function(e){Hn.prototype.copy.call(this,e);this.color.copy(e.color);this.linewidth=e.linewidth;this.linecap=e.linecap;this.linejoin=e.linejoin;return this};var pc=new pr;var vc=new pr;var mc=new Or;var gc=new wn;var yc=new dn;function xc(e,t,r){if(r===1){console.error("THREE.Line: parameter THREE.LinePieces no longer supported. Use THREE.LineSegments instead.")}Zr.call(this);this.type="Line";this.geometry=e!==undefined?e:new li;this.material=t!==undefined?t:new dc({color:Math.random()*16777215})}xc.prototype=Object.assign(Object.create(Zr.prototype),{constructor:xc,isLine:true,computeLineDistances:function(){var e=this.geometry;if(e.isBufferGeometry){if(e.index===null){var t=e.attributes.position;var r=[0];for(var n=1,i=t.count;n<i;n++){pc.fromBufferAttribute(t,n-1);vc.fromBufferAttribute(t,n);r[n]=r[n-1];r[n]+=pc.distanceTo(vc)}e.addAttribute("lineDistance",new Qn(r,1))}else{console.warn("THREE.Line.computeLineDistances(): Computation only possible with non-indexed BufferGeometry.")}}else if(e.isGeometry){var a=e.vertices;var r=e.lineDistances;r[0]=0;for(var n=1,i=a.length;n<i;n++){r[n]=r[n-1];r[n]+=a[n-1].distanceTo(a[n])}}return this},raycast:function(e,t){var r=e.linePrecision;var n=this.geometry;var i=this.matrixWorld;if(n.boundingSphere===null)n.computeBoundingSphere();yc.copy(n.boundingSphere);yc.applyMatrix4(i);yc.radius+=r;if(e.ray.intersectsSphere(yc)===false)return;mc.getInverse(i);gc.copy(e.ray).applyMatrix4(mc);var a=r/((this.scale.x+this.scale.y+this.scale.z)/3);var o=a*a;var s=new pr;var u=new pr;var l=new pr;var c=new pr;var h=this&&this.isLineSegments?2:1;if(n.isBufferGeometry){var f=n.index;var d=n.attributes;var p=d.position.array;if(f!==null){var v=f.array;for(var m=0,g=v.length-1;m<g;m+=h){var y=v[m];var x=v[m+1];s.fromArray(p,y*3);u.fromArray(p,x*3);var b=gc.distanceSqToSegment(s,u,c,l);if(b>o)continue;c.applyMatrix4(this.matrixWorld);var w=e.ray.origin.distanceTo(c);if(w<e.near||w>e.far)continue;t.push({distance:w,point:l.clone().applyMatrix4(this.matrixWorld),index:m,face:null,faceIndex:null,object:this})}}else{for(var m=0,g=p.length/3-1;m<g;m+=h){s.fromArray(p,3*m);u.fromArray(p,3*m+3);var b=gc.distanceSqToSegment(s,u,c,l);if(b>o)continue;c.applyMatrix4(this.matrixWorld);var w=e.ray.origin.distanceTo(c);if(w<e.near||w>e.far)continue;t.push({distance:w,point:l.clone().applyMatrix4(this.matrixWorld),index:m,face:null,faceIndex:null,object:this})}}}else if(n.isGeometry){var _=n.vertices;var T=_.length;for(var m=0;m<T-1;m+=h){var b=gc.distanceSqToSegment(_[m],_[m+1],c,l);if(b>o)continue;c.applyMatrix4(this.matrixWorld);var w=e.ray.origin.distanceTo(c);if(w<e.near||w>e.far)continue;t.push({distance:w,point:l.clone().applyMatrix4(this.matrixWorld),index:m,face:null,faceIndex:null,object:this})}}},clone:function(){return new this.constructor(this.geometry,this.material).copy(this)}});var bc=new pr;var wc=new pr;function _c(e,t){xc.call(this,e,t);this.type="LineSegments"}_c.prototype=Object.assign(Object.create(xc.prototype),{constructor:_c,isLineSegments:true,computeLineDistances:function(){var e=this.geometry;if(e.isBufferGeometry){if(e.index===null){var t=e.attributes.position;var r=[];for(var n=0,i=t.count;n<i;n+=2){bc.fromBufferAttribute(t,n);wc.fromBufferAttribute(t,n+1);r[n]=n===0?0:r[n-1];r[n+1]=r[n]+bc.distanceTo(wc)}e.addAttribute("lineDistance",new Qn(r,1))}else{console.warn("THREE.LineSegments.computeLineDistances(): Computation only possible with non-indexed BufferGeometry.")}}else if(e.isGeometry){var a=e.vertices;var r=e.lineDistances;for(var n=0,i=a.length;n<i;n+=2){bc.copy(a[n]);wc.copy(a[n+1]);r[n]=n===0?0:r[n-1];r[n+1]=r[n]+bc.distanceTo(wc)}}return this}});function Tc(e,t){xc.call(this,e,t);this.type="LineLoop"}Tc.prototype=Object.assign(Object.create(xc.prototype),{constructor:Tc,isLineLoop:true});function Ec(e){Hn.call(this);this.type="PointsMaterial";this.color=new Fn(16777215);this.map=null;this.size=1;this.sizeAttenuation=true;this.morphTargets=false;this.setValues(e)}Ec.prototype=Object.create(Hn.prototype);Ec.prototype.constructor=Ec;Ec.prototype.isPointsMaterial=true;Ec.prototype.copy=function(e){Hn.prototype.copy.call(this,e);this.color.copy(e.color);this.map=e.map;this.size=e.size;this.sizeAttenuation=e.sizeAttenuation;this.morphTargets=e.morphTargets;return this};var Mc=new Or;var Sc=new wn;var Ac=new dn;var Rc=new pr;function Pc(e,t){Zr.call(this);this.type="Points";this.geometry=e!==undefined?e:new li;this.material=t!==undefined?t:new Ec({color:Math.random()*16777215});this.updateMorphTargets()}Pc.prototype=Object.assign(Object.create(Zr.prototype),{constructor:Pc,isPoints:true,raycast:function(e,t){var r=this.geometry;var n=this.matrixWorld;var i=e.params.Points.threshold;if(r.boundingSphere===null)r.computeBoundingSphere();Ac.copy(r.boundingSphere);Ac.applyMatrix4(n);Ac.radius+=i;if(e.ray.intersectsSphere(Ac)===false)return;Mc.getInverse(n);Sc.copy(e.ray).applyMatrix4(Mc);var a=i/((this.scale.x+this.scale.y+this.scale.z)/3);var o=a*a;if(r.isBufferGeometry){var s=r.index;var u=r.attributes;var l=u.position.array;if(s!==null){var c=s.array;for(var h=0,f=c.length;h<f;h++){var d=c[h];Rc.fromArray(l,d*3);Cc(Rc,d,o,n,e,t,this)}}else{for(var h=0,p=l.length/3;h<p;h++){Rc.fromArray(l,h*3);Cc(Rc,h,o,n,e,t,this)}}}else{var v=r.vertices;for(var h=0,p=v.length;h<p;h++){Cc(v[h],h,o,n,e,t,this)}}},updateMorphTargets:function(){var e=this.geometry;var t,r,n;if(e.isBufferGeometry){var i=e.morphAttributes;var a=Object.keys(i);if(a.length>0){var o=i[a[0]];if(o!==undefined){this.morphTargetInfluences=[];this.morphTargetDictionary={};for(t=0,r=o.length;t<r;t++){n=o[t].name||String(t);this.morphTargetInfluences.push(0);this.morphTargetDictionary[n]=t}}}}else{var s=e.morphTargets;if(s!==undefined&&s.length>0){console.error("THREE.Points.updateMorphTargets() does not support THREE.Geometry. Use THREE.BufferGeometry instead.")}}},clone:function(){return new this.constructor(this.geometry,this.material).copy(this)}});function Cc(e,t,r,n,i,a,o){var s=Sc.distanceSqToPoint(e);if(s<r){var u=new pr;Sc.closestPointToPoint(e,u);u.applyMatrix4(n);var l=i.ray.origin.distanceTo(u);if(l<i.near||l>i.far)return;a.push({distance:l,distanceToRay:Math.sqrt(s),point:u,index:t,face:null,object:o})}}function Oc(e,t,r,n,i,a,o,s,u){br.call(this,e,t,r,n,i,a,o,s,u);this.format=o!==undefined?o:Ue;this.minFilter=a!==undefined?a:ie;this.magFilter=i!==undefined?i:ie;this.generateMipmaps=false}Oc.prototype=Object.assign(Object.create(br.prototype),{constructor:Oc,isVideoTexture:true,update:function(){var e=this.image;if(e.readyState>=e.HAVE_CURRENT_DATA){this.needsUpdate=true}}});function Lc(e,t,r,n,i,a,o,s,u,l,c,h){br.call(this,null,a,o,s,u,l,n,i,c,h);this.image={width:t,height:r};this.mipmaps=e;this.flipY=false;this.generateMipmaps=false}Lc.prototype=Object.create(br.prototype);Lc.prototype.constructor=Lc;Lc.prototype.isCompressedTexture=true;function Ic(e,t,r,n,i,a,o,s,u){br.call(this,e,t,r,n,i,a,o,s,u);this.needsUpdate=true}Ic.prototype=Object.create(br.prototype);Ic.prototype.constructor=Ic;Ic.prototype.isCanvasTexture=true;function Dc(e,t,r,n,i,a,o,s,u,l){l=l!==undefined?l:Ye;if(l!==Ye&&l!==Ze){throw new Error("DepthTexture format must be either THREE.DepthFormat or THREE.DepthStencilFormat")}if(r===undefined&&l===Ye)r=Ce;if(r===undefined&&l===Ze)r=Fe;br.call(this,null,n,i,a,o,s,l,r,u);this.image={width:e,height:t};this.magFilter=o!==undefined?o:$;this.minFilter=s!==undefined?s:$;this.flipY=false;this.generateMipmaps=false}Dc.prototype=Object.create(br.prototype);Dc.prototype.constructor=Dc;Dc.prototype.isDepthTexture=true;function Nc(e){li.call(this);this.type="WireframeGeometry";var t=[];var r,n,i,a,o;var s=[0,0],u={},l,c,h;var f,d=["a","b","c"];var p;if(e&&e.isGeometry){var v=e.faces;for(r=0,i=v.length;r<i;r++){var m=v[r];for(n=0;n<3;n++){c=m[d[n]];h=m[d[(n+1)%3]];s[0]=Math.min(c,h);s[1]=Math.max(c,h);f=s[0]+","+s[1];if(u[f]===undefined){u[f]={index1:s[0],index2:s[1]}}}}for(f in u){l=u[f];p=e.vertices[l.index1];t.push(p.x,p.y,p.z);p=e.vertices[l.index2];t.push(p.x,p.y,p.z)}}else if(e&&e.isBufferGeometry){var g,y,x;var b,w,_;var T,E;p=new pr;if(e.index!==null){g=e.attributes.position;y=e.index;x=e.groups;if(x.length===0){x=[{start:0,count:y.count,materialIndex:0}]}for(a=0,o=x.length;a<o;++a){b=x[a];w=b.start;_=b.count;for(r=w,i=w+_;r<i;r+=3){for(n=0;n<3;n++){c=y.getX(r+n);h=y.getX(r+(n+1)%3);s[0]=Math.min(c,h);s[1]=Math.max(c,h);f=s[0]+","+s[1];if(u[f]===undefined){u[f]={index1:s[0],index2:s[1]}}}}}for(f in u){l=u[f];p.fromBufferAttribute(g,l.index1);t.push(p.x,p.y,p.z);p.fromBufferAttribute(g,l.index2);t.push(p.x,p.y,p.z)}}else{g=e.attributes.position;for(r=0,i=g.count/3;r<i;r++){for(n=0;n<3;n++){T=3*r+n;p.fromBufferAttribute(g,T);t.push(p.x,p.y,p.z);E=3*r+(n+1)%3;p.fromBufferAttribute(g,E);t.push(p.x,p.y,p.z)}}}}this.addAttribute("position",new Qn(t,3))}Nc.prototype=Object.create(li.prototype);Nc.prototype.constructor=Nc;function Fc(e,t,r){Di.call(this);this.type="ParametricGeometry";this.parameters={func:e,slices:t,stacks:r};this.fromBufferGeometry(new Bc(e,t,r));this.mergeVertices()}Fc.prototype=Object.create(Di.prototype);Fc.prototype.constructor=Fc;function Bc(e,t,r){li.call(this);this.type="ParametricBufferGeometry";this.parameters={func:e,slices:t,stacks:r};var n=[];var i=[];var a=[];var o=[];var s=1e-5;var u=new pr;var l=new pr,c=new pr;var h=new pr,f=new pr;var d,p;if(e.length<3){console.error("THREE.ParametricGeometry: Function must now modify a Vector3 as third parameter.")}var v=t+1;for(d=0;d<=r;d++){var m=d/r;for(p=0;p<=t;p++){var g=p/t;e(g,m,l);i.push(l.x,l.y,l.z);if(g-s>=0){e(g-s,m,c);h.subVectors(l,c)}else{e(g+s,m,c);h.subVectors(c,l)}if(m-s>=0){e(g,m-s,c);f.subVectors(l,c)}else{e(g,m+s,c);f.subVectors(c,l)}u.crossVectors(h,f).normalize();a.push(u.x,u.y,u.z);o.push(g,m)}}for(d=0;d<r;d++){for(p=0;p<t;p++){var y=d*v+p;var x=d*v+p+1;var b=(d+1)*v+p+1;var w=(d+1)*v+p;n.push(y,x,w);n.push(x,b,w)}}this.setIndex(n);this.addAttribute("position",new Qn(i,3));this.addAttribute("normal",new Qn(a,3));this.addAttribute("uv",new Qn(o,2))}Bc.prototype=Object.create(li.prototype);Bc.prototype.constructor=Bc;function Uc(e,t,r,n){Di.call(this);this.type="PolyhedronGeometry";this.parameters={vertices:e,indices:t,radius:r,detail:n};this.fromBufferGeometry(new kc(e,t,r,n));this.mergeVertices()}Uc.prototype=Object.create(Di.prototype);Uc.prototype.constructor=Uc;function kc(n,a,e,t){li.call(this);this.type="PolyhedronBufferGeometry";this.parameters={vertices:n,indices:a,radius:e,detail:t};e=e||1;t=t||0;var c=[];var h=[];r(t);i(e);s();this.addAttribute("position",new Qn(c,3));this.addAttribute("normal",new Qn(c.slice(),3));this.addAttribute("uv",new Qn(h,2));if(t===0){this.computeVertexNormals()}else{this.normalizeNormals()}function r(e){var t=new pr;var r=new pr;var n=new pr;for(var i=0;i<a.length;i+=3){l(a[i+0],t);l(a[i+1],r);l(a[i+2],n);o(t,r,n,e)}}function o(e,t,r,n){var i=Math.pow(2,n);var a=[];var o,s;for(o=0;o<=i;o++){a[o]=[];var u=e.clone().lerp(r,o/i);var l=t.clone().lerp(r,o/i);var c=i-o;for(s=0;s<=c;s++){if(s===0&&o===i){a[o][s]=u}else{a[o][s]=u.clone().lerp(l,s/c)}}}for(o=0;o<i;o++){for(s=0;s<2*(i-o)-1;s++){var h=Math.floor(s/2);if(s%2===0){f(a[o][h+1]);f(a[o+1][h]);f(a[o][h])}else{f(a[o][h+1]);f(a[o+1][h+1]);f(a[o+1][h])}}}}function i(e){var t=new pr;for(var r=0;r<c.length;r+=3){t.x=c[r+0];t.y=c[r+1];t.z=c[r+2];t.normalize().multiplyScalar(e);c[r+0]=t.x;c[r+1]=t.y;c[r+2]=t.z}}function s(){var e=new pr;for(var t=0;t<c.length;t+=3){e.x=c[t+0];e.y=c[t+1];e.z=c[t+2];var r=v(e)/2/Math.PI+.5;var n=m(e)/Math.PI+.5;h.push(r,1-n)}d();u()}function u(){for(var e=0;e<h.length;e+=6){var t=h[e+0];var r=h[e+2];var n=h[e+4];var i=Math.max(t,r,n);var a=Math.min(t,r,n);if(i>.9&&a<.1){if(t<.2)h[e+0]+=1;if(r<.2)h[e+2]+=1;if(n<.2)h[e+4]+=1}}}function f(e){c.push(e.x,e.y,e.z)}function l(e,t){var r=e*3;t.x=n[r+0];t.y=n[r+1];t.z=n[r+2]}function d(){var e=new pr;var t=new pr;var r=new pr;var n=new pr;var i=new cr;var a=new cr;var o=new cr;for(var s=0,u=0;s<c.length;s+=9,u+=6){e.set(c[s+0],c[s+1],c[s+2]);t.set(c[s+3],c[s+4],c[s+5]);r.set(c[s+6],c[s+7],c[s+8]);i.set(h[u+0],h[u+1]);a.set(h[u+2],h[u+3]);o.set(h[u+4],h[u+5]);n.copy(e).add(t).add(r).divideScalar(3);var l=v(n);p(i,u+0,e,l);p(a,u+2,t,l);p(o,u+4,r,l)}}function p(e,t,r,n){if(n<0&&e.x===1){h[t]=e.x-1}if(r.x===0&&r.z===0){h[t]=n/2/Math.PI+.5}}function v(e){return Math.atan2(e.z,-e.x)}function m(e){return Math.atan2(-e.y,Math.sqrt(e.x*e.x+e.z*e.z))}}kc.prototype=Object.create(li.prototype);kc.prototype.constructor=kc;function jc(e,t){Di.call(this);this.type="TetrahedronGeometry";this.parameters={radius:e,detail:t};this.fromBufferGeometry(new zc(e,t));this.mergeVertices()}jc.prototype=Object.create(Di.prototype);jc.prototype.constructor=jc;function zc(e,t){var r=[1,1,1,-1,-1,1,-1,1,-1,1,-1,-1];var n=[2,1,0,0,3,2,1,3,0,2,3,1];kc.call(this,r,n,e,t);this.type="TetrahedronBufferGeometry";this.parameters={radius:e,detail:t}}zc.prototype=Object.create(kc.prototype);zc.prototype.constructor=zc;function Hc(e,t){Di.call(this);this.type="OctahedronGeometry";this.parameters={radius:e,detail:t};this.fromBufferGeometry(new Gc(e,t));this.mergeVertices()}Hc.prototype=Object.create(Di.prototype);Hc.prototype.constructor=Hc;function Gc(e,t){var r=[1,0,0,-1,0,0,0,1,0,0,-1,0,0,0,1,0,0,-1];var n=[0,2,4,0,4,3,0,3,5,0,5,2,1,2,5,1,5,3,1,3,4,1,4,2];kc.call(this,r,n,e,t);this.type="OctahedronBufferGeometry";this.parameters={radius:e,detail:t}}Gc.prototype=Object.create(kc.prototype);Gc.prototype.constructor=Gc;function Vc(e,t){Di.call(this);this.type="IcosahedronGeometry";this.parameters={radius:e,detail:t};this.fromBufferGeometry(new Wc(e,t));this.mergeVertices()}Vc.prototype=Object.create(Di.prototype);Vc.prototype.constructor=Vc;function Wc(e,t){var r=(1+Math.sqrt(5))/2;var n=[-1,r,0,1,r,0,-1,-r,0,1,-r,0,0,-1,r,0,1,r,0,-1,-r,0,1,-r,r,0,-1,r,0,1,-r,0,-1,-r,0,1];var i=[0,11,5,0,5,1,0,1,7,0,7,10,0,10,11,1,5,9,5,11,4,11,10,2,10,7,6,7,1,8,3,9,4,3,4,2,3,2,6,3,6,8,3,8,9,4,9,5,2,4,11,6,2,10,8,6,7,9,8,1];kc.call(this,n,i,e,t);this.type="IcosahedronBufferGeometry";this.parameters={radius:e,detail:t}}Wc.prototype=Object.create(kc.prototype);Wc.prototype.constructor=Wc;function qc(e,t){Di.call(this);this.type="DodecahedronGeometry";this.parameters={radius:e,detail:t};this.fromBufferGeometry(new Xc(e,t));this.mergeVertices()}qc.prototype=Object.create(Di.prototype);qc.prototype.constructor=qc;function Xc(e,t){var r=(1+Math.sqrt(5))/2;var n=1/r;var i=[-1,-1,-1,-1,-1,1,-1,1,-1,-1,1,1,1,-1,-1,1,-1,1,1,1,-1,1,1,1,0,-n,-r,0,-n,r,0,n,-r,0,n,r,-n,-r,0,-n,r,0,n,-r,0,n,r,0,-r,0,-n,r,0,-n,-r,0,n,r,0,n];var a=[3,11,7,3,7,15,3,15,13,7,19,17,7,17,6,7,6,15,17,4,8,17,8,10,17,10,6,8,0,16,8,16,2,8,2,10,0,12,1,0,1,18,0,18,16,6,10,2,6,2,13,6,13,15,2,16,18,2,18,3,2,3,13,18,1,9,18,9,11,18,11,3,4,14,12,4,12,0,4,0,8,11,9,5,11,5,19,11,19,7,19,5,14,19,14,4,19,4,17,1,12,14,1,14,5,1,5,9];kc.call(this,i,a,e,t);this.type="DodecahedronBufferGeometry";this.parameters={radius:e,detail:t}}Xc.prototype=Object.create(kc.prototype);Xc.prototype.constructor=Xc;function Yc(e,t,r,n,i,a){Di.call(this);this.type="TubeGeometry";this.parameters={path:e,tubularSegments:t,radius:r,radialSegments:n,closed:i};if(a!==undefined)console.warn("THREE.TubeGeometry: taper has been removed.");var o=new Zc(e,t,r,n,i);this.tangents=o.tangents;this.normals=o.normals;this.binormals=o.binormals;this.fromBufferGeometry(o);this.mergeVertices()}Yc.prototype=Object.create(Di.prototype);Yc.prototype.constructor=Yc;function Zc(o,s,u,l,e){li.call(this);this.type="TubeBufferGeometry";this.parameters={path:o,tubularSegments:s,radius:u,radialSegments:l,closed:e};s=s||64;u=u||1;l=l||8;e=e||false;var c=o.computeFrenetFrames(s,e);this.tangents=c.tangents;this.normals=c.normals;this.binormals=c.binormals;var h=new pr;var f=new pr;var t=new cr;var d=new pr;var i,p;var v=[];var m=[];var r=[];var a=[];n();this.setIndex(a);this.addAttribute("position",new Qn(v,3));this.addAttribute("normal",new Qn(m,3));this.addAttribute("uv",new Qn(r,2));function n(){for(i=0;i<s;i++){g(i)}g(e===false?s:0);x();y()}function g(e){d=o.getPointAt(e/s,d);var t=c.normals[e];var r=c.binormals[e];for(p=0;p<=l;p++){var n=p/l*Math.PI*2;var i=Math.sin(n);var a=-Math.cos(n);f.x=a*t.x+i*r.x;f.y=a*t.y+i*r.y;f.z=a*t.z+i*r.z;f.normalize();m.push(f.x,f.y,f.z);h.x=d.x+u*f.x;h.y=d.y+u*f.y;h.z=d.z+u*f.z;v.push(h.x,h.y,h.z)}}function y(){for(p=1;p<=s;p++){for(i=1;i<=l;i++){var e=(l+1)*(p-1)+(i-1);var t=(l+1)*p+(i-1);var r=(l+1)*p+i;var n=(l+1)*(p-1)+i;a.push(e,t,n);a.push(t,r,n)}}}function x(){for(i=0;i<=s;i++){for(p=0;p<=l;p++){t.x=i/s;t.y=p/l;r.push(t.x,t.y)}}}}Zc.prototype=Object.create(li.prototype);Zc.prototype.constructor=Zc;Zc.prototype.toJSON=function(){var e=li.prototype.toJSON.call(this);e.path=this.parameters.path.toJSON();return e};function Jc(e,t,r,n,i,a,o){Di.call(this);this.type="TorusKnotGeometry";this.parameters={radius:e,tube:t,tubularSegments:r,radialSegments:n,p:i,q:a};if(o!==undefined)console.warn("THREE.TorusKnotGeometry: heightScale has been deprecated. Use .scale( x, y, z ) instead.");this.fromBufferGeometry(new Kc(e,t,r,n,i,a));this.mergeVertices()}Jc.prototype=Object.create(Di.prototype);Jc.prototype.constructor=Jc;function Kc(e,t,r,n,i,a){li.call(this);this.type="TorusKnotBufferGeometry";this.parameters={radius:e,tube:t,tubularSegments:r,radialSegments:n,p:i,q:a};e=e||1;t=t||.4;r=Math.floor(r)||64;n=Math.floor(n)||8;i=i||2;a=a||3;var o=[];var s=[];var u=[];var l=[];var c,h;var f=new pr;var d=new pr;var p=new pr;var v=new pr;var m=new pr;var g=new pr;var y=new pr;for(c=0;c<=r;++c){var x=c/r*i*Math.PI*2;A(x,i,a,e,p);A(x+.01,i,a,e,v);g.subVectors(v,p);y.addVectors(v,p);m.crossVectors(g,y);y.crossVectors(m,g);m.normalize();y.normalize();for(h=0;h<=n;++h){var b=h/n*Math.PI*2;var w=-t*Math.cos(b);var _=t*Math.sin(b);f.x=p.x+(w*y.x+_*m.x);f.y=p.y+(w*y.y+_*m.y);f.z=p.z+(w*y.z+_*m.z);s.push(f.x,f.y,f.z);d.subVectors(f,p).normalize();u.push(d.x,d.y,d.z);l.push(c/r);l.push(h/n)}}for(h=1;h<=r;h++){for(c=1;c<=n;c++){var T=(n+1)*(h-1)+(c-1);var E=(n+1)*h+(c-1);var M=(n+1)*h+c;var S=(n+1)*(h-1)+c;o.push(T,E,S);o.push(E,M,S)}}this.setIndex(o);this.addAttribute("position",new Qn(s,3));this.addAttribute("normal",new Qn(u,3));this.addAttribute("uv",new Qn(l,2));function A(e,t,r,n,i){var a=Math.cos(e);var o=Math.sin(e);var s=r/t*e;var u=Math.cos(s);i.x=n*(2+u)*.5*a;i.y=n*(2+u)*o*.5;i.z=n*Math.sin(s)*.5}}Kc.prototype=Object.create(li.prototype);Kc.prototype.constructor=Kc;function Qc(e,t,r,n,i){Di.call(this);this.type="TorusGeometry";this.parameters={radius:e,tube:t,radialSegments:r,tubularSegments:n,arc:i};this.fromBufferGeometry(new $c(e,t,r,n,i));this.mergeVertices()}Qc.prototype=Object.create(Di.prototype);Qc.prototype.constructor=Qc;function $c(e,t,r,n,i){li.call(this);this.type="TorusBufferGeometry";this.parameters={radius:e,tube:t,radialSegments:r,tubularSegments:n,arc:i};e=e||1;t=t||.4;r=Math.floor(r)||8;n=Math.floor(n)||6;i=i||Math.PI*2;var a=[];var o=[];var s=[];var u=[];var l=new pr;var c=new pr;var h=new pr;var f,d;for(f=0;f<=r;f++){for(d=0;d<=n;d++){var p=d/n*i;var v=f/r*Math.PI*2;c.x=(e+t*Math.cos(v))*Math.cos(p);c.y=(e+t*Math.cos(v))*Math.sin(p);c.z=t*Math.sin(v);o.push(c.x,c.y,c.z);l.x=e*Math.cos(p);l.y=e*Math.sin(p);h.subVectors(c,l).normalize();s.push(h.x,h.y,h.z);u.push(d/n);u.push(f/r)}}for(f=1;f<=r;f++){for(d=1;d<=n;d++){var m=(n+1)*f+d-1;var g=(n+1)*(f-1)+d-1;var y=(n+1)*(f-1)+d;var x=(n+1)*f+d;a.push(m,g,x);a.push(g,y,x)}}this.setIndex(a);this.addAttribute("position",new Qn(o,3));this.addAttribute("normal",new Qn(s,3));this.addAttribute("uv",new Qn(u,2))}$c.prototype=Object.create(li.prototype);$c.prototype.constructor=$c;var eh={triangulate:function(e,t,r){r=r||2;var n=t&&t.length,i=n?t[0]*r:e.length,a=th(e,0,i,r,true),o=[];if(!a||a.next===a.prev)return o;var s,u,l,c,h,f,d;if(n)a=uh(e,t,a,r);if(e.length>80*r){s=l=e[0];u=c=e[1];for(var p=r;p<i;p+=r){h=e[p];f=e[p+1];if(h<s)s=h;if(f<u)u=f;if(h>l)l=h;if(f>c)c=f}d=Math.max(l-s,c-u);d=d!==0?1/d:0}nh(a,o,r,s,u,d);return o}};function th(e,t,r,n,i){var a,o;if(i===Rh(e,t,r,n)>0){for(a=t;a<r;a+=n)o=Mh(a,e[a],e[a+1],o)}else{for(a=r-n;a>=t;a-=n)o=Mh(a,e[a],e[a+1],o)}if(o&&xh(o,o.next)){Sh(o);o=o.next}return o}function rh(e,t){if(!e)return e;if(!t)t=e;var r=e,n;do{n=false;if(!r.steiner&&(xh(r,r.next)||yh(r.prev,r,r.next)===0)){Sh(r);r=t=r.prev;if(r===r.next)break;n=true}else{r=r.next}}while(n||r!==t);return t}function nh(e,t,r,n,i,a,o){if(!e)return;if(!o&&a)fh(e,n,i,a);var s=e,u,l;while(e.prev!==e.next){u=e.prev;l=e.next;if(a?ah(e,n,i,a):ih(e)){t.push(u.i/r);t.push(e.i/r);t.push(l.i/r);Sh(e);e=l.next;s=l.next;continue}e=l;if(e===s){if(!o){nh(rh(e),t,r,n,i,a,1)}else if(o===1){e=oh(e,t,r);nh(e,t,r,n,i,a,2)}else if(o===2){sh(e,t,r,n,i,a)}break}}}function ih(e){var t=e.prev,r=e,n=e.next;if(yh(t,r,n)>=0)return false;var i=e.next.next;while(i!==e.prev){if(mh(t.x,t.y,r.x,r.y,n.x,n.y,i.x,i.y)&&yh(i.prev,i,i.next)>=0)return false;i=i.next}return true}function ah(e,t,r,n){var i=e.prev,a=e,o=e.next;if(yh(i,a,o)>=0)return false;var s=i.x<a.x?i.x<o.x?i.x:o.x:a.x<o.x?a.x:o.x,u=i.y<a.y?i.y<o.y?i.y:o.y:a.y<o.y?a.y:o.y,l=i.x>a.x?i.x>o.x?i.x:o.x:a.x>o.x?a.x:o.x,c=i.y>a.y?i.y>o.y?i.y:o.y:a.y>o.y?a.y:o.y;var h=ph(s,u,t,r,n),f=ph(l,c,t,r,n);var d=e.prevZ,p=e.nextZ;while(d&&d.z>=h&&p&&p.z<=f){if(d!==e.prev&&d!==e.next&&mh(i.x,i.y,a.x,a.y,o.x,o.y,d.x,d.y)&&yh(d.prev,d,d.next)>=0)return false;d=d.prevZ;if(p!==e.prev&&p!==e.next&&mh(i.x,i.y,a.x,a.y,o.x,o.y,p.x,p.y)&&yh(p.prev,p,p.next)>=0)return false;p=p.nextZ}while(d&&d.z>=h){if(d!==e.prev&&d!==e.next&&mh(i.x,i.y,a.x,a.y,o.x,o.y,d.x,d.y)&&yh(d.prev,d,d.next)>=0)return false;d=d.prevZ}while(p&&p.z<=f){if(p!==e.prev&&p!==e.next&&mh(i.x,i.y,a.x,a.y,o.x,o.y,p.x,p.y)&&yh(p.prev,p,p.next)>=0)return false;p=p.nextZ}return true}function oh(e,t,r){var n=e;do{var i=n.prev,a=n.next.next;if(!xh(i,a)&&bh(i,n,n.next,a)&&_h(i,a)&&_h(a,i)){t.push(i.i/r);t.push(n.i/r);t.push(a.i/r);Sh(n);Sh(n.next);n=e=a}n=n.next}while(n!==e);return n}function sh(e,t,r,n,i,a){var o=e;do{var s=o.next.next;while(s!==o.prev){if(o.i!==s.i&&gh(o,s)){var u=Eh(o,s);o=rh(o,o.next);u=rh(u,u.next);nh(o,t,r,n,i,a);nh(u,t,r,n,i,a);return}s=s.next}o=o.next}while(o!==e)}function uh(e,t,r,n){var i=[],a,o,s,u,l;for(a=0,o=t.length;a<o;a++){s=t[a]*n;u=a<o-1?t[a+1]*n:e.length;l=th(e,s,u,n,false);if(l===l.next)l.steiner=true;i.push(vh(l))}i.sort(lh);for(a=0;a<i.length;a++){ch(i[a],r);r=rh(r,r.next)}return r}function lh(e,t){return e.x-t.x}function ch(e,t){t=hh(e,t);if(t){var r=Eh(t,e);rh(r,r.next)}}function hh(e,t){var r=t,n=e.x,i=e.y,a=-Infinity,o;do{if(i<=r.y&&i>=r.next.y&&r.next.y!==r.y){var s=r.x+(i-r.y)*(r.next.x-r.x)/(r.next.y-r.y);if(s<=n&&s>a){a=s;if(s===n){if(i===r.y)return r;if(i===r.next.y)return r.next}o=r.x<r.next.x?r:r.next}}r=r.next}while(r!==t);if(!o)return null;if(n===a)return o.prev;var u=o,l=o.x,c=o.y,h=Infinity,f;r=o.next;while(r!==u){if(n>=r.x&&r.x>=l&&n!==r.x&&mh(i<c?n:a,i,l,c,i<c?a:n,i,r.x,r.y)){f=Math.abs(i-r.y)/(n-r.x);if((f<h||f===h&&r.x>o.x)&&_h(r,e)){o=r;h=f}}r=r.next}return o}function fh(e,t,r,n){var i=e;do{if(i.z===null)i.z=ph(i.x,i.y,t,r,n);i.prevZ=i.prev;i.nextZ=i.next;i=i.next}while(i!==e);i.prevZ.nextZ=null;i.prevZ=null;dh(i)}function dh(e){var t,r,n,i,a,o,s,u,l=1;do{r=e;e=null;a=null;o=0;while(r){o++;n=r;s=0;for(t=0;t<l;t++){s++;n=n.nextZ;if(!n)break}u=l;while(s>0||u>0&&n){if(s!==0&&(u===0||!n||r.z<=n.z)){i=r;r=r.nextZ;s--}else{i=n;n=n.nextZ;u--}if(a)a.nextZ=i;else e=i;i.prevZ=a;a=i}r=n}a.nextZ=null;l*=2}while(o>1);return e}function ph(e,t,r,n,i){e=32767*(e-r)*i;t=32767*(t-n)*i;e=(e|e<<8)&16711935;e=(e|e<<4)&252645135;e=(e|e<<2)&858993459;e=(e|e<<1)&1431655765;t=(t|t<<8)&16711935;t=(t|t<<4)&252645135;t=(t|t<<2)&858993459;t=(t|t<<1)&1431655765;return e|t<<1}function vh(e){var t=e,r=e;do{if(t.x<r.x||t.x===r.x&&t.y<r.y)r=t;t=t.next}while(t!==e);return r}function mh(e,t,r,n,i,a,o,s){return(i-o)*(t-s)-(e-o)*(a-s)>=0&&(e-o)*(n-s)-(r-o)*(t-s)>=0&&(r-o)*(a-s)-(i-o)*(n-s)>=0}function gh(e,t){return e.next.i!==t.i&&e.prev.i!==t.i&&!wh(e,t)&&_h(e,t)&&_h(t,e)&&Th(e,t)}function yh(e,t,r){return(t.y-e.y)*(r.x-t.x)-(t.x-e.x)*(r.y-t.y)}function xh(e,t){return e.x===t.x&&e.y===t.y}function bh(e,t,r,n){if(xh(e,r)&&xh(t,n)||xh(e,n)&&xh(r,t))return true;return yh(e,t,r)>0!==yh(e,t,n)>0&&yh(r,n,e)>0!==yh(r,n,t)>0}function wh(e,t){var r=e;do{if(r.i!==e.i&&r.next.i!==e.i&&r.i!==t.i&&r.next.i!==t.i&&bh(r,r.next,e,t))return true;r=r.next}while(r!==e);return false}function _h(e,t){return yh(e.prev,e,e.next)<0?yh(e,t,e.next)>=0&&yh(e,e.prev,t)>=0:yh(e,t,e.prev)<0||yh(e,e.next,t)<0}function Th(e,t){var r=e,n=false,i=(e.x+t.x)/2,a=(e.y+t.y)/2;do{if(r.y>a!==r.next.y>a&&r.next.y!==r.y&&i<(r.next.x-r.x)*(a-r.y)/(r.next.y-r.y)+r.x)n=!n;r=r.next}while(r!==e);return n}function Eh(e,t){var r=new Ah(e.i,e.x,e.y),n=new Ah(t.i,t.x,t.y),i=e.next,a=t.prev;e.next=t;t.prev=e;r.next=i;i.prev=r;n.next=r;r.prev=n;a.next=n;n.prev=a;return n}function Mh(e,t,r,n){var i=new Ah(e,t,r);if(!n){i.prev=i;i.next=i}else{i.next=n.next;i.prev=n;n.next.prev=i;n.next=i}return i}function Sh(e){e.next.prev=e.prev;e.prev.next=e.next;if(e.prevZ)e.prevZ.nextZ=e.nextZ;if(e.nextZ)e.nextZ.prevZ=e.prevZ}function Ah(e,t,r){this.i=e;this.x=t;this.y=r;this.prev=null;this.next=null;this.z=null;this.prevZ=null;this.nextZ=null;this.steiner=false}function Rh(e,t,r,n){var i=0;for(var a=t,o=r-n;a<r;a+=n){i+=(e[o]-e[a])*(e[a+1]+e[o+1]);o=a}return i}var Ph={area:function(e){var t=e.length;var r=0;for(var n=t-1,i=0;i<t;n=i++){r+=e[n].x*e[i].y-e[i].x*e[n].y}return r*.5},isClockWise:function(e){return Ph.area(e)<0},triangulateShape:function(e,t){var r=[];var n=[];var i=[];Ch(e);Oh(r,e);var a=e.length;t.forEach(Ch);for(var o=0;o<t.length;o++){n.push(a);a+=t[o].length;Oh(r,t[o])}var s=eh.triangulate(r,n);for(var o=0;o<s.length;o+=3){i.push(s.slice(o,o+3))}return i}};r.ShapeUtils=Ph;function Ch(e){var t=e.length;if(t>2&&e[t-1].equals(e[0])){e.pop()}}function Oh(e,t){for(var r=0;r<t.length;r++){e.push(t[r].x);e.push(t[r].y)}}function Lh(e,t){Di.call(this);this.type="ExtrudeGeometry";this.parameters={shapes:e,options:t};this.fromBufferGeometry(new Ih(e,t));this.mergeVertices()}Lh.prototype=Object.create(Di.prototype);Lh.prototype.constructor=Lh;Lh.prototype.toJSON=function(){var e=Di.prototype.toJSON.call(this);var t=this.parameters.shapes;var r=this.parameters.options;return Nh(t,r,e)};function Ih(e,ee){li.call(this);this.type="ExtrudeBufferGeometry";this.parameters={shapes:e,options:ee};e=Array.isArray(e)?e:[e];var te=this;var re=[];var ne=[];for(var t=0,r=e.length;t<r;t++){var n=e[t];i(n)}this.addAttribute("position",new Qn(re,3));this.addAttribute("uv",new Qn(ne,2));this.computeVertexNormals();function i(e){var n=[];var t=ee.curveSegments!==undefined?ee.curveSegments:12;var f=ee.steps!==undefined?ee.steps:1;var r=ee.depth!==undefined?ee.depth:100;var i=ee.bevelEnabled!==undefined?ee.bevelEnabled:true;var a=ee.bevelThickness!==undefined?ee.bevelThickness:6;var o=ee.bevelSize!==undefined?ee.bevelSize:a-2;var s=ee.bevelOffset!==undefined?ee.bevelOffset:0;var d=ee.bevelSegments!==undefined?ee.bevelSegments:3;var u=ee.extrudePath;var l=ee.UVGenerator!==undefined?ee.UVGenerator:Dh;if(ee.amount!==undefined){console.warn("THREE.ExtrudeBufferGeometry: amount has been renamed to depth.");r=ee.amount}var c,h=false;var p,v,m,g;if(u){c=u.getSpacedPoints(f);h=true;i=false;p=u.computeFrenetFrames(f,false);v=new pr;m=new pr;g=new pr}if(!i){d=0;a=0;o=0;s=0}var y,x,b;var w=e.extractPoints(t);var _=w.shape;var T=w.holes;var E=!Ph.isClockWise(_);if(E){_=_.reverse();for(x=0,b=T.length;x<b;x++){y=T[x];if(Ph.isClockWise(y)){T[x]=y.reverse()}}}var M=Ph.triangulateShape(_,T);var S=_;for(x=0,b=T.length;x<b;x++){y=T[x];_=_.concat(y)}function A(e,t,r){if(!t)console.error("THREE.ExtrudeGeometry: vec does not exist");return t.clone().multiplyScalar(r).add(e)}var R,P,C,O,L,I=_.length,D,N=M.length;function F(e,t,r){var n,i,a;var o=e.x-t.x,s=e.y-t.y;var u=r.x-e.x,l=r.y-e.y;var c=o*o+s*s;var h=o*l-s*u;if(Math.abs(h)>Number.EPSILON){var f=Math.sqrt(c);var d=Math.sqrt(u*u+l*l);var p=t.x-s/f;var v=t.y+o/f;var m=r.x-l/d;var g=r.y+u/d;var y=((m-p)*l-(g-v)*u)/(o*l-s*u);n=p+o*y-e.x;i=v+s*y-e.y;var x=n*n+i*i;if(x<=2){return new cr(n,i)}else{a=Math.sqrt(x/2)}}else{var b=false;if(o>Number.EPSILON){if(u>Number.EPSILON){b=true}}else{if(o<-Number.EPSILON){if(u<-Number.EPSILON){b=true}}else{if(Math.sign(s)===Math.sign(l)){b=true}}}if(b){n=-s;i=o;a=Math.sqrt(c)}else{n=o;i=s;a=Math.sqrt(c/2)}}return new cr(n/a,i/a)}var B=[];for(var U=0,k=S.length,j=k-1,z=U+1;U<k;U++,j++,z++){if(j===k)j=0;if(z===k)z=0;B[U]=F(S[U],S[j],S[z])}var H=[],G,V=B.concat();for(x=0,b=T.length;x<b;x++){y=T[x];G=[];for(U=0,k=y.length,j=k-1,z=U+1;U<k;U++,j++,z++){if(j===k)j=0;if(z===k)z=0;G[U]=F(y[U],y[j],y[z])}H.push(G);V=V.concat(G)}for(R=0;R<d;R++){C=R/d;O=a*Math.cos(C*Math.PI/2);P=o*Math.sin(C*Math.PI/2)+s;for(U=0,k=S.length;U<k;U++){L=A(S[U],B[U],P);Z(L.x,L.y,-O)}for(x=0,b=T.length;x<b;x++){y=T[x];G=H[x];for(U=0,k=y.length;U<k;U++){L=A(y[U],G[U],P);Z(L.x,L.y,-O)}}}P=o+s;for(U=0;U<I;U++){L=i?A(_[U],V[U],P):_[U];if(!h){Z(L.x,L.y,0)}else{m.copy(p.normals[0]).multiplyScalar(L.x);v.copy(p.binormals[0]).multiplyScalar(L.y);g.copy(c[0]).add(m).add(v);Z(g.x,g.y,g.z)}}var W;for(W=1;W<=f;W++){for(U=0;U<I;U++){L=i?A(_[U],V[U],P):_[U];if(!h){Z(L.x,L.y,r/f*W)}else{m.copy(p.normals[W]).multiplyScalar(L.x);v.copy(p.binormals[W]).multiplyScalar(L.y);g.copy(c[W]).add(m).add(v);Z(g.x,g.y,g.z)}}}for(R=d-1;R>=0;R--){C=R/d;O=a*Math.cos(C*Math.PI/2);P=o*Math.sin(C*Math.PI/2)+s;for(U=0,k=S.length;U<k;U++){L=A(S[U],B[U],P);Z(L.x,L.y,r+O)}for(x=0,b=T.length;x<b;x++){y=T[x];G=H[x];for(U=0,k=y.length;U<k;U++){L=A(y[U],G[U],P);if(!h){Z(L.x,L.y,r+O)}else{Z(L.x,L.y+c[f-1].y,c[f-1].x+O)}}}}q();X();function q(){var e=re.length/3;if(i){var t=0;var r=I*t;for(U=0;U<N;U++){D=M[U];J(D[2]+r,D[1]+r,D[0]+r)}t=f+d*2;r=I*t;for(U=0;U<N;U++){D=M[U];J(D[0]+r,D[1]+r,D[2]+r)}}else{for(U=0;U<N;U++){D=M[U];J(D[2],D[1],D[0])}for(U=0;U<N;U++){D=M[U];J(D[0]+I*f,D[1]+I*f,D[2]+I*f)}}te.addGroup(e,re.length/3-e,0)}function X(){var e=re.length/3;var t=0;Y(S,t);t+=S.length;for(x=0,b=T.length;x<b;x++){y=T[x];Y(y,t);t+=y.length}te.addGroup(e,re.length/3-e,1)}function Y(e,t){var r,n;U=e.length;while(--U>=0){r=U;n=U-1;if(n<0)n=e.length-1;var i=0,a=f+d*2;for(i=0;i<a;i++){var o=I*i;var s=I*(i+1);var u=t+r+o,l=t+n+o,c=t+n+s,h=t+r+s;K(u,l,c,h)}}}function Z(e,t,r){n.push(e);n.push(t);n.push(r)}function J(e,t,r){Q(e);Q(t);Q(r);var n=re.length/3;var i=l.generateTopUV(te,re,n-3,n-2,n-1);$(i[0]);$(i[1]);$(i[2])}function K(e,t,r,n){Q(e);Q(t);Q(n);Q(t);Q(r);Q(n);var i=re.length/3;var a=l.generateSideWallUV(te,re,i-6,i-3,i-2,i-1);$(a[0]);$(a[1]);$(a[3]);$(a[1]);$(a[2]);$(a[3])}function Q(e){re.push(n[e*3+0]);re.push(n[e*3+1]);re.push(n[e*3+2])}function $(e){ne.push(e.x);ne.push(e.y)}}}Ih.prototype=Object.create(li.prototype);Ih.prototype.constructor=Ih;Ih.prototype.toJSON=function(){var e=li.prototype.toJSON.call(this);var t=this.parameters.shapes;var r=this.parameters.options;return Nh(t,r,e)};var Dh={generateTopUV:function(e,t,r,n,i){var a=t[r*3];var o=t[r*3+1];var s=t[n*3];var u=t[n*3+1];var l=t[i*3];var c=t[i*3+1];return[new cr(a,o),new cr(s,u),new cr(l,c)]},generateSideWallUV:function(e,t,r,n,i,a){var o=t[r*3];var s=t[r*3+1];var u=t[r*3+2];var l=t[n*3];var c=t[n*3+1];var h=t[n*3+2];var f=t[i*3];var d=t[i*3+1];var p=t[i*3+2];var v=t[a*3];var m=t[a*3+1];var g=t[a*3+2];if(Math.abs(s-c)<.01){return[new cr(o,1-u),new cr(l,1-h),new cr(f,1-p),new cr(v,1-g)]}else{return[new cr(s,1-u),new cr(c,1-h),new cr(d,1-p),new cr(m,1-g)]}}};function Nh(e,t,r){r.shapes=[];if(Array.isArray(e)){for(var n=0,i=e.length;n<i;n++){var a=e[n];r.shapes.push(a.uuid)}}else{r.shapes.push(e.uuid)}if(t.extrudePath!==undefined)r.options.extrudePath=t.extrudePath.toJSON();return r}function Fh(e,t){Di.call(this);this.type="TextGeometry";this.parameters={text:e,parameters:t};this.fromBufferGeometry(new Bh(e,t));this.mergeVertices()}Fh.prototype=Object.create(Di.prototype);Fh.prototype.constructor=Fh;function Bh(e,t){t=t||{};var r=t.font;if(!(r&&r.isFont)){console.error("THREE.TextGeometry: font parameter is not an instance of THREE.Font.");return new Di}var n=r.generateShapes(e,t.size);t.depth=t.height!==undefined?t.height:50;if(t.bevelThickness===undefined)t.bevelThickness=10;if(t.bevelSize===undefined)t.bevelSize=8;if(t.bevelEnabled===undefined)t.bevelEnabled=false;Ih.call(this,n,t);this.type="TextBufferGeometry"}Bh.prototype=Object.create(Ih.prototype);Bh.prototype.constructor=Bh;function Uh(e,t,r,n,i,a,o){Di.call(this);this.type="SphereGeometry";this.parameters={radius:e,widthSegments:t,heightSegments:r,phiStart:n,phiLength:i,thetaStart:a,thetaLength:o};this.fromBufferGeometry(new kh(e,t,r,n,i,a,o));this.mergeVertices()}Uh.prototype=Object.create(Di.prototype);Uh.prototype.constructor=Uh;function kh(e,t,r,n,i,a,o){li.call(this);this.type="SphereBufferGeometry";this.parameters={radius:e,widthSegments:t,heightSegments:r,phiStart:n,phiLength:i,thetaStart:a,thetaLength:o};e=e||1;t=Math.max(3,Math.floor(t)||8);r=Math.max(2,Math.floor(r)||6);n=n!==undefined?n:0;i=i!==undefined?i:Math.PI*2;a=a!==undefined?a:0;o=o!==undefined?o:Math.PI;var s=Math.min(a+o,Math.PI);var u,l;var c=0;var h=[];var f=new pr;var d=new pr;var p=[];var v=[];var m=[];var g=[];for(l=0;l<=r;l++){var y=[];var x=l/r;var b=0;if(l==0&&a==0){b=.5/t}else if(l==r&&s==Math.PI){b=-.5/t}for(u=0;u<=t;u++){var w=u/t;f.x=-e*Math.cos(n+w*i)*Math.sin(a+x*o);f.y=e*Math.cos(a+x*o);f.z=e*Math.sin(n+w*i)*Math.sin(a+x*o);v.push(f.x,f.y,f.z);d.copy(f).normalize();m.push(d.x,d.y,d.z);g.push(w+b,1-x);y.push(c++)}h.push(y)}for(l=0;l<r;l++){for(u=0;u<t;u++){var _=h[l][u+1];var T=h[l][u];var E=h[l+1][u];var M=h[l+1][u+1];if(l!==0||a>0)p.push(_,T,M);if(l!==r-1||s<Math.PI)p.push(T,E,M)}}this.setIndex(p);this.addAttribute("position",new Qn(v,3));this.addAttribute("normal",new Qn(m,3));this.addAttribute("uv",new Qn(g,2))}kh.prototype=Object.create(li.prototype);kh.prototype.constructor=kh;function jh(e,t,r,n,i,a){Di.call(this);this.type="RingGeometry";this.parameters={innerRadius:e,outerRadius:t,thetaSegments:r,phiSegments:n,thetaStart:i,thetaLength:a};this.fromBufferGeometry(new zh(e,t,r,n,i,a));this.mergeVertices()}jh.prototype=Object.create(Di.prototype);jh.prototype.constructor=jh;function zh(e,t,r,n,i,a){li.call(this);this.type="RingBufferGeometry";this.parameters={innerRadius:e,outerRadius:t,thetaSegments:r,phiSegments:n,thetaStart:i,thetaLength:a};e=e||.5;t=t||1;i=i!==undefined?i:0;a=a!==undefined?a:Math.PI*2;r=r!==undefined?Math.max(3,r):8;n=n!==undefined?Math.max(1,n):1;var o=[];var s=[];var u=[];var l=[];var c;var h=e;var f=(t-e)/n;var d=new pr;var p=new cr;var v,m;for(v=0;v<=n;v++){for(m=0;m<=r;m++){c=i+m/r*a;d.x=h*Math.cos(c);d.y=h*Math.sin(c);s.push(d.x,d.y,d.z);u.push(0,0,1);p.x=(d.x/t+1)/2;p.y=(d.y/t+1)/2;l.push(p.x,p.y)}h+=f}for(v=0;v<n;v++){var g=v*(r+1);for(m=0;m<r;m++){c=m+g;var y=c;var x=c+r+1;var b=c+r+2;var w=c+1;o.push(y,x,w);o.push(x,b,w)}}this.setIndex(o);this.addAttribute("position",new Qn(s,3));this.addAttribute("normal",new Qn(u,3));this.addAttribute("uv",new Qn(l,2))}zh.prototype=Object.create(li.prototype);zh.prototype.constructor=zh;function Hh(e,t,r,n){Di.call(this);this.type="LatheGeometry";this.parameters={points:e,segments:t,phiStart:r,phiLength:n};this.fromBufferGeometry(new Gh(e,t,r,n));this.mergeVertices()}Hh.prototype=Object.create(Di.prototype);Hh.prototype.constructor=Hh;function Gh(e,t,r,n){li.call(this);this.type="LatheBufferGeometry";this.parameters={points:e,segments:t,phiStart:r,phiLength:n};t=Math.floor(t)||12;r=r||0;n=n||Math.PI*2;n=lr.clamp(n,0,Math.PI*2);var i=[];var a=[];var o=[];var s;var u=1/t;var l=new pr;var c=new cr;var h,f;for(h=0;h<=t;h++){var d=r+h*u*n;var p=Math.sin(d);var v=Math.cos(d);for(f=0;f<=e.length-1;f++){l.x=e[f].x*p;l.y=e[f].y;l.z=e[f].x*v;a.push(l.x,l.y,l.z);c.x=h/t;c.y=f/(e.length-1);o.push(c.x,c.y)}}for(h=0;h<t;h++){for(f=0;f<e.length-1;f++){s=f+h*e.length;var m=s;var g=s+e.length;var y=s+e.length+1;var x=s+1;i.push(m,g,x);i.push(g,y,x)}}this.setIndex(i);this.addAttribute("position",new Qn(a,3));this.addAttribute("uv",new Qn(o,2));this.computeVertexNormals();if(n===Math.PI*2){var b=this.attributes.normal.array;var w=new pr;var _=new pr;var T=new pr;s=t*e.length*3;for(h=0,f=0;h<e.length;h++,f+=3){w.x=b[f+0];w.y=b[f+1];w.z=b[f+2];_.x=b[s+f+0];_.y=b[s+f+1];_.z=b[s+f+2];T.addVectors(w,_).normalize();b[f+0]=b[s+f+0]=T.x;b[f+1]=b[s+f+1]=T.y;b[f+2]=b[s+f+2]=T.z}}}Gh.prototype=Object.create(li.prototype);Gh.prototype.constructor=Gh;function Vh(e,t){Di.call(this);this.type="ShapeGeometry";if(typeof t==="object"){console.warn("THREE.ShapeGeometry: Options parameter has been removed.");t=t.curveSegments}this.parameters={shapes:e,curveSegments:t};this.fromBufferGeometry(new Wh(e,t));this.mergeVertices()}Vh.prototype=Object.create(Di.prototype);Vh.prototype.constructor=Vh;Vh.prototype.toJSON=function(){var e=Di.prototype.toJSON.call(this);var t=this.parameters.shapes;return qh(t,e)};function Wh(e,p){li.call(this);this.type="ShapeBufferGeometry";this.parameters={shapes:e,curveSegments:p};p=p||12;var v=[];var m=[];var g=[];var y=[];var t=0;var x=0;if(Array.isArray(e)===false){n(e)}else{for(var r=0;r<e.length;r++){n(e[r]);this.addGroup(t,x,r);t+=x;x=0}}this.setIndex(v);this.addAttribute("position",new Qn(m,3));this.addAttribute("normal",new Qn(g,3));this.addAttribute("uv",new Qn(y,2));function n(e){var t,r,n;var i=m.length/3;var a=e.extractPoints(p);var o=a.shape;var s=a.holes;if(Ph.isClockWise(o)===false){o=o.reverse()}for(t=0,r=s.length;t<r;t++){n=s[t];if(Ph.isClockWise(n)===true){s[t]=n.reverse()}}var u=Ph.triangulateShape(o,s);for(t=0,r=s.length;t<r;t++){n=s[t];o=o.concat(n)}for(t=0,r=o.length;t<r;t++){var l=o[t];m.push(l.x,l.y,0);g.push(0,0,1);y.push(l.x,l.y)}for(t=0,r=u.length;t<r;t++){var c=u[t];var h=c[0]+i;var f=c[1]+i;var d=c[2]+i;v.push(h,f,d);x+=3}}}Wh.prototype=Object.create(li.prototype);Wh.prototype.constructor=Wh;Wh.prototype.toJSON=function(){var e=li.prototype.toJSON.call(this);var t=this.parameters.shapes;return qh(t,e)};function qh(e,t){t.shapes=[];if(Array.isArray(e)){for(var r=0,n=e.length;r<n;r++){var i=e[r];t.shapes.push(i.uuid)}}else{t.shapes.push(e.uuid)}return t}function Xh(e,t){li.call(this);this.type="EdgesGeometry";this.parameters={thresholdAngle:t};t=t!==undefined?t:1;var r=[];var n=Math.cos(lr.DEG2RAD*t);var i=[0,0],a={},o,s;var u,l=["a","b","c"];var c;if(e.isBufferGeometry){c=new Di;c.fromBufferGeometry(e)}else{c=e.clone()}c.mergeVertices();c.computeFaceNormals();var h=c.vertices;var f=c.faces;for(var d=0,p=f.length;d<p;d++){var v=f[d];for(var m=0;m<3;m++){o=v[l[m]];s=v[l[(m+1)%3]];i[0]=Math.min(o,s);i[1]=Math.max(o,s);u=i[0]+","+i[1];if(a[u]===undefined){a[u]={index1:i[0],index2:i[1],face1:d,face2:undefined}}else{a[u].face2=d}}}for(u in a){var g=a[u];if(g.face2===undefined||f[g.face1].normal.dot(f[g.face2].normal)<=n){var y=h[g.index1];r.push(y.x,y.y,y.z);y=h[g.index2];r.push(y.x,y.y,y.z)}}this.addAttribute("position",new Qn(r,3))}Xh.prototype=Object.create(li.prototype);Xh.prototype.constructor=Xh;function Yh(e,t,r,n,i,a,o,s){Di.call(this);this.type="CylinderGeometry";this.parameters={radiusTop:e,radiusBottom:t,height:r,radialSegments:n,heightSegments:i,openEnded:a,thetaStart:o,thetaLength:s};this.fromBufferGeometry(new Zh(e,t,r,n,i,a,o,s));this.mergeVertices()}Yh.prototype=Object.create(Di.prototype);Yh.prototype.constructor=Yh;function Zh(g,y,x,b,w,e,_,T){li.call(this);this.type="CylinderBufferGeometry";this.parameters={radiusTop:g,radiusBottom:y,height:x,radialSegments:b,heightSegments:w,openEnded:e,thetaStart:_,thetaLength:T};var E=this;g=g!==undefined?g:1;y=y!==undefined?y:1;x=x||1;b=Math.floor(b)||8;w=Math.floor(w)||1;e=e!==undefined?e:false;_=_!==undefined?_:0;T=T!==undefined?T:Math.PI*2;var M=[];var S=[];var A=[];var R=[];var P=0;var C=[];var O=x/2;var L=0;t();if(e===false){if(g>0)r(true);if(y>0)r(false)}this.setIndex(M);this.addAttribute("position",new Qn(S,3));this.addAttribute("normal",new Qn(A,3));this.addAttribute("uv",new Qn(R,2));function t(){var e,t;var r=new pr;var n=new pr;var i=0;var a=(y-g)/x;for(t=0;t<=w;t++){var o=[];var s=t/w;var u=s*(y-g)+g;for(e=0;e<=b;e++){var l=e/b;var c=l*T+_;var h=Math.sin(c);var f=Math.cos(c);n.x=u*h;n.y=-s*x+O;n.z=u*f;S.push(n.x,n.y,n.z);r.set(h,a,f).normalize();A.push(r.x,r.y,r.z);R.push(l,1-s);o.push(P++)}C.push(o)}for(e=0;e<b;e++){for(t=0;t<w;t++){var d=C[t][e];var p=C[t+1][e];var v=C[t+1][e+1];var m=C[t][e+1];M.push(d,p,m);M.push(p,v,m);i+=6}}E.addGroup(L,i,0);L+=i}function r(e){var t,r,n;var i=new cr;var a=new pr;var o=0;var s=e===true?g:y;var u=e===true?1:-1;r=P;for(t=1;t<=b;t++){S.push(0,O*u,0);A.push(0,u,0);R.push(.5,.5);P++}n=P;for(t=0;t<=b;t++){var l=t/b;var c=l*T+_;var h=Math.cos(c);var f=Math.sin(c);a.x=s*f;a.y=O*u;a.z=s*h;S.push(a.x,a.y,a.z);A.push(0,u,0);i.x=h*.5+.5;i.y=f*.5*u+.5;R.push(i.x,i.y);P++}for(t=0;t<b;t++){var d=r+t;var p=n+t;if(e===true){M.push(p,p+1,d)}else{M.push(p+1,p,d)}o+=3}E.addGroup(L,o,e===true?1:2);L+=o}}Zh.prototype=Object.create(li.prototype);Zh.prototype.constructor=Zh;function Jh(e,t,r,n,i,a,o){Yh.call(this,0,e,t,r,n,i,a,o);this.type="ConeGeometry";this.parameters={radius:e,height:t,radialSegments:r,heightSegments:n,openEnded:i,thetaStart:a,thetaLength:o}}Jh.prototype=Object.create(Yh.prototype);Jh.prototype.constructor=Jh;function Kh(e,t,r,n,i,a,o){Zh.call(this,0,e,t,r,n,i,a,o);this.type="ConeBufferGeometry";this.parameters={radius:e,height:t,radialSegments:r,heightSegments:n,openEnded:i,thetaStart:a,thetaLength:o}}Kh.prototype=Object.create(Zh.prototype);Kh.prototype.constructor=Kh;function Qh(e,t,r,n){Di.call(this);this.type="CircleGeometry";this.parameters={radius:e,segments:t,thetaStart:r,thetaLength:n};this.fromBufferGeometry(new $h(e,t,r,n));this.mergeVertices()}Qh.prototype=Object.create(Di.prototype);Qh.prototype.constructor=Qh;function $h(e,t,r,n){li.call(this);this.type="CircleBufferGeometry";this.parameters={radius:e,segments:t,thetaStart:r,thetaLength:n};e=e||1;t=t!==undefined?Math.max(3,t):8;r=r!==undefined?r:0;n=n!==undefined?n:Math.PI*2;var i=[];var a=[];var o=[];var s=[];var u,l;var c=new pr;var h=new cr;a.push(0,0,0);o.push(0,0,1);s.push(.5,.5);for(l=0,u=3;l<=t;l++,u+=3){var f=r+l/t*n;c.x=e*Math.cos(f);c.y=e*Math.sin(f);a.push(c.x,c.y,c.z);o.push(0,0,1);h.x=(a[u]/e+1)/2;h.y=(a[u+1]/e+1)/2;s.push(h.x,h.y)}for(u=1;u<=t;u++){i.push(u,u+1,0)}this.setIndex(i);this.addAttribute("position",new Qn(a,3));this.addAttribute("normal",new Qn(o,3));this.addAttribute("uv",new Qn(s,2))}$h.prototype=Object.create(li.prototype);$h.prototype.constructor=$h;var ef=Object.freeze({WireframeGeometry:Nc,ParametricGeometry:Fc,ParametricBufferGeometry:Bc,TetrahedronGeometry:jc,TetrahedronBufferGeometry:zc,OctahedronGeometry:Hc,OctahedronBufferGeometry:Gc,IcosahedronGeometry:Vc,IcosahedronBufferGeometry:Wc,DodecahedronGeometry:qc,DodecahedronBufferGeometry:Xc,PolyhedronGeometry:Uc,PolyhedronBufferGeometry:kc,TubeGeometry:Yc,TubeBufferGeometry:Zc,TorusKnotGeometry:Jc,TorusKnotBufferGeometry:Kc,TorusGeometry:Qc,TorusBufferGeometry:$c,TextGeometry:Fh,TextBufferGeometry:Bh,SphereGeometry:Uh,SphereBufferGeometry:kh,RingGeometry:jh,RingBufferGeometry:zh,PlaneGeometry:Es,PlaneBufferGeometry:Ms,LatheGeometry:Hh,LatheBufferGeometry:Gh,ShapeGeometry:Vh,ShapeBufferGeometry:Wh,ExtrudeGeometry:Lh,ExtrudeBufferGeometry:Ih,EdgesGeometry:Xh,ConeGeometry:Jh,ConeBufferGeometry:Kh,CylinderGeometry:Yh,CylinderBufferGeometry:Zh,CircleGeometry:Qh,CircleBufferGeometry:$h,BoxGeometry:Ni,BoxBufferGeometry:Fi});function tf(e){Hn.call(this);this.type="ShadowMaterial";this.color=new Fn(0);this.transparent=true;this.setValues(e)}tf.prototype=Object.create(Hn.prototype);tf.prototype.constructor=tf;tf.prototype.isShadowMaterial=true;tf.prototype.copy=function(e){Hn.prototype.copy.call(this,e);this.color.copy(e.color);return this};function rf(e){Hi.call(this,e);this.type="RawShaderMaterial"}rf.prototype=Object.create(Hi.prototype);rf.prototype.constructor=rf;rf.prototype.isRawShaderMaterial=true;function nf(e){Hn.call(this);this.defines={STANDARD:""};this.type="MeshStandardMaterial";this.color=new Fn(16777215);this.roughness=.5;this.metalness=.5;this.map=null;this.lightMap=null;this.lightMapIntensity=1;this.aoMap=null;this.aoMapIntensity=1;this.emissive=new Fn(0);this.emissiveIntensity=1;this.emissiveMap=null;this.bumpMap=null;this.bumpScale=1;this.normalMap=null;this.normalMapType=Ht;this.normalScale=new cr(1,1);this.displacementMap=null;this.displacementScale=1;this.displacementBias=0;this.roughnessMap=null;this.metalnessMap=null;this.alphaMap=null;this.envMap=null;this.envMapIntensity=1;this.refractionRatio=.98;this.wireframe=false;this.wireframeLinewidth=1;this.wireframeLinecap="round";this.wireframeLinejoin="round";this.skinning=false;this.morphTargets=false;this.morphNormals=false;this.setValues(e)}nf.prototype=Object.create(Hn.prototype);nf.prototype.constructor=nf;nf.prototype.isMeshStandardMaterial=true;nf.prototype.copy=function(e){Hn.prototype.copy.call(this,e);this.defines={STANDARD:""};this.color.copy(e.color);this.roughness=e.roughness;this.metalness=e.metalness;this.map=e.map;this.lightMap=e.lightMap;this.lightMapIntensity=e.lightMapIntensity;this.aoMap=e.aoMap;this.aoMapIntensity=e.aoMapIntensity;this.emissive.copy(e.emissive);this.emissiveMap=e.emissiveMap;this.emissiveIntensity=e.emissiveIntensity;this.bumpMap=e.bumpMap;this.bumpScale=e.bumpScale;this.normalMap=e.normalMap;this.normalMapType=e.normalMapType;this.normalScale.copy(e.normalScale);this.displacementMap=e.displacementMap;this.displacementScale=e.displacementScale;this.displacementBias=e.displacementBias;this.roughnessMap=e.roughnessMap;this.metalnessMap=e.metalnessMap;this.alphaMap=e.alphaMap;this.envMap=e.envMap;this.envMapIntensity=e.envMapIntensity;this.refractionRatio=e.refractionRatio;this.wireframe=e.wireframe;this.wireframeLinewidth=e.wireframeLinewidth;this.wireframeLinecap=e.wireframeLinecap;this.wireframeLinejoin=e.wireframeLinejoin;this.skinning=e.skinning;this.morphTargets=e.morphTargets;this.morphNormals=e.morphNormals;return this};function af(e){nf.call(this);this.defines={STANDARD:"",PHYSICAL:""};this.type="MeshPhysicalMaterial";this.reflectivity=.5;this.clearcoat=0;this.clearcoatRoughness=0;this.sheen=null;this.clearcoatNormalScale=new cr(1,1);this.clearcoatNormalMap=null;this.transparency=0;this.setValues(e)}af.prototype=Object.create(nf.prototype);af.prototype.constructor=af;af.prototype.isMeshPhysicalMaterial=true;af.prototype.copy=function(e){nf.prototype.copy.call(this,e);this.defines={STANDARD:"",PHYSICAL:""};this.reflectivity=e.reflectivity;this.clearcoat=e.clearcoat;this.clearcoatRoughness=e.clearcoatRoughness;if(e.sheen)this.sheen=(this.sheen||new Fn).copy(e.sheen);else this.sheen=null;this.clearcoatNormalMap=e.clearcoatNormalMap;this.clearcoatNormalScale.copy(e.clearcoatNormalScale);this.transparency=e.transparency;return this};function of(e){Hn.call(this);this.type="MeshPhongMaterial";this.color=new Fn(16777215);this.specular=new Fn(1118481);this.shininess=30;this.map=null;this.lightMap=null;this.lightMapIntensity=1;this.aoMap=null;this.aoMapIntensity=1;this.emissive=new Fn(0);this.emissiveIntensity=1;this.emissiveMap=null;this.bumpMap=null;this.bumpScale=1;this.normalMap=null;this.normalMapType=Ht;this.normalScale=new cr(1,1);this.displacementMap=null;this.displacementScale=1;this.displacementBias=0;this.specularMap=null;this.alphaMap=null;this.envMap=null;this.combine=L;this.reflectivity=1;this.refractionRatio=.98;this.wireframe=false;this.wireframeLinewidth=1;this.wireframeLinecap="round";this.wireframeLinejoin="round";this.skinning=false;this.morphTargets=false;this.morphNormals=false;this.setValues(e)}of.prototype=Object.create(Hn.prototype);of.prototype.constructor=of;of.prototype.isMeshPhongMaterial=true;of.prototype.copy=function(e){Hn.prototype.copy.call(this,e);this.color.copy(e.color);this.specular.copy(e.specular);this.shininess=e.shininess;this.map=e.map;this.lightMap=e.lightMap;this.lightMapIntensity=e.lightMapIntensity;this.aoMap=e.aoMap;this.aoMapIntensity=e.aoMapIntensity;this.emissive.copy(e.emissive);this.emissiveMap=e.emissiveMap;this.emissiveIntensity=e.emissiveIntensity;this.bumpMap=e.bumpMap;this.bumpScale=e.bumpScale;this.normalMap=e.normalMap;this.normalMapType=e.normalMapType;this.normalScale.copy(e.normalScale);this.displacementMap=e.displacementMap;this.displacementScale=e.displacementScale;this.displacementBias=e.displacementBias;this.specularMap=e.specularMap;this.alphaMap=e.alphaMap;this.envMap=e.envMap;this.combine=e.combine;this.reflectivity=e.reflectivity;this.refractionRatio=e.refractionRatio;this.wireframe=e.wireframe;this.wireframeLinewidth=e.wireframeLinewidth;this.wireframeLinecap=e.wireframeLinecap;this.wireframeLinejoin=e.wireframeLinejoin;this.skinning=e.skinning;this.morphTargets=e.morphTargets;this.morphNormals=e.morphNormals;return this};function sf(e){of.call(this);this.defines={TOON:""};this.type="MeshToonMaterial";this.gradientMap=null;this.setValues(e)}sf.prototype=Object.create(of.prototype);sf.prototype.constructor=sf;sf.prototype.isMeshToonMaterial=true;sf.prototype.copy=function(e){of.prototype.copy.call(this,e);this.gradientMap=e.gradientMap;return this};function uf(e){Hn.call(this);this.type="MeshNormalMaterial";this.bumpMap=null;this.bumpScale=1;this.normalMap=null;this.normalMapType=Ht;this.normalScale=new cr(1,1);this.displacementMap=null;this.displacementScale=1;this.displacementBias=0;this.wireframe=false;this.wireframeLinewidth=1;this.fog=false;this.skinning=false;this.morphTargets=false;this.morphNormals=false;this.setValues(e)}uf.prototype=Object.create(Hn.prototype);uf.prototype.constructor=uf;uf.prototype.isMeshNormalMaterial=true;uf.prototype.copy=function(e){Hn.prototype.copy.call(this,e);this.bumpMap=e.bumpMap;this.bumpScale=e.bumpScale;this.normalMap=e.normalMap;this.normalMapType=e.normalMapType;this.normalScale.copy(e.normalScale);this.displacementMap=e.displacementMap;this.displacementScale=e.displacementScale;this.displacementBias=e.displacementBias;this.wireframe=e.wireframe;this.wireframeLinewidth=e.wireframeLinewidth;this.skinning=e.skinning;this.morphTargets=e.morphTargets;this.morphNormals=e.morphNormals;return this};function lf(e){Hn.call(this);this.type="MeshLambertMaterial";this.color=new Fn(16777215);this.map=null;this.lightMap=null;this.lightMapIntensity=1;this.aoMap=null;this.aoMapIntensity=1;this.emissive=new Fn(0);this.emissiveIntensity=1;this.emissiveMap=null;this.specularMap=null;this.alphaMap=null;this.envMap=null;this.combine=L;this.reflectivity=1;this.refractionRatio=.98;this.wireframe=false;this.wireframeLinewidth=1;this.wireframeLinecap="round";this.wireframeLinejoin="round";this.skinning=false;this.morphTargets=false;this.morphNormals=false;this.setValues(e)}lf.prototype=Object.create(Hn.prototype);lf.prototype.constructor=lf;lf.prototype.isMeshLambertMaterial=true;lf.prototype.copy=function(e){Hn.prototype.copy.call(this,e);this.color.copy(e.color);this.map=e.map;this.lightMap=e.lightMap;this.lightMapIntensity=e.lightMapIntensity;this.aoMap=e.aoMap;this.aoMapIntensity=e.aoMapIntensity;this.emissive.copy(e.emissive);this.emissiveMap=e.emissiveMap;this.emissiveIntensity=e.emissiveIntensity;this.specularMap=e.specularMap;this.alphaMap=e.alphaMap;this.envMap=e.envMap;this.combine=e.combine;this.reflectivity=e.reflectivity;this.refractionRatio=e.refractionRatio;this.wireframe=e.wireframe;this.wireframeLinewidth=e.wireframeLinewidth;this.wireframeLinecap=e.wireframeLinecap;this.wireframeLinejoin=e.wireframeLinejoin;this.skinning=e.skinning;this.morphTargets=e.morphTargets;this.morphNormals=e.morphNormals;return this};function cf(e){Hn.call(this);this.defines={MATCAP:""};this.type="MeshMatcapMaterial";this.color=new Fn(16777215);this.matcap=null;this.map=null;this.bumpMap=null;this.bumpScale=1;this.normalMap=null;this.normalMapType=Ht;this.normalScale=new cr(1,1);this.displacementMap=null;this.displacementScale=1;this.displacementBias=0;this.alphaMap=null;this.skinning=false;this.morphTargets=false;this.morphNormals=false;this.setValues(e)}cf.prototype=Object.create(Hn.prototype);cf.prototype.constructor=cf;cf.prototype.isMeshMatcapMaterial=true;cf.prototype.copy=function(e){Hn.prototype.copy.call(this,e);this.defines={MATCAP:""};this.color.copy(e.color);this.matcap=e.matcap;this.map=e.map;this.bumpMap=e.bumpMap;this.bumpScale=e.bumpScale;this.normalMap=e.normalMap;this.normalMapType=e.normalMapType;this.normalScale.copy(e.normalScale);this.displacementMap=e.displacementMap;this.displacementScale=e.displacementScale;this.displacementBias=e.displacementBias;this.alphaMap=e.alphaMap;this.skinning=e.skinning;this.morphTargets=e.morphTargets;this.morphNormals=e.morphNormals;return this};function hf(e){dc.call(this);this.type="LineDashedMaterial";this.scale=1;this.dashSize=3;this.gapSize=1;this.setValues(e)}hf.prototype=Object.create(dc.prototype);hf.prototype.constructor=hf;hf.prototype.isLineDashedMaterial=true;hf.prototype.copy=function(e){dc.prototype.copy.call(this,e);this.scale=e.scale;this.dashSize=e.dashSize;this.gapSize=e.gapSize;return this};var ff=Object.freeze({ShadowMaterial:tf,SpriteMaterial:Hl,RawShaderMaterial:rf,ShaderMaterial:Hi,PointsMaterial:Ec,MeshPhysicalMaterial:af,MeshStandardMaterial:nf,MeshPhongMaterial:of,MeshToonMaterial:sf,MeshNormalMaterial:uf,MeshLambertMaterial:lf,MeshDepthMaterial:bl,MeshDistanceMaterial:wl,MeshBasicMaterial:Gn,MeshMatcapMaterial:cf,LineDashedMaterial:hf,LineBasicMaterial:dc,Material:Hn});var df={arraySlice:function(e,t,r){if(df.isTypedArray(e)){return new e.constructor(e.subarray(t,r!==undefined?r:e.length))}return e.slice(t,r)},convertArray:function(e,t,r){if(!e||!r&&e.constructor===t)return e;if(typeof t.BYTES_PER_ELEMENT==="number"){return new t(e)}return Array.prototype.slice.call(e)},isTypedArray:function(e){return ArrayBuffer.isView(e)&&!(e instanceof DataView)},getKeyframeOrder:function(r){function e(e,t){return r[e]-r[t]}var t=r.length;var n=new Array(t);for(var i=0;i!==t;++i)n[i]=i;n.sort(e);return n},sortedArray:function(e,t,r){var n=e.length;var i=new e.constructor(n);for(var a=0,o=0;o!==n;++a){var s=r[a]*t;for(var u=0;u!==t;++u){i[o++]=e[s+u]}}return i},flattenJSON:function(e,t,r,n){var i=1,a=e[0];while(a!==undefined&&a[n]===undefined){a=e[i++]}if(a===undefined)return;var o=a[n];if(o===undefined)return;if(Array.isArray(o)){do{o=a[n];if(o!==undefined){t.push(a.time);r.push.apply(r,o)}a=e[i++]}while(a!==undefined)}else if(o.toArray!==undefined){do{o=a[n];if(o!==undefined){t.push(a.time);o.toArray(r,r.length)}a=e[i++]}while(a!==undefined)}else{do{o=a[n];if(o!==undefined){t.push(a.time);r.push(o)}a=e[i++]}while(a!==undefined)}}};r.AnimationUtils=df;function pf(e,t,r,n){this.parameterPositions=e;this._cachedIndex=0;this.resultBuffer=n!==undefined?n:new t.constructor(r);this.sampleValues=t;this.valueSize=r}Object.assign(pf.prototype,{evaluate:function(e){var t=this.parameterPositions,r=this._cachedIndex,n=t[r],i=t[r-1];e:{t:{var a;r:{n:if(!(e<n)){for(var o=r+2;;){if(n===undefined){if(e<i)break n;r=t.length;this._cachedIndex=r;return this.afterEnd_(r-1,e,i)}if(r===o)break;i=n;n=t[++r];if(e<n){break t}}a=t.length;break r}if(!(e>=i)){var s=t[1];if(e<s){r=2;i=s}for(var o=r-2;;){if(i===undefined){this._cachedIndex=0;return this.beforeStart_(0,e,n)}if(r===o)break;n=i;i=t[--r-1];if(e>=i){break t}}a=r;r=0;break r}break e}while(r<a){var u=r+a>>>1;if(e<t[u]){a=u}else{r=u+1}}n=t[r];i=t[r-1];if(i===undefined){this._cachedIndex=0;return this.beforeStart_(0,e,n)}if(n===undefined){r=t.length;this._cachedIndex=r;return this.afterEnd_(r-1,i,e)}}this._cachedIndex=r;this.intervalChanged_(r,i,n)}return this.interpolate_(r,i,e,n)},settings:null,DefaultSettings_:{},getSettings_:function(){return this.settings||this.DefaultSettings_},copySampleValue_:function(e){var t=this.resultBuffer,r=this.sampleValues,n=this.valueSize,i=e*n;for(var a=0;a!==n;++a){t[a]=r[i+a]}return t},interpolate_:function(){throw new Error("call to abstract method")},intervalChanged_:function(){}});Object.assign(pf.prototype,{beforeStart_:pf.prototype.copySampleValue_,afterEnd_:pf.prototype.copySampleValue_});function vf(e,t,r,n){pf.call(this,e,t,r,n);this._weightPrev=-0;this._offsetPrev=-0;this._weightNext=-0;this._offsetNext=-0}vf.prototype=Object.assign(Object.create(pf.prototype),{constructor:vf,DefaultSettings_:{endingStart:St,endingEnd:St},intervalChanged_:function(e,t,r){var n=this.parameterPositions,i=e-2,a=e+1,o=n[i],s=n[a];if(o===undefined){switch(this.getSettings_().endingStart){case At:i=e;o=2*t-r;break;case Rt:i=n.length-2;o=t+n[i]-n[i+1];break;default:i=e;o=r}}if(s===undefined){switch(this.getSettings_().endingEnd){case At:a=e;s=2*r-t;break;case Rt:a=1;s=r+n[1]-n[0];break;default:a=e-1;s=t}}var u=(r-t)*.5,l=this.valueSize;this._weightPrev=u/(t-o);this._weightNext=u/(s-r);this._offsetPrev=i*l;this._offsetNext=a*l},interpolate_:function(e,t,r,n){var i=this.resultBuffer,a=this.sampleValues,o=this.valueSize,s=e*o,u=s-o,l=this._offsetPrev,c=this._offsetNext,h=this._weightPrev,f=this._weightNext,d=(r-t)/(n-t),p=d*d,v=p*d;var m=-h*v+2*h*p-h*d;var g=(1+h)*v+(-1.5-2*h)*p+(-.5+h)*d+1;var y=(-1-f)*v+(1.5+f)*p+.5*d;var x=f*v-f*p;for(var b=0;b!==o;++b){i[b]=m*a[l+b]+g*a[u+b]+y*a[s+b]+x*a[c+b]}return i}});function mf(e,t,r,n){pf.call(this,e,t,r,n)}mf.prototype=Object.assign(Object.create(pf.prototype),{constructor:mf,interpolate_:function(e,t,r,n){var i=this.resultBuffer,a=this.sampleValues,o=this.valueSize,s=e*o,u=s-o,l=(r-t)/(n-t),c=1-l;for(var h=0;h!==o;++h){i[h]=a[u+h]*c+a[s+h]*l}return i}});function gf(e,t,r,n){pf.call(this,e,t,r,n)}gf.prototype=Object.assign(Object.create(pf.prototype),{constructor:gf,interpolate_:function(e){return this.copySampleValue_(e-1)}});function yf(e,t,r,n){if(e===undefined)throw new Error("THREE.KeyframeTrack: track name is undefined");if(t===undefined||t.length===0)throw new Error("THREE.KeyframeTrack: no keyframes in track named "+e);this.name=e;this.times=df.convertArray(t,this.TimeBufferType);this.values=df.convertArray(r,this.ValueBufferType);this.setInterpolation(n||this.DefaultInterpolation)}Object.assign(yf,{toJSON:function(e){var t=e.constructor;var r;if(t.toJSON!==undefined){r=t.toJSON(e)}else{r={name:e.name,times:df.convertArray(e.times,Array),values:df.convertArray(e.values,Array)};var n=e.getInterpolation();if(n!==e.DefaultInterpolation){r.interpolation=n}}r.type=e.ValueTypeName;return r}});Object.assign(yf.prototype,{constructor:yf,TimeBufferType:Float32Array,ValueBufferType:Float32Array,DefaultInterpolation:Et,InterpolantFactoryMethodDiscrete:function(e){return new gf(this.times,this.values,this.getValueSize(),e)},InterpolantFactoryMethodLinear:function(e){return new mf(this.times,this.values,this.getValueSize(),e)},InterpolantFactoryMethodSmooth:function(e){return new vf(this.times,this.values,this.getValueSize(),e)},setInterpolation:function(e){var t;switch(e){case Tt:t=this.InterpolantFactoryMethodDiscrete;break;case Et:t=this.InterpolantFactoryMethodLinear;break;case Mt:t=this.InterpolantFactoryMethodSmooth;break}if(t===undefined){var r="unsupported interpolation for "+this.ValueTypeName+" keyframe track named "+this.name;if(this.createInterpolant===undefined){if(e!==this.DefaultInterpolation){this.setInterpolation(this.DefaultInterpolation)}else{throw new Error(r)}}console.warn("THREE.KeyframeTrack:",r);return this}this.createInterpolant=t;return this},getInterpolation:function(){switch(this.createInterpolant){case this.InterpolantFactoryMethodDiscrete:return Tt;case this.InterpolantFactoryMethodLinear:return Et;case this.InterpolantFactoryMethodSmooth:return Mt}},getValueSize:function(){return this.values.length/this.times.length},shift:function(e){if(e!==0){var t=this.times;for(var r=0,n=t.length;r!==n;++r){t[r]+=e}}return this},scale:function(e){if(e!==1){var t=this.times;for(var r=0,n=t.length;r!==n;++r){t[r]*=e}}return this},trim:function(e,t){var r=this.times,n=r.length,i=0,a=n-1;while(i!==n&&r[i]<e){++i}while(a!==-1&&r[a]>t){--a}++a;if(i!==0||a!==n){if(i>=a)a=Math.max(a,1),i=a-1;var o=this.getValueSize();this.times=df.arraySlice(r,i,a);this.values=df.arraySlice(this.values,i*o,a*o)}return this},validate:function(){var e=true;var t=this.getValueSize();if(t-Math.floor(t)!==0){console.error("THREE.KeyframeTrack: Invalid value size in track.",this);e=false}var r=this.times,n=this.values,i=r.length;if(i===0){console.error("THREE.KeyframeTrack: Track is empty.",this);e=false}var a=null;for(var o=0;o!==i;o++){var s=r[o];if(typeof s==="number"&&isNaN(s)){console.error("THREE.KeyframeTrack: Time is not a valid number.",this,o,s);e=false;break}if(a!==null&&a>s){console.error("THREE.KeyframeTrack: Out of order keys.",this,o,s,a);e=false;break}a=s}if(n!==undefined){if(df.isTypedArray(n)){for(var o=0,u=n.length;o!==u;++o){var l=n[o];if(isNaN(l)){console.error("THREE.KeyframeTrack: Value is not a valid number.",this,o,l);e=false;break}}}}return e},optimize:function(){var e=this.times,t=this.values,r=this.getValueSize(),n=this.getInterpolation()===Mt,i=1,a=e.length-1;for(var o=1;o<a;++o){var s=false;var u=e[o];var l=e[o+1];if(u!==l&&(o!==1||u!==u[0])){if(!n){var c=o*r,h=c-r,f=c+r;for(var d=0;d!==r;++d){var p=t[c+d];if(p!==t[h+d]||p!==t[f+d]){s=true;break}}}else{s=true}}if(s){if(o!==i){e[i]=e[o];var v=o*r,m=i*r;for(var d=0;d!==r;++d){t[m+d]=t[v+d]}}++i}}if(a>0){e[i]=e[a];for(var v=a*r,m=i*r,d=0;d!==r;++d){t[m+d]=t[v+d]}++i}if(i!==e.length){this.times=df.arraySlice(e,0,i);this.values=df.arraySlice(t,0,i*r)}return this},clone:function(){var e=df.arraySlice(this.times,0);var t=df.arraySlice(this.values,0);var r=this.constructor;var n=new r(this.name,e,t);n.createInterpolant=this.createInterpolant;return n}});function xf(e,t,r){yf.call(this,e,t,r)}xf.prototype=Object.assign(Object.create(yf.prototype),{constructor:xf,ValueTypeName:"bool",ValueBufferType:Array,DefaultInterpolation:Tt,InterpolantFactoryMethodLinear:undefined,InterpolantFactoryMethodSmooth:undefined});function bf(e,t,r,n){yf.call(this,e,t,r,n)}bf.prototype=Object.assign(Object.create(yf.prototype),{constructor:bf,ValueTypeName:"color"});function wf(e,t,r,n){yf.call(this,e,t,r,n)}wf.prototype=Object.assign(Object.create(yf.prototype),{constructor:wf,ValueTypeName:"number"});function _f(e,t,r,n){pf.call(this,e,t,r,n)}_f.prototype=Object.assign(Object.create(pf.prototype),{constructor:_f,interpolate_:function(e,t,r,n){var i=this.resultBuffer,a=this.sampleValues,o=this.valueSize,s=e*o,u=(r-t)/(n-t);for(var l=s+o;s!==l;s+=4){hr.slerpFlat(i,0,a,s-o,a,s,u)}return i}});function Tf(e,t,r,n){yf.call(this,e,t,r,n)}Tf.prototype=Object.assign(Object.create(yf.prototype),{constructor:Tf,ValueTypeName:"quaternion",DefaultInterpolation:Et,InterpolantFactoryMethodLinear:function(e){return new _f(this.times,this.values,this.getValueSize(),e)},InterpolantFactoryMethodSmooth:undefined});function Ef(e,t,r,n){yf.call(this,e,t,r,n)}Ef.prototype=Object.assign(Object.create(yf.prototype),{constructor:Ef,ValueTypeName:"string",ValueBufferType:Array,DefaultInterpolation:Tt,InterpolantFactoryMethodLinear:undefined,InterpolantFactoryMethodSmooth:undefined});function Mf(e,t,r,n){yf.call(this,e,t,r,n)}Mf.prototype=Object.assign(Object.create(yf.prototype),{constructor:Mf,ValueTypeName:"vector"});function Sf(e,t,r){this.name=e;this.tracks=r;this.duration=t!==undefined?t:-1;this.uuid=lr.generateUUID();if(this.duration<0){this.resetDuration()}}function Af(e){switch(e.toLowerCase()){case"scalar":case"double":case"float":case"number":case"integer":return wf;case"vector":case"vector2":case"vector3":case"vector4":return Mf;case"color":return bf;case"quaternion":return Tf;case"bool":case"boolean":return xf;case"string":return Ef}throw new Error("THREE.KeyframeTrack: Unsupported typeName: "+e)}function Rf(e){if(e.type===undefined){throw new Error("THREE.KeyframeTrack: track type undefined, can not parse")}var t=Af(e.type);if(e.times===undefined){var r=[],n=[];df.flattenJSON(e.keys,r,n,"value");e.times=r;e.values=n}if(t.parse!==undefined){return t.parse(e)}else{return new t(e.name,e.times,e.values,e.interpolation)}}Object.assign(Sf,{parse:function(e){var t=[],r=e.tracks,n=1/(e.fps||1);for(var i=0,a=r.length;i!==a;++i){t.push(Rf(r[i]).scale(n))}return new Sf(e.name,e.duration,t)},toJSON:function(e){var t=[],r=e.tracks;var n={name:e.name,duration:e.duration,tracks:t,uuid:e.uuid};for(var i=0,a=r.length;i!==a;++i){t.push(yf.toJSON(r[i]))}return n},CreateFromMorphTargetSequence:function(e,t,r,n){var i=t.length;var a=[];for(var o=0;o<i;o++){var s=[];var u=[];s.push((o+i-1)%i,o,(o+1)%i);u.push(0,1,0);var l=df.getKeyframeOrder(s);s=df.sortedArray(s,1,l);u=df.sortedArray(u,1,l);if(!n&&s[0]===0){s.push(i);u.push(u[0])}a.push(new wf(".morphTargetInfluences["+t[o].name+"]",s,u).scale(1/r))}return new Sf(e,-1,a)},findByName:function(e,t){var r=e;if(!Array.isArray(e)){var n=e;r=n.geometry&&n.geometry.animations||n.animations}for(var i=0;i<r.length;i++){if(r[i].name===t){return r[i]}}return null},CreateClipsFromMorphTargetSequences:function(e,t,r){var n={};var i=/^([\w-]*?)([\d]+)$/;for(var a=0,o=e.length;a<o;a++){var s=e[a];var u=s.name.match(i);if(u&&u.length>1){var l=u[1];var c=n[l];if(!c){n[l]=c=[]}c.push(s)}}var h=[];for(var l in n){h.push(Sf.CreateFromMorphTargetSequence(l,n[l],t,r))}return h},parseAnimation:function(e,t){if(!e){console.error("THREE.AnimationClip: No animation in JSONLoader data.");return null}var r=function(e,t,r,n,i){if(r.length!==0){var a=[];var o=[];df.flattenJSON(r,a,o,n);if(a.length!==0){i.push(new e(t,a,o))}}};var n=[];var i=e.name||"default";var a=e.length||-1;var o=e.fps||30;var s=e.hierarchy||[];for(var u=0;u<s.length;u++){var l=s[u].keys;if(!l||l.length===0)continue;if(l[0].morphTargets){var c={};for(var h=0;h<l.length;h++){if(l[h].morphTargets){for(var f=0;f<l[h].morphTargets.length;f++){c[l[h].morphTargets[f]]=-1}}}for(var d in c){var p=[];var v=[];for(var f=0;f!==l[h].morphTargets.length;++f){var m=l[h];p.push(m.time);v.push(m.morphTarget===d?1:0)}n.push(new wf(".morphTargetInfluence["+d+"]",p,v))}a=c.length*(o||1)}else{var g=".bones["+t[u].name+"]";r(Mf,g+".position",l,"pos",n);r(Tf,g+".quaternion",l,"rot",n);r(Mf,g+".scale",l,"scl",n)}}if(n.length===0){return null}var y=new Sf(i,a,n);return y}});Object.assign(Sf.prototype,{resetDuration:function(){var e=this.tracks,t=0;for(var r=0,n=e.length;r!==n;++r){var i=this.tracks[r];t=Math.max(t,i.times[i.times.length-1])}this.duration=t;return this},trim:function(){for(var e=0;e<this.tracks.length;e++){this.tracks[e].trim(0,this.duration)}return this},validate:function(){var e=true;for(var t=0;t<this.tracks.length;t++){e=e&&this.tracks[t].validate()}return e},optimize:function(){for(var e=0;e<this.tracks.length;e++){this.tracks[e].optimize()}return this},clone:function(){var e=[];for(var t=0;t<this.tracks.length;t++){e.push(this.tracks[t].clone())}return new Sf(this.name,this.duration,e)}});var Pf={enabled:false,files:{},add:function(e,t){if(this.enabled===false)return;this.files[e]=t},get:function(e){if(this.enabled===false)return;return this.files[e]},remove:function(e){delete this.files[e]},clear:function(){this.files={}}};r.Cache=Pf;function Cf(e,t,r){var n=this;var i=false;var a=0;var o=0;var s=undefined;var u=[];this.onStart=undefined;this.onLoad=e;this.onProgress=t;this.onError=r;this.itemStart=function(e){o++;if(i===false){if(n.onStart!==undefined){n.onStart(e,a,o)}}i=true};this.itemEnd=function(e){a++;if(n.onProgress!==undefined){n.onProgress(e,a,o)}if(a===o){i=false;if(n.onLoad!==undefined){n.onLoad()}}};this.itemError=function(e){if(n.onError!==undefined){n.onError(e)}};this.resolveURL=function(e){if(s){return s(e)}return e};this.setURLModifier=function(e){s=e;return this};this.addHandler=function(e,t){u.push(e,t);return this};this.removeHandler=function(e){var t=u.indexOf(e);if(t!==-1){u.splice(t,2)}return this};this.getHandler=function(e){for(var t=0,r=u.length;t<r;t+=2){var n=u[t];var i=u[t+1];if(n.test(e)){return i}}return null}}var Of=new Cf;r.DefaultLoadingManager=Of;function Lf(e){this.manager=e!==undefined?e:Of;this.crossOrigin="anonymous";this.path="";this.resourcePath=""}Object.assign(Lf.prototype,{load:function(){},parse:function(){},setCrossOrigin:function(e){this.crossOrigin=e;return this},setPath:function(e){this.path=e;return this},setResourcePath:function(e){this.resourcePath=e;return this}});var If={};function Df(e){Lf.call(this,e)}Df.prototype=Object.assign(Object.create(Lf.prototype),{constructor:Df,load:function(o,e,t,r){if(o===undefined)o="";if(this.path!==undefined)o=this.path+o;o=this.manager.resolveURL(o);var s=this;var n=Pf.get(o);if(n!==undefined){s.manager.itemStart(o);setTimeout(function(){if(e)e(n);s.manager.itemEnd(o)},0);return n}if(If[o]!==undefined){If[o].push({onLoad:e,onProgress:t,onError:r});return}var i=/^data:(.*?)(;base64)?,(.*)$/;var a=o.match(i);if(a){var u=a[1];var l=!!a[2];var c=a[3];c=decodeURIComponent(c);if(l)c=atob(c);try{var h;var f=(this.responseType||"").toLowerCase();switch(f){case"arraybuffer":case"blob":var d=new Uint8Array(c.length);for(var p=0;p<c.length;p++){d[p]=c.charCodeAt(p)}if(f==="blob"){h=new Blob([d.buffer],{type:u})}else{h=d.buffer}break;case"document":var v=new DOMParser;h=v.parseFromString(c,u);break;case"json":h=JSON.parse(c);break;default:h=c;break}setTimeout(function(){if(e)e(h);s.manager.itemEnd(o)},0)}catch(e){setTimeout(function(){if(r)r(e);s.manager.itemError(o);s.manager.itemEnd(o)},0)}}else{If[o]=[];If[o].push({onLoad:e,onProgress:t,onError:r});var m=new XMLHttpRequest;m.open("GET",o,true);m.addEventListener("load",function(e){var t=this.response;Pf.add(o,t);var r=If[o];delete If[o];if(this.status===200||this.status===0){if(this.status===0)console.warn("THREE.FileLoader: HTTP Status 0 received.");for(var n=0,i=r.length;n<i;n++){var a=r[n];if(a.onLoad)a.onLoad(t)}s.manager.itemEnd(o)}else{for(var n=0,i=r.length;n<i;n++){var a=r[n];if(a.onError)a.onError(e)}s.manager.itemError(o);s.manager.itemEnd(o)}},false);m.addEventListener("progress",function(e){var t=If[o];for(var r=0,n=t.length;r<n;r++){var i=t[r];if(i.onProgress)i.onProgress(e)}},false);m.addEventListener("error",function(e){var t=If[o];delete If[o];for(var r=0,n=t.length;r<n;r++){var i=t[r];if(i.onError)i.onError(e)}s.manager.itemError(o);s.manager.itemEnd(o)},false);m.addEventListener("abort",function(e){var t=If[o];delete If[o];for(var r=0,n=t.length;r<n;r++){var i=t[r];if(i.onError)i.onError(e)}s.manager.itemError(o);s.manager.itemEnd(o)},false);if(this.responseType!==undefined)m.responseType=this.responseType;if(this.withCredentials!==undefined)m.withCredentials=this.withCredentials;if(m.overrideMimeType)m.overrideMimeType(this.mimeType!==undefined?this.mimeType:"text/plain");for(var g in this.requestHeader){m.setRequestHeader(g,this.requestHeader[g])}m.send(null)}s.manager.itemStart(o);return m},setResponseType:function(e){this.responseType=e;return this},setWithCredentials:function(e){this.withCredentials=e;return this},setMimeType:function(e){this.mimeType=e;return this},setRequestHeader:function(e){this.requestHeader=e;return this}});function Nf(e){Lf.call(this,e)}Nf.prototype=Object.assign(Object.create(Lf.prototype),{constructor:Nf,load:function(e,t,r,n){var i=this;var a=new Df(i.manager);a.setPath(i.path);a.load(e,function(e){t(i.parse(JSON.parse(e)))},r,n)},parse:function(e){var t=[];for(var r=0;r<e.length;r++){var n=Sf.parse(e[r]);t.push(n)}return t}});function Ff(e){Lf.call(this,e)}Ff.prototype=Object.assign(Object.create(Lf.prototype),{constructor:Ff,load:function(e,a,t,n){var o=this;var s=[];var u=new Lc;u.image=s;var i=new Df(this.manager);i.setPath(this.path);i.setResponseType("arraybuffer");function r(r){i.load(e[r],function(e){var t=o.parse(e,true);s[r]={width:t.width,height:t.height,format:t.format,mipmaps:t.mipmaps};l+=1;if(l===6){if(t.mipmapCount===1)u.minFilter=ie;u.format=t.format;u.needsUpdate=true;if(a)a(u)}},t,n)}if(Array.isArray(e)){var l=0;for(var c=0,h=e.length;c<h;++c){r(c)}}else{i.load(e,function(e){var t=o.parse(e,true);if(t.isCubemap){var r=t.mipmaps.length/t.mipmapCount;for(var n=0;n<r;n++){s[n]={mipmaps:[]};for(var i=0;i<t.mipmapCount;i++){s[n].mipmaps.push(t.mipmaps[n*t.mipmapCount+i]);s[n].format=t.format;s[n].width=t.width;s[n].height=t.height}}}else{u.image.width=t.width;u.image.height=t.height;u.mipmaps=t.mipmaps}if(t.mipmapCount===1){u.minFilter=ie}u.format=t.format;u.needsUpdate=true;if(a)a(u)},t,n)}return u}});function Bf(e){Lf.call(this,e)}Bf.prototype=Object.assign(Object.create(Lf.prototype),{constructor:Bf,load:function(e,r,t,n){var i=this;var a=new Zi;var o=new Df(this.manager);o.setResponseType("arraybuffer");o.setPath(this.path);o.load(e,function(e){var t=i.parse(e);if(!t)return;if(t.image!==undefined){a.image=t.image}else if(t.data!==undefined){a.image.width=t.width;a.image.height=t.height;a.image.data=t.data}a.wrapS=t.wrapS!==undefined?t.wrapS:K;a.wrapT=t.wrapT!==undefined?t.wrapT:K;a.magFilter=t.magFilter!==undefined?t.magFilter:ie;a.minFilter=t.minFilter!==undefined?t.minFilter:se;a.anisotropy=t.anisotropy!==undefined?t.anisotropy:1;if(t.format!==undefined){a.format=t.format}if(t.type!==undefined){a.type=t.type}if(t.mipmaps!==undefined){a.mipmaps=t.mipmaps}if(t.mipmapCount===1){a.minFilter=ie}a.needsUpdate=true;if(r)r(a,t)},t,n);return a}});function Uf(e){Lf.call(this,e)}Uf.prototype=Object.assign(Object.create(Lf.prototype),{constructor:Uf,load:function(t,e,r,n){if(this.path!==undefined)t=this.path+t;t=this.manager.resolveURL(t);var i=this;var a=Pf.get(t);if(a!==undefined){i.manager.itemStart(t);setTimeout(function(){if(e)e(a);i.manager.itemEnd(t)},0);return a}var o=document.createElementNS("http://www.w3.org/1999/xhtml","img");function s(){o.removeEventListener("load",s,false);o.removeEventListener("error",u,false);Pf.add(t,this);if(e)e(this);i.manager.itemEnd(t)}function u(e){o.removeEventListener("load",s,false);o.removeEventListener("error",u,false);if(n)n(e);i.manager.itemError(t);i.manager.itemEnd(t)}o.addEventListener("load",s,false);o.addEventListener("error",u,false);if(t.substr(0,5)!=="data:"){if(this.crossOrigin!==undefined)o.crossOrigin=this.crossOrigin}i.manager.itemStart(t);o.src=t;return o}});function kf(e){Lf.call(this,e)}kf.prototype=Object.assign(Object.create(Lf.prototype),{constructor:kf,load:function(e,r,t,n){var i=new Bs;var a=new Uf(this.manager);a.setCrossOrigin(this.crossOrigin);a.setPath(this.path);var o=0;function s(t){a.load(e[t],function(e){i.images[t]=e;o++;if(o===6){i.needsUpdate=true;if(r)r(i)}},undefined,n)}for(var u=0;u<e.length;++u){s(u)}return i}});function jf(e){Lf.call(this,e)}jf.prototype=Object.assign(Object.create(Lf.prototype),{constructor:jf,load:function(r,n,e,t){var i=new br;var a=new Uf(this.manager);a.setCrossOrigin(this.crossOrigin);a.setPath(this.path);a.load(r,function(e){i.image=e;var t=r.search(/\.jpe?g($|\?)/i)>0||r.search(/^data\:image\/jpeg/)===0;i.format=t?Ue:qe;i.needsUpdate=true;if(n!==undefined){n(i)}},e,t);return i}});function zf(){this.type="Curve";this.arcLengthDivisions=200}Object.assign(zf.prototype,{getPoint:function(){console.warn("THREE.Curve: .getPoint() not implemented.");return null},getPointAt:function(e,t){var r=this.getUtoTmapping(e);return this.getPoint(r,t)},getPoints:function(e){if(e===undefined)e=5;var t=[];for(var r=0;r<=e;r++){t.push(this.getPoint(r/e))}return t},getSpacedPoints:function(e){if(e===undefined)e=5;var t=[];for(var r=0;r<=e;r++){t.push(this.getPointAt(r/e))}return t},getLength:function(){var e=this.getLengths();return e[e.length-1]},getLengths:function(e){if(e===undefined)e=this.arcLengthDivisions;if(this.cacheArcLengths&&this.cacheArcLengths.length===e+1&&!this.needsUpdate){return this.cacheArcLengths}this.needsUpdate=false;var t=[];var r,n=this.getPoint(0);var i,a=0;t.push(0);for(i=1;i<=e;i++){r=this.getPoint(i/e);a+=r.distanceTo(n);t.push(a);n=r}this.cacheArcLengths=t;return t},updateArcLengths:function(){this.needsUpdate=true;this.getLengths()},getUtoTmapping:function(e,t){var r=this.getLengths();var n=0,i=r.length;var a;if(t){a=t}else{a=e*r[i-1]}var o=0,s=i-1,u;while(o<=s){n=Math.floor(o+(s-o)/2);u=r[n]-a;if(u<0){o=n+1}else if(u>0){s=n-1}else{s=n;break}}n=s;if(r[n]===a){return n/(i-1)}var l=r[n];var c=r[n+1];var h=c-l;var f=(a-l)/h;var d=(n+f)/(i-1);return d},getTangent:function(e){var t=1e-4;var r=e-t;var n=e+t;if(r<0)r=0;if(n>1)n=1;var i=this.getPoint(r);var a=this.getPoint(n);var o=a.clone().sub(i);return o.normalize()},getTangentAt:function(e){var t=this.getUtoTmapping(e);return this.getTangent(t)},computeFrenetFrames:function(e,t){var r=new pr;var n=[];var i=[];var a=[];var o=new pr;var s=new Or;var u,l,c;for(u=0;u<=e;u++){l=u/e;n[u]=this.getTangentAt(l);n[u].normalize()}i[0]=new pr;a[0]=new pr;var h=Number.MAX_VALUE;var f=Math.abs(n[0].x);var d=Math.abs(n[0].y);var p=Math.abs(n[0].z);if(f<=h){h=f;r.set(1,0,0)}if(d<=h){h=d;r.set(0,1,0)}if(p<=h){r.set(0,0,1)}o.crossVectors(n[0],r).normalize();i[0].crossVectors(n[0],o);a[0].crossVectors(n[0],i[0]);for(u=1;u<=e;u++){i[u]=i[u-1].clone();a[u]=a[u-1].clone();o.crossVectors(n[u-1],n[u]);if(o.length()>Number.EPSILON){o.normalize();c=Math.acos(lr.clamp(n[u-1].dot(n[u]),-1,1));i[u].applyMatrix4(s.makeRotationAxis(o,c))}a[u].crossVectors(n[u],i[u])}if(t===true){c=Math.acos(lr.clamp(i[0].dot(i[e]),-1,1));c/=e;if(n[0].dot(o.crossVectors(i[0],i[e]))>0){c=-c}for(u=1;u<=e;u++){i[u].applyMatrix4(s.makeRotationAxis(n[u],c*u));a[u].crossVectors(n[u],i[u])}}return{tangents:n,normals:i,binormals:a}},clone:function(){return(new this.constructor).copy(this)},copy:function(e){this.arcLengthDivisions=e.arcLengthDivisions;return this},toJSON:function(){var e={metadata:{version:4.5,type:"Curve",generator:"Curve.toJSON"}};e.arcLengthDivisions=this.arcLengthDivisions;e.type=this.type;return e},fromJSON:function(e){this.arcLengthDivisions=e.arcLengthDivisions;return this}});function Hf(e,t,r,n,i,a,o,s){zf.call(this);this.type="EllipseCurve";this.aX=e||0;this.aY=t||0;this.xRadius=r||1;this.yRadius=n||1;this.aStartAngle=i||0;this.aEndAngle=a||2*Math.PI;this.aClockwise=o||false;this.aRotation=s||0}Hf.prototype=Object.create(zf.prototype);Hf.prototype.constructor=Hf;Hf.prototype.isEllipseCurve=true;Hf.prototype.getPoint=function(e,t){var r=t||new cr;var n=Math.PI*2;var i=this.aEndAngle-this.aStartAngle;var a=Math.abs(i)<Number.EPSILON;while(i<0)i+=n;while(i>n)i-=n;if(i<Number.EPSILON){if(a){i=0}else{i=n}}if(this.aClockwise===true&&!a){if(i===n){i=-n}else{i=i-n}}var o=this.aStartAngle+e*i;var s=this.aX+this.xRadius*Math.cos(o);var u=this.aY+this.yRadius*Math.sin(o);if(this.aRotation!==0){var l=Math.cos(this.aRotation);var c=Math.sin(this.aRotation);var h=s-this.aX;var f=u-this.aY;s=h*l-f*c+this.aX;u=h*c+f*l+this.aY}return r.set(s,u)};Hf.prototype.copy=function(e){zf.prototype.copy.call(this,e);this.aX=e.aX;this.aY=e.aY;this.xRadius=e.xRadius;this.yRadius=e.yRadius;this.aStartAngle=e.aStartAngle;this.aEndAngle=e.aEndAngle;this.aClockwise=e.aClockwise;this.aRotation=e.aRotation;return this};Hf.prototype.toJSON=function(){var e=zf.prototype.toJSON.call(this);e.aX=this.aX;e.aY=this.aY;e.xRadius=this.xRadius;e.yRadius=this.yRadius;e.aStartAngle=this.aStartAngle;e.aEndAngle=this.aEndAngle;e.aClockwise=this.aClockwise;e.aRotation=this.aRotation;return e};Hf.prototype.fromJSON=function(e){zf.prototype.fromJSON.call(this,e);this.aX=e.aX;this.aY=e.aY;this.xRadius=e.xRadius;this.yRadius=e.yRadius;this.aStartAngle=e.aStartAngle;this.aEndAngle=e.aEndAngle;this.aClockwise=e.aClockwise;this.aRotation=e.aRotation;return this};function Gf(e,t,r,n,i,a){Hf.call(this,e,t,r,r,n,i,a);this.type="ArcCurve"}Gf.prototype=Object.create(Hf.prototype);Gf.prototype.constructor=Gf;Gf.prototype.isArcCurve=true;function Vf(){var i=0,a=0,o=0,s=0;function l(e,t,r,n){i=e;a=r;o=-3*e+3*t-2*r-n;s=2*e-2*t+r+n}return{initCatmullRom:function(e,t,r,n,i){l(t,r,i*(r-e),i*(n-t))},initNonuniformCatmullRom:function(e,t,r,n,i,a,o){var s=(t-e)/i-(r-e)/(i+a)+(r-t)/a;var u=(r-t)/a-(n-t)/(a+o)+(n-r)/o;s*=a;u*=a;l(t,r,s,u)},calc:function(e){var t=e*e;var r=t*e;return i+a*e+o*t+s*r}}}var Wf=new pr;var qf=new Vf,Xf=new Vf,Yf=new Vf;function Zf(e,t,r,n){zf.call(this);this.type="CatmullRomCurve3";this.points=e||[];this.closed=t||false;this.curveType=r||"centripetal";this.tension=n||.5}Zf.prototype=Object.create(zf.prototype);Zf.prototype.constructor=Zf;Zf.prototype.isCatmullRomCurve3=true;Zf.prototype.getPoint=function(e,t){var r=t||new pr;var n=this.points;var i=n.length;var a=(i-(this.closed?0:1))*e;var o=Math.floor(a);var s=a-o;if(this.closed){o+=o>0?0:(Math.floor(Math.abs(o)/i)+1)*i}else if(s===0&&o===i-1){o=i-2;s=1}var u,l,c,h;if(this.closed||o>0){u=n[(o-1)%i]}else{Wf.subVectors(n[0],n[1]).add(n[0]);u=Wf}l=n[o%i];c=n[(o+1)%i];if(this.closed||o+2<i){h=n[(o+2)%i]}else{Wf.subVectors(n[i-1],n[i-2]).add(n[i-1]);h=Wf}if(this.curveType==="centripetal"||this.curveType==="chordal"){var f=this.curveType==="chordal"?.5:.25;var d=Math.pow(u.distanceToSquared(l),f);var p=Math.pow(l.distanceToSquared(c),f);var v=Math.pow(c.distanceToSquared(h),f);if(p<1e-4)p=1;if(d<1e-4)d=p;if(v<1e-4)v=p;qf.initNonuniformCatmullRom(u.x,l.x,c.x,h.x,d,p,v);Xf.initNonuniformCatmullRom(u.y,l.y,c.y,h.y,d,p,v);Yf.initNonuniformCatmullRom(u.z,l.z,c.z,h.z,d,p,v)}else if(this.curveType==="catmullrom"){qf.initCatmullRom(u.x,l.x,c.x,h.x,this.tension);Xf.initCatmullRom(u.y,l.y,c.y,h.y,this.tension);Yf.initCatmullRom(u.z,l.z,c.z,h.z,this.tension)}r.set(qf.calc(s),Xf.calc(s),Yf.calc(s));return r};Zf.prototype.copy=function(e){zf.prototype.copy.call(this,e);this.points=[];for(var t=0,r=e.points.length;t<r;t++){var n=e.points[t];this.points.push(n.clone())}this.closed=e.closed;this.curveType=e.curveType;this.tension=e.tension;return this};Zf.prototype.toJSON=function(){var e=zf.prototype.toJSON.call(this);e.points=[];for(var t=0,r=this.points.length;t<r;t++){var n=this.points[t];e.points.push(n.toArray())}e.closed=this.closed;e.curveType=this.curveType;e.tension=this.tension;return e};Zf.prototype.fromJSON=function(e){zf.prototype.fromJSON.call(this,e);this.points=[];for(var t=0,r=e.points.length;t<r;t++){var n=e.points[t];this.points.push((new pr).fromArray(n))}this.closed=e.closed;this.curveType=e.curveType;this.tension=e.tension;return this};function Jf(e,t,r,n,i){var a=(n-t)*.5;var o=(i-r)*.5;var s=e*e;var u=e*s;return(2*r-2*n+a+o)*u+(-3*r+3*n-2*a-o)*s+a*e+r}function Kf(e,t){var r=1-e;return r*r*t}function Qf(e,t){return 2*(1-e)*e*t}function $f(e,t){return e*e*t}function ed(e,t,r,n){return Kf(e,t)+Qf(e,r)+$f(e,n)}function td(e,t){var r=1-e;return r*r*r*t}function rd(e,t){var r=1-e;return 3*r*r*e*t}function nd(e,t){return 3*(1-e)*e*e*t}function id(e,t){return e*e*e*t}function ad(e,t,r,n,i){return td(e,t)+rd(e,r)+nd(e,n)+id(e,i)}function od(e,t,r,n){zf.call(this);this.type="CubicBezierCurve";this.v0=e||new cr;this.v1=t||new cr;this.v2=r||new cr;this.v3=n||new cr}od.prototype=Object.create(zf.prototype);od.prototype.constructor=od;od.prototype.isCubicBezierCurve=true;od.prototype.getPoint=function(e,t){var r=t||new cr;var n=this.v0,i=this.v1,a=this.v2,o=this.v3;r.set(ad(e,n.x,i.x,a.x,o.x),ad(e,n.y,i.y,a.y,o.y));return r};od.prototype.copy=function(e){zf.prototype.copy.call(this,e);this.v0.copy(e.v0);this.v1.copy(e.v1);this.v2.copy(e.v2);this.v3.copy(e.v3);return this};od.prototype.toJSON=function(){var e=zf.prototype.toJSON.call(this);e.v0=this.v0.toArray();e.v1=this.v1.toArray();e.v2=this.v2.toArray();e.v3=this.v3.toArray();return e};od.prototype.fromJSON=function(e){zf.prototype.fromJSON.call(this,e);this.v0.fromArray(e.v0);this.v1.fromArray(e.v1);this.v2.fromArray(e.v2);this.v3.fromArray(e.v3);return this};function sd(e,t,r,n){zf.call(this);this.type="CubicBezierCurve3";this.v0=e||new pr;this.v1=t||new pr;this.v2=r||new pr;this.v3=n||new pr}sd.prototype=Object.create(zf.prototype);sd.prototype.constructor=sd;sd.prototype.isCubicBezierCurve3=true;sd.prototype.getPoint=function(e,t){var r=t||new pr;var n=this.v0,i=this.v1,a=this.v2,o=this.v3;r.set(ad(e,n.x,i.x,a.x,o.x),ad(e,n.y,i.y,a.y,o.y),ad(e,n.z,i.z,a.z,o.z));return r};sd.prototype.copy=function(e){zf.prototype.copy.call(this,e);this.v0.copy(e.v0);this.v1.copy(e.v1);this.v2.copy(e.v2);this.v3.copy(e.v3);return this};sd.prototype.toJSON=function(){var e=zf.prototype.toJSON.call(this);e.v0=this.v0.toArray();e.v1=this.v1.toArray();e.v2=this.v2.toArray();e.v3=this.v3.toArray();return e};sd.prototype.fromJSON=function(e){zf.prototype.fromJSON.call(this,e);this.v0.fromArray(e.v0);this.v1.fromArray(e.v1);this.v2.fromArray(e.v2);this.v3.fromArray(e.v3);return this};function ud(e,t){zf.call(this);this.type="LineCurve";this.v1=e||new cr;this.v2=t||new cr}ud.prototype=Object.create(zf.prototype);ud.prototype.constructor=ud;ud.prototype.isLineCurve=true;ud.prototype.getPoint=function(e,t){var r=t||new cr;if(e===1){r.copy(this.v2)}else{r.copy(this.v2).sub(this.v1);r.multiplyScalar(e).add(this.v1)}return r};ud.prototype.getPointAt=function(e,t){return this.getPoint(e,t)};ud.prototype.getTangent=function(){var e=this.v2.clone().sub(this.v1);return e.normalize()};ud.prototype.copy=function(e){zf.prototype.copy.call(this,e);this.v1.copy(e.v1);this.v2.copy(e.v2);return this};ud.prototype.toJSON=function(){var e=zf.prototype.toJSON.call(this);e.v1=this.v1.toArray();e.v2=this.v2.toArray();return e};ud.prototype.fromJSON=function(e){zf.prototype.fromJSON.call(this,e);this.v1.fromArray(e.v1);this.v2.fromArray(e.v2);return this};function ld(e,t){zf.call(this);this.type="LineCurve3";this.v1=e||new pr;this.v2=t||new pr}ld.prototype=Object.create(zf.prototype);ld.prototype.constructor=ld;ld.prototype.isLineCurve3=true;ld.prototype.getPoint=function(e,t){var r=t||new pr;if(e===1){r.copy(this.v2)}else{r.copy(this.v2).sub(this.v1);r.multiplyScalar(e).add(this.v1)}return r};ld.prototype.getPointAt=function(e,t){return this.getPoint(e,t)};ld.prototype.copy=function(e){zf.prototype.copy.call(this,e);this.v1.copy(e.v1);this.v2.copy(e.v2);return this};ld.prototype.toJSON=function(){var e=zf.prototype.toJSON.call(this);e.v1=this.v1.toArray();e.v2=this.v2.toArray();return e};ld.prototype.fromJSON=function(e){zf.prototype.fromJSON.call(this,e);this.v1.fromArray(e.v1);this.v2.fromArray(e.v2);return this};function cd(e,t,r){zf.call(this);this.type="QuadraticBezierCurve";this.v0=e||new cr;this.v1=t||new cr;this.v2=r||new cr}cd.prototype=Object.create(zf.prototype);cd.prototype.constructor=cd;cd.prototype.isQuadraticBezierCurve=true;cd.prototype.getPoint=function(e,t){var r=t||new cr;var n=this.v0,i=this.v1,a=this.v2;r.set(ed(e,n.x,i.x,a.x),ed(e,n.y,i.y,a.y));return r};cd.prototype.copy=function(e){zf.prototype.copy.call(this,e);this.v0.copy(e.v0);this.v1.copy(e.v1);this.v2.copy(e.v2);return this};cd.prototype.toJSON=function(){var e=zf.prototype.toJSON.call(this);e.v0=this.v0.toArray();e.v1=this.v1.toArray();e.v2=this.v2.toArray();return e};cd.prototype.fromJSON=function(e){zf.prototype.fromJSON.call(this,e);this.v0.fromArray(e.v0);this.v1.fromArray(e.v1);this.v2.fromArray(e.v2);return this};function hd(e,t,r){zf.call(this);this.type="QuadraticBezierCurve3";this.v0=e||new pr;this.v1=t||new pr;this.v2=r||new pr}hd.prototype=Object.create(zf.prototype);hd.prototype.constructor=hd;hd.prototype.isQuadraticBezierCurve3=true;hd.prototype.getPoint=function(e,t){var r=t||new pr;var n=this.v0,i=this.v1,a=this.v2;r.set(ed(e,n.x,i.x,a.x),ed(e,n.y,i.y,a.y),ed(e,n.z,i.z,a.z));return r};hd.prototype.copy=function(e){zf.prototype.copy.call(this,e);this.v0.copy(e.v0);this.v1.copy(e.v1);this.v2.copy(e.v2);return this};hd.prototype.toJSON=function(){var e=zf.prototype.toJSON.call(this);e.v0=this.v0.toArray();e.v1=this.v1.toArray();e.v2=this.v2.toArray();return e};hd.prototype.fromJSON=function(e){zf.prototype.fromJSON.call(this,e);this.v0.fromArray(e.v0);this.v1.fromArray(e.v1);this.v2.fromArray(e.v2);return this};function fd(e){zf.call(this);this.type="SplineCurve";this.points=e||[]}fd.prototype=Object.create(zf.prototype);fd.prototype.constructor=fd;fd.prototype.isSplineCurve=true;fd.prototype.getPoint=function(e,t){var r=t||new cr;var n=this.points;var i=(n.length-1)*e;var a=Math.floor(i);var o=i-a;var s=n[a===0?a:a-1];var u=n[a];var l=n[a>n.length-2?n.length-1:a+1];var c=n[a>n.length-3?n.length-1:a+2];r.set(Jf(o,s.x,u.x,l.x,c.x),Jf(o,s.y,u.y,l.y,c.y));return r};fd.prototype.copy=function(e){zf.prototype.copy.call(this,e);this.points=[];for(var t=0,r=e.points.length;t<r;t++){var n=e.points[t];this.points.push(n.clone())}return this};fd.prototype.toJSON=function(){var e=zf.prototype.toJSON.call(this);e.points=[];for(var t=0,r=this.points.length;t<r;t++){var n=this.points[t];e.points.push(n.toArray())}return e};fd.prototype.fromJSON=function(e){zf.prototype.fromJSON.call(this,e);this.points=[];for(var t=0,r=e.points.length;t<r;t++){var n=e.points[t];this.points.push((new cr).fromArray(n))}return this};var dd=Object.freeze({ArcCurve:Gf,CatmullRomCurve3:Zf,CubicBezierCurve:od,CubicBezierCurve3:sd,EllipseCurve:Hf,LineCurve:ud,LineCurve3:ld,QuadraticBezierCurve:cd,QuadraticBezierCurve3:hd,SplineCurve:fd});function pd(){zf.call(this);this.type="CurvePath";this.curves=[];this.autoClose=false}pd.prototype=Object.assign(Object.create(zf.prototype),{constructor:pd,add:function(e){this.curves.push(e)},closePath:function(){var e=this.curves[0].getPoint(0);var t=this.curves[this.curves.length-1].getPoint(1);if(!e.equals(t)){this.curves.push(new ud(t,e))}},getPoint:function(e){var t=e*this.getLength();var r=this.getCurveLengths();var n=0;while(n<r.length){if(r[n]>=t){var i=r[n]-t;var a=this.curves[n];var o=a.getLength();var s=o===0?0:1-i/o;return a.getPointAt(s)}n++}return null},getLength:function(){var e=this.getCurveLengths();return e[e.length-1]},updateArcLengths:function(){this.needsUpdate=true;this.cacheLengths=null;this.getCurveLengths()},getCurveLengths:function(){if(this.cacheLengths&&this.cacheLengths.length===this.curves.length){return this.cacheLengths}var e=[],t=0;for(var r=0,n=this.curves.length;r<n;r++){t+=this.curves[r].getLength();e.push(t)}this.cacheLengths=e;return e},getSpacedPoints:function(e){if(e===undefined)e=40;var t=[];for(var r=0;r<=e;r++){t.push(this.getPoint(r/e))}if(this.autoClose){t.push(t[0])}return t},getPoints:function(e){e=e||12;var t=[],r;for(var n=0,i=this.curves;n<i.length;n++){var a=i[n];var o=a&&a.isEllipseCurve?e*2:a&&(a.isLineCurve||a.isLineCurve3)?1:a&&a.isSplineCurve?e*a.points.length:e;var s=a.getPoints(o);for(var u=0;u<s.length;u++){var l=s[u];if(r&&r.equals(l))continue;t.push(l);r=l}}if(this.autoClose&&t.length>1&&!t[t.length-1].equals(t[0])){t.push(t[0])}return t},copy:function(e){zf.prototype.copy.call(this,e);this.curves=[];for(var t=0,r=e.curves.length;t<r;t++){var n=e.curves[t];this.curves.push(n.clone())}this.autoClose=e.autoClose;return this},toJSON:function(){var e=zf.prototype.toJSON.call(this);e.autoClose=this.autoClose;e.curves=[];for(var t=0,r=this.curves.length;t<r;t++){var n=this.curves[t];e.curves.push(n.toJSON())}return e},fromJSON:function(e){zf.prototype.fromJSON.call(this,e);this.autoClose=e.autoClose;this.curves=[];for(var t=0,r=e.curves.length;t<r;t++){var n=e.curves[t];this.curves.push((new dd[n.type]).fromJSON(n))}return this}});function vd(e){pd.call(this);this.type="Path";this.currentPoint=new cr;if(e){this.setFromPoints(e)}}vd.prototype=Object.assign(Object.create(pd.prototype),{constructor:vd,setFromPoints:function(e){this.moveTo(e[0].x,e[0].y);for(var t=1,r=e.length;t<r;t++){this.lineTo(e[t].x,e[t].y)}},moveTo:function(e,t){this.currentPoint.set(e,t)},lineTo:function(e,t){var r=new ud(this.currentPoint.clone(),new cr(e,t));this.curves.push(r);this.currentPoint.set(e,t)},quadraticCurveTo:function(e,t,r,n){var i=new cd(this.currentPoint.clone(),new cr(e,t),new cr(r,n));this.curves.push(i);this.currentPoint.set(r,n)},bezierCurveTo:function(e,t,r,n,i,a){var o=new od(this.currentPoint.clone(),new cr(e,t),new cr(r,n),new cr(i,a));this.curves.push(o);this.currentPoint.set(i,a)},splineThru:function(e){var t=[this.currentPoint.clone()].concat(e);var r=new fd(t);this.curves.push(r);this.currentPoint.copy(e[e.length-1])},arc:function(e,t,r,n,i,a){var o=this.currentPoint.x;var s=this.currentPoint.y;this.absarc(e+o,t+s,r,n,i,a)},absarc:function(e,t,r,n,i,a){this.absellipse(e,t,r,r,n,i,a)},ellipse:function(e,t,r,n,i,a,o,s){var u=this.currentPoint.x;var l=this.currentPoint.y;this.absellipse(e+u,t+l,r,n,i,a,o,s)},absellipse:function(e,t,r,n,i,a,o,s){var u=new Hf(e,t,r,n,i,a,o,s);if(this.curves.length>0){var l=u.getPoint(0);if(!l.equals(this.currentPoint)){this.lineTo(l.x,l.y)}}this.curves.push(u);var c=u.getPoint(1);this.currentPoint.copy(c)},copy:function(e){pd.prototype.copy.call(this,e);this.currentPoint.copy(e.currentPoint);return this},toJSON:function(){var e=pd.prototype.toJSON.call(this);e.currentPoint=this.currentPoint.toArray();return e},fromJSON:function(e){pd.prototype.fromJSON.call(this,e);this.currentPoint.fromArray(e.currentPoint);return this}});function md(e){vd.call(this,e);this.uuid=lr.generateUUID();this.type="Shape";this.holes=[]}md.prototype=Object.assign(Object.create(vd.prototype),{constructor:md,getPointsHoles:function(e){var t=[];for(var r=0,n=this.holes.length;r<n;r++){t[r]=this.holes[r].getPoints(e)}return t},extractPoints:function(e){return{shape:this.getPoints(e),holes:this.getPointsHoles(e)}},copy:function(e){vd.prototype.copy.call(this,e);this.holes=[];for(var t=0,r=e.holes.length;t<r;t++){var n=e.holes[t];this.holes.push(n.clone())}return this},toJSON:function(){var e=vd.prototype.toJSON.call(this);e.uuid=this.uuid;e.holes=[];for(var t=0,r=this.holes.length;t<r;t++){var n=this.holes[t];e.holes.push(n.toJSON())}return e},fromJSON:function(e){vd.prototype.fromJSON.call(this,e);this.uuid=e.uuid;this.holes=[];for(var t=0,r=e.holes.length;t<r;t++){var n=e.holes[t];this.holes.push((new vd).fromJSON(n))}return this}});function gd(e,t){Zr.call(this);this.type="Light";this.color=new Fn(e);this.intensity=t!==undefined?t:1;this.receiveShadow=undefined}gd.prototype=Object.assign(Object.create(Zr.prototype),{constructor:gd,isLight:true,copy:function(e){Zr.prototype.copy.call(this,e);this.color.copy(e.color);this.intensity=e.intensity;return this},toJSON:function(e){var t=Zr.prototype.toJSON.call(this,e);t.object.color=this.color.getHex();t.object.intensity=this.intensity;if(this.groundColor!==undefined)t.object.groundColor=this.groundColor.getHex();if(this.distance!==undefined)t.object.distance=this.distance;if(this.angle!==undefined)t.object.angle=this.angle;if(this.decay!==undefined)t.object.decay=this.decay;if(this.penumbra!==undefined)t.object.penumbra=this.penumbra;if(this.shadow!==undefined)t.object.shadow=this.shadow.toJSON();return t}});function yd(e,t,r){gd.call(this,e,r);this.type="HemisphereLight";this.castShadow=undefined;this.position.copy(Zr.DefaultUp);this.updateMatrix();this.groundColor=new Fn(t)}yd.prototype=Object.assign(Object.create(gd.prototype),{constructor:yd,isHemisphereLight:true,copy:function(e){gd.prototype.copy.call(this,e);this.groundColor.copy(e.groundColor);return this}});function xd(e){this.camera=e;this.bias=0;this.radius=1;this.mapSize=new cr(512,512);this.map=null;this.mapPass=null;this.matrix=new Or;this._frustum=new ra;this._frameExtents=new cr(1,1);this._viewportCount=1;this._viewports=[new wr(0,0,1,1)]}Object.assign(xd.prototype,{_projScreenMatrix:new Or,_lightPositionWorld:new pr,_lookTarget:new pr,getViewportCount:function(){return this._viewportCount},getFrustum:function(){return this._frustum},updateMatrices:function(e){var t=this.camera,r=this.matrix,n=this._projScreenMatrix,i=this._lookTarget,a=this._lightPositionWorld;a.setFromMatrixPosition(e.matrixWorld);t.position.copy(a);i.setFromMatrixPosition(e.target.matrixWorld);t.lookAt(i);t.updateMatrixWorld();n.multiplyMatrices(t.projectionMatrix,t.matrixWorldInverse);this._frustum.setFromMatrix(n);r.set(.5,0,0,.5,0,.5,0,.5,0,0,.5,.5,0,0,0,1);r.multiply(t.projectionMatrix);r.multiply(t.matrixWorldInverse)},getViewport:function(e){return this._viewports[e]},getFrameExtents:function(){return this._frameExtents},copy:function(e){this.camera=e.camera.clone();this.bias=e.bias;this.radius=e.radius;this.mapSize.copy(e.mapSize);return this},clone:function(){return(new this.constructor).copy(this)},toJSON:function(){var e={};if(this.bias!==0)e.bias=this.bias;if(this.radius!==1)e.radius=this.radius;if(this.mapSize.x!==512||this.mapSize.y!==512)e.mapSize=this.mapSize.toArray();e.camera=this.camera.toJSON(false).object;delete e.camera.matrix;return e}});function bd(){xd.call(this,new Vi(50,1,.5,500))}bd.prototype=Object.assign(Object.create(xd.prototype),{constructor:bd,isSpotLightShadow:true,updateMatrices:function(e,t,r){var n=this.camera;var i=lr.RAD2DEG*2*e.angle;var a=this.mapSize.width/this.mapSize.height;var o=e.distance||n.far;if(i!==n.fov||a!==n.aspect||o!==n.far){n.fov=i;n.aspect=a;n.far=o;n.updateProjectionMatrix()}xd.prototype.updateMatrices.call(this,e,t,r)}});function wd(e,t,r,n,i,a){gd.call(this,e,t);this.type="SpotLight";this.position.copy(Zr.DefaultUp);this.updateMatrix();this.target=new Zr;Object.defineProperty(this,"power",{get:function(){return this.intensity*Math.PI},set:function(e){this.intensity=e/Math.PI}});this.distance=r!==undefined?r:0;this.angle=n!==undefined?n:Math.PI/3;this.penumbra=i!==undefined?i:0;this.decay=a!==undefined?a:1;this.shadow=new bd}wd.prototype=Object.assign(Object.create(gd.prototype),{constructor:wd,isSpotLight:true,copy:function(e){gd.prototype.copy.call(this,e);this.distance=e.distance;this.angle=e.angle;this.penumbra=e.penumbra;this.decay=e.decay;this.target=e.target.clone();this.shadow=e.shadow.clone();return this}});function _d(){xd.call(this,new Vi(90,1,.5,500));this._frameExtents=new cr(4,2);this._viewportCount=6;this._viewports=[new wr(2,1,1,1),new wr(0,1,1,1),new wr(3,1,1,1),new wr(1,1,1,1),new wr(3,0,1,1),new wr(1,0,1,1)];this._cubeDirections=[new pr(1,0,0),new pr(-1,0,0),new pr(0,0,1),new pr(0,0,-1),new pr(0,1,0),new pr(0,-1,0)];this._cubeUps=[new pr(0,1,0),new pr(0,1,0),new pr(0,1,0),new pr(0,1,0),new pr(0,0,1),new pr(0,0,-1)]}_d.prototype=Object.assign(Object.create(xd.prototype),{constructor:_d,isPointLightShadow:true,updateMatrices:function(e,t,r){var n=this.camera,i=this.matrix,a=this._lightPositionWorld,o=this._lookTarget,s=this._projScreenMatrix;a.setFromMatrixPosition(e.matrixWorld);n.position.copy(a);o.copy(n.position);o.add(this._cubeDirections[r]);n.up.copy(this._cubeUps[r]);n.lookAt(o);n.updateMatrixWorld();i.makeTranslation(-a.x,-a.y,-a.z);s.multiplyMatrices(n.projectionMatrix,n.matrixWorldInverse);this._frustum.setFromMatrix(s)}});function Td(e,t,r,n){gd.call(this,e,t);this.type="PointLight";Object.defineProperty(this,"power",{get:function(){return this.intensity*4*Math.PI},set:function(e){this.intensity=e/(4*Math.PI)}});this.distance=r!==undefined?r:0;this.decay=n!==undefined?n:1;this.shadow=new _d}Td.prototype=Object.assign(Object.create(gd.prototype),{constructor:Td,isPointLight:true,copy:function(e){gd.prototype.copy.call(this,e);this.distance=e.distance;this.decay=e.decay;this.shadow=e.shadow.clone();return this}});function Ed(e,t,r,n,i,a){Gi.call(this);this.type="OrthographicCamera";this.zoom=1;this.view=null;this.left=e!==undefined?e:-1;this.right=t!==undefined?t:1;this.top=r!==undefined?r:1;this.bottom=n!==undefined?n:-1;this.near=i!==undefined?i:.1;this.far=a!==undefined?a:2e3;this.updateProjectionMatrix()}Ed.prototype=Object.assign(Object.create(Gi.prototype),{constructor:Ed,isOrthographicCamera:true,copy:function(e,t){Gi.prototype.copy.call(this,e,t);this.left=e.left;this.right=e.right;this.top=e.top;this.bottom=e.bottom;this.near=e.near;this.far=e.far;this.zoom=e.zoom;this.view=e.view===null?null:Object.assign({},e.view);return this},setViewOffset:function(e,t,r,n,i,a){if(this.view===null){this.view={enabled:true,fullWidth:1,fullHeight:1,offsetX:0,offsetY:0,width:1,height:1}}this.view.enabled=true;this.view.fullWidth=e;this.view.fullHeight=t;this.view.offsetX=r;this.view.offsetY=n;this.view.width=i;this.view.height=a;this.updateProjectionMatrix()},clearViewOffset:function(){if(this.view!==null){this.view.enabled=false}this.updateProjectionMatrix()},updateProjectionMatrix:function(){var e=(this.right-this.left)/(2*this.zoom);var t=(this.top-this.bottom)/(2*this.zoom);var r=(this.right+this.left)/2;var n=(this.top+this.bottom)/2;var i=r-e;var a=r+e;var o=n+t;var s=n-t;if(this.view!==null&&this.view.enabled){var u=this.zoom/(this.view.width/this.view.fullWidth);var l=this.zoom/(this.view.height/this.view.fullHeight);var c=(this.right-this.left)/this.view.width;var h=(this.top-this.bottom)/this.view.height;i+=c*(this.view.offsetX/u);a=i+c*(this.view.width/u);o-=h*(this.view.offsetY/l);s=o-h*(this.view.height/l)}this.projectionMatrix.makeOrthographic(i,a,o,s,this.near,this.far);this.projectionMatrixInverse.getInverse(this.projectionMatrix)},toJSON:function(e){var t=Zr.prototype.toJSON.call(this,e);t.object.zoom=this.zoom;t.object.left=this.left;t.object.right=this.right;t.object.top=this.top;t.object.bottom=this.bottom;t.object.near=this.near;t.object.far=this.far;if(this.view!==null)t.object.view=Object.assign({},this.view);return t}});function Md(){xd.call(this,new Ed(-5,5,5,-5,.5,500))}Md.prototype=Object.assign(Object.create(xd.prototype),{constructor:Md,isDirectionalLightShadow:true,updateMatrices:function(e,t,r){xd.prototype.updateMatrices.call(this,e,t,r)}});function Sd(e,t){gd.call(this,e,t);this.type="DirectionalLight";this.position.copy(Zr.DefaultUp);this.updateMatrix();this.target=new Zr;this.shadow=new Md}Sd.prototype=Object.assign(Object.create(gd.prototype),{constructor:Sd,isDirectionalLight:true,copy:function(e){gd.prototype.copy.call(this,e);this.target=e.target.clone();this.shadow=e.shadow.clone();return this}});function Ad(e,t){gd.call(this,e,t);this.type="AmbientLight";this.castShadow=undefined}Ad.prototype=Object.assign(Object.create(gd.prototype),{constructor:Ad,isAmbientLight:true});function Rd(e,t,r,n){gd.call(this,e,t);this.type="RectAreaLight";this.width=r!==undefined?r:10;this.height=n!==undefined?n:10}Rd.prototype=Object.assign(Object.create(gd.prototype),{constructor:Rd,isRectAreaLight:true,copy:function(e){gd.prototype.copy.call(this,e);this.width=e.width;this.height=e.height;return this},toJSON:function(e){var t=gd.prototype.toJSON.call(this,e);t.object.width=this.width;t.object.height=this.height;return t}});function Pd(e){Lf.call(this,e);this.textures={}}Pd.prototype=Object.assign(Object.create(Lf.prototype),{constructor:Pd,load:function(e,t,r,n){var i=this;var a=new Df(i.manager);a.setPath(i.path);a.load(e,function(e){t(i.parse(JSON.parse(e)))},r,n)},parse:function(e){var t=this.textures;function r(e){if(t[e]===undefined){console.warn("THREE.MaterialLoader: Undefined texture",e)}return t[e]}var n=new ff[e.type];if(e.uuid!==undefined)n.uuid=e.uuid;if(e.name!==undefined)n.name=e.name;if(e.color!==undefined)n.color.setHex(e.color);if(e.roughness!==undefined)n.roughness=e.roughness;if(e.metalness!==undefined)n.metalness=e.metalness;if(e.sheen!==undefined)n.sheen=(new Fn).setHex(e.sheen);if(e.emissive!==undefined)n.emissive.setHex(e.emissive);if(e.specular!==undefined)n.specular.setHex(e.specular);if(e.shininess!==undefined)n.shininess=e.shininess;if(e.clearcoat!==undefined)n.clearcoat=e.clearcoat;if(e.clearcoatRoughness!==undefined)n.clearcoatRoughness=e.clearcoatRoughness;if(e.vertexColors!==undefined)n.vertexColors=e.vertexColors;if(e.fog!==undefined)n.fog=e.fog;if(e.flatShading!==undefined)n.flatShading=e.flatShading;if(e.blending!==undefined)n.blending=e.blending;if(e.combine!==undefined)n.combine=e.combine;if(e.side!==undefined)n.side=e.side;if(e.opacity!==undefined)n.opacity=e.opacity;if(e.transparent!==undefined)n.transparent=e.transparent;if(e.alphaTest!==undefined)n.alphaTest=e.alphaTest;if(e.depthTest!==undefined)n.depthTest=e.depthTest;if(e.depthWrite!==undefined)n.depthWrite=e.depthWrite;if(e.colorWrite!==undefined)n.colorWrite=e.colorWrite;if(e.stencilWrite!==undefined)n.stencilWrite=e.stencilWrite;if(e.stencilWriteMask!==undefined)n.stencilWriteMask=e.stencilWriteMask;if(e.stencilFunc!==undefined)n.stencilFunc=e.stencilFunc;if(e.stencilRef!==undefined)n.stencilRef=e.stencilRef;if(e.stencilFuncMask!==undefined)n.stencilFuncMask=e.stencilFuncMask;if(e.stencilFail!==undefined)n.stencilFail=e.stencilFail;if(e.stencilZFail!==undefined)n.stencilZFail=e.stencilZFail;if(e.stencilZPass!==undefined)n.stencilZPass=e.stencilZPass;if(e.wireframe!==undefined)n.wireframe=e.wireframe;if(e.wireframeLinewidth!==undefined)n.wireframeLinewidth=e.wireframeLinewidth;if(e.wireframeLinecap!==undefined)n.wireframeLinecap=e.wireframeLinecap;if(e.wireframeLinejoin!==undefined)n.wireframeLinejoin=e.wireframeLinejoin;if(e.rotation!==undefined)n.rotation=e.rotation;if(e.linewidth!==1)n.linewidth=e.linewidth;if(e.dashSize!==undefined)n.dashSize=e.dashSize;if(e.gapSize!==undefined)n.gapSize=e.gapSize;if(e.scale!==undefined)n.scale=e.scale;if(e.polygonOffset!==undefined)n.polygonOffset=e.polygonOffset;if(e.polygonOffsetFactor!==undefined)n.polygonOffsetFactor=e.polygonOffsetFactor;if(e.polygonOffsetUnits!==undefined)n.polygonOffsetUnits=e.polygonOffsetUnits;if(e.skinning!==undefined)n.skinning=e.skinning;if(e.morphTargets!==undefined)n.morphTargets=e.morphTargets;if(e.morphNormals!==undefined)n.morphNormals=e.morphNormals;if(e.dithering!==undefined)n.dithering=e.dithering;if(e.visible!==undefined)n.visible=e.visible;if(e.toneMapped!==undefined)n.toneMapped=e.toneMapped;if(e.userData!==undefined)n.userData=e.userData;if(e.uniforms!==undefined){for(var i in e.uniforms){var a=e.uniforms[i];n.uniforms[i]={};switch(a.type){case"t":n.uniforms[i].value=r(a.value);break;case"c":n.uniforms[i].value=(new Fn).setHex(a.value);break;case"v2":n.uniforms[i].value=(new cr).fromArray(a.value);break;case"v3":n.uniforms[i].value=(new pr).fromArray(a.value);break;case"v4":n.uniforms[i].value=(new wr).fromArray(a.value);break;case"m3":n.uniforms[i].value=(new mr).fromArray(a.value);case"m4":n.uniforms[i].value=(new Or).fromArray(a.value);break;default:n.uniforms[i].value=a.value}}}if(e.defines!==undefined)n.defines=e.defines;if(e.vertexShader!==undefined)n.vertexShader=e.vertexShader;if(e.fragmentShader!==undefined)n.fragmentShader=e.fragmentShader;if(e.extensions!==undefined){for(var o in e.extensions){n.extensions[o]=e.extensions[o]}}if(e.shading!==undefined)n.flatShading=e.shading===1;if(e.size!==undefined)n.size=e.size;if(e.sizeAttenuation!==undefined)n.sizeAttenuation=e.sizeAttenuation;if(e.map!==undefined)n.map=r(e.map);if(e.matcap!==undefined)n.matcap=r(e.matcap);if(e.alphaMap!==undefined){n.alphaMap=r(e.alphaMap);n.transparent=true}if(e.bumpMap!==undefined)n.bumpMap=r(e.bumpMap);if(e.bumpScale!==undefined)n.bumpScale=e.bumpScale;if(e.normalMap!==undefined)n.normalMap=r(e.normalMap);if(e.normalMapType!==undefined)n.normalMapType=e.normalMapType;if(e.normalScale!==undefined){var s=e.normalScale;if(Array.isArray(s)===false){s=[s,s]}n.normalScale=(new cr).fromArray(s)}if(e.displacementMap!==undefined)n.displacementMap=r(e.displacementMap);if(e.displacementScale!==undefined)n.displacementScale=e.displacementScale;if(e.displacementBias!==undefined)n.displacementBias=e.displacementBias;if(e.roughnessMap!==undefined)n.roughnessMap=r(e.roughnessMap);if(e.metalnessMap!==undefined)n.metalnessMap=r(e.metalnessMap);if(e.emissiveMap!==undefined)n.emissiveMap=r(e.emissiveMap);if(e.emissiveIntensity!==undefined)n.emissiveIntensity=e.emissiveIntensity;if(e.specularMap!==undefined)n.specularMap=r(e.specularMap);if(e.envMap!==undefined)n.envMap=r(e.envMap);if(e.envMapIntensity!==undefined)n.envMapIntensity=e.envMapIntensity;if(e.reflectivity!==undefined)n.reflectivity=e.reflectivity;if(e.refractionRatio!==undefined)n.refractionRatio=e.refractionRatio;if(e.lightMap!==undefined)n.lightMap=r(e.lightMap);if(e.lightMapIntensity!==undefined)n.lightMapIntensity=e.lightMapIntensity;if(e.aoMap!==undefined)n.aoMap=r(e.aoMap);if(e.aoMapIntensity!==undefined)n.aoMapIntensity=e.aoMapIntensity;if(e.gradientMap!==undefined)n.gradientMap=r(e.gradientMap);if(e.clearcoatNormalMap!==undefined)n.clearcoatNormalMap=r(e.clearcoatNormalMap);if(e.clearcoatNormalScale!==undefined)n.clearcoatNormalScale=(new cr).fromArray(e.clearcoatNormalScale);return n},setTextures:function(e){this.textures=e;return this}});var Cd={decodeText:function(e){if(typeof TextDecoder!=="undefined"){return(new TextDecoder).decode(e)}var t="";for(var r=0,n=e.length;r<n;r++){t+=String.fromCharCode(e[r])}try{return decodeURIComponent(escape(t))}catch(e){return t}},extractUrlBase:function(e){var t=e.lastIndexOf("/");if(t===-1)return"./";return e.substr(0,t+1)}};r.LoaderUtils=Cd;function Od(){li.call(this);this.type="InstancedBufferGeometry";this.maxInstancedCount=undefined}Od.prototype=Object.assign(Object.create(li.prototype),{constructor:Od,isInstancedBufferGeometry:true,copy:function(e){li.prototype.copy.call(this,e);this.maxInstancedCount=e.maxInstancedCount;return this},clone:function(){return(new this.constructor).copy(this)},toJSON:function(){var e=li.prototype.toJSON.call(this);e.maxInstancedCount=this.maxInstancedCount;e.isInstancedBufferGeometry=true;return e}});function Ld(e,t,r,n){if(typeof r==="number"){n=r;r=false;console.error("THREE.InstancedBufferAttribute: The constructor now expects normalized as the third argument.")}Vn.call(this,e,t,r);this.meshPerAttribute=n||1}Ld.prototype=Object.assign(Object.create(Vn.prototype),{constructor:Ld,isInstancedBufferAttribute:true,copy:function(e){Vn.prototype.copy.call(this,e);this.meshPerAttribute=e.meshPerAttribute;return this},toJSON:function(){var e=Vn.prototype.toJSON.call(this);e.meshPerAttribute=this.meshPerAttribute;e.isInstancedBufferAttribute=true;return e}});function Id(e){Lf.call(this,e)}Id.prototype=Object.assign(Object.create(Lf.prototype),{constructor:Id,load:function(e,t,r,n){var i=this;var a=new Df(i.manager);a.setPath(i.path);a.load(e,function(e){t(i.parse(JSON.parse(e)))},r,n)},parse:function(e){var t=e.isInstancedBufferGeometry?new Od:new li;var r=e.data.index;if(r!==undefined){var n=new Dd[r.type](r.array);t.setIndex(new Vn(n,1))}var i=e.data.attributes;for(var a in i){var o=i[a];var n=new Dd[o.type](o.array);var s=o.isInstancedBufferAttribute?Ld:Vn;var u=new s(n,o.itemSize,o.normalized);if(o.name!==undefined)u.name=o.name;t.addAttribute(a,u)}var l=e.data.morphAttributes;if(l){for(var a in l){var c=l[a];var h=[];for(var f=0,d=c.length;f<d;f++){var o=c[f];var n=new Dd[o.type](o.array);var u=new Vn(n,o.itemSize,o.normalized);if(o.name!==undefined)u.name=o.name;h.push(u)}t.morphAttributes[a]=h}}var p=e.data.groups||e.data.drawcalls||e.data.offsets;if(p!==undefined){for(var f=0,v=p.length;f!==v;++f){var m=p[f];t.addGroup(m.start,m.count,m.materialIndex)}}var g=e.data.boundingSphere;if(g!==undefined){var y=new pr;if(g.center!==undefined){y.fromArray(g.center)}t.boundingSphere=new dn(y,g.radius)}if(e.name)t.name=e.name;if(e.userData)t.userData=e.userData;return t}});var Dd={Int8Array:Int8Array,Uint8Array:Uint8Array,Uint8ClampedArray:typeof Uint8ClampedArray!=="undefined"?Uint8ClampedArray:Uint8Array,Int16Array:Int16Array,Uint16Array:Uint16Array,Int32Array:Int32Array,Uint32Array:Uint32Array,Float32Array:Float32Array,Float64Array:Float64Array};function Nd(e){Lf.call(this,e)}Nd.prototype=Object.assign(Object.create(Lf.prototype),{constructor:Nd,load:function(n,i,e,a){var o=this;var t=this.path===""?Cd.extractUrlBase(n):this.path;this.resourcePath=this.resourcePath||t;var r=new Df(o.manager);r.setPath(this.path);r.load(n,function(e){var t=null;try{t=JSON.parse(e)}catch(e){if(a!==undefined)a(e);console.error("THREE:ObjectLoader: Can't parse "+n+".",e.message);return}var r=t.metadata;if(r===undefined||r.type===undefined||r.type.toLowerCase()==="geometry"){console.error("THREE.ObjectLoader: Can't load "+n);return}o.parse(t,i)},e,a)},parse:function(e,t){var r=this.parseShape(e.shapes);var n=this.parseGeometries(e.geometries,r);var i=this.parseImages(e.images,function(){if(t!==undefined)t(s)});var a=this.parseTextures(e.textures,i);var o=this.parseMaterials(e.materials,a);var s=this.parseObject(e.object,n,o);if(e.animations){s.animations=this.parseAnimations(e.animations)}if(e.images===undefined||e.images.length===0){if(t!==undefined)t(s)}return s},parseShape:function(e){var t={};if(e!==undefined){for(var r=0,n=e.length;r<n;r++){var i=(new md).fromJSON(e[r]);t[i.uuid]=i}}return t},parseGeometries:function(e,t){var r={};if(e!==undefined){var n=new Id;for(var i=0,a=e.length;i<a;i++){var o;var s=e[i];switch(s.type){case"PlaneGeometry":case"PlaneBufferGeometry":o=new ef[s.type](s.width,s.height,s.widthSegments,s.heightSegments);break;case"BoxGeometry":case"BoxBufferGeometry":case"CubeGeometry":o=new ef[s.type](s.width,s.height,s.depth,s.widthSegments,s.heightSegments,s.depthSegments);break;case"CircleGeometry":case"CircleBufferGeometry":o=new ef[s.type](s.radius,s.segments,s.thetaStart,s.thetaLength);break;case"CylinderGeometry":case"CylinderBufferGeometry":o=new ef[s.type](s.radiusTop,s.radiusBottom,s.height,s.radialSegments,s.heightSegments,s.openEnded,s.thetaStart,s.thetaLength);break;case"ConeGeometry":case"ConeBufferGeometry":o=new ef[s.type](s.radius,s.height,s.radialSegments,s.heightSegments,s.openEnded,s.thetaStart,s.thetaLength);break;case"SphereGeometry":case"SphereBufferGeometry":o=new ef[s.type](s.radius,s.widthSegments,s.heightSegments,s.phiStart,s.phiLength,s.thetaStart,s.thetaLength);break;case"DodecahedronGeometry":case"DodecahedronBufferGeometry":case"IcosahedronGeometry":case"IcosahedronBufferGeometry":case"OctahedronGeometry":case"OctahedronBufferGeometry":case"TetrahedronGeometry":case"TetrahedronBufferGeometry":o=new ef[s.type](s.radius,s.detail);break;case"RingGeometry":case"RingBufferGeometry":o=new ef[s.type](s.innerRadius,s.outerRadius,s.thetaSegments,s.phiSegments,s.thetaStart,s.thetaLength);break;case"TorusGeometry":case"TorusBufferGeometry":o=new ef[s.type](s.radius,s.tube,s.radialSegments,s.tubularSegments,s.arc);break;case"TorusKnotGeometry":case"TorusKnotBufferGeometry":o=new ef[s.type](s.radius,s.tube,s.tubularSegments,s.radialSegments,s.p,s.q);break;case"TubeGeometry":case"TubeBufferGeometry":o=new ef[s.type]((new dd[s.path.type]).fromJSON(s.path),s.tubularSegments,s.radius,s.radialSegments,s.closed);break;case"LatheGeometry":case"LatheBufferGeometry":o=new ef[s.type](s.points,s.segments,s.phiStart,s.phiLength);break;case"PolyhedronGeometry":case"PolyhedronBufferGeometry":o=new ef[s.type](s.vertices,s.indices,s.radius,s.details);break;case"ShapeGeometry":case"ShapeBufferGeometry":var u=[];for(var l=0,c=s.shapes.length;l<c;l++){var h=t[s.shapes[l]];u.push(h)}o=new ef[s.type](u,s.curveSegments);break;case"ExtrudeGeometry":case"ExtrudeBufferGeometry":var u=[];for(var l=0,c=s.shapes.length;l<c;l++){var h=t[s.shapes[l]];u.push(h)}var f=s.options.extrudePath;if(f!==undefined){s.options.extrudePath=(new dd[f.type]).fromJSON(f)}o=new ef[s.type](u,s.options);break;case"BufferGeometry":case"InstancedBufferGeometry":o=n.parse(s);break;case"Geometry":if("THREE"in window&&"LegacyJSONLoader"in THREE){var d=new THREE.LegacyJSONLoader;o=d.parse(s,this.resourcePath).geometry}else{console.error('THREE.ObjectLoader: You have to import LegacyJSONLoader in order load geometry data of type "Geometry".')}break;default:console.warn('THREE.ObjectLoader: Unsupported geometry type "'+s.type+'"');continue}o.uuid=s.uuid;if(s.name!==undefined)o.name=s.name;if(o.isBufferGeometry===true&&s.userData!==undefined)o.userData=s.userData;r[s.uuid]=o}}return r},parseMaterials:function(e,t){var r={};var n={};if(e!==undefined){var i=new Pd;i.setTextures(t);for(var a=0,o=e.length;a<o;a++){var s=e[a];if(s.type==="MultiMaterial"){var u=[];for(var l=0;l<s.materials.length;l++){var c=s.materials[l];if(r[c.uuid]===undefined){r[c.uuid]=i.parse(c)}u.push(r[c.uuid])}n[s.uuid]=u}else{if(r[s.uuid]===undefined){r[s.uuid]=i.parse(s)}n[s.uuid]=r[s.uuid]}}}return n},parseAnimations:function(e){var t=[];for(var r=0;r<e.length;r++){var n=e[r];var i=Sf.parse(n);if(n.uuid!==undefined)i.uuid=n.uuid;t.push(i)}return t},parseImages:function(e,t){var r=this;var n={};function i(e){r.manager.itemStart(e);return o.load(e,function(){r.manager.itemEnd(e)},undefined,function(){r.manager.itemError(e);r.manager.itemEnd(e)})}if(e!==undefined&&e.length>0){var a=new Cf(t);var o=new Uf(a);o.setCrossOrigin(this.crossOrigin);for(var s=0,u=e.length;s<u;s++){var l=e[s];var c=l.url;if(Array.isArray(c)){n[l.uuid]=[];for(var h=0,f=c.length;h<f;h++){var d=c[h];var p=/^(\/\/)|([a-z]+:(\/\/)?)/i.test(d)?d:r.resourcePath+d;n[l.uuid].push(i(p))}}else{var p=/^(\/\/)|([a-z]+:(\/\/)?)/i.test(l.url)?l.url:r.resourcePath+l.url;n[l.uuid]=i(p)}}}return n},parseTextures:function(e,t){function r(e,t){if(typeof e==="number")return e;console.warn("THREE.ObjectLoader.parseTexture: Constant should be in numeric form.",e);return t[e]}var n={};if(e!==undefined){for(var i=0,a=e.length;i<a;i++){var o=e[i];if(o.image===undefined){console.warn('THREE.ObjectLoader: No "image" specified for',o.uuid)}if(t[o.image]===undefined){console.warn("THREE.ObjectLoader: Undefined image",o.image)}var s;if(Array.isArray(t[o.image])){s=new Bs(t[o.image])}else{s=new br(t[o.image])}s.needsUpdate=true;s.uuid=o.uuid;if(o.name!==undefined)s.name=o.name;if(o.mapping!==undefined)s.mapping=r(o.mapping,Fd);if(o.offset!==undefined)s.offset.fromArray(o.offset);if(o.repeat!==undefined)s.repeat.fromArray(o.repeat);if(o.center!==undefined)s.center.fromArray(o.center);if(o.rotation!==undefined)s.rotation=o.rotation;if(o.wrap!==undefined){s.wrapS=r(o.wrap[0],Bd);s.wrapT=r(o.wrap[1],Bd)}if(o.format!==undefined)s.format=o.format;if(o.type!==undefined)s.type=o.type;if(o.encoding!==undefined)s.encoding=o.encoding;if(o.minFilter!==undefined)s.minFilter=r(o.minFilter,Ud);if(o.magFilter!==undefined)s.magFilter=r(o.magFilter,Ud);if(o.anisotropy!==undefined)s.anisotropy=o.anisotropy;if(o.flipY!==undefined)s.flipY=o.flipY;if(o.premultiplyAlpha!==undefined)s.premultiplyAlpha=o.premultiplyAlpha;if(o.unpackAlignment!==undefined)s.unpackAlignment=o.unpackAlignment;n[o.uuid]=s}}return n},parseObject:function(e,t,a){var r;function n(e){if(t[e]===undefined){console.warn("THREE.ObjectLoader: Undefined geometry",e)}return t[e]}function i(e){if(e===undefined)return undefined;if(Array.isArray(e)){var t=[];for(var r=0,n=e.length;r<n;r++){var i=e[r];if(a[i]===undefined){console.warn("THREE.ObjectLoader: Undefined material",i)}t.push(a[i])}return t}if(a[e]===undefined){console.warn("THREE.ObjectLoader: Undefined material",e)}return a[e]}switch(e.type){case"Scene":r=new Jr;if(e.background!==undefined){if(Number.isInteger(e.background)){r.background=new Fn(e.background)}}if(e.fog!==undefined){if(e.fog.type==="Fog"){r.fog=new kl(e.fog.color,e.fog.near,e.fog.far)}else if(e.fog.type==="FogExp2"){r.fog=new Ul(e.fog.color,e.fog.density)}}break;case"PerspectiveCamera":r=new Vi(e.fov,e.aspect,e.near,e.far);if(e.focus!==undefined)r.focus=e.focus;if(e.zoom!==undefined)r.zoom=e.zoom;if(e.filmGauge!==undefined)r.filmGauge=e.filmGauge;if(e.filmOffset!==undefined)r.filmOffset=e.filmOffset;if(e.view!==undefined)r.view=Object.assign({},e.view);break;case"OrthographicCamera":r=new Ed(e.left,e.right,e.top,e.bottom,e.near,e.far);if(e.zoom!==undefined)r.zoom=e.zoom;if(e.view!==undefined)r.view=Object.assign({},e.view);break;case"AmbientLight":r=new Ad(e.color,e.intensity);break;case"DirectionalLight":r=new Sd(e.color,e.intensity);break;case"PointLight":r=new Td(e.color,e.intensity,e.distance,e.decay);break;case"RectAreaLight":r=new Rd(e.color,e.intensity,e.width,e.height);break;case"SpotLight":r=new wd(e.color,e.intensity,e.distance,e.angle,e.penumbra,e.decay);break;case"HemisphereLight":r=new yd(e.color,e.groundColor,e.intensity);break;case"SkinnedMesh":console.warn("THREE.ObjectLoader.parseObject() does not support SkinnedMesh yet.");case"Mesh":var o=n(e.geometry);var s=i(e.material);if(o.bones&&o.bones.length>0){r=new sc(o,s)}else{r=new Ai(o,s)}if(e.drawMode!==undefined)r.setDrawMode(e.drawMode);break;case"LOD":r=new oc;break;case"Line":r=new xc(n(e.geometry),i(e.material),e.mode);break;case"LineLoop":r=new Tc(n(e.geometry),i(e.material));break;case"LineSegments":r=new _c(n(e.geometry),i(e.material));break;case"PointCloud":case"Points":r=new Pc(n(e.geometry),i(e.material));break;case"Sprite":r=new rc(i(e.material));break;case"Group":r=new Cl;break;default:r=new Zr}r.uuid=e.uuid;if(e.name!==undefined)r.name=e.name;if(e.matrix!==undefined){r.matrix.fromArray(e.matrix);if(e.matrixAutoUpdate!==undefined)r.matrixAutoUpdate=e.matrixAutoUpdate;if(r.matrixAutoUpdate)r.matrix.decompose(r.position,r.quaternion,r.scale)}else{if(e.position!==undefined)r.position.fromArray(e.position);if(e.rotation!==undefined)r.rotation.fromArray(e.rotation);if(e.quaternion!==undefined)r.quaternion.fromArray(e.quaternion);if(e.scale!==undefined)r.scale.fromArray(e.scale)}if(e.castShadow!==undefined)r.castShadow=e.castShadow;if(e.receiveShadow!==undefined)r.receiveShadow=e.receiveShadow;if(e.shadow){if(e.shadow.bias!==undefined)r.shadow.bias=e.shadow.bias;if(e.shadow.radius!==undefined)r.shadow.radius=e.shadow.radius;if(e.shadow.mapSize!==undefined)r.shadow.mapSize.fromArray(e.shadow.mapSize);if(e.shadow.camera!==undefined)r.shadow.camera=this.parseObject(e.shadow.camera)}if(e.visible!==undefined)r.visible=e.visible;if(e.frustumCulled!==undefined)r.frustumCulled=e.frustumCulled;if(e.renderOrder!==undefined)r.renderOrder=e.renderOrder;if(e.userData!==undefined)r.userData=e.userData;if(e.layers!==undefined)r.layers.mask=e.layers;if(e.children!==undefined){var u=e.children;for(var l=0;l<u.length;l++){r.add(this.parseObject(u[l],t,a))}}if(e.type==="LOD"){var c=e.levels;for(var h=0;h<c.length;h++){var f=c[h];var d=r.getObjectByProperty("uuid",f.object);if(d!==undefined){r.addLevel(d,f.distance)}}}return r}});var Fd={UVMapping:H,CubeReflectionMapping:G,CubeRefractionMapping:V,EquirectangularReflectionMapping:W,EquirectangularRefractionMapping:q,SphericalReflectionMapping:X,CubeUVReflectionMapping:Y,CubeUVRefractionMapping:Z};var Bd={RepeatWrapping:J,ClampToEdgeWrapping:K,MirroredRepeatWrapping:Q};var Ud={NearestFilter:$,NearestMipmapNearestFilter:ee,NearestMipmapLinearFilter:re,LinearFilter:ie,LinearMipmapNearestFilter:ae,LinearMipmapLinearFilter:se};function kd(e){if(typeof createImageBitmap==="undefined"){console.warn("THREE.ImageBitmapLoader: createImageBitmap() not supported.")}if(typeof fetch==="undefined"){console.warn("THREE.ImageBitmapLoader: fetch() not supported.")}Lf.call(this,e);this.options=undefined}kd.prototype=Object.assign(Object.create(Lf.prototype),{constructor:kd,setOptions:function e(t){this.options=t;return this},load:function(t,r,e,n){if(t===undefined)t="";if(this.path!==undefined)t=this.path+t;t=this.manager.resolveURL(t);var i=this;var a=Pf.get(t);if(a!==undefined){i.manager.itemStart(t);setTimeout(function(){if(r)r(a);i.manager.itemEnd(t)},0);return a}fetch(t).then(function(e){return e.blob()}).then(function(e){if(i.options===undefined){return createImageBitmap(e)}else{return createImageBitmap(e,i.options)}}).then(function(e){Pf.add(t,e);if(r)r(e);i.manager.itemEnd(t)}).catch(function(e){if(n)n(e);i.manager.itemError(t);i.manager.itemEnd(t)});i.manager.itemStart(t)}});function jd(){this.type="ShapePath";this.color=new Fn;this.subPaths=[];this.currentPath=null}Object.assign(jd.prototype,{moveTo:function(e,t){this.currentPath=new vd;this.subPaths.push(this.currentPath);this.currentPath.moveTo(e,t)},lineTo:function(e,t){this.currentPath.lineTo(e,t)},quadraticCurveTo:function(e,t,r,n){this.currentPath.quadraticCurveTo(e,t,r,n)},bezierCurveTo:function(e,t,r,n,i,a){this.currentPath.bezierCurveTo(e,t,r,n,i,a)},splineThru:function(e){this.currentPath.splineThru(e)},toShapes:function(e,t){function r(e){var t=[];for(var r=0,n=e.length;r<n;r++){var i=e[r];var a=new md;a.curves=i.curves;t.push(a)}return t}function n(e,t){var r=t.length;var n=false;for(var i=r-1,a=0;a<r;i=a++){var o=t[i];var s=t[a];var u=s.x-o.x;var l=s.y-o.y;if(Math.abs(l)>Number.EPSILON){if(l<0){o=t[a];u=-u;s=t[i];l=-l}if(e.y<o.y||e.y>s.y)continue;if(e.y===o.y){if(e.x===o.x)return true}else{var c=l*(e.x-o.x)-u*(e.y-o.y);if(c===0)return true;if(c<0)continue;n=!n}}else{if(e.y!==o.y)continue;if(s.x<=e.x&&e.x<=o.x||o.x<=e.x&&e.x<=s.x)return true}}return n}var i=Ph.isClockWise;var a=this.subPaths;if(a.length===0)return[];if(t===true)return r(a);var o,s,u,l=[];if(a.length===1){s=a[0];u=new md;u.curves=s.curves;l.push(u);return l}var c=!i(a[0].getPoints());c=e?!c:c;var h=[];var f=[];var d=[];var p=0;var v;f[p]=undefined;d[p]=[];for(var m=0,g=a.length;m<g;m++){s=a[m];v=s.getPoints();o=i(v);o=e?!o:o;if(o){if(!c&&f[p])p++;f[p]={s:new md,p:v};f[p].s.curves=s.curves;if(c)p++;d[p]=[]}else{d[p].push({h:s,p:v[0]})}}if(!f[0])return r(a);if(f.length>1){var y=false;var x=[];for(var b=0,w=f.length;b<w;b++){h[b]=[]}for(var b=0,w=f.length;b<w;b++){var _=d[b];for(var T=0;T<_.length;T++){var E=_[T];var M=true;for(var S=0;S<f.length;S++){if(n(E.p,f[S].p)){if(b!==S)x.push({froms:b,tos:S,hole:T});if(M){M=false;h[S].push(E)}else{y=true}}}if(M){h[b].push(E)}}}if(x.length>0){if(!y)d=h}}var A;for(var m=0,R=f.length;m<R;m++){u=f[m].s;l.push(u);A=d[m];for(var P=0,C=A.length;P<C;P++){u.holes.push(A[P].h)}}return l}});function zd(e){this.type="Font";this.data=e}Object.assign(zd.prototype,{isFont:true,generateShapes:function(e,t){if(t===undefined)t=100;var r=[];var n=Hd(e,t,this.data);for(var i=0,a=n.length;i<a;i++){Array.prototype.push.apply(r,n[i].toShapes())}return r}});function Hd(e,t,r){var n=Array.from?Array.from(e):String(e).split("");var i=t/r.resolution;var a=(r.boundingBox.yMax-r.boundingBox.yMin+r.underlineThickness)*i;var o=[];var s=0,u=0;for(var l=0;l<n.length;l++){var c=n[l];if(c==="\n"){s=0;u-=a}else{var h=Gd(c,i,s,u,r);s+=h.offsetX;o.push(h.path)}}return o}function Gd(e,t,r,n,i){var a=i.glyphs[e]||i.glyphs["?"];if(!a){console.error('THREE.Font: character "'+e+'" does not exists in font family '+i.familyName+".");return}var o=new jd;var s,u,l,c,h,f,d,p;if(a.o){var v=a._cachedOutline||(a._cachedOutline=a.o.split(" "));for(var m=0,g=v.length;m<g;){var y=v[m++];switch(y){case"m":s=v[m++]*t+r;u=v[m++]*t+n;o.moveTo(s,u);break;case"l":s=v[m++]*t+r;u=v[m++]*t+n;o.lineTo(s,u);break;case"q":l=v[m++]*t+r;c=v[m++]*t+n;h=v[m++]*t+r;f=v[m++]*t+n;o.quadraticCurveTo(h,f,l,c);break;case"b":l=v[m++]*t+r;c=v[m++]*t+n;h=v[m++]*t+r;f=v[m++]*t+n;d=v[m++]*t+r;p=v[m++]*t+n;o.bezierCurveTo(h,f,d,p,l,c);break}}}return{offsetX:a.ha*t,path:o}}function Vd(e){Lf.call(this,e)}Vd.prototype=Object.assign(Object.create(Lf.prototype),{constructor:Vd,load:function(e,n,t,r){var i=this;var a=new Df(this.manager);a.setPath(this.path);a.load(e,function(t){var r;try{r=JSON.parse(t)}catch(e){console.warn("THREE.FontLoader: typeface.js support is being deprecated. Use typeface.json instead.");r=JSON.parse(t.substring(65,t.length-2))}var e=i.parse(r);if(n)n(e)},t,r)},parse:function(e){return new zd(e)}});var Wd;var qd={getContext:function(){if(Wd===undefined){Wd=new(window.AudioContext||window.webkitAudioContext)}return Wd},setContext:function(e){Wd=e}};r.AudioContext=qd;function Xd(e){Lf.call(this,e)}Xd.prototype=Object.assign(Object.create(Lf.prototype),{constructor:Xd,load:function(e,n,t,r){var i=new Df(this.manager);i.setResponseType("arraybuffer");i.setPath(this.path);i.load(e,function(e){var t=e.slice(0);var r=qd.getContext();r.decodeAudioData(t,function(e){n(e)})},t,r)}});function Yd(){this.coefficients=[];for(var e=0;e<9;e++){this.coefficients.push(new pr)}}Object.assign(Yd.prototype,{isSphericalHarmonics3:true,set:function(e){for(var t=0;t<9;t++){this.coefficients[t].copy(e[t])}return this},zero:function(){for(var e=0;e<9;e++){this.coefficients[e].set(0,0,0)}return this},getAt:function(e,t){var r=e.x,n=e.y,i=e.z;var a=this.coefficients;t.copy(a[0]).multiplyScalar(.282095);t.addScale(a[1],.488603*n);t.addScale(a[2],.488603*i);t.addScale(a[3],.488603*r);t.addScale(a[4],1.092548*(r*n));t.addScale(a[5],1.092548*(n*i));t.addScale(a[6],.315392*(3*i*i-1));t.addScale(a[7],1.092548*(r*i));t.addScale(a[8],.546274*(r*r-n*n));return t},getIrradianceAt:function(e,t){var r=e.x,n=e.y,i=e.z;var a=this.coefficients;t.copy(a[0]).multiplyScalar(.886227);t.addScale(a[1],2*.511664*n);t.addScale(a[2],2*.511664*i);t.addScale(a[3],2*.511664*r);t.addScale(a[4],2*.429043*r*n);t.addScale(a[5],2*.429043*n*i);t.addScale(a[6],.743125*i*i-.247708);t.addScale(a[7],2*.429043*r*i);t.addScale(a[8],.429043*(r*r-n*n));return t},add:function(e){for(var t=0;t<9;t++){this.coefficients[t].add(e.coefficients[t])}return this},scale:function(e){for(var t=0;t<9;t++){this.coefficients[t].multiplyScalar(e)}return this},lerp:function(e,t){for(var r=0;r<9;r++){this.coefficients[r].lerp(e.coefficients[r],t)}return this},equals:function(e){for(var t=0;t<9;t++){if(!this.coefficients[t].equals(e.coefficients[t])){return false}}return true},copy:function(e){return this.set(e.coefficients)},clone:function(){return(new this.constructor).copy(this)},fromArray:function(e,t){if(t===undefined)t=0;var r=this.coefficients;for(var n=0;n<9;n++){r[n].fromArray(e,t+n*3)}return this},toArray:function(e,t){if(e===undefined)e=[];if(t===undefined)t=0;var r=this.coefficients;for(var n=0;n<9;n++){r[n].toArray(e,t+n*3)}return e}});Object.assign(Yd,{getBasisAt:function(e,t){var r=e.x,n=e.y,i=e.z;t[0]=.282095;t[1]=.488603*n;t[2]=.488603*i;t[3]=.488603*r;t[4]=1.092548*r*n;t[5]=1.092548*n*i;t[6]=.315392*(3*i*i-1);t[7]=1.092548*r*i;t[8]=.546274*(r*r-n*n)}});function Zd(e,t){gd.call(this,undefined,t);this.sh=e!==undefined?e:new Yd}Zd.prototype=Object.assign(Object.create(gd.prototype),{constructor:Zd,isLightProbe:true,copy:function(e){gd.prototype.copy.call(this,e);this.sh.copy(e.sh);this.intensity=e.intensity;return this},toJSON:function(e){var t=gd.prototype.toJSON.call(this,e);return t}});function Jd(e,t,r){Zd.call(this,undefined,r);var n=(new Fn).set(e);var i=(new Fn).set(t);var a=new pr(n.r,n.g,n.b);var o=new pr(i.r,i.g,i.b);var s=Math.sqrt(Math.PI);var u=s*Math.sqrt(.75);this.sh.coefficients[0].copy(a).add(o).multiplyScalar(s);this.sh.coefficients[1].copy(a).sub(o).multiplyScalar(u)}Jd.prototype=Object.assign(Object.create(Zd.prototype),{constructor:Jd,isHemisphereLightProbe:true,copy:function(e){Zd.prototype.copy.call(this,e);return this},toJSON:function(e){var t=Zd.prototype.toJSON.call(this,e);return t}});function Kd(e,t){Zd.call(this,undefined,t);var r=(new Fn).set(e);this.sh.coefficients[0].set(r.r,r.g,r.b).multiplyScalar(2*Math.sqrt(Math.PI))}Kd.prototype=Object.assign(Object.create(Zd.prototype),{constructor:Kd,isAmbientLightProbe:true,copy:function(e){Zd.prototype.copy.call(this,e);return this},toJSON:function(e){var t=Zd.prototype.toJSON.call(this,e);return t}});var Qd=new Or;var $d=new Or;function ep(){this.type="StereoCamera";this.aspect=1;this.eyeSep=.064;this.cameraL=new Vi;this.cameraL.layers.enable(1);this.cameraL.matrixAutoUpdate=false;this.cameraR=new Vi;this.cameraR.layers.enable(2);this.cameraR.matrixAutoUpdate=false;this._cache={focus:null,fov:null,aspect:null,near:null,far:null,zoom:null,eyeSep:null}}Object.assign(ep.prototype,{update:function(e){var t=this._cache;var r=t.focus!==e.focus||t.fov!==e.fov||t.aspect!==e.aspect*this.aspect||t.near!==e.near||t.far!==e.far||t.zoom!==e.zoom||t.eyeSep!==this.eyeSep;if(r){t.focus=e.focus;t.fov=e.fov;t.aspect=e.aspect*this.aspect;t.near=e.near;t.far=e.far;t.zoom=e.zoom;t.eyeSep=this.eyeSep;var n=e.projectionMatrix.clone();var i=t.eyeSep/2;var a=i*t.near/t.focus;var o=t.near*Math.tan(lr.DEG2RAD*t.fov*.5)/t.zoom;var s,u;$d.elements[12]=-i;Qd.elements[12]=i;s=-o*t.aspect+a;u=o*t.aspect+a;n.elements[0]=2*t.near/(u-s);n.elements[8]=(u+s)/(u-s);this.cameraL.projectionMatrix.copy(n);s=-o*t.aspect-a;u=o*t.aspect-a;n.elements[0]=2*t.near/(u-s);n.elements[8]=(u+s)/(u-s);this.cameraR.projectionMatrix.copy(n)}this.cameraL.matrixWorld.copy(e.matrixWorld).multiply($d);this.cameraR.matrixWorld.copy(e.matrixWorld).multiply(Qd)}});function tp(e){this.autoStart=e!==undefined?e:true;this.startTime=0;this.oldTime=0;this.elapsedTime=0;this.running=false}Object.assign(tp.prototype,{start:function(){this.startTime=(typeof performance==="undefined"?Date:performance).now();this.oldTime=this.startTime;this.elapsedTime=0;this.running=true},stop:function(){this.getElapsedTime();this.running=false;this.autoStart=false},getElapsedTime:function(){this.getDelta();return this.elapsedTime},getDelta:function(){var e=0;if(this.autoStart&&!this.running){this.start();return 0}if(this.running){var t=(typeof performance==="undefined"?Date:performance).now();e=(t-this.oldTime)/1e3;this.oldTime=t;this.elapsedTime+=e}return e}});var rp=new pr;var np=new hr;var ip=new pr;var ap=new pr;function op(){Zr.call(this);this.type="AudioListener";this.context=qd.getContext();this.gain=this.context.createGain();this.gain.connect(this.context.destination);this.filter=null;this.timeDelta=0;this._clock=new tp}op.prototype=Object.assign(Object.create(Zr.prototype),{constructor:op,getInput:function(){return this.gain},removeFilter:function(){if(this.filter!==null){this.gain.disconnect(this.filter);this.filter.disconnect(this.context.destination);this.gain.connect(this.context.destination);this.filter=null}return this},getFilter:function(){return this.filter},setFilter:function(e){if(this.filter!==null){this.gain.disconnect(this.filter);this.filter.disconnect(this.context.destination)}else{this.gain.disconnect(this.context.destination)}this.filter=e;this.gain.connect(this.filter);this.filter.connect(this.context.destination);return this},getMasterVolume:function(){return this.gain.gain.value},setMasterVolume:function(e){this.gain.gain.setTargetAtTime(e,this.context.currentTime,.01);return this},updateMatrixWorld:function(e){Zr.prototype.updateMatrixWorld.call(this,e);var t=this.context.listener;var r=this.up;this.timeDelta=this._clock.getDelta();this.matrixWorld.decompose(rp,np,ip);ap.set(0,0,-1).applyQuaternion(np);if(t.positionX){var n=this.context.currentTime+this.timeDelta;t.positionX.linearRampToValueAtTime(rp.x,n);t.positionY.linearRampToValueAtTime(rp.y,n);t.positionZ.linearRampToValueAtTime(rp.z,n);t.forwardX.linearRampToValueAtTime(ap.x,n);t.forwardY.linearRampToValueAtTime(ap.y,n);t.forwardZ.linearRampToValueAtTime(ap.z,n);t.upX.linearRampToValueAtTime(r.x,n);t.upY.linearRampToValueAtTime(r.y,n);t.upZ.linearRampToValueAtTime(r.z,n)}else{t.setPosition(rp.x,rp.y,rp.z);t.setOrientation(ap.x,ap.y,ap.z,r.x,r.y,r.z)}}});function sp(e){Zr.call(this);this.type="Audio";this.listener=e;this.context=e.context;this.gain=this.context.createGain();this.gain.connect(e.getInput());this.autoplay=false;this.buffer=null;this.detune=0;this.loop=false;this.startTime=0;this.offset=0;this.duration=undefined;this.playbackRate=1;this.isPlaying=false;this.hasPlaybackControl=true;this.sourceType="empty";this.filters=[]}sp.prototype=Object.assign(Object.create(Zr.prototype),{constructor:sp,getOutput:function(){return this.gain},setNodeSource:function(e){this.hasPlaybackControl=false;this.sourceType="audioNode";this.source=e;this.connect();return this},setMediaElementSource:function(e){this.hasPlaybackControl=false;this.sourceType="mediaNode";this.source=this.context.createMediaElementSource(e);this.connect();return this},setMediaStreamSource:function(e){this.hasPlaybackControl=false;this.sourceType="mediaStreamNode";this.source=this.context.createMediaStreamSource(e);this.connect();return this},setBuffer:function(e){this.buffer=e;this.sourceType="buffer";if(this.autoplay)this.play();return this},play:function(){if(this.isPlaying===true){console.warn("THREE.Audio: Audio is already playing.");return}if(this.hasPlaybackControl===false){console.warn("THREE.Audio: this Audio has no playback control.");return}var e=this.context.createBufferSource();e.buffer=this.buffer;e.loop=this.loop;e.onended=this.onEnded.bind(this);this.startTime=this.context.currentTime;e.start(this.startTime,this.offset,this.duration);this.isPlaying=true;this.source=e;this.setDetune(this.detune);this.setPlaybackRate(this.playbackRate);return this.connect()},pause:function(){if(this.hasPlaybackControl===false){console.warn("THREE.Audio: this Audio has no playback control.");return}if(this.isPlaying===true){this.source.stop();this.source.onended=null;this.offset+=(this.context.currentTime-this.startTime)*this.playbackRate;this.isPlaying=false}return this},stop:function(){if(this.hasPlaybackControl===false){console.warn("THREE.Audio: this Audio has no playback control.");return}this.source.stop();this.source.onended=null;this.offset=0;this.isPlaying=false;return this},connect:function(){if(this.filters.length>0){this.source.connect(this.filters[0]);for(var e=1,t=this.filters.length;e<t;e++){this.filters[e-1].connect(this.filters[e])}this.filters[this.filters.length-1].connect(this.getOutput())}else{this.source.connect(this.getOutput())}return this},disconnect:function(){if(this.filters.length>0){this.source.disconnect(this.filters[0]);for(var e=1,t=this.filters.length;e<t;e++){this.filters[e-1].disconnect(this.filters[e])}this.filters[this.filters.length-1].disconnect(this.getOutput())}else{this.source.disconnect(this.getOutput())}return this},getFilters:function(){return this.filters},setFilters:function(e){if(!e)e=[];if(this.isPlaying===true){this.disconnect();this.filters=e;this.connect()}else{this.filters=e}return this},setDetune:function(e){this.detune=e;if(this.source.detune===undefined)return;if(this.isPlaying===true){this.source.detune.setTargetAtTime(this.detune,this.context.currentTime,.01)}return this},getDetune:function(){return this.detune},getFilter:function(){return this.getFilters()[0]},setFilter:function(e){return this.setFilters(e?[e]:[])},setPlaybackRate:function(e){if(this.hasPlaybackControl===false){console.warn("THREE.Audio: this Audio has no playback control.");return}this.playbackRate=e;if(this.isPlaying===true){this.source.playbackRate.setTargetAtTime(this.playbackRate,this.context.currentTime,.01)}return this},getPlaybackRate:function(){return this.playbackRate},onEnded:function(){this.isPlaying=false},getLoop:function(){if(this.hasPlaybackControl===false){console.warn("THREE.Audio: this Audio has no playback control.");return false}return this.loop},setLoop:function(e){if(this.hasPlaybackControl===false){console.warn("THREE.Audio: this Audio has no playback control.");return}this.loop=e;if(this.isPlaying===true){this.source.loop=this.loop}return this},getVolume:function(){return this.gain.gain.value},setVolume:function(e){this.gain.gain.setTargetAtTime(e,this.context.currentTime,.01);return this}});var up=new pr;var lp=new hr;var cp=new pr;var hp=new pr;function fp(e){sp.call(this,e);this.panner=this.context.createPanner();this.panner.panningModel="HRTF";this.panner.connect(this.gain)}fp.prototype=Object.assign(Object.create(sp.prototype),{constructor:fp,getOutput:function(){return this.panner},getRefDistance:function(){return this.panner.refDistance},setRefDistance:function(e){this.panner.refDistance=e;return this},getRolloffFactor:function(){return this.panner.rolloffFactor},setRolloffFactor:function(e){this.panner.rolloffFactor=e;return this},getDistanceModel:function(){return this.panner.distanceModel},setDistanceModel:function(e){this.panner.distanceModel=e;return this},getMaxDistance:function(){return this.panner.maxDistance},setMaxDistance:function(e){this.panner.maxDistance=e;return this},setDirectionalCone:function(e,t,r){this.panner.coneInnerAngle=e;this.panner.coneOuterAngle=t;this.panner.coneOuterGain=r;return this},updateMatrixWorld:function(e){Zr.prototype.updateMatrixWorld.call(this,e);if(this.hasPlaybackControl===true&&this.isPlaying===false)return;this.matrixWorld.decompose(up,lp,cp);hp.set(0,0,1).applyQuaternion(lp);var t=this.panner;if(t.positionX){var r=this.context.currentTime+this.listener.timeDelta;t.positionX.linearRampToValueAtTime(up.x,r);t.positionY.linearRampToValueAtTime(up.y,r);t.positionZ.linearRampToValueAtTime(up.z,r);t.orientationX.linearRampToValueAtTime(hp.x,r);t.orientationY.linearRampToValueAtTime(hp.y,r);t.orientationZ.linearRampToValueAtTime(hp.z,r)}else{t.setPosition(up.x,up.y,up.z);t.setOrientation(hp.x,hp.y,hp.z)}}});function dp(e,t){this.analyser=e.context.createAnalyser();this.analyser.fftSize=t!==undefined?t:2048;this.data=new Uint8Array(this.analyser.frequencyBinCount);e.getOutput().connect(this.analyser)}Object.assign(dp.prototype,{getFrequencyData:function(){this.analyser.getByteFrequencyData(this.data);return this.data},getAverageFrequency:function(){var e=0,t=this.getFrequencyData();for(var r=0;r<t.length;r++){e+=t[r]}return e/t.length}});function pp(e,t,r){this.binding=e;this.valueSize=r;var n=Float64Array,i;switch(t){case"quaternion":i=this._slerp;break;case"string":case"bool":n=Array;i=this._select;break;default:i=this._lerp}this.buffer=new n(r*4);this._mixBufferRegion=i;this.cumulativeWeight=0;this.useCount=0;this.referenceCount=0}Object.assign(pp.prototype,{accumulate:function(e,t){var r=this.buffer,n=this.valueSize,i=e*n+n,a=this.cumulativeWeight;if(a===0){for(var o=0;o!==n;++o){r[i+o]=r[o]}a=t}else{a+=t;var s=t/a;this._mixBufferRegion(r,i,0,s,n)}this.cumulativeWeight=a},apply:function(e){var t=this.valueSize,r=this.buffer,n=e*t+t,i=this.cumulativeWeight,a=this.binding;this.cumulativeWeight=0;if(i<1){var o=t*3;this._mixBufferRegion(r,n,o,1-i,t)}for(var s=t,u=t+t;s!==u;++s){if(r[s]!==r[s+t]){a.setValue(r,n);break}}},saveOriginalState:function(){var e=this.binding;var t=this.buffer,r=this.valueSize,n=r*3;e.getValue(t,n);for(var i=r,a=n;i!==a;++i){t[i]=t[n+i%r]}this.cumulativeWeight=0},restoreOriginalState:function(){var e=this.valueSize*3;this.binding.setValue(this.buffer,e)},_select:function(e,t,r,n,i){if(n>=.5){for(var a=0;a!==i;++a){e[t+a]=e[r+a]}}},_slerp:function(e,t,r,n){hr.slerpFlat(e,t,e,t,e,r,n)},_lerp:function(e,t,r,n,i){var a=1-n;for(var o=0;o!==i;++o){var s=t+o;e[s]=e[s]*a+e[r+o]*n}}});var vp="\\[\\]\\.:\\/";var mp=new RegExp("["+vp+"]","g");var gp="[^"+vp+"]";var yp="[^"+vp.replace("\\.","")+"]";var xp=/((?:WC+[\/:])*)/.source.replace("WC",gp);var bp=/(WCOD+)?/.source.replace("WCOD",yp);var wp=/(?:\.(WC+)(?:\[(.+)\])?)?/.source.replace("WC",gp);var _p=/\.(WC+)(?:\[(.+)\])?/.source.replace("WC",gp);var Tp=new RegExp(""+"^"+xp+bp+wp+_p+"$");var Ep=["material","materials","bones"];function Mp(e,t,r){var n=r||Sp.parseTrackName(t);this._targetGroup=e;this._bindings=e.subscribe_(t,n)}Object.assign(Mp.prototype,{getValue:function(e,t){this.bind();var r=this._targetGroup.nCachedObjects_,n=this._bindings[r];if(n!==undefined)n.getValue(e,t)},setValue:function(e,t){var r=this._bindings;for(var n=this._targetGroup.nCachedObjects_,i=r.length;n!==i;++n){r[n].setValue(e,t)}},bind:function(){var e=this._bindings;for(var t=this._targetGroup.nCachedObjects_,r=e.length;t!==r;++t){e[t].bind()}},unbind:function(){var e=this._bindings;for(var t=this._targetGroup.nCachedObjects_,r=e.length;t!==r;++t){e[t].unbind()}}});function Sp(e,t,r){this.path=t;this.parsedPath=r||Sp.parseTrackName(t);this.node=Sp.findNode(e,this.parsedPath.nodeName)||e;this.rootNode=e}Object.assign(Sp,{Composite:Mp,create:function(e,t,r){if(!(e&&e.isAnimationObjectGroup)){return new Sp(e,t,r)}else{return new Sp.Composite(e,t,r)}},sanitizeNodeName:function(e){return e.replace(/\s/g,"_").replace(mp,"")},parseTrackName:function(e){var t=Tp.exec(e);if(!t){throw new Error("PropertyBinding: Cannot parse trackName: "+e)}var r={nodeName:t[2],objectName:t[3],objectIndex:t[4],propertyName:t[5],propertyIndex:t[6]};var n=r.nodeName&&r.nodeName.lastIndexOf(".");if(n!==undefined&&n!==-1){var i=r.nodeName.substring(n+1);if(Ep.indexOf(i)!==-1){r.nodeName=r.nodeName.substring(0,n);r.objectName=i}}if(r.propertyName===null||r.propertyName.length===0){throw new Error("PropertyBinding: can not parse propertyName from trackName: "+e)}return r},findNode:function(e,i){if(!i||i===""||i==="root"||i==="."||i===-1||i===e.name||i===e.uuid){return e}if(e.skeleton){var t=e.skeleton.getBoneByName(i);if(t!==undefined){return t}}if(e.children){var a=function(e){for(var t=0;t<e.length;t++){var r=e[t];if(r.name===i||r.uuid===i){return r}var n=a(r.children);if(n)return n}return null};var r=a(e.children);if(r){return r}}return null}});Object.assign(Sp.prototype,{_getValue_unavailable:function(){},_setValue_unavailable:function(){},BindingType:{Direct:0,EntireArray:1,ArrayElement:2,HasFromToArray:3},Versioning:{None:0,NeedsUpdate:1,MatrixWorldNeedsUpdate:2},GetterByBindingType:[function e(t,r){t[r]=this.node[this.propertyName]},function e(t,r){var n=this.resolvedProperty;for(var i=0,a=n.length;i!==a;++i){t[r++]=n[i]}},function e(t,r){t[r]=this.resolvedProperty[this.propertyIndex]},function e(t,r){this.resolvedProperty.toArray(t,r)}],SetterByBindingTypeAndVersioning:[[function e(t,r){this.targetObject[this.propertyName]=t[r]},function e(t,r){this.targetObject[this.propertyName]=t[r];this.targetObject.needsUpdate=true},function e(t,r){this.targetObject[this.propertyName]=t[r];this.targetObject.matrixWorldNeedsUpdate=true}],[function e(t,r){var n=this.resolvedProperty;for(var i=0,a=n.length;i!==a;++i){n[i]=t[r++]}},function e(t,r){var n=this.resolvedProperty;for(var i=0,a=n.length;i!==a;++i){n[i]=t[r++]}this.targetObject.needsUpdate=true},function e(t,r){var n=this.resolvedProperty;for(var i=0,a=n.length;i!==a;++i){n[i]=t[r++]}this.targetObject.matrixWorldNeedsUpdate=true}],[function e(t,r){this.resolvedProperty[this.propertyIndex]=t[r]},function e(t,r){this.resolvedProperty[this.propertyIndex]=t[r];this.targetObject.needsUpdate=true},function e(t,r){this.resolvedProperty[this.propertyIndex]=t[r];this.targetObject.matrixWorldNeedsUpdate=true}],[function e(t,r){this.resolvedProperty.fromArray(t,r)},function e(t,r){this.resolvedProperty.fromArray(t,r);this.targetObject.needsUpdate=true},function e(t,r){this.resolvedProperty.fromArray(t,r);this.targetObject.matrixWorldNeedsUpdate=true}]],getValue:function e(t,r){this.bind();this.getValue(t,r)},setValue:function e(t,r){this.bind();this.setValue(t,r)},bind:function(){var e=this.node,t=this.parsedPath,r=t.objectName,n=t.propertyName,i=t.propertyIndex;if(!e){e=Sp.findNode(this.rootNode,t.nodeName)||this.rootNode;this.node=e}this.getValue=this._getValue_unavailable;this.setValue=this._setValue_unavailable;if(!e){console.error("THREE.PropertyBinding: Trying to update node for track: "+this.path+" but it wasn't found.");return}if(r){var a=t.objectIndex;switch(r){case"materials":if(!e.material){console.error("THREE.PropertyBinding: Can not bind to material as node does not have a material.",this);return}if(!e.material.materials){console.error("THREE.PropertyBinding: Can not bind to material.materials as node.material does not have a materials array.",this);return}e=e.material.materials;break;case"bones":if(!e.skeleton){console.error("THREE.PropertyBinding: Can not bind to bones as node does not have a skeleton.",this);return}e=e.skeleton.bones;for(var o=0;o<e.length;o++){if(e[o].name===a){a=o;break}}break;default:if(e[r]===undefined){console.error("THREE.PropertyBinding: Can not bind to objectName of node undefined.",this);return}e=e[r]}if(a!==undefined){if(e[a]===undefined){console.error("THREE.PropertyBinding: Trying to bind to objectIndex of objectName, but is undefined.",this,e);return}e=e[a]}}var s=e[n];if(s===undefined){var u=t.nodeName;console.error("THREE.PropertyBinding: Trying to update property for track: "+u+"."+n+" but it wasn't found.",e);return}var l=this.Versioning.None;this.targetObject=e;if(e.needsUpdate!==undefined){l=this.Versioning.NeedsUpdate}else if(e.matrixWorldNeedsUpdate!==undefined){l=this.Versioning.MatrixWorldNeedsUpdate}var c=this.BindingType.Direct;if(i!==undefined){if(n==="morphTargetInfluences"){if(!e.geometry){console.error("THREE.PropertyBinding: Can not bind to morphTargetInfluences because node does not have a geometry.",this);return}if(e.geometry.isBufferGeometry){if(!e.geometry.morphAttributes){console.error("THREE.PropertyBinding: Can not bind to morphTargetInfluences because node does not have a geometry.morphAttributes.",this);return}for(var o=0;o<this.node.geometry.morphAttributes.position.length;o++){if(e.geometry.morphAttributes.position[o].name===i){i=o;break}}}else{if(!e.geometry.morphTargets){console.error("THREE.PropertyBinding: Can not bind to morphTargetInfluences because node does not have a geometry.morphTargets.",this);return}for(var o=0;o<this.node.geometry.morphTargets.length;o++){if(e.geometry.morphTargets[o].name===i){i=o;break}}}}c=this.BindingType.ArrayElement;this.resolvedProperty=s;this.propertyIndex=i}else if(s.fromArray!==undefined&&s.toArray!==undefined){c=this.BindingType.HasFromToArray;this.resolvedProperty=s}else if(Array.isArray(s)){c=this.BindingType.EntireArray;this.resolvedProperty=s}else{this.propertyName=n}this.getValue=this.GetterByBindingType[c];this.setValue=this.SetterByBindingTypeAndVersioning[c][l]},unbind:function(){this.node=null;this.getValue=this._getValue_unbound;this.setValue=this._setValue_unbound}});Object.assign(Sp.prototype,{_getValue_unbound:Sp.prototype.getValue,_setValue_unbound:Sp.prototype.setValue});function Ap(){this.uuid=lr.generateUUID();this._objects=Array.prototype.slice.call(arguments);this.nCachedObjects_=0;var e={};this._indicesByUUID=e;for(var t=0,r=arguments.length;t!==r;++t){e[arguments[t].uuid]=t}this._paths=[];this._parsedPaths=[];this._bindings=[];this._bindingsIndicesByPath={};var n=this;this.stats={objects:{get total(){return n._objects.length},get inUse(){return this.total-n.nCachedObjects_}},get bindingsPerObject(){return n._bindings.length}}}Object.assign(Ap.prototype,{isAnimationObjectGroup:true,add:function(){var e=this._objects,t=e.length,r=this.nCachedObjects_,n=this._indicesByUUID,i=this._paths,a=this._parsedPaths,o=this._bindings,s=o.length,u=undefined;for(var l=0,c=arguments.length;l!==c;++l){var h=arguments[l],f=h.uuid,d=n[f];if(d===undefined){d=t++;n[f]=d;e.push(h);for(var p=0,v=s;p!==v;++p){o[p].push(new Sp(h,i[p],a[p]))}}else if(d<r){u=e[d];var m=--r,g=e[m];n[g.uuid]=d;e[d]=g;n[f]=m;e[m]=h;for(var p=0,v=s;p!==v;++p){var y=o[p],x=y[m],b=y[d];y[d]=x;if(b===undefined){b=new Sp(h,i[p],a[p])}y[m]=b}}else if(e[d]!==u){console.error("THREE.AnimationObjectGroup: Different objects with the same UUID "+"detected. Clean the caches or recreate your infrastructure when reloading scenes.")}}this.nCachedObjects_=r},remove:function(){var e=this._objects,t=this.nCachedObjects_,r=this._indicesByUUID,n=this._bindings,i=n.length;for(var a=0,o=arguments.length;a!==o;++a){var s=arguments[a],u=s.uuid,l=r[u];if(l!==undefined&&l>=t){var c=t++,h=e[c];r[h.uuid]=l;e[l]=h;r[u]=c;e[c]=s;for(var f=0,d=i;f!==d;++f){var p=n[f],v=p[c],m=p[l];p[l]=v;p[c]=m}}}this.nCachedObjects_=t},uncache:function(){var e=this._objects,t=e.length,r=this.nCachedObjects_,n=this._indicesByUUID,i=this._bindings,a=i.length;for(var o=0,s=arguments.length;o!==s;++o){var u=arguments[o],l=u.uuid,c=n[l];if(c!==undefined){delete n[l];if(c<r){var h=--r,f=e[h],d=--t,p=e[d];n[f.uuid]=c;e[c]=f;n[p.uuid]=h;e[h]=p;e.pop();for(var v=0,m=a;v!==m;++v){var g=i[v],y=g[h],x=g[d];g[c]=y;g[h]=x;g.pop()}}else{var d=--t,p=e[d];n[p.uuid]=c;e[c]=p;e.pop();for(var v=0,m=a;v!==m;++v){var g=i[v];g[c]=g[d];g.pop()}}}}this.nCachedObjects_=r},subscribe_:function(e,t){var r=this._bindingsIndicesByPath,n=r[e],i=this._bindings;if(n!==undefined)return i[n];var a=this._paths,o=this._parsedPaths,s=this._objects,u=s.length,l=this.nCachedObjects_,c=new Array(u);n=i.length;r[e]=n;a.push(e);o.push(t);i.push(c);for(var h=l,f=s.length;h!==f;++h){var d=s[h];c[h]=new Sp(d,e,t)}return c},unsubscribe_:function(e){var t=this._bindingsIndicesByPath,r=t[e];if(r!==undefined){var n=this._paths,i=this._parsedPaths,a=this._bindings,o=a.length-1,s=a[o],u=e[o];t[u]=r;a[r]=s;a.pop();i[r]=i[o];i.pop();n[r]=n[o];n.pop()}}});function Rp(e,t,r){this._mixer=e;this._clip=t;this._localRoot=r||null;var n=t.tracks,i=n.length,a=new Array(i);var o={endingStart:St,endingEnd:St};for(var s=0;s!==i;++s){var u=n[s].createInterpolant(null);a[s]=u;u.settings=o}this._interpolantSettings=o;this._interpolants=a;this._propertyBindings=new Array(i);this._cacheIndex=null;this._byClipCacheIndex=null;this._timeScaleInterpolant=null;this._weightInterpolant=null;this.loop=wt;this._loopCount=-1;this._startTime=null;this.time=0;this.timeScale=1;this._effectiveTimeScale=1;this.weight=1;this._effectiveWeight=1;this.repetitions=Infinity;this.paused=false;this.enabled=true;this.clampWhenFinished=false;this.zeroSlopeAtStart=true;this.zeroSlopeAtEnd=true}Object.assign(Rp.prototype,{play:function(){this._mixer._activateAction(this);return this},stop:function(){this._mixer._deactivateAction(this);return this.reset()},reset:function(){this.paused=false;this.enabled=true;this.time=0;this._loopCount=-1;this._startTime=null;return this.stopFading().stopWarping()},isRunning:function(){return this.enabled&&!this.paused&&this.timeScale!==0&&this._startTime===null&&this._mixer._isActiveAction(this)},isScheduled:function(){return this._mixer._isActiveAction(this)},startAt:function(e){this._startTime=e;return this},setLoop:function(e,t){this.loop=e;this.repetitions=t;return this},setEffectiveWeight:function(e){this.weight=e;this._effectiveWeight=this.enabled?e:0;return this.stopFading()},getEffectiveWeight:function(){return this._effectiveWeight},fadeIn:function(e){return this._scheduleFading(e,0,1)},fadeOut:function(e){return this._scheduleFading(e,1,0)},crossFadeFrom:function(e,t,r){e.fadeOut(t);this.fadeIn(t);if(r){var n=this._clip.duration,i=e._clip.duration,a=i/n,o=n/i;e.warp(1,a,t);this.warp(o,1,t)}return this},crossFadeTo:function(e,t,r){return e.crossFadeFrom(this,t,r)},stopFading:function(){var e=this._weightInterpolant;if(e!==null){this._weightInterpolant=null;this._mixer._takeBackControlInterpolant(e)}return this},setEffectiveTimeScale:function(e){this.timeScale=e;this._effectiveTimeScale=this.paused?0:e;return this.stopWarping()},getEffectiveTimeScale:function(){return this._effectiveTimeScale},setDuration:function(e){this.timeScale=this._clip.duration/e;return this.stopWarping()},syncWith:function(e){this.time=e.time;this.timeScale=e.timeScale;return this.stopWarping()},halt:function(e){return this.warp(this._effectiveTimeScale,0,e)},warp:function(e,t,r){var n=this._mixer,i=n.time,a=this._timeScaleInterpolant,o=this.timeScale;if(a===null){a=n._lendControlInterpolant();this._timeScaleInterpolant=a}var s=a.parameterPositions,u=a.sampleValues;s[0]=i;s[1]=i+r;u[0]=e/o;u[1]=t/o;return this},stopWarping:function(){var e=this._timeScaleInterpolant;if(e!==null){this._timeScaleInterpolant=null;this._mixer._takeBackControlInterpolant(e)}return this},getMixer:function(){return this._mixer},getClip:function(){return this._clip},getRoot:function(){return this._localRoot||this._mixer._root},_update:function(e,t,r,n){if(!this.enabled){this._updateWeight(e);return}var i=this._startTime;if(i!==null){var a=(e-i)*r;if(a<0||r===0){return}this._startTime=null;t=r*a}t*=this._updateTimeScale(e);var o=this._updateTime(t);var s=this._updateWeight(e);if(s>0){var u=this._interpolants;var l=this._propertyBindings;for(var c=0,h=u.length;c!==h;++c){u[c].evaluate(o);l[c].accumulate(n,s)}}},_updateWeight:function(e){var t=0;if(this.enabled){t=this.weight;var r=this._weightInterpolant;if(r!==null){var n=r.evaluate(e)[0];t*=n;if(e>r.parameterPositions[1]){this.stopFading();if(n===0){this.enabled=false}}}}this._effectiveWeight=t;return t},_updateTimeScale:function(e){var t=0;if(!this.paused){t=this.timeScale;var r=this._timeScaleInterpolant;if(r!==null){var n=r.evaluate(e)[0];t*=n;if(e>r.parameterPositions[1]){this.stopWarping();if(t===0){this.paused=true}else{this.timeScale=t}}}}this._effectiveTimeScale=t;return t},_updateTime:function(e){var t=this.time+e;var r=this._clip.duration;var n=this.loop;var i=this._loopCount;var a=n===_t;if(e===0){if(i===-1)return t;return a&&(i&1)===1?r-t:t}if(n===bt){if(i===-1){this._loopCount=0;this._setEndings(true,true,false)}e:{if(t>=r){t=r}else if(t<0){t=0}else{this.time=t;break e}if(this.clampWhenFinished)this.paused=true;else this.enabled=false;this.time=t;this._mixer.dispatchEvent({type:"finished",action:this,direction:e<0?-1:1})}}else{if(i===-1){if(e>=0){i=0;this._setEndings(true,this.repetitions===0,a)}else{this._setEndings(this.repetitions===0,true,a)}}if(t>=r||t<0){var o=Math.floor(t/r);t-=r*o;i+=Math.abs(o);var s=this.repetitions-i;if(s<=0){if(this.clampWhenFinished)this.paused=true;else this.enabled=false;t=e>0?r:0;this.time=t;this._mixer.dispatchEvent({type:"finished",action:this,direction:e>0?1:-1})}else{if(s===1){var u=e<0;this._setEndings(u,!u,a)}else{this._setEndings(false,false,a)}this._loopCount=i;this.time=t;this._mixer.dispatchEvent({type:"loop",action:this,loopDelta:o})}}else{this.time=t}if(a&&(i&1)===1){return r-t}}return t},_setEndings:function(e,t,r){var n=this._interpolantSettings;if(r){n.endingStart=At;n.endingEnd=At}else{if(e){n.endingStart=this.zeroSlopeAtStart?At:St}else{n.endingStart=Rt}if(t){n.endingEnd=this.zeroSlopeAtEnd?At:St}else{n.endingEnd=Rt}}},_scheduleFading:function(e,t,r){var n=this._mixer,i=n.time,a=this._weightInterpolant;if(a===null){a=n._lendControlInterpolant();this._weightInterpolant=a}var o=a.parameterPositions,s=a.sampleValues;o[0]=i;s[0]=t;o[1]=i+e;s[1]=r;return this}});function Pp(e){this._root=e;this._initMemoryManager();this._accuIndex=0;this.time=0;this.timeScale=1}Pp.prototype=Object.assign(Object.create(or.prototype),{constructor:Pp,_bindAction:function(e,t){var r=e._localRoot||this._root,n=e._clip.tracks,i=n.length,a=e._propertyBindings,o=e._interpolants,s=r.uuid,u=this._bindingsByRootAndName,l=u[s];if(l===undefined){l={};u[s]=l}for(var c=0;c!==i;++c){var h=n[c],f=h.name,d=l[f];if(d!==undefined){a[c]=d}else{d=a[c];if(d!==undefined){if(d._cacheIndex===null){++d.referenceCount;this._addInactiveBinding(d,s,f)}continue}var p=t&&t._propertyBindings[c].binding.parsedPath;d=new pp(Sp.create(r,f,p),h.ValueTypeName,h.getValueSize());++d.referenceCount;this._addInactiveBinding(d,s,f);a[c]=d}o[c].resultBuffer=d.buffer}},_activateAction:function(e){if(!this._isActiveAction(e)){if(e._cacheIndex===null){var t=(e._localRoot||this._root).uuid,r=e._clip.uuid,n=this._actionsByClip[r];this._bindAction(e,n&&n.knownActions[0]);this._addInactiveAction(e,r,t)}var i=e._propertyBindings;for(var a=0,o=i.length;a!==o;++a){var s=i[a];if(s.useCount++===0){this._lendBinding(s);s.saveOriginalState()}}this._lendAction(e)}},_deactivateAction:function(e){if(this._isActiveAction(e)){var t=e._propertyBindings;for(var r=0,n=t.length;r!==n;++r){var i=t[r];if(--i.useCount===0){i.restoreOriginalState();this._takeBackBinding(i)}}this._takeBackAction(e)}},_initMemoryManager:function(){this._actions=[];this._nActiveActions=0;this._actionsByClip={};this._bindings=[];this._nActiveBindings=0;this._bindingsByRootAndName={};this._controlInterpolants=[];this._nActiveControlInterpolants=0;var e=this;this.stats={actions:{get total(){return e._actions.length},get inUse(){return e._nActiveActions}},bindings:{get total(){return e._bindings.length},get inUse(){return e._nActiveBindings}},controlInterpolants:{get total(){return e._controlInterpolants.length},get inUse(){return e._nActiveControlInterpolants}}}},_isActiveAction:function(e){var t=e._cacheIndex;return t!==null&&t<this._nActiveActions},_addInactiveAction:function(e,t,r){var n=this._actions,i=this._actionsByClip,a=i[t];if(a===undefined){a={knownActions:[e],actionByRoot:{}};e._byClipCacheIndex=0;i[t]=a}else{var o=a.knownActions;e._byClipCacheIndex=o.length;o.push(e)}e._cacheIndex=n.length;n.push(e);a.actionByRoot[r]=e},_removeInactiveAction:function(e){var t=this._actions,r=t[t.length-1],n=e._cacheIndex;r._cacheIndex=n;t[n]=r;t.pop();e._cacheIndex=null;var i=e._clip.uuid,a=this._actionsByClip,o=a[i],s=o.knownActions,u=s[s.length-1],l=e._byClipCacheIndex;u._byClipCacheIndex=l;s[l]=u;s.pop();e._byClipCacheIndex=null;var c=o.actionByRoot,h=(e._localRoot||this._root).uuid;delete c[h];if(s.length===0){delete a[i]}this._removeInactiveBindingsForAction(e)},_removeInactiveBindingsForAction:function(e){var t=e._propertyBindings;for(var r=0,n=t.length;r!==n;++r){var i=t[r];if(--i.referenceCount===0){this._removeInactiveBinding(i)}}},_lendAction:function(e){var t=this._actions,r=e._cacheIndex,n=this._nActiveActions++,i=t[n];e._cacheIndex=n;t[n]=e;i._cacheIndex=r;t[r]=i},_takeBackAction:function(e){var t=this._actions,r=e._cacheIndex,n=--this._nActiveActions,i=t[n];e._cacheIndex=n;t[n]=e;i._cacheIndex=r;t[r]=i},_addInactiveBinding:function(e,t,r){var n=this._bindingsByRootAndName,i=n[t],a=this._bindings;if(i===undefined){i={};n[t]=i}i[r]=e;e._cacheIndex=a.length;a.push(e)},_removeInactiveBinding:function(e){var t=this._bindings,r=e.binding,n=r.rootNode.uuid,i=r.path,a=this._bindingsByRootAndName,o=a[n],s=t[t.length-1],u=e._cacheIndex;s._cacheIndex=u;t[u]=s;t.pop();delete o[i];if(Object.keys(o).length===0){delete a[n]}},_lendBinding:function(e){var t=this._bindings,r=e._cacheIndex,n=this._nActiveBindings++,i=t[n];e._cacheIndex=n;t[n]=e;i._cacheIndex=r;t[r]=i},_takeBackBinding:function(e){var t=this._bindings,r=e._cacheIndex,n=--this._nActiveBindings,i=t[n];e._cacheIndex=n;t[n]=e;i._cacheIndex=r;t[r]=i},_lendControlInterpolant:function(){var e=this._controlInterpolants,t=this._nActiveControlInterpolants++,r=e[t];if(r===undefined){r=new mf(new Float32Array(2),new Float32Array(2),1,this._controlInterpolantsResultBuffer);r.__cacheIndex=t;e[t]=r}return r},_takeBackControlInterpolant:function(e){var t=this._controlInterpolants,r=e.__cacheIndex,n=--this._nActiveControlInterpolants,i=t[n];e.__cacheIndex=n;t[n]=e;i.__cacheIndex=r;t[r]=i},_controlInterpolantsResultBuffer:new Float32Array(1),clipAction:function(e,t){var r=t||this._root,n=r.uuid,i=typeof e==="string"?Sf.findByName(r,e):e,a=i!==null?i.uuid:e,o=this._actionsByClip[a],s=null;if(o!==undefined){var u=o.actionByRoot[n];if(u!==undefined){return u}s=o.knownActions[0];if(i===null)i=s._clip}if(i===null)return null;var l=new Rp(this,i,t);this._bindAction(l,s);this._addInactiveAction(l,a,n);return l},existingAction:function(e,t){var r=t||this._root,n=r.uuid,i=typeof e==="string"?Sf.findByName(r,e):e,a=i?i.uuid:e,o=this._actionsByClip[a];if(o!==undefined){return o.actionByRoot[n]||null}return null},stopAllAction:function(){var e=this._actions,t=this._nActiveActions,r=this._bindings,n=this._nActiveBindings;this._nActiveActions=0;this._nActiveBindings=0;for(var i=0;i!==t;++i){e[i].reset()}for(var i=0;i!==n;++i){r[i].useCount=0}return this},update:function(e){e*=this.timeScale;var t=this._actions,r=this._nActiveActions,n=this.time+=e,i=Math.sign(e),a=this._accuIndex^=1;for(var o=0;o!==r;++o){var s=t[o];s._update(n,e,i,a)}var u=this._bindings,l=this._nActiveBindings;for(var o=0;o!==l;++o){u[o].apply(a)}return this},setTime:function(e){this.time=0;for(var t=0;t<this._actions.length;t++){this._actions[t].time=0}return this.update(e)},getRoot:function(){return this._root},uncacheClip:function(e){var t=this._actions,r=e.uuid,n=this._actionsByClip,i=n[r];if(i!==undefined){var a=i.knownActions;for(var o=0,s=a.length;o!==s;++o){var u=a[o];this._deactivateAction(u);var l=u._cacheIndex,c=t[t.length-1];u._cacheIndex=null;u._byClipCacheIndex=null;c._cacheIndex=l;t[l]=c;t.pop();this._removeInactiveBindingsForAction(u)}delete n[r]}},uncacheRoot:function(e){var t=e.uuid,r=this._actionsByClip;for(var n in r){var i=r[n].actionByRoot,a=i[t];if(a!==undefined){this._deactivateAction(a);this._removeInactiveAction(a)}}var o=this._bindingsByRootAndName,s=o[t];if(s!==undefined){for(var u in s){var l=s[u];l.restoreOriginalState();this._removeInactiveBinding(l)}}},uncacheAction:function(e,t){var r=this.existingAction(e,t);if(r!==null){this._deactivateAction(r);this._removeInactiveAction(r)}}});function Cp(e){if(typeof e==="string"){console.warn("THREE.Uniform: Type parameter is no longer needed.");e=arguments[1]}this.value=e}Cp.prototype.clone=function(){return new Cp(this.value.clone===undefined?this.value:this.value.clone())};function Op(e,t,r){jl.call(this,e,t);this.meshPerAttribute=r||1}Op.prototype=Object.assign(Object.create(jl.prototype),{constructor:Op,isInstancedInterleavedBuffer:true,copy:function(e){jl.prototype.copy.call(this,e);this.meshPerAttribute=e.meshPerAttribute;return this}});function Lp(e,t,r,n){this.ray=new wn(e,t);this.near=r||0;this.far=n||Infinity;this.camera=null;this.params={Mesh:{},Line:{},LOD:{},Points:{threshold:1},Sprite:{}};Object.defineProperties(this.params,{PointCloud:{get:function(){console.warn("THREE.Raycaster: params.PointCloud has been renamed to params.Points.");return this.Points}}})}function Ip(e,t){return e.distance-t.distance}function Dp(e,t,r,n){if(e.visible===false)return;e.raycast(t,r);if(n===true){var i=e.children;for(var a=0,o=i.length;a<o;a++){Dp(i[a],t,r,true)}}}Object.assign(Lp.prototype,{linePrecision:1,set:function(e,t){this.ray.set(e,t)},setFromCamera:function(e,t){if(t&&t.isPerspectiveCamera){this.ray.origin.setFromMatrixPosition(t.matrixWorld);this.ray.direction.set(e.x,e.y,.5).unproject(t).sub(this.ray.origin).normalize();this.camera=t}else if(t&&t.isOrthographicCamera){this.ray.origin.set(e.x,e.y,(t.near+t.far)/(t.near-t.far)).unproject(t);this.ray.direction.set(0,0,-1).transformDirection(t.matrixWorld);this.camera=t}else{console.error("THREE.Raycaster: Unsupported camera type.")}},intersectObject:function(e,t,r){var n=r||[];Dp(e,this,n,t);n.sort(Ip);return n},intersectObjects:function(e,t,r){var n=r||[];if(Array.isArray(e)===false){console.warn("THREE.Raycaster.intersectObjects: objects is not an Array.");return n}for(var i=0,a=e.length;i<a;i++){Dp(e[i],this,n,t)}n.sort(Ip);return n}});function Np(e,t,r){this.radius=e!==undefined?e:1;this.phi=t!==undefined?t:0;this.theta=r!==undefined?r:0;return this}Object.assign(Np.prototype,{set:function(e,t,r){this.radius=e;this.phi=t;this.theta=r;return this},clone:function(){return(new this.constructor).copy(this)},copy:function(e){this.radius=e.radius;this.phi=e.phi;this.theta=e.theta;return this},makeSafe:function(){var e=1e-6;this.phi=Math.max(e,Math.min(Math.PI-e,this.phi));return this},setFromVector3:function(e){return this.setFromCartesianCoords(e.x,e.y,e.z)},setFromCartesianCoords:function(e,t,r){this.radius=Math.sqrt(e*e+t*t+r*r);if(this.radius===0){this.theta=0;this.phi=0}else{this.theta=Math.atan2(e,r);this.phi=Math.acos(lr.clamp(t/this.radius,-1,1))}return this}});function Fp(e,t,r){this.radius=e!==undefined?e:1;this.theta=t!==undefined?t:0;this.y=r!==undefined?r:0;return this}Object.assign(Fp.prototype,{set:function(e,t,r){this.radius=e;this.theta=t;this.y=r;return this},clone:function(){return(new this.constructor).copy(this)},copy:function(e){this.radius=e.radius;this.theta=e.theta;this.y=e.y;return this},setFromVector3:function(e){return this.setFromCartesianCoords(e.x,e.y,e.z)},setFromCartesianCoords:function(e,t,r){this.radius=Math.sqrt(e*e+r*r);this.theta=Math.atan2(e,r);this.y=t;return this}});var Bp=new cr;function Up(e,t){this.min=e!==undefined?e:new cr(+Infinity,+Infinity);this.max=t!==undefined?t:new cr(-Infinity,-Infinity)}Object.assign(Up.prototype,{set:function(e,t){this.min.copy(e);this.max.copy(t);return this},setFromPoints:function(e){this.makeEmpty();for(var t=0,r=e.length;t<r;t++){this.expandByPoint(e[t])}return this},setFromCenterAndSize:function(e,t){var r=Bp.copy(t).multiplyScalar(.5);this.min.copy(e).sub(r);this.max.copy(e).add(r);return this},clone:function(){return(new this.constructor).copy(this)},copy:function(e){this.min.copy(e.min);this.max.copy(e.max);return this},makeEmpty:function(){this.min.x=this.min.y=+Infinity;this.max.x=this.max.y=-Infinity;return this},isEmpty:function(){return this.max.x<this.min.x||this.max.y<this.min.y},getCenter:function(e){if(e===undefined){console.warn("THREE.Box2: .getCenter() target is now required");e=new cr}return this.isEmpty()?e.set(0,0):e.addVectors(this.min,this.max).multiplyScalar(.5)},getSize:function(e){if(e===undefined){console.warn("THREE.Box2: .getSize() target is now required");e=new cr}return this.isEmpty()?e.set(0,0):e.subVectors(this.max,this.min)},expandByPoint:function(e){this.min.min(e);this.max.max(e);return this},expandByVector:function(e){this.min.sub(e);this.max.add(e);return this},expandByScalar:function(e){this.min.addScalar(-e);this.max.addScalar(e);return this},containsPoint:function(e){return e.x<this.min.x||e.x>this.max.x||e.y<this.min.y||e.y>this.max.y?false:true},containsBox:function(e){return this.min.x<=e.min.x&&e.max.x<=this.max.x&&this.min.y<=e.min.y&&e.max.y<=this.max.y},getParameter:function(e,t){if(t===undefined){console.warn("THREE.Box2: .getParameter() target is now required");t=new cr}return t.set((e.x-this.min.x)/(this.max.x-this.min.x),(e.y-this.min.y)/(this.max.y-this.min.y))},intersectsBox:function(e){return e.max.x<this.min.x||e.min.x>this.max.x||e.max.y<this.min.y||e.min.y>this.max.y?false:true},clampPoint:function(e,t){if(t===undefined){console.warn("THREE.Box2: .clampPoint() target is now required");t=new cr}return t.copy(e).clamp(this.min,this.max)},distanceToPoint:function(e){var t=Bp.copy(e).clamp(this.min,this.max);return t.sub(e).length()},intersect:function(e){this.min.max(e.min);this.max.min(e.max);return this},union:function(e){this.min.min(e.min);this.max.max(e.max);return this},translate:function(e){this.min.add(e);this.max.add(e);return this},equals:function(e){return e.min.equals(this.min)&&e.max.equals(this.max)}});var kp=new pr;var jp=new pr;function zp(e,t){this.start=e!==undefined?e:new pr;this.end=t!==undefined?t:new pr}Object.assign(zp.prototype,{set:function(e,t){this.start.copy(e);this.end.copy(t);return this},clone:function(){return(new this.constructor).copy(this)},copy:function(e){this.start.copy(e.start);this.end.copy(e.end);return this},getCenter:function(e){if(e===undefined){console.warn("THREE.Line3: .getCenter() target is now required");e=new pr}return e.addVectors(this.start,this.end).multiplyScalar(.5)},delta:function(e){if(e===undefined){console.warn("THREE.Line3: .delta() target is now required");e=new pr}return e.subVectors(this.end,this.start)},distanceSq:function(){return this.start.distanceToSquared(this.end)},distance:function(){return this.start.distanceTo(this.end)},at:function(e,t){if(t===undefined){console.warn("THREE.Line3: .at() target is now required");t=new pr}return this.delta(t).multiplyScalar(e).add(this.start)},closestPointToPointParameter:function(e,t){kp.subVectors(e,this.start);jp.subVectors(this.end,this.start);var r=jp.dot(jp);var n=jp.dot(kp);var i=n/r;if(t){i=lr.clamp(i,0,1)}return i},closestPointToPoint:function(e,t,r){var n=this.closestPointToPointParameter(e,t);if(r===undefined){console.warn("THREE.Line3: .closestPointToPoint() target is now required");r=new pr}return this.delta(r).multiplyScalar(n).add(this.start)},applyMatrix4:function(e){this.start.applyMatrix4(e);this.end.applyMatrix4(e);return this},equals:function(e){return e.start.equals(this.start)&&e.end.equals(this.end)}});function Hp(e){Zr.call(this);this.material=e;this.render=function(){}}Hp.prototype=Object.create(Zr.prototype);Hp.prototype.constructor=Hp;Hp.prototype.isImmediateRenderObject=true;var Gp=new pr;var Vp=new pr;var Wp=new mr;var qp=["a","b","c"];function Xp(e,t,r,n){this.object=e;this.size=t!==undefined?t:1;var i=r!==undefined?r:16711680;var a=n!==undefined?n:1;var o=0;var s=this.object.geometry;if(s&&s.isGeometry){o=s.faces.length*3}else if(s&&s.isBufferGeometry){o=s.attributes.normal.count}var u=new li;var l=new Qn(o*2*3,3);u.addAttribute("position",l);_c.call(this,u,new dc({color:i,linewidth:a}));this.matrixAutoUpdate=false;this.update()}Xp.prototype=Object.create(_c.prototype);Xp.prototype.constructor=Xp;Xp.prototype.update=function(){this.object.updateMatrixWorld(true);Wp.getNormalMatrix(this.object.matrixWorld);var e=this.object.matrixWorld;var t=this.geometry.attributes.position;var r=this.object.geometry;if(r&&r.isGeometry){var n=r.vertices;var i=r.faces;var a=0;for(var o=0,s=i.length;o<s;o++){var u=i[o];for(var l=0,c=u.vertexNormals.length;l<c;l++){var h=n[u[qp[l]]];var f=u.vertexNormals[l];Gp.copy(h).applyMatrix4(e);Vp.copy(f).applyMatrix3(Wp).normalize().multiplyScalar(this.size).add(Gp);t.setXYZ(a,Gp.x,Gp.y,Gp.z);a=a+1;t.setXYZ(a,Vp.x,Vp.y,Vp.z);a=a+1}}}else if(r&&r.isBufferGeometry){var d=r.attributes.position;var p=r.attributes.normal;var a=0;for(var l=0,c=d.count;l<c;l++){Gp.set(d.getX(l),d.getY(l),d.getZ(l)).applyMatrix4(e);Vp.set(p.getX(l),p.getY(l),p.getZ(l));Vp.applyMatrix3(Wp).normalize().multiplyScalar(this.size).add(Gp);t.setXYZ(a,Gp.x,Gp.y,Gp.z);a=a+1;t.setXYZ(a,Vp.x,Vp.y,Vp.z);a=a+1}}t.needsUpdate=true};var Yp=new pr;function Zp(e,t){Zr.call(this);this.light=e;this.light.updateMatrixWorld();this.matrix=e.matrixWorld;this.matrixAutoUpdate=false;this.color=t;var r=new li;var n=[0,0,0,0,0,1,0,0,0,1,0,1,0,0,0,-1,0,1,0,0,0,0,1,1,0,0,0,0,-1,1];for(var i=0,a=1,o=32;i<o;i++,a++){var s=i/o*Math.PI*2;var u=a/o*Math.PI*2;n.push(Math.cos(s),Math.sin(s),1,Math.cos(u),Math.sin(u),1)}r.addAttribute("position",new Qn(n,3));var l=new dc({fog:false});this.cone=new _c(r,l);this.add(this.cone);this.update()}Zp.prototype=Object.create(Zr.prototype);Zp.prototype.constructor=Zp;Zp.prototype.dispose=function(){this.cone.geometry.dispose();this.cone.material.dispose()};Zp.prototype.update=function(){this.light.updateMatrixWorld();var e=this.light.distance?this.light.distance:1e3;var t=e*Math.tan(this.light.angle);this.cone.scale.set(t,t,e);Yp.setFromMatrixPosition(this.light.target.matrixWorld);this.cone.lookAt(Yp);if(this.color!==undefined){this.cone.material.color.set(this.color)}else{this.cone.material.color.copy(this.light.color)}};var Jp=new pr;var Kp=new Or;var Qp=new Or;function $p(e){var t=[];if(e&&e.isBone){t.push(e)}for(var r=0;r<e.children.length;r++){t.push.apply(t,$p(e.children[r]))}return t}function ev(e){var t=$p(e);var r=new li;var n=[];var i=[];var a=new Fn(0,0,1);var o=new Fn(0,1,0);for(var s=0;s<t.length;s++){var u=t[s];if(u.parent&&u.parent.isBone){n.push(0,0,0);n.push(0,0,0);i.push(a.r,a.g,a.b);i.push(o.r,o.g,o.b)}}r.addAttribute("position",new Qn(n,3));r.addAttribute("color",new Qn(i,3));var l=new dc({vertexColors:g,depthTest:false,depthWrite:false,transparent:true});_c.call(this,r,l);this.root=e;this.bones=t;this.matrix=e.matrixWorld;this.matrixAutoUpdate=false}ev.prototype=Object.create(_c.prototype);ev.prototype.constructor=ev;ev.prototype.updateMatrixWorld=function(e){var t=this.bones;var r=this.geometry;var n=r.getAttribute("position");Qp.getInverse(this.root.matrixWorld);for(var i=0,a=0;i<t.length;i++){var o=t[i];if(o.parent&&o.parent.isBone){Kp.multiplyMatrices(Qp,o.matrixWorld);Jp.setFromMatrixPosition(Kp);n.setXYZ(a,Jp.x,Jp.y,Jp.z);Kp.multiplyMatrices(Qp,o.parent.matrixWorld);Jp.setFromMatrixPosition(Kp);n.setXYZ(a+1,Jp.x,Jp.y,Jp.z);a+=2}}r.getAttribute("position").needsUpdate=true;Zr.prototype.updateMatrixWorld.call(this,e)};function tv(e,t,r){this.light=e;this.light.updateMatrixWorld();this.color=r;var n=new kh(t,4,2);var i=new Gn({wireframe:true,fog:false});Ai.call(this,n,i);this.matrix=this.light.matrixWorld;this.matrixAutoUpdate=false;this.update()}tv.prototype=Object.create(Ai.prototype);tv.prototype.constructor=tv;tv.prototype.dispose=function(){this.geometry.dispose();this.material.dispose()};tv.prototype.update=function(){if(this.color!==undefined){this.material.color.set(this.color)}else{this.material.color.copy(this.light.color)}};function rv(e,t){this.type="RectAreaLightHelper";this.light=e;this.color=t;var r=[1,1,0,-1,1,0,-1,-1,0,1,-1,0,1,1,0];var n=new li;n.addAttribute("position",new Qn(r,3));n.computeBoundingSphere();var i=new dc({fog:false});xc.call(this,n,i);var a=[1,1,0,-1,1,0,-1,-1,0,1,1,0,-1,-1,0,1,-1,0];var o=new li;o.addAttribute("position",new Qn(a,3));o.computeBoundingSphere();this.add(new Ai(o,new Gn({side:ze,fog:false})));this.update()}rv.prototype=Object.create(xc.prototype);rv.prototype.constructor=rv;rv.prototype.update=function(){this.scale.set(.5*this.light.width,.5*this.light.height,1);if(this.color!==undefined){this.material.color.set(this.color);this.children[0].material.color.set(this.color)}else{this.material.color.copy(this.light.color).multiplyScalar(this.light.intensity);var e=this.material.color;var t=Math.max(e.r,e.g,e.b);if(t>1)e.multiplyScalar(1/t);this.children[0].material.color.copy(this.material.color)}};rv.prototype.dispose=function(){this.geometry.dispose();this.material.dispose();this.children[0].geometry.dispose();this.children[0].material.dispose()};var nv=new pr;var iv=new Fn;var av=new Fn;function ov(e,t,r){Zr.call(this);this.light=e;this.light.updateMatrixWorld();this.matrix=e.matrixWorld;this.matrixAutoUpdate=false;this.color=r;var n=new Gc(t);n.rotateY(Math.PI*.5);this.material=new Gn({wireframe:true,fog:false});if(this.color===undefined)this.material.vertexColors=g;var i=n.getAttribute("position");var a=new Float32Array(i.count*3);n.addAttribute("color",new Vn(a,3));this.add(new Ai(n,this.material));this.update()}ov.prototype=Object.create(Zr.prototype);ov.prototype.constructor=ov;ov.prototype.dispose=function(){this.children[0].geometry.dispose();this.children[0].material.dispose()};ov.prototype.update=function(){var e=this.children[0];if(this.color!==undefined){this.material.color.set(this.color)}else{var t=e.geometry.getAttribute("color");iv.copy(this.light.color);av.copy(this.light.groundColor);for(var r=0,n=t.count;r<n;r++){var i=r<n/2?iv:av;t.setXYZ(r,i.r,i.g,i.b)}t.needsUpdate=true}e.lookAt(nv.setFromMatrixPosition(this.light.matrixWorld).negate())};function sv(e,t){this.lightProbe=e;this.size=t;var r={};r["GAMMA_OUTPUT"]="";var n=new Hi({defines:r,uniforms:{sh:{value:this.lightProbe.sh.coefficients},intensity:{value:this.lightProbe.intensity}},vertexShader:["varying vec3 vNormal;","void main() {","\tvNormal = normalize( normalMatrix * normal );","\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );","}"].join("\n"),fragmentShader:["#define RECIPROCAL_PI 0.318309886","vec3 inverseTransformDirection( in vec3 normal, in mat4 matrix ) {","\t// matrix is assumed to be orthogonal","\treturn normalize( ( vec4( normal, 0.0 ) * matrix ).xyz );","}","vec3 linearToOutput( in vec3 a ) {","\t#ifdef GAMMA_OUTPUT","\t\treturn pow( a, vec3( 1.0 / float( GAMMA_FACTOR ) ) );","\t#else","\t\treturn a;","\t#endif","}","// source: https://graphics.stanford.edu/papers/envmap/envmap.pdf","vec3 shGetIrradianceAt( in vec3 normal, in vec3 shCoefficients[ 9 ] ) {","\t// normal is assumed to have unit length","\tfloat x = normal.x, y = normal.y, z = normal.z;","\t// band 0","\tvec3 result = shCoefficients[ 0 ] * 0.886227;","\t// band 1","\tresult += shCoefficients[ 1 ] * 2.0 * 0.511664 * y;","\tresult += shCoefficients[ 2 ] * 2.0 * 0.511664 * z;","\tresult += shCoefficients[ 3 ] * 2.0 * 0.511664 * x;","\t// band 2","\tresult += shCoefficients[ 4 ] * 2.0 * 0.429043 * x * y;","\tresult += shCoefficients[ 5 ] * 2.0 * 0.429043 * y * z;","\tresult += shCoefficients[ 6 ] * ( 0.743125 * z * z - 0.247708 );","\tresult += shCoefficients[ 7 ] * 2.0 * 0.429043 * x * z;","\tresult += shCoefficients[ 8 ] * 0.429043 * ( x * x - y * y );","\treturn result;","}","uniform vec3 sh[ 9 ]; // sh coefficients","uniform float intensity; // light probe intensity","varying vec3 vNormal;","void main() {","\tvec3 normal = normalize( vNormal );","\tvec3 worldNormal = inverseTransformDirection( normal, viewMatrix );","\tvec3 irradiance = shGetIrradianceAt( worldNormal, sh );","\tvec3 outgoingLight = RECIPROCAL_PI * irradiance * intensity;","\toutgoingLight = linearToOutput( outgoingLight );","\tgl_FragColor = vec4( outgoingLight, 1.0 );","}"].join("\n")});var i=new kh(1,32,16);Ai.call(this,i,n);this.onBeforeRender()}sv.prototype=Object.create(Ai.prototype);sv.prototype.constructor=sv;sv.prototype.dispose=function(){this.geometry.dispose();this.material.dispose()};sv.prototype.onBeforeRender=function(){this.position.copy(this.lightProbe.position);this.scale.set(1,1,1).multiplyScalar(this.size);this.material.uniforms.intensity.value=this.lightProbe.intensity};function uv(e,t,r,n){e=e||10;t=t||10;r=new Fn(r!==undefined?r:4473924);n=new Fn(n!==undefined?n:8947848);var i=t/2;var a=e/t;var o=e/2;var s=[],u=[];for(var l=0,c=0,h=-o;l<=t;l++,h+=a){s.push(-o,0,h,o,0,h);s.push(h,0,-o,h,0,o);var f=l===i?r:n;f.toArray(u,c);c+=3;f.toArray(u,c);c+=3;f.toArray(u,c);c+=3;f.toArray(u,c);c+=3}var d=new li;d.addAttribute("position",new Qn(s,3));d.addAttribute("color",new Qn(u,3));var p=new dc({vertexColors:g});_c.call(this,d,p)}uv.prototype=Object.assign(Object.create(_c.prototype),{constructor:uv,copy:function(e){_c.prototype.copy.call(this,e);this.geometry.copy(e.geometry);this.material.copy(e.material);return this},clone:function(){return(new this.constructor).copy(this)}});function lv(e,t,r,n,i,a){e=e||10;t=t||16;r=r||8;n=n||64;i=new Fn(i!==undefined?i:4473924);a=new Fn(a!==undefined?a:8947848);var o=[];var s=[];var u,l;var c,h,f,d,p;for(h=0;h<=t;h++){c=h/t*(Math.PI*2);u=Math.sin(c)*e;l=Math.cos(c)*e;o.push(0,0,0);o.push(u,0,l);p=h&1?i:a;s.push(p.r,p.g,p.b);s.push(p.r,p.g,p.b)}for(h=0;h<=r;h++){p=h&1?i:a;d=e-e/r*h;for(f=0;f<n;f++){c=f/n*(Math.PI*2);u=Math.sin(c)*d;l=Math.cos(c)*d;o.push(u,0,l);s.push(p.r,p.g,p.b);c=(f+1)/n*(Math.PI*2);u=Math.sin(c)*d;l=Math.cos(c)*d;o.push(u,0,l);s.push(p.r,p.g,p.b)}}var v=new li;v.addAttribute("position",new Qn(o,3));v.addAttribute("color",new Qn(s,3));var m=new dc({vertexColors:g});_c.call(this,v,m)}lv.prototype=Object.create(_c.prototype);lv.prototype.constructor=lv;function cv(e,t,r,n){this.audio=e;this.range=t||1;this.divisionsInnerAngle=r||16;this.divisionsOuterAngle=n||2;var i=new li;var a=this.divisionsInnerAngle+this.divisionsOuterAngle*2;var o=new Float32Array((a*3+3)*3);i.addAttribute("position",new Vn(o,3));var s=new dc({color:65280});var u=new dc({color:16776960});xc.call(this,i,[u,s]);this.update()}cv.prototype=Object.create(xc.prototype);cv.prototype.constructor=cv;cv.prototype.update=function(){var e=this.audio;var a=this.range;var t=this.divisionsInnerAngle;var r=this.divisionsOuterAngle;var n=lr.degToRad(e.panner.coneInnerAngle);var i=lr.degToRad(e.panner.coneOuterAngle);var o=n/2;var s=i/2;var u=0;var l=0;var c,h;var f=this.geometry;var d=f.attributes.position;f.clearGroups();function p(e,t,r,n){var i=(t-e)/r;d.setXYZ(u,0,0,0);l++;for(c=e;c<t;c+=i){h=u+l;d.setXYZ(h,Math.sin(c)*a,0,Math.cos(c)*a);d.setXYZ(h+1,Math.sin(Math.min(c+i,t))*a,0,Math.cos(Math.min(c+i,t))*a);d.setXYZ(h+2,0,0,0);l+=3}f.addGroup(u,l,n);u+=l;l=0}p(-s,-o,r,0);p(-o,o,t,1);p(o,s,r,0);d.needsUpdate=true;if(n===i)this.material[0].visible=false};cv.prototype.dispose=function(){this.geometry.dispose();this.material[0].dispose();this.material[1].dispose()};var hv=new pr;var fv=new pr;var dv=new mr;function pv(e,t,r,n){this.object=e;this.size=t!==undefined?t:1;var i=r!==undefined?r:16776960;var a=n!==undefined?n:1;var o=0;var s=this.object.geometry;if(s&&s.isGeometry){o=s.faces.length}else{console.warn("THREE.FaceNormalsHelper: only THREE.Geometry is supported. Use THREE.VertexNormalsHelper, instead.")}var u=new li;var l=new Qn(o*2*3,3);u.addAttribute("position",l);_c.call(this,u,new dc({color:i,linewidth:a}));this.matrixAutoUpdate=false;this.update()}pv.prototype=Object.create(_c.prototype);pv.prototype.constructor=pv;pv.prototype.update=function(){this.object.updateMatrixWorld(true);dv.getNormalMatrix(this.object.matrixWorld);var e=this.object.matrixWorld;var t=this.geometry.attributes.position;var r=this.object.geometry;var n=r.vertices;var i=r.faces;var a=0;for(var o=0,s=i.length;o<s;o++){var u=i[o];var l=u.normal;hv.copy(n[u.a]).add(n[u.b]).add(n[u.c]).divideScalar(3).applyMatrix4(e);fv.copy(l).applyMatrix3(dv).normalize().multiplyScalar(this.size).add(hv);t.setXYZ(a,hv.x,hv.y,hv.z);a=a+1;t.setXYZ(a,fv.x,fv.y,fv.z);a=a+1}t.needsUpdate=true};var vv=new pr;var mv=new pr;var gv=new pr;function yv(e,t,r){Zr.call(this);this.light=e;this.light.updateMatrixWorld();this.matrix=e.matrixWorld;this.matrixAutoUpdate=false;this.color=r;if(t===undefined)t=1;var n=new li;n.addAttribute("position",new Qn([-t,t,0,t,t,0,t,-t,0,-t,-t,0,-t,t,0],3));var i=new dc({fog:false});this.lightPlane=new xc(n,i);this.add(this.lightPlane);n=new li;n.addAttribute("position",new Qn([0,0,0,0,0,1],3));this.targetLine=new xc(n,i);this.add(this.targetLine);this.update()}yv.prototype=Object.create(Zr.prototype);yv.prototype.constructor=yv;yv.prototype.dispose=function(){this.lightPlane.geometry.dispose();this.lightPlane.material.dispose();this.targetLine.geometry.dispose();this.targetLine.material.dispose()};yv.prototype.update=function(){vv.setFromMatrixPosition(this.light.matrixWorld);mv.setFromMatrixPosition(this.light.target.matrixWorld);gv.subVectors(mv,vv);this.lightPlane.lookAt(mv);if(this.color!==undefined){this.lightPlane.material.color.set(this.color);this.targetLine.material.color.set(this.color)}else{this.lightPlane.material.color.copy(this.light.color);this.targetLine.material.color.copy(this.light.color)}this.targetLine.lookAt(mv);this.targetLine.scale.z=gv.length()};var xv=new pr;var bv=new Gi;function wv(e){var t=new li;var r=new dc({color:16777215,vertexColors:v});var n=[];var i=[];var a={};var o=new Fn(16755200);var s=new Fn(16711680);var u=new Fn(43775);var l=new Fn(16777215);var c=new Fn(3355443);h("n1","n2",o);h("n2","n4",o);h("n4","n3",o);h("n3","n1",o);h("f1","f2",o);h("f2","f4",o);h("f4","f3",o);h("f3","f1",o);h("n1","f1",o);h("n2","f2",o);h("n3","f3",o);h("n4","f4",o);h("p","n1",s);h("p","n2",s);h("p","n3",s);h("p","n4",s);h("u1","u2",u);h("u2","u3",u);h("u3","u1",u);h("c","t",l);h("p","c",c);h("cn1","cn2",c);h("cn3","cn4",c);h("cf1","cf2",c);h("cf3","cf4",c);function h(e,t,r){f(e,r);f(t,r)}function f(e,t){n.push(0,0,0);i.push(t.r,t.g,t.b);if(a[e]===undefined){a[e]=[]}a[e].push(n.length/3-1)}t.addAttribute("position",new Qn(n,3));t.addAttribute("color",new Qn(i,3));_c.call(this,t,r);this.camera=e;if(this.camera.updateProjectionMatrix)this.camera.updateProjectionMatrix();this.matrix=e.matrixWorld;this.matrixAutoUpdate=false;this.pointMap=a;this.update()}wv.prototype=Object.create(_c.prototype);wv.prototype.constructor=wv;wv.prototype.update=function(){var e=this.geometry;var t=this.pointMap;var r=1,n=1;bv.projectionMatrixInverse.copy(this.camera.projectionMatrixInverse);_v("c",t,e,bv,0,0,-1);_v("t",t,e,bv,0,0,1);_v("n1",t,e,bv,-r,-n,-1);_v("n2",t,e,bv,r,-n,-1);_v("n3",t,e,bv,-r,n,-1);_v("n4",t,e,bv,r,n,-1);_v("f1",t,e,bv,-r,-n,1);_v("f2",t,e,bv,r,-n,1);_v("f3",t,e,bv,-r,n,1);_v("f4",t,e,bv,r,n,1);_v("u1",t,e,bv,r*.7,n*1.1,-1);_v("u2",t,e,bv,-r*.7,n*1.1,-1);_v("u3",t,e,bv,0,n*2,-1);_v("cf1",t,e,bv,-r,0,1);_v("cf2",t,e,bv,r,0,1);_v("cf3",t,e,bv,0,-n,1);_v("cf4",t,e,bv,0,n,1);_v("cn1",t,e,bv,-r,0,-1);_v("cn2",t,e,bv,r,0,-1);_v("cn3",t,e,bv,0,-n,-1);_v("cn4",t,e,bv,0,n,-1);e.getAttribute("position").needsUpdate=true};function _v(e,t,r,n,i,a,o){xv.set(i,a,o).unproject(n);var s=t[e];if(s!==undefined){var u=r.getAttribute("position");for(var l=0,c=s.length;l<c;l++){u.setXYZ(s[l],xv.x,xv.y,xv.z)}}}var Tv=new cn;function Ev(e,t){this.object=e;if(t===undefined)t=16776960;var r=new Uint16Array([0,1,1,2,2,3,3,0,4,5,5,6,6,7,7,4,0,4,1,5,2,6,3,7]);var n=new Float32Array(8*3);var i=new li;i.setIndex(new Vn(r,1));i.addAttribute("position",new Vn(n,3));_c.call(this,i,new dc({color:t}));this.matrixAutoUpdate=false;this.update()}Ev.prototype=Object.create(_c.prototype);Ev.prototype.constructor=Ev;Ev.prototype.update=function(e){if(e!==undefined){console.warn("THREE.BoxHelper: .update() has no longer arguments.")}if(this.object!==undefined){Tv.setFromObject(this.object)}if(Tv.isEmpty())return;var t=Tv.min;var r=Tv.max;var n=this.geometry.attributes.position;var i=n.array;i[0]=r.x;i[1]=r.y;i[2]=r.z;i[3]=t.x;i[4]=r.y;i[5]=r.z;i[6]=t.x;i[7]=t.y;i[8]=r.z;i[9]=r.x;i[10]=t.y;i[11]=r.z;i[12]=r.x;i[13]=r.y;i[14]=t.z;i[15]=t.x;i[16]=r.y;i[17]=t.z;i[18]=t.x;i[19]=t.y;i[20]=t.z;i[21]=r.x;i[22]=t.y;i[23]=t.z;n.needsUpdate=true;this.geometry.computeBoundingSphere()};Ev.prototype.setFromObject=function(e){this.object=e;this.update();return this};Ev.prototype.copy=function(e){_c.prototype.copy.call(this,e);this.object=e.object;return this};Ev.prototype.clone=function(){return(new this.constructor).copy(this)};function Mv(e,t){this.type="Box3Helper";this.box=e;t=t||16776960;var r=new Uint16Array([0,1,1,2,2,3,3,0,4,5,5,6,6,7,7,4,0,4,1,5,2,6,3,7]);var n=[1,1,1,-1,1,1,-1,-1,1,1,-1,1,1,1,-1,-1,1,-1,-1,-1,-1,1,-1,-1];var i=new li;i.setIndex(new Vn(r,1));i.addAttribute("position",new Qn(n,3));_c.call(this,i,new dc({color:t}));this.geometry.computeBoundingSphere()}Mv.prototype=Object.create(_c.prototype);Mv.prototype.constructor=Mv;Mv.prototype.updateMatrixWorld=function(e){var t=this.box;if(t.isEmpty())return;t.getCenter(this.position);t.getSize(this.scale);this.scale.multiplyScalar(.5);Zr.prototype.updateMatrixWorld.call(this,e)};function Sv(e,t,r){this.type="PlaneHelper";this.plane=e;this.size=t===undefined?1:t;var n=r!==undefined?r:16776960;var i=[1,-1,1,-1,1,1,-1,-1,1,1,1,1,-1,1,1,-1,-1,1,1,-1,1,1,1,1,0,0,1,0,0,0];var a=new li;a.addAttribute("position",new Qn(i,3));a.computeBoundingSphere();xc.call(this,a,new dc({color:n}));var o=[1,1,1,-1,1,1,-1,-1,1,1,1,1,-1,-1,1,1,-1,1];var s=new li;s.addAttribute("position",new Qn(o,3));s.computeBoundingSphere();this.add(new Ai(s,new Gn({color:n,opacity:.2,transparent:true,depthWrite:false})))}Sv.prototype=Object.create(xc.prototype);Sv.prototype.constructor=Sv;Sv.prototype.updateMatrixWorld=function(e){var t=-this.plane.constant;if(Math.abs(t)<1e-8)t=1e-8;this.scale.set(.5*this.size,.5*this.size,t);this.children[0].material.side=t<0?ze:D;this.lookAt(this.plane.normal);Zr.prototype.updateMatrixWorld.call(this,e)};var Av=new pr;var Rv,Pv;function Cv(e,t,r,n,i,a){Zr.call(this);if(e===undefined)e=new pr(0,0,1);if(t===undefined)t=new pr(0,0,0);if(r===undefined)r=1;if(n===undefined)n=16776960;if(i===undefined)i=.2*r;if(a===undefined)a=.2*i;if(Rv===undefined){Rv=new li;Rv.addAttribute("position",new Qn([0,0,0,0,1,0],3));Pv=new Zh(0,.5,1,5,1);Pv.translate(0,-.5,0)}this.position.copy(t);this.line=new xc(Rv,new dc({color:n}));this.line.matrixAutoUpdate=false;this.add(this.line);this.cone=new Ai(Pv,new Gn({color:n}));this.cone.matrixAutoUpdate=false;this.add(this.cone);this.setDirection(e);this.setLength(r,i,a)}Cv.prototype=Object.create(Zr.prototype);Cv.prototype.constructor=Cv;Cv.prototype.setDirection=function(e){if(e.y>.99999){this.quaternion.set(0,0,0,1)}else if(e.y<-.99999){this.quaternion.set(1,0,0,0)}else{Av.set(e.z,0,-e.x).normalize();var t=Math.acos(e.y);this.quaternion.setFromAxisAngle(Av,t)}};Cv.prototype.setLength=function(e,t,r){if(t===undefined)t=.2*e;if(r===undefined)r=.2*t;this.line.scale.set(1,Math.max(1e-4,e-t),1);this.line.updateMatrix();this.cone.scale.set(r,t,r);this.cone.position.y=e;this.cone.updateMatrix()};Cv.prototype.setColor=function(e){this.line.material.color.set(e);this.cone.material.color.set(e)};Cv.prototype.copy=function(e){Zr.prototype.copy.call(this,e,false);this.line.copy(e.line);this.cone.copy(e.cone);return this};Cv.prototype.clone=function(){return(new this.constructor).copy(this)};function Ov(e){e=e||1;var t=[0,0,0,e,0,0,0,0,0,0,e,0,0,0,0,0,0,e];var r=[1,0,0,1,.6,0,0,1,0,.6,1,0,0,0,1,0,.6,1];var n=new li;n.addAttribute("position",new Qn(t,3));n.addAttribute("color",new Qn(r,3));var i=new dc({vertexColors:g});_c.call(this,n,i)}Ov.prototype=Object.create(_c.prototype);Ov.prototype.constructor=Ov;function Lv(e,t,r,n,i,a,o){console.warn("THREE.Face4 has been removed. A THREE.Face3 will be created instead.");return new jn(e,t,r,i,a,o)}var Iv=0;r.LineStrip=Iv;var Dv=1;r.LinePieces=Dv;function Nv(e){console.warn("THREE.MeshFaceMaterial has been removed. Use an Array instead.");return e}function Fv(e){if(e===undefined)e=[];console.warn("THREE.MultiMaterial has been removed. Use an Array instead.");e.isMultiMaterial=true;e.materials=e;e.clone=function(){return e.slice()};return e}function Bv(e,t){console.warn("THREE.PointCloud has been renamed to THREE.Points.");return new Pc(e,t)}function Uv(e){console.warn("THREE.Particle has been renamed to THREE.Sprite.");return new rc(e)}function kv(e,t){console.warn("THREE.ParticleSystem has been renamed to THREE.Points.");return new Pc(e,t)}function jv(e){console.warn("THREE.PointCloudMaterial has been renamed to THREE.PointsMaterial.");return new Ec(e)}function zv(e){console.warn("THREE.ParticleBasicMaterial has been renamed to THREE.PointsMaterial.");return new Ec(e)}function Hv(e){console.warn("THREE.ParticleSystemMaterial has been renamed to THREE.PointsMaterial.");return new Ec(e)}function Gv(e,t,r){console.warn("THREE.Vertex has been removed. Use THREE.Vector3 instead.");return new pr(e,t,r)}function Vv(e,t){console.warn("THREE.DynamicBufferAttribute has been removed. Use new THREE.BufferAttribute().setDynamic( true ) instead.");return new Vn(e,t).setDynamic(true)}function Wv(e,t){console.warn("THREE.Int8Attribute has been removed. Use new THREE.Int8BufferAttribute() instead.");return new Wn(e,t)}function qv(e,t){console.warn("THREE.Uint8Attribute has been removed. Use new THREE.Uint8BufferAttribute() instead.");return new qn(e,t)}function Xv(e,t){console.warn("THREE.Uint8ClampedAttribute has been removed. Use new THREE.Uint8ClampedBufferAttribute() instead.");return new Xn(e,t)}function Yv(e,t){console.warn("THREE.Int16Attribute has been removed. Use new THREE.Int16BufferAttribute() instead.");return new Yn(e,t)}function Zv(e,t){console.warn("THREE.Uint16Attribute has been removed. Use new THREE.Uint16BufferAttribute() instead.");return new Zn(e,t)}function Jv(e,t){console.warn("THREE.Int32Attribute has been removed. Use new THREE.Int32BufferAttribute() instead.");return new Jn(e,t)}function Kv(e,t){console.warn("THREE.Uint32Attribute has been removed. Use new THREE.Uint32BufferAttribute() instead.");return new Kn(e,t)}function Qv(e,t){console.warn("THREE.Float32Attribute has been removed. Use new THREE.Float32BufferAttribute() instead.");return new Qn(e,t)}function $v(e,t){console.warn("THREE.Float64Attribute has been removed. Use new THREE.Float64BufferAttribute() instead.");return new $n(e,t)}zf.create=function(e,t){console.log("THREE.Curve.create() has been deprecated");e.prototype=Object.create(zf.prototype);e.prototype.constructor=e;e.prototype.getPoint=t;return e};Object.assign(pd.prototype,{createPointsGeometry:function(e){console.warn("THREE.CurvePath: .createPointsGeometry() has been removed. Use new THREE.Geometry().setFromPoints( points ) instead.");var t=this.getPoints(e);return this.createGeometry(t)},createSpacedPointsGeometry:function(e){console.warn("THREE.CurvePath: .createSpacedPointsGeometry() has been removed. Use new THREE.Geometry().setFromPoints( points ) instead.");var t=this.getSpacedPoints(e);return this.createGeometry(t)},createGeometry:function(e){console.warn("THREE.CurvePath: .createGeometry() has been removed. Use new THREE.Geometry().setFromPoints( points ) instead.");var t=new Di;for(var r=0,n=e.length;r<n;r++){var i=e[r];t.vertices.push(new pr(i.x,i.y,i.z||0))}return t}});Object.assign(vd.prototype,{fromPoints:function(e){console.warn("THREE.Path: .fromPoints() has been renamed to .setFromPoints().");this.setFromPoints(e)}});function em(e){console.warn("THREE.ClosedSplineCurve3 has been deprecated. Use THREE.CatmullRomCurve3 instead.");Zf.call(this,e);this.type="catmullrom";this.closed=true}em.prototype=Object.create(Zf.prototype);function tm(e){console.warn("THREE.SplineCurve3 has been deprecated. Use THREE.CatmullRomCurve3 instead.");Zf.call(this,e);this.type="catmullrom"}tm.prototype=Object.create(Zf.prototype);function rm(e){console.warn("THREE.Spline has been removed. Use THREE.CatmullRomCurve3 instead.");Zf.call(this,e);this.type="catmullrom"}rm.prototype=Object.create(Zf.prototype);Object.assign(rm.prototype,{initFromArray:function(){console.error("THREE.Spline: .initFromArray() has been removed.")},getControlPointsArray:function(){console.error("THREE.Spline: .getControlPointsArray() has been removed.")},reparametrizeByArcLength:function(){console.error("THREE.Spline: .reparametrizeByArcLength() has been removed.")}});function nm(e){console.warn("THREE.AxisHelper has been renamed to THREE.AxesHelper.");return new Ov(e)}function im(e,t){console.warn("THREE.BoundingBoxHelper has been deprecated. Creating a THREE.BoxHelper instead.");return new Ev(e,t)}function am(e,t){console.warn("THREE.EdgesHelper has been removed. Use THREE.EdgesGeometry instead.");return new _c(new Xh(e.geometry),new dc({color:t!==undefined?t:16777215}))}uv.prototype.setColors=function(){console.error("THREE.GridHelper: setColors() has been deprecated, pass them in the constructor instead.")};ev.prototype.update=function(){console.error("THREE.SkeletonHelper: update() no longer needs to be called.")};function om(e,t){console.warn("THREE.WireframeHelper has been removed. Use THREE.WireframeGeometry instead.");return new _c(new Nc(e.geometry),new dc({color:t!==undefined?t:16777215}))}Object.assign(Lf.prototype,{extractUrlBase:function(e){console.warn("THREE.Loader: .extractUrlBase() has been deprecated. Use THREE.LoaderUtils.extractUrlBase() instead.");return Cd.extractUrlBase(e)}});Lf.Handlers={add:function(){console.error("THREE.Loader: Handlers.add() has been removed. Use LoadingManager.addHandler() instead.")},get:function(){console.error("THREE.Loader: Handlers.get() has been removed. Use LoadingManager.getHandler() instead.")}};function sm(e){console.warn("THREE.XHRLoader has been renamed to THREE.FileLoader.");return new Df(e)}function um(e){console.warn("THREE.BinaryTextureLoader has been renamed to THREE.DataTextureLoader.");return new Bf(e)}Object.assign(Nd.prototype,{setTexturePath:function(e){console.warn("THREE.ObjectLoader: .setTexturePath() has been renamed to .setResourcePath().");return this.setResourcePath(e)}});Object.assign(Up.prototype,{center:function(e){console.warn("THREE.Box2: .center() has been renamed to .getCenter().");return this.getCenter(e)},empty:function(){console.warn("THREE.Box2: .empty() has been renamed to .isEmpty().");return this.isEmpty()},isIntersectionBox:function(e){console.warn("THREE.Box2: .isIntersectionBox() has been renamed to .intersectsBox().");return this.intersectsBox(e)},size:function(e){console.warn("THREE.Box2: .size() has been renamed to .getSize().");return this.getSize(e)}});Object.assign(cn.prototype,{center:function(e){console.warn("THREE.Box3: .center() has been renamed to .getCenter().");return this.getCenter(e)},empty:function(){console.warn("THREE.Box3: .empty() has been renamed to .isEmpty().");return this.isEmpty()},isIntersectionBox:function(e){console.warn("THREE.Box3: .isIntersectionBox() has been renamed to .intersectsBox().");return this.intersectsBox(e)},isIntersectionSphere:function(e){console.warn("THREE.Box3: .isIntersectionSphere() has been renamed to .intersectsSphere().");return this.intersectsSphere(e)},size:function(e){console.warn("THREE.Box3: .size() has been renamed to .getSize().");return this.getSize(e)}});zp.prototype.center=function(e){console.warn("THREE.Line3: .center() has been renamed to .getCenter().");return this.getCenter(e)};Object.assign(lr,{random16:function(){console.warn("THREE.Math: .random16() has been deprecated. Use Math.random() instead.");return Math.random()},nearestPowerOfTwo:function(e){console.warn("THREE.Math: .nearestPowerOfTwo() has been renamed to .floorPowerOfTwo().");return lr.floorPowerOfTwo(e)},nextPowerOfTwo:function(e){console.warn("THREE.Math: .nextPowerOfTwo() has been renamed to .ceilPowerOfTwo().");return lr.ceilPowerOfTwo(e)}});Object.assign(mr.prototype,{flattenToArrayOffset:function(e,t){console.warn("THREE.Matrix3: .flattenToArrayOffset() has been deprecated. Use .toArray() instead.");return this.toArray(e,t)},multiplyVector3:function(e){console.warn("THREE.Matrix3: .multiplyVector3() has been removed. Use vector.applyMatrix3( matrix ) instead.");return e.applyMatrix3(this)},multiplyVector3Array:function(){console.error("THREE.Matrix3: .multiplyVector3Array() has been removed.")},applyToBuffer:function(e){console.warn("THREE.Matrix3: .applyToBuffer() has been removed. Use matrix.applyToBufferAttribute( attribute ) instead.");return this.applyToBufferAttribute(e)},applyToVector3Array:function(){console.error("THREE.Matrix3: .applyToVector3Array() has been removed.")}});Object.assign(Or.prototype,{extractPosition:function(e){console.warn("THREE.Matrix4: .extractPosition() has been renamed to .copyPosition().");return this.copyPosition(e)},flattenToArrayOffset:function(e,t){console.warn("THREE.Matrix4: .flattenToArrayOffset() has been deprecated. Use .toArray() instead.");return this.toArray(e,t)},getPosition:function(){console.warn("THREE.Matrix4: .getPosition() has been removed. Use Vector3.setFromMatrixPosition( matrix ) instead.");return(new pr).setFromMatrixColumn(this,3)},setRotationFromQuaternion:function(e){console.warn("THREE.Matrix4: .setRotationFromQuaternion() has been renamed to .makeRotationFromQuaternion().");return this.makeRotationFromQuaternion(e)},multiplyToArray:function(){console.warn("THREE.Matrix4: .multiplyToArray() has been removed.")},multiplyVector3:function(e){console.warn("THREE.Matrix4: .multiplyVector3() has been removed. Use vector.applyMatrix4( matrix ) instead.");return e.applyMatrix4(this)},multiplyVector4:function(e){console.warn("THREE.Matrix4: .multiplyVector4() has been removed. Use vector.applyMatrix4( matrix ) instead.");return e.applyMatrix4(this)},multiplyVector3Array:function(){console.error("THREE.Matrix4: .multiplyVector3Array() has been removed.")},rotateAxis:function(e){console.warn("THREE.Matrix4: .rotateAxis() has been removed. Use Vector3.transformDirection( matrix ) instead.");e.transformDirection(this)},crossVector:function(e){console.warn("THREE.Matrix4: .crossVector() has been removed. Use vector.applyMatrix4( matrix ) instead.");return e.applyMatrix4(this)},translate:function(){console.error("THREE.Matrix4: .translate() has been removed.")},rotateX:function(){console.error("THREE.Matrix4: .rotateX() has been removed.")},rotateY:function(){console.error("THREE.Matrix4: .rotateY() has been removed.")},rotateZ:function(){console.error("THREE.Matrix4: .rotateZ() has been removed.")},rotateByAxis:function(){console.error("THREE.Matrix4: .rotateByAxis() has been removed.")},applyToBuffer:function(e){console.warn("THREE.Matrix4: .applyToBuffer() has been removed. Use matrix.applyToBufferAttribute( attribute ) instead.");return this.applyToBufferAttribute(e)},applyToVector3Array:function(){console.error("THREE.Matrix4: .applyToVector3Array() has been removed.")},makeFrustum:function(e,t,r,n,i,a){console.warn("THREE.Matrix4: .makeFrustum() has been removed. Use .makePerspective( left, right, top, bottom, near, far ) instead.");return this.makePerspective(e,t,n,r,i,a)}});$i.prototype.isIntersectionLine=function(e){console.warn("THREE.Plane: .isIntersectionLine() has been renamed to .intersectsLine().");return this.intersectsLine(e)};hr.prototype.multiplyVector3=function(e){console.warn("THREE.Quaternion: .multiplyVector3() has been removed. Use is now vector.applyQuaternion( quaternion ) instead.");return e.applyQuaternion(this)};Object.assign(wn.prototype,{isIntersectionBox:function(e){console.warn("THREE.Ray: .isIntersectionBox() has been renamed to .intersectsBox().");return this.intersectsBox(e)},isIntersectionPlane:function(e){console.warn("THREE.Ray: .isIntersectionPlane() has been renamed to .intersectsPlane().");return this.intersectsPlane(e)},isIntersectionSphere:function(e){console.warn("THREE.Ray: .isIntersectionSphere() has been renamed to .intersectsSphere().");return this.intersectsSphere(e)}});Object.assign(Ln.prototype,{area:function(){console.warn("THREE.Triangle: .area() has been renamed to .getArea().");return this.getArea()},barycoordFromPoint:function(e,t){console.warn("THREE.Triangle: .barycoordFromPoint() has been renamed to .getBarycoord().");return this.getBarycoord(e,t)},midpoint:function(e){console.warn("THREE.Triangle: .midpoint() has been renamed to .getMidpoint().");return this.getMidpoint(e)},normal:function(e){console.warn("THREE.Triangle: .normal() has been renamed to .getNormal().");return this.getNormal(e)},plane:function(e){console.warn("THREE.Triangle: .plane() has been renamed to .getPlane().");return this.getPlane(e)}});Object.assign(Ln,{barycoordFromPoint:function(e,t,r,n,i){console.warn("THREE.Triangle: .barycoordFromPoint() has been renamed to .getBarycoord().");return Ln.getBarycoord(e,t,r,n,i)},normal:function(e,t,r,n){console.warn("THREE.Triangle: .normal() has been renamed to .getNormal().");return Ln.getNormal(e,t,r,n)}});Object.assign(md.prototype,{extractAllPoints:function(e){console.warn("THREE.Shape: .extractAllPoints() has been removed. Use .extractPoints() instead.");return this.extractPoints(e)},extrude:function(e){console.warn("THREE.Shape: .extrude() has been removed. Use ExtrudeGeometry() instead.");return new Lh(this,e)},makeGeometry:function(e){console.warn("THREE.Shape: .makeGeometry() has been removed. Use ShapeGeometry() instead.");return new Vh(this,e)}});Object.assign(cr.prototype,{fromAttribute:function(e,t,r){console.warn("THREE.Vector2: .fromAttribute() has been renamed to .fromBufferAttribute().");return this.fromBufferAttribute(e,t,r)},distanceToManhattan:function(e){console.warn("THREE.Vector2: .distanceToManhattan() has been renamed to .manhattanDistanceTo().");return this.manhattanDistanceTo(e)},lengthManhattan:function(){console.warn("THREE.Vector2: .lengthManhattan() has been renamed to .manhattanLength().");return this.manhattanLength()}});Object.assign(pr.prototype,{setEulerFromRotationMatrix:function(){console.error("THREE.Vector3: .setEulerFromRotationMatrix() has been removed. Use Euler.setFromRotationMatrix() instead.")},setEulerFromQuaternion:function(){console.error("THREE.Vector3: .setEulerFromQuaternion() has been removed. Use Euler.setFromQuaternion() instead.")},getPositionFromMatrix:function(e){console.warn("THREE.Vector3: .getPositionFromMatrix() has been renamed to .setFromMatrixPosition().");return this.setFromMatrixPosition(e)},getScaleFromMatrix:function(e){console.warn("THREE.Vector3: .getScaleFromMatrix() has been renamed to .setFromMatrixScale().");return this.setFromMatrixScale(e)},getColumnFromMatrix:function(e,t){console.warn("THREE.Vector3: .getColumnFromMatrix() has been renamed to .setFromMatrixColumn().");return this.setFromMatrixColumn(t,e)},applyProjection:function(e){console.warn("THREE.Vector3: .applyProjection() has been removed. Use .applyMatrix4( m ) instead.");return this.applyMatrix4(e)},fromAttribute:function(e,t,r){console.warn("THREE.Vector3: .fromAttribute() has been renamed to .fromBufferAttribute().");return this.fromBufferAttribute(e,t,r)},distanceToManhattan:function(e){console.warn("THREE.Vector3: .distanceToManhattan() has been renamed to .manhattanDistanceTo().");return this.manhattanDistanceTo(e)},lengthManhattan:function(){console.warn("THREE.Vector3: .lengthManhattan() has been renamed to .manhattanLength().");return this.manhattanLength()}});Object.assign(wr.prototype,{fromAttribute:function(e,t,r){console.warn("THREE.Vector4: .fromAttribute() has been renamed to .fromBufferAttribute().");return this.fromBufferAttribute(e,t,r)},lengthManhattan:function(){console.warn("THREE.Vector4: .lengthManhattan() has been renamed to .manhattanLength().");return this.manhattanLength()}});Object.assign(Di.prototype,{computeTangents:function(){console.error("THREE.Geometry: .computeTangents() has been removed.")},computeLineDistances:function(){console.error("THREE.Geometry: .computeLineDistances() has been removed. Use THREE.Line.computeLineDistances() instead.")}});Object.assign(Zr.prototype,{getChildByName:function(e){console.warn("THREE.Object3D: .getChildByName() has been renamed to .getObjectByName().");return this.getObjectByName(e)},renderDepth:function(){console.warn("THREE.Object3D: .renderDepth has been removed. Use .renderOrder, instead.")},translate:function(e,t){console.warn("THREE.Object3D: .translate() has been removed. Use .translateOnAxis( axis, distance ) instead.");return this.translateOnAxis(t,e)},getWorldRotation:function(){console.error("THREE.Object3D: .getWorldRotation() has been removed. Use THREE.Object3D.getWorldQuaternion( target ) instead.")}});Object.defineProperties(Zr.prototype,{eulerOrder:{get:function(){console.warn("THREE.Object3D: .eulerOrder is now .rotation.order.");return this.rotation.order},set:function(e){console.warn("THREE.Object3D: .eulerOrder is now .rotation.order.");this.rotation.order=e}},useQuaternion:{get:function(){console.warn("THREE.Object3D: .useQuaternion has been removed. The library now uses quaternions by default.")},set:function(){console.warn("THREE.Object3D: .useQuaternion has been removed. The library now uses quaternions by default.")}}});Object.defineProperties(oc.prototype,{objects:{get:function(){console.warn("THREE.LOD: .objects has been renamed to .levels.");return this.levels}}});Object.defineProperty(cc.prototype,"useVertexTexture",{get:function(){console.warn("THREE.Skeleton: useVertexTexture has been removed.")},set:function(){console.warn("THREE.Skeleton: useVertexTexture has been removed.")}});sc.prototype.initBones=function(){console.error("THREE.SkinnedMesh: initBones() has been removed.")};Object.defineProperty(zf.prototype,"__arcLengthDivisions",{get:function(){console.warn("THREE.Curve: .__arcLengthDivisions is now .arcLengthDivisions.");return this.arcLengthDivisions},set:function(e){console.warn("THREE.Curve: .__arcLengthDivisions is now .arcLengthDivisions.");this.arcLengthDivisions=e}});Vi.prototype.setLens=function(e,t){console.warn("THREE.PerspectiveCamera.setLens is deprecated. "+"Use .setFocalLength and .filmGauge for a photographic setup.");if(t!==undefined)this.filmGauge=t;this.setFocalLength(e)};Object.defineProperties(gd.prototype,{onlyShadow:{set:function(){console.warn("THREE.Light: .onlyShadow has been removed.")}},shadowCameraFov:{set:function(e){console.warn("THREE.Light: .shadowCameraFov is now .shadow.camera.fov.");this.shadow.camera.fov=e}},shadowCameraLeft:{set:function(e){console.warn("THREE.Light: .shadowCameraLeft is now .shadow.camera.left.");this.shadow.camera.left=e}},shadowCameraRight:{set:function(e){console.warn("THREE.Light: .shadowCameraRight is now .shadow.camera.right.");this.shadow.camera.right=e}},shadowCameraTop:{set:function(e){console.warn("THREE.Light: .shadowCameraTop is now .shadow.camera.top.");this.shadow.camera.top=e}},shadowCameraBottom:{set:function(e){console.warn("THREE.Light: .shadowCameraBottom is now .shadow.camera.bottom.");this.shadow.camera.bottom=e}},shadowCameraNear:{set:function(e){console.warn("THREE.Light: .shadowCameraNear is now .shadow.camera.near.");this.shadow.camera.near=e}},shadowCameraFar:{set:function(e){console.warn("THREE.Light: .shadowCameraFar is now .shadow.camera.far.");this.shadow.camera.far=e}},shadowCameraVisible:{set:function(){console.warn("THREE.Light: .shadowCameraVisible has been removed. Use new THREE.CameraHelper( light.shadow.camera ) instead.")}},shadowBias:{set:function(e){console.warn("THREE.Light: .shadowBias is now .shadow.bias.");this.shadow.bias=e}},shadowDarkness:{set:function(){console.warn("THREE.Light: .shadowDarkness has been removed.")}},shadowMapWidth:{set:function(e){console.warn("THREE.Light: .shadowMapWidth is now .shadow.mapSize.width.");this.shadow.mapSize.width=e}},shadowMapHeight:{set:function(e){console.warn("THREE.Light: .shadowMapHeight is now .shadow.mapSize.height.");this.shadow.mapSize.height=e}}});Object.defineProperties(Vn.prototype,{length:{get:function(){console.warn("THREE.BufferAttribute: .length has been deprecated. Use .count instead.");return this.array.length}}});Object.assign(Vn.prototype,{copyIndicesArray:function(){console.error("THREE.BufferAttribute: .copyIndicesArray() has been removed.")},setArray:function(e){console.warn("THREE.BufferAttribute: .setArray has been deprecated. Use BufferGeometry .setAttribute to replace/resize attribute buffers");this.count=e!==undefined?e.length/this.itemSize:0;this.array=e;return this}});Object.assign(li.prototype,{addIndex:function(e){console.warn("THREE.BufferGeometry: .addIndex() has been renamed to .setIndex().");this.setIndex(e)},addDrawCall:function(e,t,r){if(r!==undefined){console.warn("THREE.BufferGeometry: .addDrawCall() no longer supports indexOffset.")}console.warn("THREE.BufferGeometry: .addDrawCall() is now .addGroup().");this.addGroup(e,t)},clearDrawCalls:function(){console.warn("THREE.BufferGeometry: .clearDrawCalls() is now .clearGroups().");this.clearGroups()},computeTangents:function(){console.warn("THREE.BufferGeometry: .computeTangents() has been removed.")},computeOffsets:function(){console.warn("THREE.BufferGeometry: .computeOffsets() has been removed.")}});Object.defineProperties(li.prototype,{drawcalls:{get:function(){console.error("THREE.BufferGeometry: .drawcalls has been renamed to .groups.");return this.groups}},offsets:{get:function(){console.warn("THREE.BufferGeometry: .offsets has been renamed to .groups.");return this.groups}}});Object.assign(jl.prototype,{setArray:function(e){console.warn("THREE.InterleavedBuffer: .setArray has been deprecated. Use BufferGeometry .setAttribute to replace/resize attribute buffers");this.count=e!==undefined?e.length/this.stride:0;this.array=e;return this}});Object.assign(Ih.prototype,{getArrays:function(){console.error("THREE.ExtrudeBufferGeometry: .getArrays() has been removed.")},addShapeList:function(){console.error("THREE.ExtrudeBufferGeometry: .addShapeList() has been removed.")},addShape:function(){console.error("THREE.ExtrudeBufferGeometry: .addShape() has been removed.")}});Object.defineProperties(Cp.prototype,{dynamic:{set:function(){console.warn("THREE.Uniform: .dynamic has been removed. Use object.onBeforeRender() instead.")}},onUpdate:{value:function(){console.warn("THREE.Uniform: .onUpdate() has been removed. Use object.onBeforeRender() instead.");return this}}});Object.defineProperties(Hn.prototype,{wrapAround:{get:function(){console.warn("THREE.Material: .wrapAround has been removed.")},set:function(){console.warn("THREE.Material: .wrapAround has been removed.")}},overdraw:{get:function(){console.warn("THREE.Material: .overdraw has been removed.")},set:function(){console.warn("THREE.Material: .overdraw has been removed.")}},wrapRGB:{get:function(){console.warn("THREE.Material: .wrapRGB has been removed.");return new Fn}},shading:{get:function(){console.error("THREE."+this.type+": .shading has been removed. Use the boolean .flatShading instead.")},set:function(e){console.warn("THREE."+this.type+": .shading has been removed. Use the boolean .flatShading instead.");this.flatShading=e===f}},stencilMask:{get:function(){console.warn("THREE."+this.type+": .stencilMask has been removed. Use .stencilFuncMask instead.");return this.stencilFuncMask},set:function(e){console.warn("THREE."+this.type+": .stencilMask has been removed. Use .stencilFuncMask instead.");this.stencilFuncMask=e}}});Object.defineProperties(of.prototype,{metal:{get:function(){console.warn("THREE.MeshPhongMaterial: .metal has been removed. Use THREE.MeshStandardMaterial instead.");return false},set:function(){console.warn("THREE.MeshPhongMaterial: .metal has been removed. Use THREE.MeshStandardMaterial instead")}}});Object.defineProperties(Hi.prototype,{derivatives:{get:function(){console.warn("THREE.ShaderMaterial: .derivatives has been moved to .extensions.derivatives.");return this.extensions.derivatives},set:function(e){console.warn("THREE. ShaderMaterial: .derivatives has been moved to .extensions.derivatives.");this.extensions.derivatives=e}}});Object.assign(Bl.prototype,{clearTarget:function(e,t,r,n){console.warn("THREE.WebGLRenderer: .clearTarget() has been deprecated. Use .setRenderTarget() and .clear() instead.");this.setRenderTarget(e);this.clear(t,r,n)},animate:function(e){console.warn("THREE.WebGLRenderer: .animate() is now .setAnimationLoop().");this.setAnimationLoop(e)},getCurrentRenderTarget:function(){console.warn("THREE.WebGLRenderer: .getCurrentRenderTarget() is now .getRenderTarget().");return this.getRenderTarget()},getMaxAnisotropy:function(){console.warn("THREE.WebGLRenderer: .getMaxAnisotropy() is now .capabilities.getMaxAnisotropy().");return this.capabilities.getMaxAnisotropy()},getPrecision:function(){console.warn("THREE.WebGLRenderer: .getPrecision() is now .capabilities.precision.");return this.capabilities.precision},resetGLState:function(){console.warn("THREE.WebGLRenderer: .resetGLState() is now .state.reset().");return this.state.reset()},supportsFloatTextures:function(){console.warn("THREE.WebGLRenderer: .supportsFloatTextures() is now .extensions.get( 'OES_texture_float' ).");return this.extensions.get("OES_texture_float")},supportsHalfFloatTextures:function(){console.warn("THREE.WebGLRenderer: .supportsHalfFloatTextures() is now .extensions.get( 'OES_texture_half_float' ).");return this.extensions.get("OES_texture_half_float")},supportsStandardDerivatives:function(){console.warn("THREE.WebGLRenderer: .supportsStandardDerivatives() is now .extensions.get( 'OES_standard_derivatives' ).");return this.extensions.get("OES_standard_derivatives")},supportsCompressedTextureS3TC:function(){console.warn("THREE.WebGLRenderer: .supportsCompressedTextureS3TC() is now .extensions.get( 'WEBGL_compressed_texture_s3tc' ).");return this.extensions.get("WEBGL_compressed_texture_s3tc")},supportsCompressedTexturePVRTC:function(){console.warn("THREE.WebGLRenderer: .supportsCompressedTexturePVRTC() is now .extensions.get( 'WEBGL_compressed_texture_pvrtc' ).");return this.extensions.get("WEBGL_compressed_texture_pvrtc")},supportsBlendMinMax:function(){console.warn("THREE.WebGLRenderer: .supportsBlendMinMax() is now .extensions.get( 'EXT_blend_minmax' ).");return this.extensions.get("EXT_blend_minmax")},supportsVertexTextures:function(){console.warn("THREE.WebGLRenderer: .supportsVertexTextures() is now .capabilities.vertexTextures.");return this.capabilities.vertexTextures},supportsInstancedArrays:function(){console.warn("THREE.WebGLRenderer: .supportsInstancedArrays() is now .extensions.get( 'ANGLE_instanced_arrays' ).");return this.extensions.get("ANGLE_instanced_arrays")},enableScissorTest:function(e){console.warn("THREE.WebGLRenderer: .enableScissorTest() is now .setScissorTest().");this.setScissorTest(e)},initMaterial:function(){console.warn("THREE.WebGLRenderer: .initMaterial() has been removed.")},addPrePlugin:function(){console.warn("THREE.WebGLRenderer: .addPrePlugin() has been removed.")},addPostPlugin:function(){console.warn("THREE.WebGLRenderer: .addPostPlugin() has been removed.")},updateShadowMap:function(){console.warn("THREE.WebGLRenderer: .updateShadowMap() has been removed.")},setFaceCulling:function(){console.warn("THREE.WebGLRenderer: .setFaceCulling() has been removed.")},allocTextureUnit:function(){console.warn("THREE.WebGLRenderer: .allocTextureUnit() has been removed.")},setTexture:function(){console.warn("THREE.WebGLRenderer: .setTexture() has been removed.")},setTexture2D:function(){console.warn("THREE.WebGLRenderer: .setTexture2D() has been removed.")},setTextureCube:function(){console.warn("THREE.WebGLRenderer: .setTextureCube() has been removed.")},getActiveMipMapLevel:function(){console.warn("THREE.WebGLRenderer: .getActiveMipMapLevel() is now .getActiveMipmapLevel().");return this.getActiveMipmapLevel()}});Object.defineProperties(Bl.prototype,{shadowMapEnabled:{get:function(){return this.shadowMap.enabled},set:function(e){console.warn("THREE.WebGLRenderer: .shadowMapEnabled is now .shadowMap.enabled.");this.shadowMap.enabled=e}},shadowMapType:{get:function(){return this.shadowMap.type},set:function(e){console.warn("THREE.WebGLRenderer: .shadowMapType is now .shadowMap.type.");this.shadowMap.type=e}},shadowMapCullFace:{get:function(){console.warn("THREE.WebGLRenderer: .shadowMapCullFace has been removed. Set Material.shadowSide instead.");return undefined},set:function(){console.warn("THREE.WebGLRenderer: .shadowMapCullFace has been removed. Set Material.shadowSide instead.")}},context:{get:function(){console.warn("THREE.WebGLRenderer: .context has been removed. Use .getContext() instead.");return this.getContext()}}});Object.defineProperties(El.prototype,{cullFace:{get:function(){console.warn("THREE.WebGLRenderer: .shadowMap.cullFace has been removed. Set Material.shadowSide instead.");return undefined},set:function(){console.warn("THREE.WebGLRenderer: .shadowMap.cullFace has been removed. Set Material.shadowSide instead.")}},renderReverseSided:{get:function(){console.warn("THREE.WebGLRenderer: .shadowMap.renderReverseSided has been removed. Set Material.shadowSide instead.");return undefined},set:function(){console.warn("THREE.WebGLRenderer: .shadowMap.renderReverseSided has been removed. Set Material.shadowSide instead.")}},renderSingleSided:{get:function(){console.warn("THREE.WebGLRenderer: .shadowMap.renderSingleSided has been removed. Set Material.shadowSide instead.");return undefined},set:function(){console.warn("THREE.WebGLRenderer: .shadowMap.renderSingleSided has been removed. Set Material.shadowSide instead.")}}});Object.defineProperties(Yi.prototype,{activeCubeFace:{set:function(){console.warn("THREE.WebGLRenderTargetCube: .activeCubeFace has been removed. It is now the second parameter of WebGLRenderer.setRenderTarget().")}},activeMipMapLevel:{set:function(){console.warn("THREE.WebGLRenderTargetCube: .activeMipMapLevel has been removed. It is now the third parameter of WebGLRenderer.setRenderTarget().")}}});Object.defineProperties(_r.prototype,{wrapS:{get:function(){console.warn("THREE.WebGLRenderTarget: .wrapS is now .texture.wrapS.");return this.texture.wrapS},set:function(e){console.warn("THREE.WebGLRenderTarget: .wrapS is now .texture.wrapS.");this.texture.wrapS=e}},wrapT:{get:function(){console.warn("THREE.WebGLRenderTarget: .wrapT is now .texture.wrapT.");return this.texture.wrapT},set:function(e){console.warn("THREE.WebGLRenderTarget: .wrapT is now .texture.wrapT.");this.texture.wrapT=e}},magFilter:{get:function(){console.warn("THREE.WebGLRenderTarget: .magFilter is now .texture.magFilter.");return this.texture.magFilter},set:function(e){console.warn("THREE.WebGLRenderTarget: .magFilter is now .texture.magFilter.");this.texture.magFilter=e}},minFilter:{get:function(){console.warn("THREE.WebGLRenderTarget: .minFilter is now .texture.minFilter.");return this.texture.minFilter},set:function(e){console.warn("THREE.WebGLRenderTarget: .minFilter is now .texture.minFilter.");this.texture.minFilter=e}},anisotropy:{get:function(){console.warn("THREE.WebGLRenderTarget: .anisotropy is now .texture.anisotropy.");return this.texture.anisotropy},set:function(e){console.warn("THREE.WebGLRenderTarget: .anisotropy is now .texture.anisotropy.");this.texture.anisotropy=e}},offset:{get:function(){console.warn("THREE.WebGLRenderTarget: .offset is now .texture.offset.");return this.texture.offset},set:function(e){console.warn("THREE.WebGLRenderTarget: .offset is now .texture.offset.");this.texture.offset=e}},repeat:{get:function(){console.warn("THREE.WebGLRenderTarget: .repeat is now .texture.repeat.");return this.texture.repeat},set:function(e){console.warn("THREE.WebGLRenderTarget: .repeat is now .texture.repeat.");this.texture.repeat=e}},format:{get:function(){console.warn("THREE.WebGLRenderTarget: .format is now .texture.format.");return this.texture.format},set:function(e){console.warn("THREE.WebGLRenderTarget: .format is now .texture.format.");this.texture.format=e}},type:{get:function(){console.warn("THREE.WebGLRenderTarget: .type is now .texture.type.");return this.texture.type},set:function(e){console.warn("THREE.WebGLRenderTarget: .type is now .texture.type.");this.texture.type=e}},generateMipmaps:{get:function(){console.warn("THREE.WebGLRenderTarget: .generateMipmaps is now .texture.generateMipmaps.");return this.texture.generateMipmaps},set:function(e){console.warn("THREE.WebGLRenderTarget: .generateMipmaps is now .texture.generateMipmaps.");this.texture.generateMipmaps=e}}});Object.defineProperties(Nl.prototype,{standing:{set:function(){console.warn("THREE.WebVRManager: .standing has been removed.")}},userHeight:{set:function(){console.warn("THREE.WebVRManager: .userHeight has been removed.")}}});sp.prototype.load=function(e){console.warn("THREE.Audio: .load has been deprecated. Use THREE.AudioLoader instead.");var t=this;var r=new Xd;r.load(e,function(e){t.setBuffer(e)});return this};dp.prototype.getData=function(){console.warn("THREE.AudioAnalyser: .getData() is now .getFrequencyData().");return this.getFrequencyData()};Xi.prototype.updateCubeMap=function(e,t){console.warn("THREE.CubeCamera: .updateCubeMap() is now .update().");return this.update(e,t)};var lm={merge:function(e,t,r){console.warn("THREE.GeometryUtils: .merge() has been moved to Geometry. Use geometry.merge( geometry2, matrix, materialIndexOffset ) instead.");var n;if(t.isMesh){t.matrixAutoUpdate&&t.updateMatrix();n=t.matrix;t=t.geometry}e.merge(t,n,r)},center:function(e){console.warn("THREE.GeometryUtils: .center() has been moved to Geometry. Use geometry.center() instead.");return e.center()}};r.GeometryUtils=lm;yr.crossOrigin=undefined;yr.loadTexture=function(e,t,r,n){console.warn("THREE.ImageUtils.loadTexture has been deprecated. Use THREE.TextureLoader() instead.");var i=new jf;i.setCrossOrigin(this.crossOrigin);var a=i.load(e,r,undefined,n);if(t)a.mapping=t;return a};yr.loadTextureCube=function(e,t,r,n){console.warn("THREE.ImageUtils.loadTextureCube has been deprecated. Use THREE.CubeTextureLoader() instead.");var i=new kf;i.setCrossOrigin(this.crossOrigin);var a=i.load(e,r,undefined,n);if(t)a.mapping=t;return a};yr.loadCompressedTexture=function(){console.error("THREE.ImageUtils.loadCompressedTexture has been removed. Use THREE.DDSLoader instead.")};yr.loadCompressedTextureCube=function(){console.error("THREE.ImageUtils.loadCompressedTextureCube has been removed. Use THREE.DDSLoader instead.")};function cm(){console.error("THREE.CanvasRenderer has been removed")}function hm(){console.error("THREE.JSONLoader has been removed.")}var fm={createMultiMaterialObject:function(){console.error("THREE.SceneUtils has been moved to /examples/js/utils/SceneUtils.js")},detach:function(){console.error("THREE.SceneUtils has been moved to /examples/js/utils/SceneUtils.js")},attach:function(){console.error("THREE.SceneUtils has been moved to /examples/js/utils/SceneUtils.js")}};r.SceneUtils=fm;function dm(){console.error("THREE.LensFlare has been moved to /examples/js/objects/Lensflare.js")}if(typeof __THREE_DEVTOOLS__!=="undefined"){__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("register",{detail:{revision:n}}))}},{}]},{},[1]);var _Group=function(){this._tweens={};this._tweensAddedDuringUpdate={}};_Group.prototype={getAll:function(){return Object.keys(this._tweens).map(function(e){return this._tweens[e]}.bind(this))},removeAll:function(){this._tweens={}},add:function(e){this._tweens[e.getId()]=e;this._tweensAddedDuringUpdate[e.getId()]=e},remove:function(e){delete this._tweens[e.getId()];delete this._tweensAddedDuringUpdate[e.getId()]},update:function(e,t){var r=Object.keys(this._tweens);if(r.length===0){return false}e=e!==undefined?e:TWEEN.now();while(r.length>0){this._tweensAddedDuringUpdate={};for(var n=0;n<r.length;n++){var i=this._tweens[r[n]];if(i&&i.update(e)===false){i._isPlaying=false;if(!t){delete this._tweens[r[n]]}}}r=Object.keys(this._tweensAddedDuringUpdate)}return true}};var TWEEN=new _Group;TWEEN.Group=_Group;TWEEN._nextId=0;TWEEN.nextId=function(){return TWEEN._nextId++};if(typeof window==="undefined"&&typeof process!=="undefined"){TWEEN.now=function(){var e=process.hrtime();return e[0]*1e3+e[1]/1e6}}else if(typeof window!=="undefined"&&window.performance!==undefined&&window.performance.now!==undefined){TWEEN.now=window.performance.now.bind(window.performance)}else if(Date.now!==undefined){TWEEN.now=Date.now}else{TWEEN.now=function(){return(new Date).getTime()}}TWEEN.Tween=function(e,t){this._object=e;this._valuesStart={};this._valuesEnd={};this._valuesStartRepeat={};this._duration=1e3;this._repeat=0;this._repeatDelayTime=undefined;this._yoyo=false;this._isPlaying=false;this._reversed=false;this._delayTime=0;this._startTime=null;this._easingFunction=TWEEN.Easing.Linear.None;this._interpolationFunction=TWEEN.Interpolation.Linear;this._chainedTweens=[];this._onStartCallback=null;this._onStartCallbackFired=false;this._onUpdateCallback=null;this._onCompleteCallback=null;this._onStopCallback=null;this._group=t||TWEEN;this._id=TWEEN.nextId()};TWEEN.Tween.prototype={getId:function e(){return this._id},isPlaying:function e(){return this._isPlaying},to:function e(t,r){this._valuesEnd=t;if(r!==undefined){this._duration=r}return this},start:function e(t){this._group.add(this);this._isPlaying=true;this._onStartCallbackFired=false;this._startTime=t!==undefined?typeof t==="string"?TWEEN.now()+parseFloat(t):t:TWEEN.now();this._startTime+=this._delayTime;for(var r in this._valuesEnd){if(this._valuesEnd[r]instanceof Array){if(this._valuesEnd[r].length===0){continue}this._valuesEnd[r]=[this._object[r]].concat(this._valuesEnd[r])}if(this._object[r]===undefined){continue}this._valuesStart[r]=this._object[r];if(this._valuesStart[r]instanceof Array===false){this._valuesStart[r]*=1}this._valuesStartRepeat[r]=this._valuesStart[r]||0}return this},stop:function e(){if(!this._isPlaying){return this}this._group.remove(this);this._isPlaying=false;if(this._onStopCallback!==null){this._onStopCallback(this._object)}this.stopChainedTweens();return this},end:function e(){this.update(this._startTime+this._duration);return this},stopChainedTweens:function e(){for(var t=0,r=this._chainedTweens.length;t<r;t++){this._chainedTweens[t].stop()}},group:function e(e){this._group=e;return this},delay:function e(t){this._delayTime=t;return this},repeat:function e(t){this._repeat=t;return this},repeatDelay:function e(t){this._repeatDelayTime=t;return this},yoyo:function e(t){this._yoyo=t;return this},easing:function e(t){this._easingFunction=t;return this},interpolation:function e(t){this._interpolationFunction=t;return this},chain:function e(){this._chainedTweens=arguments;return this},onStart:function e(t){this._onStartCallback=t;return this},onUpdate:function e(t){this._onUpdateCallback=t;return this},onComplete:function e(t){this._onCompleteCallback=t;return this},onStop:function e(t){this._onStopCallback=t;return this},update:function e(t){var r;var n;var i;if(t<this._startTime){return true}if(this._onStartCallbackFired===false){if(this._onStartCallback!==null){this._onStartCallback(this._object)}this._onStartCallbackFired=true}n=(t-this._startTime)/this._duration;n=this._duration===0||n>1?1:n;i=this._easingFunction(n);for(r in this._valuesEnd){if(this._valuesStart[r]===undefined){continue}var a=this._valuesStart[r]||0;var o=this._valuesEnd[r];if(o instanceof Array){this._object[r]=this._interpolationFunction(o,i)}else{if(typeof o==="string"){if(o.charAt(0)==="+"||o.charAt(0)==="-"){o=a+parseFloat(o)}else{o=parseFloat(o)}}if(typeof o==="number"){this._object[r]=a+(o-a)*i}}}if(this._onUpdateCallback!==null){this._onUpdateCallback(this._object)}if(n===1){if(this._repeat>0){if(isFinite(this._repeat)){this._repeat--}for(r in this._valuesStartRepeat){if(typeof this._valuesEnd[r]==="string"){this._valuesStartRepeat[r]=this._valuesStartRepeat[r]+parseFloat(this._valuesEnd[r])}if(this._yoyo){var s=this._valuesStartRepeat[r];this._valuesStartRepeat[r]=this._valuesEnd[r];this._valuesEnd[r]=s}this._valuesStart[r]=this._valuesStartRepeat[r]}if(this._yoyo){this._reversed=!this._reversed}if(this._repeatDelayTime!==undefined){this._startTime=t+this._repeatDelayTime}else{this._startTime=t+this._delayTime}return true}else{if(this._onCompleteCallback!==null){this._onCompleteCallback(this._object)}for(var u=0,l=this._chainedTweens.length;u<l;u++){this._chainedTweens[u].start(this._startTime+this._duration)}return false}}return true}};TWEEN.Easing={Linear:{None:function(e){return e}},Quadratic:{In:function(e){return e*e},Out:function(e){return e*(2-e)},InOut:function(e){if((e*=2)<1){return.5*e*e}return-.5*(--e*(e-2)-1)}},Cubic:{In:function(e){return e*e*e},Out:function(e){return--e*e*e+1},InOut:function(e){if((e*=2)<1){return.5*e*e*e}return.5*((e-=2)*e*e+2)}},Quartic:{In:function(e){return e*e*e*e},Out:function(e){return 1- --e*e*e*e},InOut:function(e){if((e*=2)<1){return.5*e*e*e*e}return-.5*((e-=2)*e*e*e-2)}},Quintic:{In:function(e){return e*e*e*e*e},Out:function(e){return--e*e*e*e*e+1},InOut:function(e){if((e*=2)<1){return.5*e*e*e*e*e}return.5*((e-=2)*e*e*e*e+2)}},Sinusoidal:{In:function(e){return 1-Math.cos(e*Math.PI/2)},Out:function(e){return Math.sin(e*Math.PI/2)},InOut:function(e){return.5*(1-Math.cos(Math.PI*e))}},Exponential:{In:function(e){return e===0?0:Math.pow(1024,e-1)},Out:function(e){return e===1?1:1-Math.pow(2,-10*e)},InOut:function(e){if(e===0){return 0}if(e===1){return 1}if((e*=2)<1){return.5*Math.pow(1024,e-1)}return.5*(-Math.pow(2,-10*(e-1))+2)}},Circular:{In:function(e){return 1-Math.sqrt(1-e*e)},Out:function(e){return Math.sqrt(1- --e*e)},InOut:function(e){if((e*=2)<1){return-.5*(Math.sqrt(1-e*e)-1)}return.5*(Math.sqrt(1-(e-=2)*e)+1)}},Elastic:{In:function(e){if(e===0){return 0}if(e===1){return 1}return-Math.pow(2,10*(e-1))*Math.sin((e-1.1)*5*Math.PI)},Out:function(e){if(e===0){return 0}if(e===1){return 1}return Math.pow(2,-10*e)*Math.sin((e-.1)*5*Math.PI)+1},InOut:function(e){if(e===0){return 0}if(e===1){return 1}e*=2;if(e<1){return-.5*Math.pow(2,10*(e-1))*Math.sin((e-1.1)*5*Math.PI)}return.5*Math.pow(2,-10*(e-1))*Math.sin((e-1.1)*5*Math.PI)+1}},Back:{In:function(e){var t=1.70158;return e*e*((t+1)*e-t)},Out:function(e){var t=1.70158;return--e*e*((t+1)*e+t)+1},InOut:function(e){var t=1.70158*1.525;if((e*=2)<1){return.5*(e*e*((t+1)*e-t))}return.5*((e-=2)*e*((t+1)*e+t)+2)}},Bounce:{In:function(e){return 1-TWEEN.Easing.Bounce.Out(1-e)},Out:function(e){if(e<1/2.75){return 7.5625*e*e}else if(e<2/2.75){return 7.5625*(e-=1.5/2.75)*e+.75}else if(e<2.5/2.75){return 7.5625*(e-=2.25/2.75)*e+.9375}else{return 7.5625*(e-=2.625/2.75)*e+.984375}},InOut:function(e){if(e<.5){return TWEEN.Easing.Bounce.In(e*2)*.5}return TWEEN.Easing.Bounce.Out(e*2-1)*.5+.5}}};TWEEN.Interpolation={Linear:function(e,t){var r=e.length-1;var n=r*t;var i=Math.floor(n);var a=TWEEN.Interpolation.Utils.Linear;if(t<0){return a(e[0],e[1],n)}if(t>1){return a(e[r],e[r-1],r-n)}return a(e[i],e[i+1>r?r:i+1],n-i)},Bezier:function(e,t){var r=0;var n=e.length-1;var i=Math.pow;var a=TWEEN.Interpolation.Utils.Bernstein;for(var o=0;o<=n;o++){r+=i(1-t,n-o)*i(t,o)*e[o]*a(n,o)}return r},CatmullRom:function(e,t){var r=e.length-1;var n=r*t;var i=Math.floor(n);var a=TWEEN.Interpolation.Utils.CatmullRom;if(e[0]===e[r]){if(t<0){i=Math.floor(n=r*(1+t))}return a(e[(i-1+r)%r],e[i],e[(i+1)%r],e[(i+2)%r],n-i)}else{if(t<0){return e[0]-(a(e[0],e[0],e[1],e[1],-n)-e[0])}if(t>1){return e[r]-(a(e[r],e[r],e[r-1],e[r-1],n-r)-e[r])}return a(e[i?i-1:0],e[i],e[r<i+1?r:i+1],e[r<i+2?r:i+2],n-i)}},Utils:{Linear:function(e,t,r){return(t-e)*r+e},Bernstein:function(e,t){var r=TWEEN.Interpolation.Utils.Factorial;return r(e)/r(t)/r(e-t)},Factorial:function(){var n=[1];return function(e){var t=1;if(n[e]){return n[e]}for(var r=e;r>1;r--){t*=r}n[e]=t;return t}}(),CatmullRom:function(e,t,r,n,i){var a=(r-e)*.5;var o=(n-t)*.5;var s=i*i;var u=i*s;return(2*t-2*r+a+o)*u+(-3*t+3*r-2*a-o)*s+a*i+t}}};(function(e){if(typeof define==="function"&&define.amd){define([],function(){return TWEEN})}else if(typeof module!=="undefined"&&typeof exports==="object"){module.exports=TWEEN}else if(e!==undefined){e.TWEEN=TWEEN}})(this);THREE.OrbitControls=function(e,t){this.object=e;this.domElement=t!==undefined?t:document;this.enabled=true;this.target=new THREE.Vector3;this.minDistance=0;this.maxDistance=Infinity;this.minZoom=0;this.maxZoom=Infinity;this.minPolarAngle=0;this.maxPolarAngle=Math.PI;this.minAzimuthAngle=-Infinity;this.maxAzimuthAngle=Infinity;this.enableDamping=false;this.dampingFactor=.25;this.enableZoom=true;this.zoomSpeed=1;this.enableRotate=true;this.rotateSpeed=1;this.enablePan=true;this.keyPanSpeed=7;this.autoRotate=false;this.autoRotateSpeed=2;this.enableKeys=true;this.keys={LEFT:37,UP:38,RIGHT:39,BOTTOM:40};this.mouseButtons={ORBIT:THREE.MOUSE.LEFT,ZOOM:THREE.MOUSE.MIDDLE,PAN:THREE.MOUSE.RIGHT};this.target0=this.target.clone();this.position0=this.object.position.clone();this.zoom0=this.object.zoom;this.getPolarAngle=function(){return f.phi};this.getAzimuthalAngle=function(){return f.theta};this.saveState=function(){s.target0.copy(s.target);s.position0.copy(s.object.position);s.zoom0=s.object.zoom};this.reset=function(){s.target.copy(s.target0);s.object.position.copy(s.position0);s.object.zoom=s.zoom0;s.object.updateProjectionMatrix();s.dispatchEvent(u);s.update();c=l.NONE};this.update=function(){var r=new THREE.Vector3;var n=(new THREE.Quaternion).setFromUnitVectors(e.up,new THREE.Vector3(0,1,0));var i=n.clone().inverse();var a=new THREE.Vector3;var o=new THREE.Quaternion;return function e(){var t=s.object.position;r.copy(t).sub(s.target);r.applyQuaternion(n);f.setFromVector3(r);if(s.autoRotate&&c===l.NONE){M(T())}f.theta+=d.theta;f.phi+=d.phi;f.theta=Math.max(s.minAzimuthAngle,Math.min(s.maxAzimuthAngle,f.theta));f.phi=Math.max(s.minPolarAngle,Math.min(s.maxPolarAngle,f.phi));f.makeSafe();f.radius*=p;f.radius=Math.max(s.minDistance,Math.min(s.maxDistance,f.radius));s.target.add(v);r.setFromSpherical(f);r.applyQuaternion(i);t.copy(s.target).add(r);s.object.lookAt(s.target);if(s.enableDamping===true){d.theta*=1-s.dampingFactor;d.phi*=1-s.dampingFactor}else{d.set(0,0,0)}p=1;v.set(0,0,0);if(m||a.distanceToSquared(s.object.position)>h||8*(1-o.dot(s.object.quaternion))>h){s.dispatchEvent(u);a.copy(s.object.position);o.copy(s.object.quaternion);m=false;return true}return false}}();this.dispose=function(){s.domElement.removeEventListener("contextmenu",re,false);s.domElement.removeEventListener("mousedown",Y,false);s.domElement.removeEventListener("wheel",K,false);s.domElement.removeEventListener("touchstart",$,false);s.domElement.removeEventListener("touchend",te,false);s.domElement.removeEventListener("touchmove",ee,false);document.removeEventListener("mousemove",Z,false);document.removeEventListener("mouseup",J,false);window.removeEventListener("keydown",Q,false)};var s=this;var u={type:"change"};var r={type:"start"};var n={type:"end"};var l={NONE:-1,ROTATE:0,DOLLY:1,PAN:2,TOUCH_ROTATE:3,TOUCH_DOLLY:4,TOUCH_PAN:5};var c=l.NONE;var h=1e-6;var f=new THREE.Spherical;var d=new THREE.Spherical;var p=1;var v=new THREE.Vector3;var m=false;var i=new THREE.Vector2;var a=new THREE.Vector2;var o=new THREE.Vector2;var g=new THREE.Vector2;var y=new THREE.Vector2;var x=new THREE.Vector2;var b=new THREE.Vector2;var w=new THREE.Vector2;var _=new THREE.Vector2;function T(){return 2*Math.PI/60/60*s.autoRotateSpeed}function E(){return Math.pow(.95,s.zoomSpeed)}function M(e){d.theta-=e}function S(e){d.phi-=e}var A=function(){var n=new THREE.Vector3;return function e(t,r){n.setFromMatrixColumn(r,0);n.multiplyScalar(-t);v.add(n)}}();var R=function(){var n=new THREE.Vector3;return function e(t,r){n.setFromMatrixColumn(r,1);n.multiplyScalar(t);v.add(n)}}();var P=function(){var o=new THREE.Vector3;return function e(t,r){var n=s.domElement===document?s.domElement.body:s.domElement;if(s.object instanceof THREE.PerspectiveCamera){var i=s.object.position;o.copy(i).sub(s.target);var a=o.length();a*=Math.tan(s.object.fov/2*Math.PI/180);A(2*t*a/n.clientHeight,s.object.matrix);R(2*r*a/n.clientHeight,s.object.matrix)}else if(s.object instanceof THREE.OrthographicCamera){A(t*(s.object.right-s.object.left)/s.object.zoom/n.clientWidth,s.object.matrix);R(r*(s.object.top-s.object.bottom)/s.object.zoom/n.clientHeight,s.object.matrix)}else{console.warn("WARNING: OrbitControls.js encountered an unknown camera type - pan disabled.");s.enablePan=false}}}();function C(e){if(s.object instanceof THREE.PerspectiveCamera){p/=e}else if(s.object instanceof THREE.OrthographicCamera){s.object.zoom=Math.max(s.minZoom,Math.min(s.maxZoom,s.object.zoom*e));s.object.updateProjectionMatrix();m=true}else{console.warn("WARNING: OrbitControls.js encountered an unknown camera type - dolly/zoom disabled.");s.enableZoom=false}}function O(e){if(s.object instanceof THREE.PerspectiveCamera){p*=e}else if(s.object instanceof THREE.OrthographicCamera){s.object.zoom=Math.max(s.minZoom,Math.min(s.maxZoom,s.object.zoom/e));s.object.updateProjectionMatrix();m=true}else{console.warn("WARNING: OrbitControls.js encountered an unknown camera type - dolly/zoom disabled.");s.enableZoom=false}}function L(e){i.set(e.clientX,e.clientY)}function I(e){b.set(e.clientX,e.clientY)}function D(e){g.set(e.clientX,e.clientY)}function N(e){a.set(e.clientX,e.clientY);o.subVectors(a,i);var t=s.domElement===document?s.domElement.body:s.domElement;M(2*Math.PI*o.x/t.clientWidth*s.rotateSpeed);S(2*Math.PI*o.y/t.clientHeight*s.rotateSpeed);i.copy(a);s.update()}function F(e){w.set(e.clientX,e.clientY);_.subVectors(w,b);if(_.y>0){C(E())}else if(_.y<0){O(E())}b.copy(w);s.update()}function B(e){y.set(e.clientX,e.clientY);x.subVectors(y,g);P(x.x,x.y);g.copy(y);s.update()}function U(e){}function k(e){if(e.deltaY<0){O(E())}else if(e.deltaY>0){C(E())}s.update()}function j(e){switch(e.keyCode){case s.keys.UP:P(0,s.keyPanSpeed);s.update();break;case s.keys.BOTTOM:P(0,-s.keyPanSpeed);s.update();break;case s.keys.LEFT:P(s.keyPanSpeed,0);s.update();break;case s.keys.RIGHT:P(-s.keyPanSpeed,0);s.update();break}}function z(e){i.set(e.touches[0].pageX,e.touches[0].pageY)}function H(e){var t=e.touches[0].pageX-e.touches[1].pageX;var r=e.touches[0].pageY-e.touches[1].pageY;var n=Math.sqrt(t*t+r*r);b.set(0,n)}function G(e){g.set(e.touches[0].pageX,e.touches[0].pageY)}function V(e){a.set(e.touches[0].pageX,e.touches[0].pageY);o.subVectors(a,i);var t=s.domElement===document?s.domElement.body:s.domElement;M(2*Math.PI*o.x/t.clientWidth*s.rotateSpeed);S(2*Math.PI*o.y/t.clientHeight*s.rotateSpeed);i.copy(a);s.update()}function W(e){var t=e.touches[0].pageX-e.touches[1].pageX;var r=e.touches[0].pageY-e.touches[1].pageY;var n=Math.sqrt(t*t+r*r);w.set(0,n);_.subVectors(w,b);if(_.y>0){O(E())}else if(_.y<0){C(E())}b.copy(w);s.update()}function q(e){y.set(e.touches[0].pageX,e.touches[0].pageY);x.subVectors(y,g);P(x.x,x.y);g.copy(y);s.update()}function X(e){}function Y(e){if(s.enabled===false)return;e.preventDefault();switch(e.button){case s.mouseButtons.ORBIT:if(s.enableRotate===false)return;L(e);c=l.ROTATE;break;case s.mouseButtons.ZOOM:if(s.enableZoom===false)return;I(e);c=l.DOLLY;break;case s.mouseButtons.PAN:if(s.enablePan===false)return;D(e);c=l.PAN;break}if(c!==l.NONE){document.addEventListener("mousemove",Z,false);document.addEventListener("mouseup",J,false);s.dispatchEvent(r)}}function Z(e){if(s.enabled===false)return;e.preventDefault();switch(c){case l.ROTATE:if(s.enableRotate===false)return;N(e);break;case l.DOLLY:if(s.enableZoom===false)return;F(e);break;case l.PAN:if(s.enablePan===false)return;B(e);break}}function J(e){if(s.enabled===false)return;U(e);document.removeEventListener("mousemove",Z,false);document.removeEventListener("mouseup",J,false);s.dispatchEvent(n);c=l.NONE}function K(e){if(s.enabled===false||s.enableZoom===false||c!==l.NONE&&c!==l.ROTATE)return;e.preventDefault();e.stopPropagation();k(e);s.dispatchEvent(r);s.dispatchEvent(n)}function Q(e){if(s.enabled===false||s.enableKeys===false||s.enablePan===false)return;j(e)}function $(e){if(s.enabled===false)return;switch(e.touches.length){case 1:if(s.enableRotate===false)return;z(e);c=l.TOUCH_ROTATE;break;case 2:if(s.enableZoom===false)return;H(e);c=l.TOUCH_DOLLY;break;case 3:if(s.enablePan===false)return;G(e);c=l.TOUCH_PAN;break;default:c=l.NONE}if(c!==l.NONE){s.dispatchEvent(r)}}function ee(e){if(s.enabled===false)return;e.preventDefault();e.stopPropagation();switch(e.touches.length){case 1:if(s.enableRotate===false)return;if(c!==l.TOUCH_ROTATE)return;V(e);break;case 2:if(s.enableZoom===false)return;if(c!==l.TOUCH_DOLLY)return;W(e);break;case 3:if(s.enablePan===false)return;if(c!==l.TOUCH_PAN)return;q(e);break;default:c=l.NONE}}function te(e){if(s.enabled===false)return;X(e);s.dispatchEvent(n);c=l.NONE}function re(e){if(s.enabled===false)return;e.preventDefault()}s.domElement.addEventListener("contextmenu",re,false);s.domElement.addEventListener("mousedown",Y,false);s.domElement.addEventListener("wheel",K,false);s.domElement.addEventListener("touchstart",$,false);s.domElement.addEventListener("touchend",te,false);s.domElement.addEventListener("touchmove",ee,false);window.addEventListener("keydown",Q,false);this.update()};THREE.OrbitControls.prototype=Object.create(THREE.EventDispatcher.prototype);THREE.OrbitControls.prototype.constructor=THREE.OrbitControls;Object.defineProperties(THREE.OrbitControls.prototype,{center:{get:function(){console.warn("THREE.OrbitControls: .center has been renamed to .target");return this.target}},noZoom:{get:function(){console.warn("THREE.OrbitControls: .noZoom has been deprecated. Use .enableZoom instead.");return!this.enableZoom},set:function(e){console.warn("THREE.OrbitControls: .noZoom has been deprecated. Use .enableZoom instead.");this.enableZoom=!e}},noRotate:{get:function(){console.warn("THREE.OrbitControls: .noRotate has been deprecated. Use .enableRotate instead.");return!this.enableRotate},set:function(e){console.warn("THREE.OrbitControls: .noRotate has been deprecated. Use .enableRotate instead.");this.enableRotate=!e}},noPan:{get:function(){console.warn("THREE.OrbitControls: .noPan has been deprecated. Use .enablePan instead.");return!this.enablePan},set:function(e){console.warn("THREE.OrbitControls: .noPan has been deprecated. Use .enablePan instead.");this.enablePan=!e}},noKeys:{get:function(){console.warn("THREE.OrbitControls: .noKeys has been deprecated. Use .enableKeys instead.");return!this.enableKeys},set:function(e){console.warn("THREE.OrbitControls: .noKeys has been deprecated. Use .enableKeys instead.");this.enableKeys=!e}},staticMoving:{get:function(){console.warn("THREE.OrbitControls: .staticMoving has been deprecated. Use .enableDamping instead.");return!this.enableDamping},set:function(e){console.warn("THREE.OrbitControls: .staticMoving has been deprecated. Use .enableDamping instead.");this.enableDamping=!e}},dynamicDampingFactor:{get:function(){console.warn("THREE.OrbitControls: .dynamicDampingFactor has been renamed. Use .dampingFactor instead.");return this.dampingFactor},set:function(e){console.warn("THREE.OrbitControls: .dynamicDampingFactor has been renamed. Use .dampingFactor instead.");this.dampingFactor=e}}});(function(){function c(a,o,s){function u(r,e){if(!o[r]){if(!a[r]){var t="function"==typeof require&&require;if(!e&&t)return t(r,!0);if(l)return l(r,!0);var n=new Error("Cannot find module '"+r+"'");throw n.code="MODULE_NOT_FOUND",n}var i=o[r]={exports:{}};a[r][0].call(i.exports,function(e){var t=a[r][1][e];return u(t||e)},i,i.exports,c,a,o,s)}return o[r].exports}for(var l="function"==typeof require&&require,e=0;e<s.length;e++)u(s[e]);return u}return c})()({1:[function(e,t,r){"use strict";e(2);var n=i(e(15));function i(e){return e&&e.__esModule?e:{default:e}}if(n["default"]._babelPolyfill&&typeof console!=="undefined"&&console.warn){console.warn("@babel/polyfill is loaded more than once on this page. This is probably not desirable/intended "+"and may have consequences if different versions of the polyfills are applied sequentially. "+"If you do need to load the polyfill more than once, use @babel/polyfill/noConflict "+"instead to bypass the warning.")}n["default"]._babelPolyfill=true},{15:15,2:2}],2:[function(e,t,r){"use strict";e(3);e(5);e(4);e(11);e(10);e(13);e(12);e(14);e(7);e(8);e(6);e(9);e(306);e(307)},{10:10,11:11,12:12,13:13,14:14,3:3,306:306,307:307,4:4,5:5,6:6,7:7,8:8,9:9}],3:[function(e,t,r){e(278);e(214);e(216);e(215);e(218);e(220);e(225);e(219);e(217);e(227);e(226);e(222);e(223);e(221);e(213);e(224);e(228);e(229);e(180);e(182);e(181);e(231);e(230);e(201);e(211);e(212);e(202);e(203);e(204);e(205);e(206);e(207);e(208);e(209);e(210);e(184);e(185);e(186);e(187);e(188);e(189);e(190);e(191);e(192);e(193);e(194);e(195);e(196);e(197);e(198);e(199);e(200);e(265);e(270);e(277);e(268);e(260);e(261);e(266);e(271);e(273);e(256);e(257);e(258);e(259);e(262);e(263);e(264);e(267);e(269);e(272);e(274);e(275);e(276);e(175);e(177);e(176);e(179);e(178);e(163);e(161);e(168);e(165);e(171);e(173);e(160);e(167);e(157);e(172);e(155);e(170);e(169);e(162);e(166);e(154);e(156);e(159);e(158);e(174);e(164);e(247);e(248);e(254);e(249);e(250);e(251);e(252);e(253);e(232);e(183);e(255);e(290);e(291);e(279);e(280);e(285);e(288);e(289);e(283);e(286);e(284);e(287);e(281);e(282);e(233);e(234);e(235);e(236);e(237);e(240);e(238);e(239);e(241);e(242);e(243);e(244);e(246);e(245);t.exports=e(52)},{154:154,155:155,156:156,157:157,158:158,159:159,160:160,161:161,162:162,163:163,164:164,165:165,166:166,167:167,168:168,169:169,170:170,171:171,172:172,173:173,174:174,175:175,176:176,177:177,178:178,179:179,180:180,181:181,182:182,183:183,184:184,185:185,186:186,187:187,188:188,189:189,190:190,191:191,192:192,193:193,194:194,195:195,196:196,197:197,198:198,199:199,200:200,201:201,202:202,203:203,204:204,205:205,206:206,207:207,208:208,209:209,210:210,211:211,212:212,213:213,214:214,215:215,216:216,217:217,218:218,219:219,220:220,221:221,222:222,223:223,224:224,225:225,226:226,227:227,228:228,229:229,230:230,231:231,232:232,233:233,234:234,235:235,236:236,237:237,238:238,239:239,240:240,241:241,242:242,243:243,244:244,245:245,246:246,247:247,248:248,249:249,250:250,251:251,252:252,253:253,254:254,255:255,256:256,257:257,258:258,259:259,260:260,261:261,262:262,263:263,264:264,265:265,266:266,267:267,268:268,269:269,270:270,271:271,272:272,273:273,274:274,275:275,276:276,277:277,278:278,279:279,280:280,281:281,282:282,283:283,284:284,285:285,286:286,287:287,288:288,289:289,290:290,291:291,52:52}],4:[function(e,t,r){e(292);t.exports=e(52).Array.flatMap},{292:292,52:52}],5:[function(e,t,r){e(293);t.exports=e(52).Array.includes},{293:293,52:52}],6:[function(e,t,r){e(294);t.exports=e(52).Object.entries},{294:294,52:52}],7:[function(e,t,r){e(295);t.exports=e(52).Object.getOwnPropertyDescriptors},{295:295,52:52}],8:[function(e,t,r){e(296);t.exports=e(52).Object.values},{296:296,52:52}],9:[function(e,t,r){"use strict";e(232);e(297);t.exports=e(52).Promise["finally"]},{232:232,297:297,52:52}],10:[function(e,t,r){e(298);t.exports=e(52).String.padEnd},{298:298,52:52}],11:[function(e,t,r){e(299);t.exports=e(52).String.padStart},{299:299,52:52}],12:[function(e,t,r){e(301);t.exports=e(52).String.trimRight},{301:301,52:52}],13:[function(e,t,r){e(300);t.exports=e(52).String.trimLeft},{300:300,52:52}],14:[function(e,t,r){e(302);t.exports=e(151).f("asyncIterator")},{151:151,302:302}],15:[function(e,t,r){e(32);t.exports=e(18).global},{18:18,32:32}],16:[function(e,t,r){t.exports=function(e){if(typeof e!="function")throw TypeError(e+" is not a function!");return e}},{}],17:[function(e,t,r){var n=e(28);t.exports=function(e){if(!n(e))throw TypeError(e+" is not an object!");return e}},{28:28}],18:[function(e,t,r){var n=t.exports={version:"2.6.9"};if(typeof __e=="number")__e=n},{}],19:[function(e,t,r){var a=e(16);t.exports=function(n,i,e){a(n);if(i===undefined)return n;switch(e){case 1:return function(e){return n.call(i,e)};case 2:return function(e,t){return n.call(i,e,t)};case 3:return function(e,t,r){return n.call(i,e,t,r)}}return function(){return n.apply(i,arguments)}}},{16:16}],20:[function(e,t,r){t.exports=!e(23)(function(){return Object.defineProperty({},"a",{get:function(){return 7}}).a!=7})},{23:23}],21:[function(e,t,r){var n=e(28);var i=e(24).document;var a=n(i)&&n(i.createElement);t.exports=function(e){return a?i.createElement(e):{}}},{24:24,28:28}],22:[function(e,t,r){var v=e(24);var m=e(18);var g=e(19);var y=e(26);var x=e(25);var b="prototype";var w=function(e,t,r){var n=e&w.F;var i=e&w.G;var a=e&w.S;var o=e&w.P;var s=e&w.B;var u=e&w.W;var l=i?m:m[t]||(m[t]={});var c=l[b];var h=i?v:a?v[t]:(v[t]||{})[b];var f,d,p;if(i)r=t;for(f in r){d=!n&&h&&h[f]!==undefined;if(d&&x(l,f))continue;p=d?h[f]:r[f];l[f]=i&&typeof h[f]!="function"?r[f]:s&&d?g(p,v):u&&h[f]==p?function(n){var e=function(e,t,r){if(this instanceof n){switch(arguments.length){case 0:return new n;case 1:return new n(e);case 2:return new n(e,t)}return new n(e,t,r)}return n.apply(this,arguments)};e[b]=n[b];return e}(p):o&&typeof p=="function"?g(Function.call,p):p;if(o){(l.virtual||(l.virtual={}))[f]=p;if(e&w.R&&c&&!c[f])y(c,f,p)}}};w.F=1;w.G=2;w.S=4;w.P=8;w.B=16;w.W=32;w.U=64;w.R=128;t.exports=w},{18:18,19:19,24:24,25:25,26:26}],23:[function(e,t,r){t.exports=function(e){try{return!!e()}catch(e){return true}}},{}],24:[function(e,t,r){var n=t.exports=typeof window!="undefined"&&window.Math==Math?window:typeof self!="undefined"&&self.Math==Math?self:Function("return this")();if(typeof __g=="number")__g=n},{}],25:[function(e,t,r){var n={}.hasOwnProperty;t.exports=function(e,t){return n.call(e,t)}},{}],26:[function(e,t,r){var n=e(29);var i=e(30);t.exports=e(20)?function(e,t,r){return n.f(e,t,i(1,r))}:function(e,t,r){e[t]=r;return e}},{20:20,29:29,30:30}],27:[function(e,t,r){t.exports=!e(20)&&!e(23)(function(){return Object.defineProperty(e(21)("div"),"a",{get:function(){return 7}}).a!=7})},{20:20,21:21,23:23}],28:[function(e,t,r){t.exports=function(e){return typeof e==="object"?e!==null:typeof e==="function"}},{}],29:[function(e,t,r){var i=e(17);var a=e(27);var o=e(31);var s=Object.defineProperty;r.f=e(20)?Object.defineProperty:function e(t,r,n){i(t);r=o(r,true);i(n);if(a)try{return s(t,r,n)}catch(e){}if("get"in n||"set"in n)throw TypeError("Accessors not supported!");if("value"in n)t[r]=n.value;return t}},{17:17,20:20,27:27,31:31}],30:[function(e,t,r){t.exports=function(e,t){return{enumerable:!(e&1),configurable:!(e&2),writable:!(e&4),value:t}}},{}],31:[function(e,t,r){var i=e(28);t.exports=function(e,t){if(!i(e))return e;var r,n;if(t&&typeof(r=e.toString)=="function"&&!i(n=r.call(e)))return n;if(typeof(r=e.valueOf)=="function"&&!i(n=r.call(e)))return n;if(!t&&typeof(r=e.toString)=="function"&&!i(n=r.call(e)))return n;throw TypeError("Can't convert object to primitive value")}},{28:28}],32:[function(e,t,r){var n=e(22);n(n.G,{global:e(24)})},{22:22,24:24}],33:[function(e,t,r){arguments[4][16][0].apply(r,arguments)},{16:16}],34:[function(e,t,r){var n=e(48);t.exports=function(e,t){if(typeof e!="number"&&n(e)!="Number")throw TypeError(t);return+e}},{48:48}],35:[function(e,t,r){var n=e(152)("unscopables");var i=Array.prototype;if(i[n]==undefined)e(72)(i,n,{});t.exports=function(e){i[n][e]=true}},{152:152,72:72}],36:[function(e,t,r){"use strict";var n=e(129)(true);t.exports=function(e,t,r){return t+(r?n(e,t).length:1)}},{129:129}],37:[function(e,t,r){t.exports=function(e,t,r,n){if(!(e instanceof t)||n!==undefined&&n in e){throw TypeError(r+": incorrect invocation!")}return e}},{}],38:[function(e,t,r){arguments[4][17][0].apply(r,arguments)},{17:17,81:81}],39:[function(e,t,r){"use strict";var c=e(142);var h=e(137);var f=e(141);t.exports=[].copyWithin||function e(t,r){var n=c(this);var i=f(n.length);var a=h(t,i);var o=h(r,i);var s=arguments.length>2?arguments[2]:undefined;var u=Math.min((s===undefined?i:h(s,i))-o,i-a);var l=1;if(o<a&&a<o+u){l=-1;o+=u-1;a+=u-1}while(u-- >0){if(o in n)n[a]=n[o];else delete n[a];a+=l;o+=l}return n}},{137:137,141:141,142:142}],40:[function(e,t,r){"use strict";var u=e(142);var l=e(137);var c=e(141);t.exports=function e(t){var r=u(this);var n=c(r.length);var i=arguments.length;var a=l(i>1?arguments[1]:undefined,n);var o=i>2?arguments[2]:undefined;var s=o===undefined?n:l(o,n);while(s>a)r[a++]=t;return r}},{137:137,141:141,142:142}],41:[function(e,t,r){var u=e(140);var l=e(141);var c=e(137);t.exports=function(s){return function(e,t,r){var n=u(e);var i=l(n.length);var a=c(r,i);var o;if(s&&t!=t)while(i>a){o=n[a++];if(o!=o)return true}else for(;i>a;a++)if(s||a in n){if(n[a]===t)return s||a||0}return!s&&-1}}},{137:137,140:140,141:141}],42:[function(e,t,r){var x=e(54);var b=e(77);var w=e(142);var _=e(141);var n=e(45);t.exports=function(h,e){var f=h==1;var d=h==2;var p=h==3;var v=h==4;var m=h==6;var g=h==5||m;var y=e||n;return function(e,t,r){var n=w(e);var i=b(n);var a=x(t,r,3);var o=_(i.length);var s=0;var u=f?y(e,o):d?y(e,0):undefined;var l,c;for(;o>s;s++)if(g||s in i){l=i[s];c=a(l,s,n);if(h){if(f)u[s]=c;else if(c)switch(h){case 3:return true;case 5:return l;case 6:return s;case 2:u.push(l)}else if(v)return false}}return m?-1:p||v?v:u}}},{141:141,142:142,45:45,54:54,77:77}],43:[function(e,t,r){var c=e(33);var h=e(142);var f=e(77);var d=e(141);t.exports=function(e,t,r,n,i){c(t);var a=h(e);var o=f(a);var s=d(a.length);var u=i?s-1:0;var l=i?-1:1;if(r<2)for(;;){if(u in o){n=o[u];u+=l;break}u+=l;if(i?u<0:s<=u){throw TypeError("Reduce of empty array with no initial value")}}for(;i?u>=0:s>u;u+=l)if(u in o){n=t(n,o[u],u,a)}return n}},{141:141,142:142,33:33,77:77}],44:[function(e,t,r){var n=e(81);var i=e(79);var a=e(152)("species");t.exports=function(e){var t;if(i(e)){t=e.constructor;if(typeof t=="function"&&(t===Array||i(t.prototype)))t=undefined;if(n(t)){t=t[a];if(t===null)t=undefined}}return t===undefined?Array:t}},{152:152,79:79,81:81}],45:[function(e,t,r){var n=e(44);t.exports=function(e,t){return new(n(e))(t)}},{44:44}],46:[function(e,t,r){"use strict";var a=e(33);var o=e(81);var s=e(76);var u=[].slice;var l={};var c=function(e,t,r){if(!(t in l)){for(var n=[],i=0;i<t;i++)n[i]="a["+i+"]";l[t]=Function("F,a","return new F("+n.join(",")+")")}return l[t](e,r)};t.exports=Function.bind||function e(t){var r=a(this);var n=u.call(arguments,1);var i=function(){var e=n.concat(u.call(arguments));return this instanceof i?c(r,e.length,e):s(r,e,t)};if(o(r.prototype))i.prototype=r.prototype;return i}},{33:33,76:76,81:81}],47:[function(e,t,r){var i=e(48);var a=e(152)("toStringTag");var o=i(function(){return arguments}())=="Arguments";var s=function(e,t){try{return e[t]}catch(e){}};t.exports=function(e){var t,r,n;return e===undefined?"Undefined":e===null?"Null":typeof(r=s(t=Object(e),a))=="string"?r:o?i(t):(n=i(t))=="Object"&&typeof t.callee=="function"?"Arguments":n}},{152:152,48:48}],48:[function(e,t,r){var n={}.toString;t.exports=function(e){return n.call(e).slice(8,-1)}},{}],49:[function(e,t,r){"use strict";var o=e(99).f;var s=e(98);var u=e(117);var l=e(54);var c=e(37);var h=e(68);var n=e(85);var i=e(87);var a=e(123);var f=e(58);var d=e(94).fastKey;var p=e(149);var v=f?"_s":"size";var m=function(e,t){var r=d(t);var n;if(r!=="F")return e._i[r];for(n=e._f;n;n=n.n){if(n.k==t)return n}};t.exports={getConstructor:function(e,a,r,n){var i=e(function(e,t){c(e,i,a,"_i");e._t=a;e._i=s(null);e._f=undefined;e._l=undefined;e[v]=0;if(t!=undefined)h(t,r,e[n],e)});u(i.prototype,{clear:function e(){for(var t=p(this,a),r=t._i,n=t._f;n;n=n.n){n.r=true;if(n.p)n.p=n.p.n=undefined;delete r[n.i]}t._f=t._l=undefined;t[v]=0},delete:function(e){var t=p(this,a);var r=m(t,e);if(r){var n=r.n;var i=r.p;delete t._i[r.i];r.r=true;if(i)i.n=n;if(n)n.p=i;if(t._f==r)t._f=n;if(t._l==r)t._l=i;t[v]--}return!!r},forEach:function e(t){p(this,a);var r=l(t,arguments.length>1?arguments[1]:undefined,3);var n;while(n=n?n.n:this._f){r(n.v,n.k,this);while(n&&n.r)n=n.p}},has:function e(t){return!!m(p(this,a),t)}});if(f)o(i.prototype,"size",{get:function(){return p(this,a)[v]}});return i},def:function(e,t,r){var n=m(e,t);var i,a;if(n){n.v=r}else{e._l=n={i:a=d(t,true),k:t,v:r,p:i=e._l,n:undefined,r:false};if(!e._f)e._f=n;if(i)i.n=n;e[v]++;if(a!=="F")e._i[a]=n}return e},getEntry:m,setStrong:function(e,r,t){n(e,r,function(e,t){this._t=p(e,r);this._k=t;this._l=undefined},function(){var e=this;var t=e._k;var r=e._l;while(r&&r.r)r=r.p;if(!e._t||!(e._l=r=r?r.n:e._t._f)){e._t=undefined;return i(1)}if(t=="keys")return i(0,r.k);if(t=="values")return i(0,r.v);return i(0,[r.k,r.v])},t?"entries":"values",!t,true);a(r)}}},{117:117,123:123,149:149,37:37,54:54,58:58,68:68,85:85,87:87,94:94,98:98,99:99}],50:[function(e,t,r){"use strict";var o=e(117);var s=e(94).getWeak;var i=e(38);var u=e(81);var l=e(37);var c=e(68);var n=e(42);var h=e(71);var f=e(149);var a=n(5);var d=n(6);var p=0;var v=function(e){return e._l||(e._l=new m)};var m=function(){this.a=[]};var g=function(e,t){return a(e.a,function(e){return e[0]===t})};m.prototype={get:function(e){var t=g(this,e);if(t)return t[1]},has:function(e){return!!g(this,e)},set:function(e,t){var r=g(this,e);if(r)r[1]=t;else this.a.push([e,t])},delete:function(t){var e=d(this.a,function(e){return e[0]===t});if(~e)this.a.splice(e,1);return!!~e}};t.exports={getConstructor:function(e,n,r,i){var a=e(function(e,t){l(e,a,n,"_i");e._t=n;e._i=p++;e._l=undefined;if(t!=undefined)c(t,r,e[i],e)});o(a.prototype,{delete:function(e){if(!u(e))return false;var t=s(e);if(t===true)return v(f(this,n))["delete"](e);return t&&h(t,this._i)&&delete t[this._i]},has:function e(t){if(!u(t))return false;var r=s(t);if(r===true)return v(f(this,n)).has(t);return r&&h(r,this._i)}});return a},def:function(e,t,r){var n=s(i(t),true);if(n===true)v(e).set(t,r);else n[e._i]=r;return e},ufstore:v}},{117:117,149:149,37:37,38:38,42:42,68:68,71:71,81:81,94:94}],51:[function(e,t,r){"use strict";var g=e(70);var y=e(62);var x=e(118);var b=e(117);var w=e(94);var _=e(68);var T=e(37);var E=e(81);var M=e(64);var S=e(86);var A=e(124);var R=e(75);t.exports=function(n,e,t,r,i,a){var o=g[n];var s=o;var u=i?"set":"add";var l=s&&s.prototype;var c={};var h=function(e){var n=l[e];x(l,e,e=="delete"?function(e){return a&&!E(e)?false:n.call(this,e===0?0:e)}:e=="has"?function e(t){return a&&!E(t)?false:n.call(this,t===0?0:t)}:e=="get"?function e(t){return a&&!E(t)?undefined:n.call(this,t===0?0:t)}:e=="add"?function e(t){n.call(this,t===0?0:t);return this}:function e(t,r){n.call(this,t===0?0:t,r);return this})};if(typeof s!="function"||!(a||l.forEach&&!M(function(){(new s).entries().next()}))){s=r.getConstructor(e,n,i,u);b(s.prototype,t);w.NEED=true}else{var f=new s;var d=f[u](a?{}:-0,1)!=f;var p=M(function(){f.has(1)});var v=S(function(e){new s(e)});var m=!a&&M(function(){var e=new s;var t=5;while(t--)e[u](t,t);return!e.has(-0)});if(!v){s=e(function(e,t){T(e,s,n);var r=R(new o,e,s);if(t!=undefined)_(t,i,r[u],r);return r});s.prototype=l;l.constructor=s}if(p||m){h("delete");h("has");i&&h("get")}if(m||d)h(u);if(a&&l.clear)delete l.clear}A(s,n);c[n]=s;y(y.G+y.W+y.F*(s!=o),c);if(!a)r.setStrong(s,n,i);return s}},{117:117,118:118,124:124,37:37,62:62,64:64,68:68,70:70,75:75,81:81,86:86,94:94}],52:[function(e,t,r){arguments[4][18][0].apply(r,arguments)},{18:18}],53:[function(e,t,r){"use strict";var n=e(99);var i=e(116);t.exports=function(e,t,r){if(t in e)n.f(e,t,i(0,r));else e[t]=r}},{116:116,99:99}],54:[function(e,t,r){arguments[4][19][0].apply(r,arguments)},{19:19,33:33}],55:[function(e,t,r){"use strict";var n=e(64);var a=Date.prototype.getTime;var i=Date.prototype.toISOString;var o=function(e){return e>9?e:"0"+e};t.exports=n(function(){return i.call(new Date(-5e13-1))!="0385-07-25T07:06:39.999Z"})||!n(function(){i.call(new Date(NaN))})?function e(){if(!isFinite(a.call(this)))throw RangeError("Invalid time value");var t=this;var r=t.getUTCFullYear();var n=t.getUTCMilliseconds();var i=r<0?"-":r>9999?"+":"";return i+("00000"+Math.abs(r)).slice(i?-6:-4)+"-"+o(t.getUTCMonth()+1)+"-"+o(t.getUTCDate())+"T"+o(t.getUTCHours())+":"+o(t.getUTCMinutes())+":"+o(t.getUTCSeconds())+"."+(n>99?n:"0"+o(n))+"Z"}:i},{64:64}],56:[function(e,t,r){"use strict";var n=e(38);var i=e(143);var a="number";t.exports=function(e){if(e!=="string"&&e!==a&&e!=="default")throw TypeError("Incorrect hint");return i(n(this),e!=a)}},{143:143,38:38}],57:[function(e,t,r){t.exports=function(e){if(e==undefined)throw TypeError("Can't call method on  "+e);return e}},{}],58:[function(e,t,r){arguments[4][20][0].apply(r,arguments)},{20:20,64:64}],59:[function(e,t,r){arguments[4][21][0].apply(r,arguments)},{21:21,70:70,81:81}],60:[function(e,t,r){t.exports="constructor,hasOwnProperty,isPrototypeOf,propertyIsEnumerable,toLocaleString,toString,valueOf".split(",")},{}],61:[function(e,t,r){var s=e(107);var u=e(104);var l=e(108);t.exports=function(e){var t=s(e);var r=u.f;if(r){var n=r(e);var i=l.f;var a=0;var o;while(n.length>a)if(i.call(e,o=n[a++]))t.push(o)}return t}},{104:104,107:107,108:108}],62:[function(e,t,r){var v=e(70);var m=e(52);var g=e(72);var y=e(118);var x=e(54);var b="prototype";var w=function(e,t,r){var n=e&w.F;var i=e&w.G;var a=e&w.S;var o=e&w.P;var s=e&w.B;var u=i?v:a?v[t]||(v[t]={}):(v[t]||{})[b];var l=i?m:m[t]||(m[t]={});var c=l[b]||(l[b]={});var h,f,d,p;if(i)r=t;for(h in r){f=!n&&u&&u[h]!==undefined;d=(f?u:r)[h];p=s&&f?x(d,v):o&&typeof d=="function"?x(Function.call,d):d;if(u)y(u,h,d,e&w.U);if(l[h]!=d)g(l,h,p);if(o&&c[h]!=d)c[h]=d}};v.core=m;w.F=1;w.G=2;w.S=4;w.P=8;w.B=16;w.W=32;w.U=64;w.R=128;t.exports=w},{118:118,52:52,54:54,70:70,72:72}],63:[function(e,t,r){var n=e(152)("match");t.exports=function(t){var r=/./;try{"/./"[t](r)}catch(e){try{r[n]=false;return!"/./"[t](r)}catch(e){}}return true}},{152:152}],64:[function(e,t,r){arguments[4][23][0].apply(r,arguments)},{23:23}],65:[function(e,t,r){"use strict";e(248);var c=e(118);var h=e(72);var f=e(64);var d=e(57);var p=e(152);var v=e(120);var m=p("species");var g=!f(function(){var e=/./;e.exec=function(){var e=[];e.groups={a:"7"};return e};return"".replace(e,"$<a>")!=="7"});var y=function(){var e=/(?:)/;var t=e.exec;e.exec=function(){return t.apply(this,arguments)};var r="ab".split(e);return r.length===2&&r[0]==="a"&&r[1]==="b"}();t.exports=function(r,e,t){var n=p(r);var o=!f(function(){var e={};e[n]=function(){return 7};return""[r](e)!=7});var i=o?!f(function(){var e=false;var t=/a/;t.exec=function(){e=true;return null};if(r==="split"){t.constructor={};t.constructor[m]=function(){return t}}t[n]("");return!e}):undefined;if(!o||!i||r==="replace"&&!g||r==="split"&&!y){var s=/./[n];var a=t(d,n,""[r],function e(t,r,n,i,a){if(r.exec===v){if(o&&!a){return{done:true,value:s.call(r,n,i)}}return{done:true,value:t.call(n,r,i)}}return{done:false}});var u=a[0];var l=a[1];c(String.prototype,r,u);h(RegExp.prototype,n,e==2?function(e,t){return l.call(e,this,t)}:function(e){return l.call(e,this)})}}},{118:118,120:120,152:152,248:248,57:57,64:64,72:72}],66:[function(e,t,r){"use strict";var n=e(38);t.exports=function(){var e=n(this);var t="";if(e.global)t+="g";if(e.ignoreCase)t+="i";if(e.multiline)t+="m";if(e.unicode)t+="u";if(e.sticky)t+="y";return t}},{38:38}],67:[function(e,t,r){"use strict";var d=e(79);var p=e(81);var v=e(141);var m=e(54);var g=e(152)("isConcatSpreadable");function y(e,t,r,n,i,a,o,s){var u=i;var l=0;var c=o?m(o,s,3):false;var h,f;while(l<n){if(l in r){h=c?c(r[l],l,t):r[l];f=false;if(p(h)){f=h[g];f=f!==undefined?!!f:d(h)}if(f&&a>0){u=y(e,t,h,v(h.length),u,a-1)-1}else{if(u>=9007199254740991)throw TypeError();e[u]=h}u++}l++}return u}t.exports=y},{141:141,152:152,54:54,79:79,81:81}],68:[function(e,t,r){var f=e(54);var d=e(83);var p=e(78);var v=e(38);var m=e(141);var g=e(153);var y={};var x={};var r=t.exports=function(e,t,r,n,i){var a=i?function(){return e}:g(e);var o=f(r,n,t?2:1);var s=0;var u,l,c,h;if(typeof a!="function")throw TypeError(e+" is not iterable!");if(p(a))for(u=m(e.length);u>s;s++){h=t?o(v(l=e[s])[0],l[1]):o(e[s]);if(h===y||h===x)return h}else for(c=a.call(e);!(l=c.next()).done;){h=d(c,o,l.value,t);if(h===y||h===x)return h}};r.BREAK=y;r.RETURN=x},{141:141,153:153,38:38,54:54,78:78,83:83}],69:[function(e,t,r){t.exports=e(126)("native-function-to-string",Function.toString)},{126:126}],70:[function(e,t,r){arguments[4][24][0].apply(r,arguments)},{24:24}],71:[function(e,t,r){arguments[4][25][0].apply(r,arguments)},{25:25}],72:[function(e,t,r){arguments[4][26][0].apply(r,arguments)},{116:116,26:26,58:58,99:99}],73:[function(e,t,r){var n=e(70).document;t.exports=n&&n.documentElement},{70:70}],74:[function(e,t,r){arguments[4][27][0].apply(r,arguments)},{27:27,58:58,59:59,64:64}],75:[function(e,t,r){var a=e(81);var o=e(122).set;t.exports=function(e,t,r){var n=t.constructor;var i;if(n!==r&&typeof n=="function"&&(i=n.prototype)!==r.prototype&&a(i)&&o){o(e,i)}return e}},{122:122,81:81}],76:[function(e,t,r){t.exports=function(e,t,r){var n=r===undefined;switch(t.length){case 0:return n?e():e.call(r);case 1:return n?e(t[0]):e.call(r,t[0]);case 2:return n?e(t[0],t[1]):e.call(r,t[0],t[1]);case 3:return n?e(t[0],t[1],t[2]):e.call(r,t[0],t[1],t[2]);case 4:return n?e(t[0],t[1],t[2],t[3]):e.call(r,t[0],t[1],t[2],t[3])}return e.apply(r,t)}},{}],77:[function(e,t,r){var n=e(48);t.exports=Object("z").propertyIsEnumerable(0)?Object:function(e){return n(e)=="String"?e.split(""):Object(e)}},{48:48}],78:[function(e,t,r){var n=e(88);var i=e(152)("iterator");var a=Array.prototype;t.exports=function(e){return e!==undefined&&(n.Array===e||a[i]===e)}},{152:152,88:88}],79:[function(e,t,r){var n=e(48);t.exports=Array.isArray||function e(t){return n(t)=="Array"}},{48:48}],80:[function(e,t,r){var n=e(81);var i=Math.floor;t.exports=function e(t){return!n(t)&&isFinite(t)&&i(t)===t}},{81:81}],81:[function(e,t,r){arguments[4][28][0].apply(r,arguments)},{28:28}],82:[function(e,t,r){var n=e(81);var i=e(48);var a=e(152)("match");t.exports=function(e){var t;return n(e)&&((t=e[a])!==undefined?!!t:i(e)=="RegExp")}},{152:152,48:48,81:81}],83:[function(e,t,r){var a=e(38);t.exports=function(t,e,r,n){try{return n?e(a(r)[0],r[1]):e(r)}catch(e){var i=t["return"];if(i!==undefined)a(i.call(t));throw e}}},{38:38}],84:[function(e,t,r){"use strict";var n=e(98);var i=e(116);var a=e(124);var o={};e(72)(o,e(152)("iterator"),function(){return this});t.exports=function(e,t,r){e.prototype=n(o,{next:i(1,r)});a(e,t+" Iterator")}},{116:116,124:124,152:152,72:72,98:98}],85:[function(e,t,r){"use strict";var x=e(89);var b=e(62);var w=e(118);var _=e(72);var T=e(88);var E=e(84);var M=e(124);var S=e(105);var A=e(152)("iterator");var R=!([].keys&&"next"in[].keys());var P="@@iterator";var C="keys";var O="values";var L=function(){return this};t.exports=function(e,t,r,n,i,a,o){E(r,t,n);var s=function(t){if(!R&&t in h)return h[t];switch(t){case C:return function e(){return new r(this,t)};case O:return function e(){return new r(this,t)}}return function e(){return new r(this,t)}};var u=t+" Iterator";var l=i==O;var c=false;var h=e.prototype;var f=h[A]||h[P]||i&&h[i];var d=f||s(i);var p=i?!l?d:s("entries"):undefined;var v=t=="Array"?h.entries||f:f;var m,g,y;if(v){y=S(v.call(new e));if(y!==Object.prototype&&y.next){M(y,u,true);if(!x&&typeof y[A]!="function")_(y,A,L)}}if(l&&f&&f.name!==O){c=true;d=function e(){return f.call(this)}}if((!x||o)&&(R||c||!h[A])){_(h,A,d)}T[t]=d;T[u]=L;if(i){m={values:l?d:s(O),keys:a?d:s(C),entries:p};if(o)for(g in m){if(!(g in h))w(h,g,m[g])}else b(b.P+b.F*(R||c),t,m)}return m}},{105:105,118:118,124:124,152:152,62:62,72:72,84:84,88:88,89:89}],86:[function(e,t,r){var a=e(152)("iterator");var o=false;try{var n=[7][a]();n["return"]=function(){o=true};Array.from(n,function(){throw 2})}catch(e){}t.exports=function(e,t){if(!t&&!o)return false;var r=false;try{var n=[7];var i=n[a]();i.next=function(){return{done:r=true}};n[a]=function(){return i};e(n)}catch(e){}return r}},{152:152}],87:[function(e,t,r){t.exports=function(e,t){return{value:t,done:!!e}}},{}],88:[function(e,t,r){t.exports={}},{}],89:[function(e,t,r){t.exports=false},{}],90:[function(e,t,r){var n=Math.expm1;t.exports=!n||n(10)>22025.465794806718||n(10)<22025.465794806718||n(-2e-17)!=-2e-17?function e(t){return(t=+t)==0?t:t>-1e-6&&t<1e-6?t+t*t/2:Math.exp(t)-1}:n},{}],91:[function(e,t,r){var o=e(93);var n=Math.pow;var s=n(2,-52);var u=n(2,-23);var l=n(2,127)*(2-u);var c=n(2,-126);var h=function(e){return e+1/s-1/s};t.exports=Math.fround||function e(t){var r=Math.abs(t);var n=o(t);var i,a;if(r<c)return n*h(r/c/u)*c*u;i=(1+u/s)*r;a=i-(i-r);if(a>l||a!=a)return n*Infinity;return n*a}},{93:93}],92:[function(e,t,r){t.exports=Math.log1p||function e(t){return(t=+t)>-1e-8&&t<1e-8?t-t*t/2:Math.log(1+t)}},{}],93:[function(e,t,r){t.exports=Math.sign||function e(t){return(t=+t)==0||t!=t?t:t<0?-1:1}},{}],94:[function(e,t,r){var n=e(147)("meta");var i=e(81);var a=e(71);var o=e(99).f;var s=0;var u=Object.isExtensible||function(){return true};var l=!e(64)(function(){return u(Object.preventExtensions({}))});var c=function(e){o(e,n,{value:{i:"O"+ ++s,w:{}}})};var h=function(e,t){if(!i(e))return typeof e=="symbol"?e:(typeof e=="string"?"S":"P")+e;if(!a(e,n)){if(!u(e))return"F";if(!t)return"E";c(e)}return e[n].i};var f=function(e,t){if(!a(e,n)){if(!u(e))return true;if(!t)return false;c(e)}return e[n].w};var d=function(e){if(l&&p.NEED&&u(e)&&!a(e,n))c(e);return e};var p=t.exports={KEY:n,NEED:false,fastKey:h,getWeak:f,onFreeze:d}},{147:147,64:64,71:71,81:81,99:99}],95:[function(e,t,r){var s=e(70);var u=e(136).set;var l=s.MutationObserver||s.WebKitMutationObserver;var c=s.process;var h=s.Promise;var f=e(48)(c)=="process";t.exports=function(){var r,n,i;var e=function(){var e,t;if(f&&(e=c.domain))e.exit();while(r){t=r.fn;r=r.next;try{t()}catch(e){if(r)i();else n=undefined;throw e}}n=undefined;if(e)e.enter()};if(f){i=function(){c.nextTick(e)}}else if(l&&!(s.navigator&&s.navigator.standalone)){var t=true;var a=document.createTextNode("");new l(e).observe(a,{characterData:true});i=function(){a.data=t=!t}}else if(h&&h.resolve){var o=h.resolve(undefined);i=function(){o.then(e)}}else{i=function(){u.call(s,e)}}return function(e){var t={fn:e,next:undefined};if(n)n.next=t;if(!r){r=t;i()}n=t}}},{136:136,48:48,70:70}],96:[function(e,t,r){"use strict";var i=e(33);function n(e){var r,n;this.promise=new e(function(e,t){if(r!==undefined||n!==undefined)throw TypeError("Bad Promise constructor");r=e;n=t});this.resolve=i(r);this.reject=i(n)}t.exports.f=function(e){return new n(e)}},{33:33}],97:[function(e,t,r){"use strict";var d=e(58);var p=e(107);var v=e(104);var m=e(108);var g=e(142);var y=e(77);var i=Object.assign;t.exports=!i||e(64)(function(){var e={};var t={};var r=Symbol();var n="abcdefghijklmnopqrst";e[r]=7;n.split("").forEach(function(e){t[e]=e});return i({},e)[r]!=7||Object.keys(i({},t)).join("")!=n})?function e(t,r){var n=g(t);var i=arguments.length;var a=1;var o=v.f;var s=m.f;while(i>a){var u=y(arguments[a++]);var l=o?p(u).concat(o(u)):p(u);var c=l.length;var h=0;var f;while(c>h){f=l[h++];if(!d||s.call(u,f))n[f]=u[f]}}return n}:i},{104:104,107:107,108:108,142:142,58:58,64:64,77:77}],98:[function(u,e,t){var i=u(38);var a=u(100);var l=u(60);var o=u(125)("IE_PROTO");var s=function(){};var c="prototype";var h=function(){var e=u(59)("iframe");var t=l.length;var r="<";var n=">";var i=":";var a="javas";var o="cript";var s;e.style.display="none";u(73).appendChild(e);e.src=a+o+i;s=e.contentWindow.document;s.open();s.write(r+"script"+n+"document.F=Object"+r+"/script"+n);s.close();h=s.F;while(t--)delete h[c][l[t]];return h()};e.exports=Object.create||function e(t,r){var n;if(t!==null){s[c]=i(t);n=new s;s[c]=null;n[o]=t}else n=h();return r===undefined?n:a(n,r)}},{100:100,125:125,38:38,59:59,60:60,73:73}],99:[function(e,t,r){arguments[4][29][0].apply(r,arguments)},{143:143,29:29,38:38,58:58,74:74}],100:[function(e,t,r){var s=e(99);var u=e(38);var l=e(107);t.exports=e(58)?Object.defineProperties:function e(t,r){u(t);var n=l(r);var i=n.length;var a=0;var o;while(i>a)s.f(t,o=n[a++],r[o]);return t}},{107:107,38:38,58:58,99:99}],101:[function(e,t,r){var n=e(108);var i=e(116);var a=e(140);var o=e(143);var s=e(71);var u=e(74);var l=Object.getOwnPropertyDescriptor;r.f=e(58)?l:function e(t,r){t=a(t);r=o(r,true);if(u)try{return l(t,r)}catch(e){}if(s(t,r))return i(!n.f.call(t,r),t[r])}},{108:108,116:116,140:140,143:143,58:58,71:71,74:74}],102:[function(e,t,r){var n=e(140);var i=e(103).f;var a={}.toString;var o=typeof window=="object"&&window&&Object.getOwnPropertyNames?Object.getOwnPropertyNames(window):[];var s=function(e){try{return i(e)}catch(e){return o.slice()}};t.exports.f=function e(t){return o&&a.call(t)=="[object Window]"?s(t):i(n(t))}},{103:103,140:140}],103:[function(e,t,r){var n=e(106);var i=e(60).concat("length","prototype");r.f=Object.getOwnPropertyNames||function e(t){return n(t,i)}},{106:106,60:60}],104:[function(e,t,r){r.f=Object.getOwnPropertySymbols},{}],105:[function(e,t,r){var n=e(71);var i=e(142);var a=e(125)("IE_PROTO");var o=Object.prototype;t.exports=Object.getPrototypeOf||function(e){e=i(e);if(n(e,a))return e[a];if(typeof e.constructor=="function"&&e instanceof e.constructor){return e.constructor.prototype}return e instanceof Object?o:null}},{125:125,142:142,71:71}],106:[function(e,t,r){var o=e(71);var s=e(140);var u=e(41)(false);var l=e(125)("IE_PROTO");t.exports=function(e,t){var r=s(e);var n=0;var i=[];var a;for(a in r)if(a!=l)o(r,a)&&i.push(a);while(t.length>n)if(o(r,a=t[n++])){~u(i,a)||i.push(a)}return i}},{125:125,140:140,41:41,71:71}],107:[function(e,t,r){var n=e(106);var i=e(60);t.exports=Object.keys||function e(t){return n(t,i)}},{106:106,60:60}],108:[function(e,t,r){r.f={}.propertyIsEnumerable},{}],109:[function(e,t,r){var i=e(62);var a=e(52);var o=e(64);t.exports=function(e,t){var r=(a.Object||{})[e]||Object[e];var n={};n[e]=t(r);i(i.S+i.F*o(function(){r(1)}),"Object",n)}},{52:52,62:62,64:64}],110:[function(e,t,r){var u=e(58);var l=e(107);var c=e(140);var h=e(108).f;t.exports=function(s){return function(e){var t=c(e);var r=l(t);var n=r.length;var i=0;var a=[];var o;while(n>i){o=r[i++];if(!u||h.call(t,o)){a.push(s?[o,t[o]]:t[o])}}return a}}},{107:107,108:108,140:140,58:58}],111:[function(e,t,r){var i=e(103);var a=e(104);var o=e(38);var n=e(70).Reflect;t.exports=n&&n.ownKeys||function e(t){var r=i.f(o(t));var n=a.f;return n?r.concat(n(t)):r}},{103:103,104:104,38:38,70:70}],112:[function(e,t,r){var i=e(70).parseFloat;var a=e(134).trim;t.exports=1/i(e(135)+"-0")!==-Infinity?function e(t){var r=a(String(t),3);var n=i(r);return n===0&&r.charAt(0)=="-"?-0:n}:i},{134:134,135:135,70:70}],113:[function(e,t,r){var i=e(70).parseInt;var a=e(134).trim;var n=e(135);var o=/^[-+]?0[xX]/;t.exports=i(n+"08")!==8||i(n+"0x16")!==22?function e(t,r){var n=a(String(t),3);return i(n,r>>>0||(o.test(n)?16:10))}:i},{134:134,135:135,70:70}],114:[function(e,t,r){t.exports=function(e){try{return{e:false,v:e()}}catch(e){return{e:true,v:e}}}},{}],115:[function(e,t,r){var i=e(38);var a=e(81);var o=e(96);t.exports=function(e,t){i(e);if(a(t)&&t.constructor===e)return t;var r=o.f(e);var n=r.resolve;n(t);return r.promise}},{38:38,81:81,96:96}],116:[function(e,t,r){arguments[4][30][0].apply(r,arguments)},{30:30}],117:[function(e,t,r){var i=e(118);t.exports=function(e,t,r){for(var n in t)i(e,n,t[n],r);return e}},{118:118}],118:[function(e,t,r){var a=e(70);var o=e(72);var s=e(71);var u=e(147)("src");var n=e(69);var i="toString";var l=(""+n).split(i);e(52).inspectSource=function(e){return n.call(e)};(t.exports=function(e,t,r,n){var i=typeof r=="function";if(i)s(r,"name")||o(r,"name",t);if(e[t]===r)return;if(i)s(r,u)||o(r,u,e[t]?""+e[t]:l.join(String(t)));if(e===a){e[t]=r}else if(!n){delete e[t];o(e,t,r)}else if(e[t]){e[t]=r}else{o(e,t,r)}})(Function.prototype,i,function e(){return typeof this=="function"&&this[u]||n.call(this)})},{147:147,52:52,69:69,70:70,71:71,72:72}],119:[function(e,t,r){"use strict";var i=e(47);var a=RegExp.prototype.exec;t.exports=function(e,t){var r=e.exec;if(typeof r==="function"){var n=r.call(e,t);if(typeof n!=="object"){throw new TypeError("RegExp exec method returned something other than an Object or null")}return n}if(i(e)!=="RegExp"){throw new TypeError("RegExp#exec called on incompatible receiver")}return a.call(e,t)}},{47:47}],120:[function(e,t,r){"use strict";var s=e(66);var u=RegExp.prototype.exec;var l=String.prototype.replace;var n=u;var c="lastIndex";var h=function(){var e=/a/,t=/b*/g;u.call(e,"a");u.call(t,"a");return e[c]!==0||t[c]!==0}();var f=/()??/.exec("")[1]!==undefined;var i=h||f;if(i){n=function e(t){var r=this;var n,i,a,o;if(f){i=new RegExp("^"+r.source+"$(?!\\s)",s.call(r))}if(h)n=r[c];a=u.call(r,t);if(h&&a){r[c]=r.global?a.index+a[0].length:n}if(f&&a&&a.length>1){l.call(a[0],i,function(){for(o=1;o<arguments.length-2;o++){if(arguments[o]===undefined)a[o]=undefined}})}return a}}t.exports=n},{66:66}],121:[function(e,t,r){t.exports=Object.is||function e(t,r){return t===r?t!==0||1/t===1/r:t!=t&&r!=r}},{}],122:[function(t,e,r){var n=t(81);var i=t(38);var a=function(e,t){i(e);if(!n(t)&&t!==null)throw TypeError(t+": can't set as prototype!")};e.exports={set:Object.setPrototypeOf||("__proto__"in{}?function(e,n,i){try{i=t(54)(Function.call,t(101).f(Object.prototype,"__proto__").set,2);i(e,[]);n=!(e instanceof Array)}catch(e){n=true}return function e(t,r){a(t,r);if(n)t.__proto__=r;else i(t,r);return t}}({},false):undefined),check:a}},{101:101,38:38,54:54,81:81}],123:[function(e,t,r){"use strict";var n=e(70);var i=e(99);var a=e(58);var o=e(152)("species");t.exports=function(e){var t=n[e];if(a&&t&&!t[o])i.f(t,o,{configurable:true,get:function(){return this}})}},{152:152,58:58,70:70,99:99}],124:[function(e,t,r){var n=e(99).f;var i=e(71);var a=e(152)("toStringTag");t.exports=function(e,t,r){if(e&&!i(e=r?e:e.prototype,a))n(e,a,{configurable:true,value:t})}},{152:152,71:71,99:99}],125:[function(e,t,r){var n=e(126)("keys");var i=e(147);t.exports=function(e){return n[e]||(n[e]=i(e))}},{126:126,147:147}],126:[function(e,t,r){var n=e(52);var i=e(70);var a="__core-js_shared__";var o=i[a]||(i[a]={});(t.exports=function(e,t){return o[e]||(o[e]=t!==undefined?t:{})})("versions",[]).push({version:n.version,mode:e(89)?"pure":"global",copyright:"© 2019 Denis Pushkarev (zloirock.ru)"})},{52:52,70:70,89:89}],127:[function(e,t,r){var i=e(38);var a=e(33);var o=e(152)("species");t.exports=function(e,t){var r=i(e).constructor;var n;return r===undefined||(n=i(r)[o])==undefined?t:a(n)}},{152:152,33:33,38:38}],128:[function(e,t,r){"use strict";var n=e(64);t.exports=function(e,t){return!!e&&n(function(){t?e.call(null,function(){},1):e.call(null)})}},{64:64}],129:[function(e,t,r){var u=e(139);var l=e(57);t.exports=function(s){return function(e,t){var r=String(l(e));var n=u(t);var i=r.length;var a,o;if(n<0||n>=i)return s?"":undefined;a=r.charCodeAt(n);return a<55296||a>56319||n+1===i||(o=r.charCodeAt(n+1))<56320||o>57343?s?r.charAt(n):a:s?r.slice(n,n+2):(a-55296<<10)+(o-56320)+65536}}},{139:139,57:57}],130:[function(e,t,r){var n=e(82);var i=e(57);t.exports=function(e,t,r){if(n(t))throw TypeError("String#"+r+" doesn't accept regex!");return String(i(e))}},{57:57,82:82}],131:[function(e,t,r){var n=e(62);var i=e(64);var o=e(57);var s=/"/g;var a=function(e,t,r,n){var i=String(o(e));var a="<"+t;if(r!=="")a+=" "+r+'="'+String(n).replace(s,"&quot;")+'"';return a+">"+i+"</"+t+">"};t.exports=function(t,e){var r={};r[t]=e(a);n(n.P+n.F*i(function(){var e=""[t]('"');return e!==e.toLowerCase()||e.split('"').length>3}),"String",r)}},{57:57,62:62,64:64}],132:[function(e,t,r){var c=e(141);var h=e(133);var f=e(57);t.exports=function(e,t,r,n){var i=String(f(e));var a=i.length;var o=r===undefined?" ":String(r);var s=c(t);if(s<=a||o=="")return i;var u=s-a;var l=h.call(o,Math.ceil(u/o.length));if(l.length>u)l=l.slice(0,u);return n?l+i:i+l}},{133:133,141:141,57:57}],133:[function(e,t,r){"use strict";var a=e(139);var o=e(57);t.exports=function e(t){var r=String(o(this));var n="";var i=a(t);if(i<0||i==Infinity)throw RangeError("Count can't be negative");for(;i>0;(i>>>=1)&&(r+=r))if(i&1)n+=r;return n}},{139:139,57:57}],134:[function(e,t,r){var o=e(62);var n=e(57);var s=e(64);var u=e(135);var i="["+u+"]";var l="​";var a=RegExp("^"+i+i+"*");var c=RegExp(i+i+"*$");var h=function(e,t,r){var n={};var i=s(function(){return!!u[e]()||l[e]()!=l});var a=n[e]=i?t(f):u[e];if(r)n[r]=a;o(o.P+o.F*i,"String",n)};var f=h.trim=function(e,t){e=String(n(e));if(t&1)e=e.replace(a,"");if(t&2)e=e.replace(c,"");return e};t.exports=h},{135:135,57:57,62:62,64:64}],135:[function(e,t,r){t.exports="\t\n\v\f\r   ᠎    "+"         　\u2028\u2029\ufeff"},{}],136:[function(e,t,r){var n=e(54);var i=e(76);var a=e(73);var o=e(59);var s=e(70);var u=s.process;var l=s.setImmediate;var c=s.clearImmediate;var h=s.MessageChannel;var f=s.Dispatch;var d=0;var p={};var v="onreadystatechange";var m,g,y;var x=function(){var e=+this;if(p.hasOwnProperty(e)){var t=p[e];delete p[e];t()}};var b=function(e){x.call(e.data)};if(!l||!c){l=function e(t){var r=[];var n=1;while(arguments.length>n)r.push(arguments[n++]);p[++d]=function(){i(typeof t=="function"?t:Function(t),r)};m(d);return d};c=function e(t){delete p[t]};if(e(48)(u)=="process"){m=function(e){u.nextTick(n(x,e,1))}}else if(f&&f.now){m=function(e){f.now(n(x,e,1))}}else if(h){g=new h;y=g.port2;g.port1.onmessage=b;m=n(y.postMessage,y,1)}else if(s.addEventListener&&typeof postMessage=="function"&&!s.importScripts){m=function(e){s.postMessage(e+"","*")};s.addEventListener("message",b,false)}else if(v in o("script")){m=function(e){a.appendChild(o("script"))[v]=function(){a.removeChild(this);x.call(e)}}}else{m=function(e){setTimeout(n(x,e,1),0)}}}t.exports={set:l,clear:c}},{48:48,54:54,59:59,70:70,73:73,76:76}],137:[function(e,t,r){var n=e(139);var i=Math.max;var a=Math.min;t.exports=function(e,t){e=n(e);return e<0?i(e+t,0):a(e,t)}},{139:139}],138:[function(e,t,r){var n=e(139);var i=e(141);t.exports=function(e){if(e===undefined)return 0;var t=n(e);var r=i(t);if(t!==r)throw RangeError("Wrong length!");return r}},{139:139,141:141}],139:[function(e,t,r){var n=Math.ceil;var i=Math.floor;t.exports=function(e){return isNaN(e=+e)?0:(e>0?i:n)(e)}},{}],140:[function(e,t,r){var n=e(77);var i=e(57);t.exports=function(e){return n(i(e))}},{57:57,77:77}],141:[function(e,t,r){var n=e(139);var i=Math.min;t.exports=function(e){return e>0?i(n(e),9007199254740991):0}},{139:139}],142:[function(e,t,r){var n=e(57);t.exports=function(e){return Object(n(e))}},{57:57}],143:[function(e,t,r){arguments[4][31][0].apply(r,arguments)},{31:31,81:81}],144:[function(e,t,r){"use strict";if(e(58)){var x=e(89);var b=e(70);var w=e(64);var _=e(62);var T=e(146);var n=e(145);var d=e(54);var E=e(37);var i=e(116);var M=e(72);var a=e(117);var o=e(139);var S=e(141);var A=e(138);var s=e(137);var u=e(143);var l=e(71);var R=e(47);var P=e(81);var p=e(142);var v=e(78);var C=e(98);var O=e(105);var L=e(103).f;var m=e(153);var c=e(147);var h=e(152);var f=e(42);var g=e(41);var y=e(127);var I=e(164);var D=e(88);var N=e(86);var F=e(123);var B=e(40);var U=e(39);var k=e(99);var j=e(101);var z=k.f;var H=j.f;var G=b.RangeError;var V=b.TypeError;var W=b.Uint8Array;var q="ArrayBuffer";var X="Shared"+q;var Y="BYTES_PER_ELEMENT";var Z="prototype";var J=Array[Z];var K=n.ArrayBuffer;var Q=n.DataView;var $=f(0);var ee=f(2);var te=f(3);var re=f(4);var ne=f(5);var ie=f(6);var ae=g(true);var oe=g(false);var se=I.values;var ue=I.keys;var le=I.entries;var ce=J.lastIndexOf;var he=J.reduce;var fe=J.reduceRight;var de=J.join;var pe=J.sort;var ve=J.slice;var me=J.toString;var ge=J.toLocaleString;var ye=h("iterator");var xe=h("toStringTag");var be=c("typed_constructor");var we=c("def_constructor");var _e=T.CONSTR;var Te=T.TYPED;var Ee=T.VIEW;var Me="Wrong length!";var Se=f(1,function(e,t){return Oe(y(e,e[we]),t)});var Ae=w(function(){return new W(new Uint16Array([1]).buffer)[0]===1});var Re=!!W&&!!W[Z].set&&w(function(){new W(1).set({})});var Pe=function(e,t){var r=o(e);if(r<0||r%t)throw G("Wrong offset!");return r};var Ce=function(e){if(P(e)&&Te in e)return e;throw V(e+" is not a typed array!")};var Oe=function(e,t){if(!(P(e)&&be in e)){throw V("It is not a typed array constructor!")}return new e(t)};var Le=function(e,t){return Ie(y(e,e[we]),t)};var Ie=function(e,t){var r=0;var n=t.length;var i=Oe(e,n);while(n>r)i[r]=t[r++];return i};var De=function(e,t,r){z(e,t,{get:function(){return this._d[r]}})};var Ne=function e(t){var r=p(t);var n=arguments.length;var i=n>1?arguments[1]:undefined;var a=i!==undefined;var o=m(r);var s,u,l,c,h,f;if(o!=undefined&&!v(o)){for(f=o.call(r),l=[],s=0;!(h=f.next()).done;s++){l.push(h.value)}r=l}if(a&&n>2)i=d(i,arguments[2],2);for(s=0,u=S(r.length),c=Oe(this,u);u>s;s++){c[s]=a?i(r[s],s):r[s]}return c};var Fe=function e(){var t=0;var r=arguments.length;var n=Oe(this,r);while(r>t)n[t]=arguments[t++];return n};var Be=!!W&&w(function(){ge.call(new W(1))});var Ue=function e(){return ge.apply(Be?ve.call(Ce(this)):Ce(this),arguments)};var ke={copyWithin:function e(t,r){return U.call(Ce(this),t,r,arguments.length>2?arguments[2]:undefined)},every:function e(t){return re(Ce(this),t,arguments.length>1?arguments[1]:undefined)},fill:function e(t){return B.apply(Ce(this),arguments)},filter:function e(t){return Le(this,ee(Ce(this),t,arguments.length>1?arguments[1]:undefined))},find:function e(t){return ne(Ce(this),t,arguments.length>1?arguments[1]:undefined)},findIndex:function e(t){return ie(Ce(this),t,arguments.length>1?arguments[1]:undefined)},forEach:function e(t){$(Ce(this),t,arguments.length>1?arguments[1]:undefined)},indexOf:function e(t){return oe(Ce(this),t,arguments.length>1?arguments[1]:undefined)},includes:function e(t){return ae(Ce(this),t,arguments.length>1?arguments[1]:undefined)},join:function e(t){return de.apply(Ce(this),arguments)},lastIndexOf:function e(t){return ce.apply(Ce(this),arguments)},map:function e(t){return Se(Ce(this),t,arguments.length>1?arguments[1]:undefined)},reduce:function e(t){return he.apply(Ce(this),arguments)},reduceRight:function e(t){return fe.apply(Ce(this),arguments)},reverse:function e(){var t=this;var r=Ce(t).length;var n=Math.floor(r/2);var i=0;var a;while(i<n){a=t[i];t[i++]=t[--r];t[r]=a}return t},some:function e(t){return te(Ce(this),t,arguments.length>1?arguments[1]:undefined)},sort:function e(t){return pe.call(Ce(this),t)},subarray:function e(t,r){var n=Ce(this);var i=n.length;var a=s(t,i);return new(y(n,n[we]))(n.buffer,n.byteOffset+a*n.BYTES_PER_ELEMENT,S((r===undefined?i:s(r,i))-a))}};var je=function e(t,r){return Le(this,ve.call(Ce(this),t,r))};var ze=function e(t){Ce(this);var r=Pe(arguments[1],1);var n=this.length;var i=p(t);var a=S(i.length);var o=0;if(a+r>n)throw G(Me);while(o<a)this[r+o]=i[o++]};var He={entries:function e(){return le.call(Ce(this))},keys:function e(){return ue.call(Ce(this))},values:function e(){return se.call(Ce(this))}};var Ge=function(e,t){return P(e)&&e[Te]&&typeof t!="symbol"&&t in e&&String(+t)==String(t)};var Ve=function e(t,r){return Ge(t,r=u(r,true))?i(2,t[r]):H(t,r)};var We=function e(t,r,n){if(Ge(t,r=u(r,true))&&P(n)&&l(n,"value")&&!l(n,"get")&&!l(n,"set")&&!n.configurable&&(!l(n,"writable")||n.writable)&&(!l(n,"enumerable")||n.enumerable)){t[r]=n.value;return t}return z(t,r,n)};if(!_e){j.f=Ve;k.f=We}_(_.S+_.F*!_e,"Object",{getOwnPropertyDescriptor:Ve,defineProperty:We});if(w(function(){me.call({})})){me=ge=function e(){return de.call(this)}}var qe=a({},ke);a(qe,He);M(qe,ye,He.values);a(qe,{slice:je,set:ze,constructor:function(){},toString:me,toLocaleString:Ue});De(qe,"buffer","b");De(qe,"byteOffset","o");De(qe,"byteLength","l");De(qe,"length","e");z(qe,xe,{get:function(){return this[Te]}});t.exports=function(e,h,t,i){i=!!i;var f=e+(i?"Clamped":"")+"Array";var n="get"+e;var a="set"+e;var d=b[f];var o=d||{};var r=d&&O(d);var s=!d||!T.ABV;var u={};var l=d&&d[Z];var c=function(e,t){var r=e._d;return r.v[n](t*h+r.o,Ae)};var p=function(e,t,r){var n=e._d;if(i)r=(r=Math.round(r))<0?0:r>255?255:r&255;n.v[a](t*h+n.o,r,Ae)};var v=function(e,t){z(e,t,{get:function(){return c(this,t)},set:function(e){return p(this,t,e)},enumerable:true})};if(s){d=t(function(e,t,r,n){E(e,d,f,"_d");var i=0;var a=0;var o,s,u,l;if(!P(t)){u=A(t);s=u*h;o=new K(s)}else if(t instanceof K||(l=R(t))==q||l==X){o=t;a=Pe(r,h);var c=t.byteLength;if(n===undefined){if(c%h)throw G(Me);s=c-a;if(s<0)throw G(Me)}else{s=S(n)*h;if(s+a>c)throw G(Me)}u=s/h}else if(Te in t){return Ie(d,t)}else{return Ne.call(d,t)}M(e,"_d",{b:o,o:a,l:s,e:u,v:new Q(o)});while(i<u)v(e,i++)});l=d[Z]=C(qe);M(l,"constructor",d)}else if(!w(function(){d(1)})||!w(function(){new d(-1)})||!N(function(e){new d;new d(null);new d(1.5);new d(e)},true)){d=t(function(e,t,r,n){E(e,d,f);var i;if(!P(t))return new o(A(t));if(t instanceof K||(i=R(t))==q||i==X){return n!==undefined?new o(t,Pe(r,h),n):r!==undefined?new o(t,Pe(r,h)):new o(t)}if(Te in t)return Ie(d,t);return Ne.call(d,t)});$(r!==Function.prototype?L(o).concat(L(r)):L(o),function(e){if(!(e in d))M(d,e,o[e])});d[Z]=l;if(!x)l.constructor=d}var m=l[ye];var g=!!m&&(m.name=="values"||m.name==undefined);var y=He.values;M(d,be,true);M(l,Te,f);M(l,Ee,true);M(l,we,d);if(i?new d(1)[xe]!=f:!(xe in l)){z(l,xe,{get:function(){return f}})}u[f]=d;_(_.G+_.W+_.F*(d!=o),u);_(_.S,f,{BYTES_PER_ELEMENT:h});_(_.S+_.F*w(function(){o.of.call(d,1)}),f,{from:Ne,of:Fe});if(!(Y in l))M(l,Y,h);_(_.P,f,ke);F(f);_(_.P+_.F*Re,f,{set:ze});_(_.P+_.F*!g,f,He);if(!x&&l.toString!=me)l.toString=me;_(_.P+_.F*w(function(){new d(1).slice()}),f,{slice:je});_(_.P+_.F*(w(function(){return[1,2].toLocaleString()!=new d([1,2]).toLocaleString()})||!w(function(){l.toLocaleString.call([1,2])})),f,{toLocaleString:Ue});D[f]=g?m:y;if(!x&&!g)M(l,ye,y)}}else t.exports=function(){}},{101:101,103:103,105:105,116:116,117:117,123:123,127:127,137:137,138:138,139:139,141:141,142:142,143:143,145:145,146:146,147:147,152:152,153:153,164:164,37:37,39:39,40:40,41:41,42:42,47:47,54:54,58:58,62:62,64:64,70:70,71:71,72:72,78:78,81:81,86:86,88:88,89:89,98:98,99:99}],145:[function(e,t,r){"use strict";var n=e(70);var i=e(58);var a=e(89);var o=e(146);var s=e(72);var u=e(117);var l=e(64);var c=e(37);var h=e(139);var f=e(141);var d=e(138);var p=e(103).f;var v=e(99).f;var m=e(40);var g=e(124);var y="ArrayBuffer";var x="DataView";var b="prototype";var w="Wrong length!";var _="Wrong index!";var T=n[y];var E=n[x];var M=n.Math;var S=n.RangeError;var A=n.Infinity;var R=T;var P=M.abs;var C=M.pow;var O=M.floor;var L=M.log;var I=M.LN2;var D="buffer";var N="byteLength";var F="byteOffset";var B=i?"_b":D;var U=i?"_l":N;var k=i?"_o":F;function j(e,t,r){var n=new Array(r);var i=r*8-t-1;var a=(1<<i)-1;var o=a>>1;var s=t===23?C(2,-24)-C(2,-77):0;var u=0;var l=e<0||e===0&&1/e<0?1:0;var c,h,f;e=P(e);if(e!=e||e===A){h=e!=e?1:0;c=a}else{c=O(L(e)/I);if(e*(f=C(2,-c))<1){c--;f*=2}if(c+o>=1){e+=s/f}else{e+=s*C(2,1-o)}if(e*f>=2){c++;f/=2}if(c+o>=a){h=0;c=a}else if(c+o>=1){h=(e*f-1)*C(2,t);c=c+o}else{h=e*C(2,o-1)*C(2,t);c=0}}for(;t>=8;n[u++]=h&255,h/=256,t-=8);c=c<<t|h;i+=t;for(;i>0;n[u++]=c&255,c/=256,i-=8);n[--u]|=l*128;return n}function z(e,t,r){var n=r*8-t-1;var i=(1<<n)-1;var a=i>>1;var o=n-7;var s=r-1;var u=e[s--];var l=u&127;var c;u>>=7;for(;o>0;l=l*256+e[s],s--,o-=8);c=l&(1<<-o)-1;l>>=-o;o+=t;for(;o>0;c=c*256+e[s],s--,o-=8);if(l===0){l=1-a}else if(l===i){return c?NaN:u?-A:A}else{c=c+C(2,t);l=l-a}return(u?-1:1)*c*C(2,l-t)}function H(e){return e[3]<<24|e[2]<<16|e[1]<<8|e[0]}function G(e){return[e&255]}function V(e){return[e&255,e>>8&255]}function W(e){return[e&255,e>>8&255,e>>16&255,e>>24&255]}function q(e){return j(e,52,8)}function X(e){return j(e,23,4)}function Y(e,t,r){v(e[b],t,{get:function(){return this[r]}})}function Z(e,t,r,n){var i=+r;var a=d(i);if(a+t>e[U])throw S(_);var o=e[B]._b;var s=a+e[k];var u=o.slice(s,s+t);return n?u:u.reverse()}function J(e,t,r,n,i,a){var o=+r;var s=d(o);if(s+t>e[U])throw S(_);var u=e[B]._b;var l=s+e[k];var c=n(+i);for(var h=0;h<t;h++)u[l+h]=c[a?h:t-h-1]}if(!o.ABV){T=function e(t){c(this,T,y);var r=d(t);this._b=m.call(new Array(r),0);this[U]=r};E=function e(t,r,n){c(this,E,x);c(t,T,x);var i=t[U];var a=h(r);if(a<0||a>i)throw S("Wrong offset!");n=n===undefined?i-a:f(n);if(a+n>i)throw S(w);this[B]=t;this[k]=a;this[U]=n};if(i){Y(T,N,"_l");Y(E,D,"_b");Y(E,N,"_l");Y(E,F,"_o")}u(E[b],{getInt8:function e(t){return Z(this,1,t)[0]<<24>>24},getUint8:function e(t){return Z(this,1,t)[0]},getInt16:function e(t){var r=Z(this,2,t,arguments[1]);return(r[1]<<8|r[0])<<16>>16},getUint16:function e(t){var r=Z(this,2,t,arguments[1]);return r[1]<<8|r[0]},getInt32:function e(t){return H(Z(this,4,t,arguments[1]))},getUint32:function e(t){return H(Z(this,4,t,arguments[1]))>>>0},getFloat32:function e(t){return z(Z(this,4,t,arguments[1]),23,4)},getFloat64:function e(t){return z(Z(this,8,t,arguments[1]),52,8)},setInt8:function e(t,r){J(this,1,t,G,r)},setUint8:function e(t,r){J(this,1,t,G,r)},setInt16:function e(t,r){J(this,2,t,V,r,arguments[2])},setUint16:function e(t,r){J(this,2,t,V,r,arguments[2])},setInt32:function e(t,r){J(this,4,t,W,r,arguments[2])},setUint32:function e(t,r){J(this,4,t,W,r,arguments[2])},setFloat32:function e(t,r){J(this,4,t,X,r,arguments[2])},setFloat64:function e(t,r){J(this,8,t,q,r,arguments[2])}})}else{if(!l(function(){T(1)})||!l(function(){new T(-1)})||l(function(){new T;new T(1.5);new T(NaN);return T.name!=y})){T=function e(t){c(this,T);return new R(d(t))};var K=T[b]=R[b];for(var Q=p(R),$=0,ee;Q.length>$;){if(!((ee=Q[$++])in T))s(T,ee,R[ee])}if(!a)K.constructor=T}var te=new E(new T(2));var re=E[b].setInt8;te.setInt8(0,2147483648);te.setInt8(1,2147483649);if(te.getInt8(0)||!te.getInt8(1))u(E[b],{setInt8:function e(t,r){re.call(this,t,r<<24>>24)},setUint8:function e(t,r){re.call(this,t,r<<24>>24)}},true)}g(T,y);g(E,x);s(E[b],o.VIEW,true);r[y]=T;r[x]=E},{103:103,117:117,124:124,138:138,139:139,141:141,146:146,37:37,40:40,58:58,64:64,70:70,72:72,89:89,99:99}],146:[function(e,t,r){var n=e(70);var i=e(72);var a=e(147);var o=a("typed_array");var s=a("view");var u=!!(n.ArrayBuffer&&n.DataView);var l=u;var c=0;var h=9;var f;var d="Int8Array,Uint8Array,Uint8ClampedArray,Int16Array,Uint16Array,Int32Array,Uint32Array,Float32Array,Float64Array".split(",");while(c<h){if(f=n[d[c++]]){i(f.prototype,o,true);i(f.prototype,s,true)}else l=false}t.exports={ABV:u,CONSTR:l,TYPED:o,VIEW:s}},{147:147,70:70,72:72}],147:[function(e,t,r){var n=0;var i=Math.random();t.exports=function(e){return"Symbol(".concat(e===undefined?"":e,")_",(++n+i).toString(36))}},{}],148:[function(e,t,r){var n=e(70);var i=n.navigator;t.exports=i&&i.userAgent||""},{70:70}],149:[function(e,t,r){var n=e(81);t.exports=function(e,t){if(!n(e)||e._t!==t)throw TypeError("Incompatible receiver, "+t+" required!");return e}},{81:81}],150:[function(e,t,r){var n=e(70);var i=e(52);var a=e(89);var o=e(151);var s=e(99).f;t.exports=function(e){var t=i.Symbol||(i.Symbol=a?{}:n.Symbol||{});if(e.charAt(0)!="_"&&!(e in t))s(t,e,{value:o.f(e)})}},{151:151,52:52,70:70,89:89,99:99}],151:[function(e,t,r){r.f=e(152)},{152:152}],152:[function(e,t,r){var n=e(126)("wks");var i=e(147);var a=e(70).Symbol;var o=typeof a=="function";var s=t.exports=function(e){return n[e]||(n[e]=o&&a[e]||(o?a:i)("Symbol."+e))};s.store=n},{126:126,147:147,70:70}],153:[function(e,t,r){var n=e(47);var i=e(152)("iterator");var a=e(88);t.exports=e(52).getIteratorMethod=function(e){if(e!=undefined)return e[i]||e["@@iterator"]||a[n(e)]}},{152:152,47:47,52:52,88:88}],154:[function(e,t,r){var n=e(62);n(n.P,"Array",{copyWithin:e(39)});e(35)("copyWithin")},{35:35,39:39,62:62}],155:[function(e,t,r){"use strict";var n=e(62);var i=e(42)(4);n(n.P+n.F*!e(128)([].every,true),"Array",{every:function e(t){return i(this,t,arguments[1])}})},{128:128,42:42,62:62}],156:[function(e,t,r){var n=e(62);n(n.P,"Array",{fill:e(40)});e(35)("fill")},{35:35,40:40,62:62}],157:[function(e,t,r){"use strict";var n=e(62);var i=e(42)(2);n(n.P+n.F*!e(128)([].filter,true),"Array",{filter:function e(t){return i(this,t,arguments[1])}})},{128:128,42:42,62:62}],158:[function(e,t,r){"use strict";var n=e(62);var i=e(42)(6);var a="findIndex";var o=true;if(a in[])Array(1)[a](function(){o=false});n(n.P+n.F*o,"Array",{findIndex:function e(t){return i(this,t,arguments.length>1?arguments[1]:undefined)}});e(35)(a)},{35:35,42:42,62:62}],159:[function(e,t,r){"use strict";var n=e(62);var i=e(42)(5);var a="find";var o=true;if(a in[])Array(1)[a](function(){o=false});n(n.P+n.F*o,"Array",{find:function e(t){return i(this,t,arguments.length>1?arguments[1]:undefined)}});e(35)(a)},{35:35,42:42,62:62}],160:[function(e,t,r){"use strict";var n=e(62);var i=e(42)(0);var a=e(128)([].forEach,true);n(n.P+n.F*!a,"Array",{forEach:function e(t){return i(this,t,arguments[1])}})},{128:128,42:42,62:62}],161:[function(e,t,r){"use strict";var d=e(54);var n=e(62);var p=e(142);var v=e(83);var m=e(78);var g=e(141);var y=e(53);var x=e(153);n(n.S+n.F*!e(86)(function(e){Array.from(e)}),"Array",{from:function e(t){var r=p(t);var n=typeof this=="function"?this:Array;var i=arguments.length;var a=i>1?arguments[1]:undefined;var o=a!==undefined;var s=0;var u=x(r);var l,c,h,f;if(o)a=d(a,i>2?arguments[2]:undefined,2);if(u!=undefined&&!(n==Array&&m(u))){for(f=u.call(r),c=new n;!(h=f.next()).done;s++){y(c,s,o?v(f,a,[h.value,s],true):h.value)}}else{l=g(r.length);for(c=new n(l);l>s;s++){y(c,s,o?a(r[s],s):r[s])}}c.length=s;return c}})},{141:141,142:142,153:153,53:53,54:54,62:62,78:78,83:83,86:86}],162:[function(e,t,r){"use strict";var n=e(62);var i=e(41)(false);var a=[].indexOf;var o=!!a&&1/[1].indexOf(1,-0)<0;n(n.P+n.F*(o||!e(128)(a)),"Array",{indexOf:function e(t){return o?a.apply(this,arguments)||0:i(this,t,arguments[1])}})},{128:128,41:41,62:62}],163:[function(e,t,r){var n=e(62);n(n.S,"Array",{isArray:e(79)})},{62:62,79:79}],164:[function(e,t,r){"use strict";var n=e(35);var i=e(87);var a=e(88);var o=e(140);t.exports=e(85)(Array,"Array",function(e,t){this._t=o(e);this._i=0;this._k=t},function(){var e=this._t;var t=this._k;var r=this._i++;if(!e||r>=e.length){this._t=undefined;return i(1)}if(t=="keys")return i(0,r);if(t=="values")return i(0,e[r]);return i(0,[r,e[r]])},"values");a.Arguments=a.Array;n("keys");n("values");n("entries")},{140:140,35:35,85:85,87:87,88:88}],165:[function(e,t,r){"use strict";var n=e(62);var i=e(140);var a=[].join;n(n.P+n.F*(e(77)!=Object||!e(128)(a)),"Array",{join:function e(t){return a.call(i(this),t===undefined?",":t)}})},{128:128,140:140,62:62,77:77}],166:[function(e,t,r){"use strict";var n=e(62);var a=e(140);var o=e(139);var s=e(141);var u=[].lastIndexOf;var l=!!u&&1/[1].lastIndexOf(1,-0)<0;n(n.P+n.F*(l||!e(128)(u)),"Array",{lastIndexOf:function e(t){if(l)return u.apply(this,arguments)||0;var r=a(this);var n=s(r.length);var i=n-1;if(arguments.length>1)i=Math.min(i,o(arguments[1]));if(i<0)i=n+i;for(;i>=0;i--)if(i in r)if(r[i]===t)return i||0;return-1}})},{128:128,139:139,140:140,141:141,62:62}],167:[function(e,t,r){"use strict";var n=e(62);var i=e(42)(1);n(n.P+n.F*!e(128)([].map,true),"Array",{map:function e(t){return i(this,t,arguments[1])}})},{128:128,42:42,62:62}],168:[function(e,t,r){"use strict";var n=e(62);var i=e(53);n(n.S+n.F*e(64)(function(){function e(){}return!(Array.of.call(e)instanceof e)}),"Array",{of:function e(){var t=0;var r=arguments.length;var n=new(typeof this=="function"?this:Array)(r);while(r>t)i(n,t,arguments[t++]);n.length=r;return n}})},{53:53,62:62,64:64}],169:[function(e,t,r){"use strict";var n=e(62);var i=e(43);n(n.P+n.F*!e(128)([].reduceRight,true),"Array",{reduceRight:function e(t){return i(this,t,arguments.length,arguments[1],true)}})},{128:128,43:43,62:62}],170:[function(e,t,r){"use strict";var n=e(62);var i=e(43);n(n.P+n.F*!e(128)([].reduce,true),"Array",{reduce:function e(t){return i(this,t,arguments.length,arguments[1],false)}})},{128:128,43:43,62:62}],171:[function(e,t,r){"use strict";var n=e(62);var i=e(73);var c=e(48);var h=e(137);var f=e(141);var d=[].slice;n(n.P+n.F*e(64)(function(){if(i)d.call(i)}),"Array",{slice:function e(t,r){var n=f(this.length);var i=c(this);r=r===undefined?n:r;if(i=="Array")return d.call(this,t,r);var a=h(t,n);var o=h(r,n);var s=f(o-a);var u=new Array(s);var l=0;for(;l<s;l++)u[l]=i=="String"?this.charAt(a+l):this[a+l];return u}})},{137:137,141:141,48:48,62:62,64:64,73:73}],172:[function(e,t,r){"use strict";var n=e(62);var i=e(42)(3);n(n.P+n.F*!e(128)([].some,true),"Array",{some:function e(t){return i(this,t,arguments[1])}})},{128:128,42:42,62:62}],173:[function(e,t,r){"use strict";var n=e(62);var i=e(33);var a=e(142);var o=e(64);var s=[].sort;var u=[1,2,3];n(n.P+n.F*(o(function(){u.sort(undefined)})||!o(function(){u.sort(null)})||!e(128)(s)),"Array",{sort:function e(t){return t===undefined?s.call(a(this)):s.call(a(this),i(t))}})},{128:128,142:142,33:33,62:62,64:64}],174:[function(e,t,r){e(123)("Array")},{123:123}],175:[function(e,t,r){var n=e(62);n(n.S,"Date",{now:function(){return(new Date).getTime()}})},{62:62}],176:[function(e,t,r){var n=e(62);var i=e(55);n(n.P+n.F*(Date.prototype.toISOString!==i),"Date",{toISOString:i})},{55:55,62:62}],177:[function(e,t,r){"use strict";var n=e(62);var i=e(142);var a=e(143);n(n.P+n.F*e(64)(function(){return new Date(NaN).toJSON()!==null||Date.prototype.toJSON.call({toISOString:function(){return 1}})!==1}),"Date",{toJSON:function e(t){var r=i(this);var n=a(r);return typeof n=="number"&&!isFinite(n)?null:r.toISOString()}})},{142:142,143:143,62:62,64:64}],178:[function(e,t,r){var n=e(152)("toPrimitive");var i=Date.prototype;if(!(n in i))e(72)(i,n,e(56))},{152:152,56:56,72:72}],179:[function(e,t,r){var n=Date.prototype;var i="Invalid Date";var a="toString";var o=n[a];var s=n.getTime;if(new Date(NaN)+""!=i){e(118)(n,a,function e(){var t=s.call(this);return t===t?o.call(this):i})}},{118:118}],180:[function(e,t,r){var n=e(62);n(n.P,"Function",{bind:e(46)})},{46:46,62:62}],181:[function(e,t,r){"use strict";var n=e(81);var i=e(105);var a=e(152)("hasInstance");var o=Function.prototype;if(!(a in o))e(99).f(o,a,{value:function(e){if(typeof this!="function"||!n(e))return false;if(!n(this.prototype))return e instanceof this;while(e=i(e))if(this.prototype===e)return true;return false}})},{105:105,152:152,81:81,99:99}],182:[function(e,t,r){var n=e(99).f;var i=Function.prototype;var a=/^\s*function ([^ (]*)/;var o="name";o in i||e(58)&&n(i,o,{configurable:true,get:function(){try{return(""+this).match(a)[1]}catch(e){return""}}})},{58:58,99:99}],183:[function(e,t,r){"use strict";var n=e(49);var i=e(149);var a="Map";t.exports=e(51)(a,function(t){return function e(){return t(this,arguments.length>0?arguments[0]:undefined)}},{get:function e(t){var r=n.getEntry(i(this,a),t);return r&&r.v},set:function e(t,r){return n.def(i(this,a),t===0?0:t,r)}},n,true)},{149:149,49:49,51:51}],184:[function(e,t,r){var n=e(62);var i=e(92);var a=Math.sqrt;var o=Math.acosh;n(n.S+n.F*!(o&&Math.floor(o(Number.MAX_VALUE))==710&&o(Infinity)==Infinity),"Math",{acosh:function e(t){return(t=+t)<1?NaN:t>94906265.62425156?Math.log(t)+Math.LN2:i(t-1+a(t-1)*a(t+1))}})},{62:62,92:92}],185:[function(e,t,r){var n=e(62);var i=Math.asinh;function a(e){return!isFinite(e=+e)||e==0?e:e<0?-a(-e):Math.log(e+Math.sqrt(e*e+1))}n(n.S+n.F*!(i&&1/i(0)>0),"Math",{asinh:a})},{62:62}],186:[function(e,t,r){var n=e(62);var i=Math.atanh;n(n.S+n.F*!(i&&1/i(-0)<0),"Math",{atanh:function e(t){return(t=+t)==0?t:Math.log((1+t)/(1-t))/2}})},{62:62}],187:[function(e,t,r){var n=e(62);var i=e(93);n(n.S,"Math",{cbrt:function e(t){return i(t=+t)*Math.pow(Math.abs(t),1/3)}})},{62:62,93:93}],188:[function(e,t,r){var n=e(62);n(n.S,"Math",{clz32:function e(t){return(t>>>=0)?31-Math.floor(Math.log(t+.5)*Math.LOG2E):32}})},{62:62}],189:[function(e,t,r){var n=e(62);var i=Math.exp;n(n.S,"Math",{cosh:function e(t){return(i(t=+t)+i(-t))/2}})},{62:62}],190:[function(e,t,r){var n=e(62);var i=e(90);n(n.S+n.F*(i!=Math.expm1),"Math",{expm1:i})},{62:62,90:90}],191:[function(e,t,r){var n=e(62);n(n.S,"Math",{fround:e(91)})},{62:62,91:91}],192:[function(e,t,r){var n=e(62);var l=Math.abs;n(n.S,"Math",{hypot:function e(t,r){var n=0;var i=0;var a=arguments.length;var o=0;var s,u;while(i<a){s=l(arguments[i++]);if(o<s){u=o/s;n=n*u*u+1;o=s}else if(s>0){u=s/o;n+=u*u}else n+=s}return o===Infinity?Infinity:o*Math.sqrt(n)}})},{62:62}],193:[function(e,t,r){var n=e(62);var i=Math.imul;n(n.S+n.F*e(64)(function(){return i(4294967295,5)!=-5||i.length!=2}),"Math",{imul:function e(t,r){var n=65535;var i=+t;var a=+r;var o=n&i;var s=n&a;return 0|o*s+((n&i>>>16)*s+o*(n&a>>>16)<<16>>>0)}})},{62:62,64:64}],194:[function(e,t,r){var n=e(62);n(n.S,"Math",{log10:function e(t){return Math.log(t)*Math.LOG10E}})},{62:62}],195:[function(e,t,r){var n=e(62);n(n.S,"Math",{log1p:e(92)})},{62:62,92:92}],196:[function(e,t,r){var n=e(62);n(n.S,"Math",{log2:function e(t){return Math.log(t)/Math.LN2}})},{62:62}],197:[function(e,t,r){var n=e(62);n(n.S,"Math",{sign:e(93)})},{62:62,93:93}],198:[function(e,t,r){var n=e(62);var i=e(90);var a=Math.exp;n(n.S+n.F*e(64)(function(){return!Math.sinh(-2e-17)!=-2e-17}),"Math",{sinh:function e(t){return Math.abs(t=+t)<1?(i(t)-i(-t))/2:(a(t-1)-a(-t-1))*(Math.E/2)}})},{62:62,64:64,90:90}],199:[function(e,t,r){var n=e(62);var i=e(90);var a=Math.exp;n(n.S,"Math",{tanh:function e(t){var r=i(t=+t);var n=i(-t);return r==Infinity?1:n==Infinity?-1:(r-n)/(a(t)+a(-t))}})},{62:62,90:90}],200:[function(e,t,r){var n=e(62);n(n.S,"Math",{trunc:function e(t){return(t>0?Math.floor:Math.ceil)(t)}})},{62:62}],201:[function(e,t,r){"use strict";var n=e(70);var i=e(71);var a=e(48);var o=e(75);var c=e(143);var s=e(64);var u=e(103).f;var l=e(101).f;var h=e(99).f;var f=e(134).trim;var d="Number";var p=n[d];var v=p;var m=p.prototype;var g=a(e(98)(m))==d;var y="trim"in String.prototype;var x=function(e){var t=c(e,false);if(typeof t=="string"&&t.length>2){t=y?t.trim():f(t,3);var r=t.charCodeAt(0);var n,i,a;if(r===43||r===45){n=t.charCodeAt(2);if(n===88||n===120)return NaN}else if(r===48){switch(t.charCodeAt(1)){case 66:case 98:i=2;a=49;break;case 79:case 111:i=8;a=55;break;default:return+t}for(var o=t.slice(2),s=0,u=o.length,l;s<u;s++){l=o.charCodeAt(s);if(l<48||l>a)return NaN}return parseInt(o,i)}}return+t};if(!p(" 0o1")||!p("0b1")||p("+0x1")){p=function e(t){var r=arguments.length<1?0:t;var n=this;return n instanceof p&&(g?s(function(){m.valueOf.call(n)}):a(n)!=d)?o(new v(x(r)),n,p):x(r)};for(var b=e(58)?u(v):("MAX_VALUE,MIN_VALUE,NaN,NEGATIVE_INFINITY,POSITIVE_INFINITY,"+"EPSILON,isFinite,isInteger,isNaN,isSafeInteger,MAX_SAFE_INTEGER,"+"MIN_SAFE_INTEGER,parseFloat,parseInt,isInteger").split(","),w=0,_;b.length>w;w++){if(i(v,_=b[w])&&!i(p,_)){h(p,_,l(v,_))}}p.prototype=m;m.constructor=p;e(118)(n,d,p)}},{101:101,103:103,118:118,134:134,143:143,48:48,58:58,64:64,70:70,71:71,75:75,98:98,99:99}],202:[function(e,t,r){var n=e(62);n(n.S,"Number",{EPSILON:Math.pow(2,-52)})},{62:62}],203:[function(e,t,r){var n=e(62);var i=e(70).isFinite;n(n.S,"Number",{isFinite:function e(t){return typeof t=="number"&&i(t)}})},{62:62,70:70}],204:[function(e,t,r){var n=e(62);n(n.S,"Number",{isInteger:e(80)})},{62:62,80:80}],205:[function(e,t,r){var n=e(62);n(n.S,"Number",{isNaN:function e(t){return t!=t}})},{62:62}],206:[function(e,t,r){var n=e(62);var i=e(80);var a=Math.abs;n(n.S,"Number",{isSafeInteger:function e(t){return i(t)&&a(t)<=9007199254740991}})},{62:62,80:80}],207:[function(e,t,r){var n=e(62);n(n.S,"Number",{MAX_SAFE_INTEGER:9007199254740991})},{62:62}],208:[function(e,t,r){var n=e(62);n(n.S,"Number",{MIN_SAFE_INTEGER:-9007199254740991})},{62:62}],209:[function(e,t,r){var n=e(62);var i=e(112);n(n.S+n.F*(Number.parseFloat!=i),"Number",{parseFloat:i})},{112:112,62:62}],210:[function(e,t,r){var n=e(62);var i=e(113);n(n.S+n.F*(Number.parseInt!=i),"Number",{parseInt:i})},{113:113,62:62}],211:[function(e,t,r){"use strict";var n=e(62);var c=e(139);var h=e(34);var f=e(133);var i=1..toFixed;var a=Math.floor;var o=[0,0,0,0,0,0];var d="Number.toFixed: incorrect invocation!";var p="0";var v=function(e,t){var r=-1;var n=t;while(++r<6){n+=e*o[r];o[r]=n%1e7;n=a(n/1e7)}};var m=function(e){var t=6;var r=0;while(--t>=0){r+=o[t];o[t]=a(r/e);r=r%e*1e7}};var g=function(){var e=6;var t="";while(--e>=0){if(t!==""||e===0||o[e]!==0){var r=String(o[e]);t=t===""?r:t+f.call(p,7-r.length)+r}}return t};var y=function(e,t,r){return t===0?r:t%2===1?y(e,t-1,r*e):y(e*e,t/2,r)};var x=function(e){var t=0;var r=e;while(r>=4096){t+=12;r/=4096}while(r>=2){t+=1;r/=2}return t};n(n.P+n.F*(!!i&&(8e-5.toFixed(3)!=="0.000"||.9.toFixed(0)!=="1"||1.255.toFixed(2)!=="1.25"||0xde0b6b3a7640080.toFixed(0)!=="1000000000000000128")||!e(64)(function(){i.call({})})),"Number",{toFixed:function e(t){var r=h(this,d);var n=c(t);var i="";var a=p;var o,s,u,l;if(n<0||n>20)throw RangeError(d);if(r!=r)return"NaN";if(r<=-1e21||r>=1e21)return String(r);if(r<0){i="-";r=-r}if(r>1e-21){o=x(r*y(2,69,1))-69;s=o<0?r*y(2,-o,1):r/y(2,o,1);s*=4503599627370496;o=52-o;if(o>0){v(0,s);u=n;while(u>=7){v(1e7,0);u-=7}v(y(10,u,1),0);u=o-1;while(u>=23){m(1<<23);u-=23}m(1<<u);v(1,1);m(2);a=g()}else{v(0,s);v(1<<-o,0);a=g()+f.call(p,n)}}if(n>0){l=a.length;a=i+(l<=n?"0."+f.call(p,n-l)+a:a.slice(0,l-n)+"."+a.slice(l-n))}else{a=i+a}return a}})},{133:133,139:139,34:34,62:62,64:64}],212:[function(e,t,r){"use strict";var n=e(62);var i=e(64);var a=e(34);var o=1..toPrecision;n(n.P+n.F*(i(function(){return o.call(1,undefined)!=="1"})||!i(function(){o.call({})})),"Number",{toPrecision:function e(t){var r=a(this,"Number#toPrecision: incorrect invocation!");return t===undefined?o.call(r):o.call(r,t)}})},{34:34,62:62,64:64}],213:[function(e,t,r){var n=e(62);n(n.S+n.F,"Object",{assign:e(97)})},{62:62,97:97}],214:[function(e,t,r){var n=e(62);n(n.S,"Object",{create:e(98)})},{62:62,98:98}],215:[function(e,t,r){var n=e(62);n(n.S+n.F*!e(58),"Object",{defineProperties:e(100)})},{100:100,58:58,62:62}],216:[function(e,t,r){var n=e(62);n(n.S+n.F*!e(58),"Object",{defineProperty:e(99).f})},{58:58,62:62,99:99}],217:[function(e,t,r){var n=e(81);var i=e(94).onFreeze;e(109)("freeze",function(r){return function e(t){return r&&n(t)?r(i(t)):t}})},{109:109,81:81,94:94}],218:[function(e,t,r){var n=e(140);var i=e(101).f;e(109)("getOwnPropertyDescriptor",function(){return function e(t,r){return i(n(t),r)}})},{101:101,109:109,140:140}],219:[function(e,t,r){e(109)("getOwnPropertyNames",function(){return e(102).f})},{102:102,109:109}],220:[function(e,t,r){var n=e(142);var i=e(105);e(109)("getPrototypeOf",function(){return function e(t){return i(n(t))}})},{105:105,109:109,142:142}],221:[function(e,t,r){var n=e(81);e(109)("isExtensible",function(r){return function e(t){return n(t)?r?r(t):true:false}})},{109:109,81:81}],222:[function(e,t,r){var n=e(81);e(109)("isFrozen",function(r){return function e(t){return n(t)?r?r(t):false:true}})},{109:109,81:81}],223:[function(e,t,r){var n=e(81);e(109)("isSealed",function(r){return function e(t){return n(t)?r?r(t):false:true}})},{109:109,81:81}],224:[function(e,t,r){var n=e(62);n(n.S,"Object",{is:e(121)})},{121:121,62:62}],225:[function(e,t,r){var n=e(142);var i=e(107);e(109)("keys",function(){return function e(t){return i(n(t))}})},{107:107,109:109,142:142}],226:[function(e,t,r){var n=e(81);var i=e(94).onFreeze;e(109)("preventExtensions",function(r){return function e(t){return r&&n(t)?r(i(t)):t}})},{109:109,81:81,94:94}],227:[function(e,t,r){var n=e(81);var i=e(94).onFreeze;e(109)("seal",function(r){return function e(t){return r&&n(t)?r(i(t)):t}})},{109:109,81:81,94:94}],228:[function(e,t,r){var n=e(62);n(n.S,"Object",{setPrototypeOf:e(122).set})},{122:122,62:62}],229:[function(e,t,r){"use strict";var n=e(47);var i={};i[e(152)("toStringTag")]="z";if(i+""!="[object z]"){e(118)(Object.prototype,"toString",function e(){return"[object "+n(this)+"]"},true)}},{118:118,152:152,47:47}],230:[function(e,t,r){var n=e(62);var i=e(112);n(n.G+n.F*(parseFloat!=i),{parseFloat:i})},{112:112,62:62}],231:[function(e,t,r){var n=e(62);var i=e(113);n(n.G+n.F*(parseInt!=i),{parseInt:i})},{113:113,62:62}],232:[function(r,e,t){"use strict";var n=r(89);var o=r(70);var i=r(54);var a=r(47);var s=r(62);var u=r(81);var l=r(33);var c=r(37);var h=r(68);var f=r(127);var d=r(136).set;var p=r(95)();var v=r(96);var m=r(114);var g=r(148);var y=r(115);var x="Promise";var b=o.TypeError;var w=o.process;var _=w&&w.versions;var T=_&&_.v8||"";var E=o[x];var M=a(w)=="process";var S=function(){};var A,R,P,C;var O=R=v.f;var L=!!function(){try{var e=E.resolve(1);var t=(e.constructor={})[r(152)("species")]=function(e){e(S,S)};return(M||typeof PromiseRejectionEvent=="function")&&e.then(S)instanceof t&&T.indexOf("6.6")!==0&&g.indexOf("Chrome/66")===-1}catch(e){}}();var I=function(e){var t;return u(e)&&typeof(t=e.then)=="function"?t:false};var D=function(c,r){if(c._n)return;c._n=true;var n=c._c;p(function(){var u=c._v;var l=c._s==1;var e=0;var t=function(e){var t=l?e.ok:e.fail;var r=e.resolve;var n=e.reject;var i=e.domain;var a,o,s;try{if(t){if(!l){if(c._h==2)B(c);c._h=1}if(t===true)a=u;else{if(i)i.enter();a=t(u);if(i){i.exit();s=true}}if(a===e.promise){n(b("Promise-chain cycle"))}else if(o=I(a)){o.call(a,r,n)}else r(a)}else n(u)}catch(e){if(i&&!s)i.exit();n(e)}};while(n.length>e)t(n[e++]);c._c=[];c._n=false;if(r&&!c._h)N(c)})};var N=function(a){d.call(o,function(){var e=a._v;var t=F(a);var r,n,i;if(t){r=m(function(){if(M){w.emit("unhandledRejection",e,a)}else if(n=o.onunhandledrejection){n({promise:a,reason:e})}else if((i=o.console)&&i.error){i.error("Unhandled promise rejection",e)}});a._h=M||F(a)?2:1}a._a=undefined;if(t&&r.e)throw r.v})};var F=function(e){return e._h!==1&&(e._a||e._c).length===0};var B=function(t){d.call(o,function(){var e;if(M){w.emit("rejectionHandled",t)}else if(e=o.onrejectionhandled){e({promise:t,reason:t._v})}})};var U=function(e){var t=this;if(t._d)return;t._d=true;t=t._w||t;t._v=e;t._s=2;if(!t._a)t._a=t._c.slice();D(t,true)};var k=function(e){var r=this;var n;if(r._d)return;r._d=true;r=r._w||r;try{if(r===e)throw b("Promise can't be resolved itself");if(n=I(e)){p(function(){var t={_w:r,_d:false};try{n.call(e,i(k,t,1),i(U,t,1))}catch(e){U.call(t,e)}})}else{r._v=e;r._s=1;D(r,false)}}catch(e){U.call({_w:r,_d:false},e)}};if(!L){E=function e(t){c(this,E,x,"_h");l(t);A.call(this);try{t(i(k,this,1),i(U,this,1))}catch(e){U.call(this,e)}};A=function e(t){this._c=[];this._a=undefined;this._s=0;this._d=false;this._v=undefined;this._h=0;this._n=false};A.prototype=r(117)(E.prototype,{then:function e(t,r){var n=O(f(this,E));n.ok=typeof t=="function"?t:true;n.fail=typeof r=="function"&&r;n.domain=M?w.domain:undefined;this._c.push(n);if(this._a)this._a.push(n);if(this._s)D(this,false);return n.promise},catch:function(e){return this.then(undefined,e)}});P=function(){var e=new A;this.promise=e;this.resolve=i(k,e,1);this.reject=i(U,e,1)};v.f=O=function(e){return e===E||e===C?new P(e):R(e)}}s(s.G+s.W+s.F*!L,{Promise:E});r(124)(E,x);r(123)(x);C=r(52)[x];s(s.S+s.F*!L,x,{reject:function e(t){var r=O(this);var n=r.reject;n(t);return r.promise}});s(s.S+s.F*(n||!L),x,{resolve:function e(t){return y(n&&this===C?E:this,t)}});s(s.S+s.F*!(L&&r(86)(function(e){E.all(e)["catch"](S)})),x,{all:function e(t){var o=this;var r=O(o);var s=r.resolve;var u=r.reject;var n=m(function(){var n=[];var i=0;var a=1;h(t,false,function(e){var t=i++;var r=false;n.push(undefined);a++;o.resolve(e).then(function(e){if(r)return;r=true;n[t]=e;--a||s(n)},u)});--a||s(n)});if(n.e)u(n.v);return r.promise},race:function e(t){var r=this;var n=O(r);var i=n.reject;var a=m(function(){h(t,false,function(e){r.resolve(e).then(n.resolve,i)})});if(a.e)i(a.v);return n.promise}})},{114:114,115:115,117:117,123:123,124:124,127:127,136:136,148:148,152:152,33:33,37:37,47:47,52:52,54:54,62:62,68:68,70:70,81:81,86:86,89:89,95:95,96:96}],233:[function(e,t,r){var n=e(62);var o=e(33);var s=e(38);var u=(e(70).Reflect||{}).apply;var l=Function.apply;n(n.S+n.F*!e(64)(function(){u(function(){})}),"Reflect",{apply:function e(t,r,n){var i=o(t);var a=s(n);return u?u(i,r,a):l.call(i,r,a)}})},{33:33,38:38,62:62,64:64,70:70}],234:[function(e,t,r){var n=e(62);var u=e(98);var l=e(33);var c=e(38);var h=e(81);var i=e(64);var f=e(46);var d=(e(70).Reflect||{}).construct;var p=i(function(){function e(){}return!(d(function(){},[],e)instanceof e)});var v=!i(function(){d(function(){})});n(n.S+n.F*(p||v),"Reflect",{construct:function e(t,r){l(t);c(r);var n=arguments.length<3?t:l(arguments[2]);if(v&&!p)return d(t,r,n);if(t==n){switch(r.length){case 0:return new t;case 1:return new t(r[0]);case 2:return new t(r[0],r[1]);case 3:return new t(r[0],r[1],r[2]);case 4:return new t(r[0],r[1],r[2],r[3])}var i=[null];i.push.apply(i,r);return new(f.apply(t,i))}var a=n.prototype;var o=u(h(a)?a:Object.prototype);var s=Function.apply.call(t,o,r);return h(s)?s:o}})},{33:33,38:38,46:46,62:62,64:64,70:70,81:81,98:98}],235:[function(e,t,r){var i=e(99);var n=e(62);var a=e(38);var o=e(143);n(n.S+n.F*e(64)(function(){Reflect.defineProperty(i.f({},1,{value:1}),1,{value:2})}),"Reflect",{defineProperty:function e(t,r,n){a(t);r=o(r,true);a(n);try{i.f(t,r,n);return true}catch(e){return false}}})},{143:143,38:38,62:62,64:64,99:99}],236:[function(e,t,r){var n=e(62);var i=e(101).f;var a=e(38);n(n.S,"Reflect",{deleteProperty:function e(t,r){var n=i(a(t),r);return n&&!n.configurable?false:delete t[r]}})},{101:101,38:38,62:62}],237:[function(e,t,r){"use strict";var n=e(62);var i=e(38);var a=function(e){this._t=i(e);this._i=0;var t=this._k=[];var r;for(r in e)t.push(r)};e(84)(a,"Object",function(){var e=this;var t=e._k;var r;do{if(e._i>=t.length)return{value:undefined,done:true}}while(!((r=t[e._i++])in e._t));return{value:r,done:false}});n(n.S,"Reflect",{enumerate:function e(t){return new a(t)}})},{38:38,62:62,84:84}],238:[function(e,t,r){var n=e(101);var i=e(62);var a=e(38);i(i.S,"Reflect",{getOwnPropertyDescriptor:function e(t,r){return n.f(a(t),r)}})},{101:101,38:38,62:62}],239:[function(e,t,r){var n=e(62);var i=e(105);var a=e(38);n(n.S,"Reflect",{getPrototypeOf:function e(t){return i(a(t))}})},{105:105,38:38,62:62}],240:[function(e,t,r){var a=e(101);var o=e(105);var s=e(71);var n=e(62);var u=e(81);var l=e(38);function c(e,t){var r=arguments.length<3?e:arguments[2];var n,i;if(l(e)===r)return e[t];if(n=a.f(e,t))return s(n,"value")?n.value:n.get!==undefined?n.get.call(r):undefined;if(u(i=o(e)))return c(i,t,r)}n(n.S,"Reflect",{get:c})},{101:101,105:105,38:38,62:62,71:71,81:81}],241:[function(e,t,r){var n=e(62);n(n.S,"Reflect",{has:function e(t,r){return r in t}})},{62:62}],242:[function(e,t,r){var n=e(62);var i=e(38);var a=Object.isExtensible;n(n.S,"Reflect",{isExtensible:function e(t){i(t);return a?a(t):true}})},{38:38,62:62}],243:[function(e,t,r){var n=e(62);n(n.S,"Reflect",{ownKeys:e(111)})},{111:111,62:62}],244:[function(e,t,r){var n=e(62);var i=e(38);var a=Object.preventExtensions;n(n.S,"Reflect",{preventExtensions:function e(t){i(t);try{if(a)a(t);return true}catch(e){return false}}})},{38:38,62:62}],245:[function(e,t,r){var n=e(62);var i=e(122);if(i)n(n.S,"Reflect",{setPrototypeOf:function e(t,r){i.check(t,r);try{i.set(t,r);return true}catch(e){return false}}})},{122:122,62:62}],246:[function(e,t,r){var s=e(99);var u=e(101);var l=e(105);var c=e(71);var n=e(62);var h=e(116);var f=e(38);var d=e(81);function p(e,t,r){var n=arguments.length<4?e:arguments[3];var i=u.f(f(e),t);var a,o;if(!i){if(d(o=l(e))){return p(o,t,r,n)}i=h(0)}if(c(i,"value")){if(i.writable===false||!d(n))return false;if(a=u.f(n,t)){if(a.get||a.set||a.writable===false)return false;a.value=r;s.f(n,t,a)}else s.f(n,t,h(0,r));return true}return i.set===undefined?false:(i.set.call(n,r),true)}n(n.S,"Reflect",{set:p})},{101:101,105:105,116:116,38:38,62:62,71:71,81:81,99:99}],247:[function(e,t,r){var n=e(70);var o=e(75);var i=e(99).f;var a=e(103).f;var s=e(82);var u=e(66);var l=n.RegExp;var c=l;var h=l.prototype;var f=/a/g;var d=/a/g;var p=new l(f)!==f;if(e(58)&&(!p||e(64)(function(){d[e(152)("match")]=false;return l(f)!=f||l(d)==d||l(f,"i")!="/a/i"}))){l=function e(t,r){var n=this instanceof l;var i=s(t);var a=r===undefined;return!n&&i&&t.constructor===l&&a?t:o(p?new c(i&&!a?t.source:t,r):c((i=t instanceof l)?t.source:t,i&&a?u.call(t):r),n?this:h,l)};var v=function(t){t in l||i(l,t,{configurable:true,get:function(){return c[t]},set:function(e){c[t]=e}})};for(var m=a(c),g=0;m.length>g;)v(m[g++]);h.constructor=l;l.prototype=h;e(118)(n,"RegExp",l)}e(123)("RegExp")},{103:103,118:118,123:123,152:152,58:58,64:64,66:66,70:70,75:75,82:82,99:99}],248:[function(e,t,r){"use strict";var n=e(120);e(62)({target:"RegExp",proto:true,forced:n!==/./.exec},{exec:n})},{120:120,62:62}],249:[function(e,t,r){if(e(58)&&/./g.flags!="g")e(99).f(RegExp.prototype,"flags",{configurable:true,get:e(66)})},{58:58,66:66,99:99}],250:[function(e,t,r){"use strict";var h=e(38);var f=e(141);var d=e(36);var p=e(119);e(65)("match",1,function(i,a,l,c){return[function e(t){var r=i(this);var n=t==undefined?undefined:t[a];return n!==undefined?n.call(t,r):new RegExp(t)[a](String(r))},function(e){var t=c(l,e,this);if(t.done)return t.value;var r=h(e);var n=String(this);if(!r.global)return p(r,n);var i=r.unicode;r.lastIndex=0;var a=[];var o=0;var s;while((s=p(r,n))!==null){var u=String(s[0]);a[o]=u;if(u==="")r.lastIndex=d(n,f(r.lastIndex),i);o++}return o===0?null:a}]})},{119:119,141:141,36:36,38:38,65:65}],251:[function(e,t,r){"use strict";var E=e(38);var n=e(142);var M=e(141);var S=e(139);var A=e(36);var R=e(119);var P=Math.max;var C=Math.min;var f=Math.floor;var i=/\$([$&`']|\d\d?|<[^>]*>)/g;var d=/\$([$&`']|\d\d?)/g;var O=function(e){return e===undefined?e:String(e)};e(65)("replace",2,function(a,o,w,_){return[function e(t,r){var n=a(this);var i=t==undefined?undefined:t[o];return i!==undefined?i.call(t,n,r):w.call(String(n),t,r)},function(e,t){var r=_(w,e,this,t);if(r.done)return r.value;var n=E(e);var i=String(this);var a=typeof t==="function";if(!a)t=String(t);var o=n.global;if(o){var s=n.unicode;n.lastIndex=0}var u=[];while(true){var l=R(n,i);if(l===null)break;u.push(l);if(!o)break;var c=String(l[0]);if(c==="")n.lastIndex=A(i,M(n.lastIndex),s)}var h="";var f=0;for(var d=0;d<u.length;d++){l=u[d];var p=String(l[0]);var v=P(C(S(l.index),i.length),0);var m=[];for(var g=1;g<l.length;g++)m.push(O(l[g]));var y=l.groups;if(a){var x=[p].concat(m,v,i);if(y!==undefined)x.push(y);var b=String(t.apply(undefined,x))}else{b=T(p,i,v,m,y,t)}if(v>=f){h+=i.slice(f,v)+b;f=v+p.length}}return h+i.slice(f)}];function T(a,o,s,u,l,e){var c=s+a.length;var h=u.length;var t=d;if(l!==undefined){l=n(l);t=i}return w.call(e,t,function(e,t){var r;switch(t.charAt(0)){case"$":return"$";case"&":return a;case"`":return o.slice(0,s);case"'":return o.slice(c);case"<":r=l[t.slice(1,-1)];break;default:var n=+t;if(n===0)return e;if(n>h){var i=f(n/10);if(i===0)return e;if(i<=h)return u[i-1]===undefined?t.charAt(1):u[i-1]+t.charAt(1);return e}r=u[n-1]}return r===undefined?"":r})}})},{119:119,139:139,141:141,142:142,36:36,38:38,65:65}],252:[function(e,t,r){"use strict";var u=e(38);var l=e(121);var c=e(119);e(65)("search",1,function(i,a,o,s){return[function e(t){var r=i(this);var n=t==undefined?undefined:t[a];return n!==undefined?n.call(t,r):new RegExp(t)[a](String(r))},function(e){var t=s(o,e,this);if(t.done)return t.value;var r=u(e);var n=String(this);var i=r.lastIndex;if(!l(i,0))r.lastIndex=0;var a=c(r,n);if(!l(r.lastIndex,i))r.lastIndex=i;return a===null?-1:a.index}]})},{119:119,121:121,38:38,65:65}],253:[function(e,t,r){"use strict";var h=e(82);var x=e(38);var b=e(127);var w=e(36);var _=e(141);var T=e(119);var f=e(120);var n=e(64);var E=Math.min;var d=[].push;var i="split";var p="length";var v="lastIndex";var M=4294967295;var S=!n(function(){RegExp(M,"y")});e(65)("split",2,function(a,o,m,g){var y;if("abbc"[i](/(b)*/)[1]=="c"||"test"[i](/(?:)/,-1)[p]!=4||"ab"[i](/(?:ab)*/)[p]!=2||"."[i](/(.?)(.?)/)[p]!=4||"."[i](/()()/)[p]>1||""[i](/.?/)[p]){y=function(e,t){var r=String(this);if(e===undefined&&t===0)return[];if(!h(e))return m.call(r,e,t);var n=[];var i=(e.ignoreCase?"i":"")+(e.multiline?"m":"")+(e.unicode?"u":"")+(e.sticky?"y":"");var a=0;var o=t===undefined?M:t>>>0;var s=new RegExp(e.source,i+"g");var u,l,c;while(u=f.call(s,r)){l=s[v];if(l>a){n.push(r.slice(a,u.index));if(u[p]>1&&u.index<r[p])d.apply(n,u.slice(1));c=u[0][p];a=l;if(n[p]>=o)break}if(s[v]===u.index)s[v]++}if(a===r[p]){if(c||!s.test(""))n.push("")}else n.push(r.slice(a));return n[p]>o?n.slice(0,o):n}}else if("0"[i](undefined,0)[p]){y=function(e,t){return e===undefined&&t===0?[]:m.call(this,e,t)}}else{y=m}return[function e(t,r){var n=a(this);var i=t==undefined?undefined:t[o];return i!==undefined?i.call(t,n,r):y.call(String(n),t,r)},function(e,t){var r=g(y,e,this,t,y!==m);if(r.done)return r.value;var n=x(e);var i=String(this);var a=b(n,RegExp);var o=n.unicode;var s=(n.ignoreCase?"i":"")+(n.multiline?"m":"")+(n.unicode?"u":"")+(S?"y":"g");var u=new a(S?n:"^(?:"+n.source+")",s);var l=t===undefined?M:t>>>0;if(l===0)return[];if(i.length===0)return T(u,i)===null?[i]:[];var c=0;var h=0;var f=[];while(h<i.length){u.lastIndex=S?h:0;var d=T(u,S?i:i.slice(h));var p;if(d===null||(p=E(_(u.lastIndex+(S?0:h)),i.length))===c){h=w(i,h,o)}else{f.push(i.slice(c,h));if(f.length===l)return f;for(var v=1;v<=d.length-1;v++){f.push(d[v]);if(f.length===l)return f}h=c=p}}f.push(i.slice(c));return f}]})},{119:119,120:120,127:127,141:141,36:36,38:38,64:64,65:65,82:82}],254:[function(t,e,r){"use strict";t(249);var n=t(38);var i=t(66);var a=t(58);var o="toString";var s=/./[o];var u=function(e){t(118)(RegExp.prototype,o,e,true)};if(t(64)(function(){return s.call({source:"a",flags:"b"})!="/a/b"})){u(function e(){var t=n(this);return"/".concat(t.source,"/","flags"in t?t.flags:!a&&t instanceof RegExp?i.call(t):undefined)})}else if(s.name!=o){u(function e(){return s.call(this)})}},{118:118,249:249,38:38,58:58,64:64,66:66}],255:[function(e,t,r){"use strict";var n=e(49);var i=e(149);var a="Set";t.exports=e(51)(a,function(t){return function e(){return t(this,arguments.length>0?arguments[0]:undefined)}},{add:function e(t){return n.def(i(this,a),t=t===0?0:t,t)}},n)},{149:149,49:49,51:51}],256:[function(e,t,r){"use strict";e(131)("anchor",function(r){return function e(t){return r(this,"a","name",t)}})},{131:131}],257:[function(e,t,r){"use strict";e(131)("big",function(t){return function e(){return t(this,"big","","")}})},{131:131}],258:[function(e,t,r){"use strict";e(131)("blink",function(t){return function e(){return t(this,"blink","","")}})},{131:131}],259:[function(e,t,r){"use strict";e(131)("bold",function(t){return function e(){return t(this,"b","","")}})},{131:131}],260:[function(e,t,r){"use strict";var n=e(62);var i=e(129)(false);n(n.P,"String",{codePointAt:function e(t){return i(this,t)}})},{129:129,62:62}],261:[function(e,t,r){"use strict";var n=e(62);var s=e(141);var u=e(130);var l="endsWith";var c=""[l];n(n.P+n.F*e(63)(l),"String",{endsWith:function e(t){var r=u(this,t,l);var n=arguments.length>1?arguments[1]:undefined;var i=s(r.length);var a=n===undefined?i:Math.min(s(n),i);var o=String(t);return c?c.call(r,o,a):r.slice(a-o.length,a)===o}})},{130:130,141:141,62:62,63:63}],262:[function(e,t,r){"use strict";e(131)("fixed",function(t){return function e(){return t(this,"tt","","")}})},{131:131}],263:[function(e,t,r){"use strict";e(131)("fontcolor",function(r){return function e(t){return r(this,"font","color",t)}})},{131:131}],264:[function(e,t,r){"use strict";e(131)("fontsize",function(r){return function e(t){return r(this,"font","size",t)}})},{131:131}],265:[function(e,t,r){var n=e(62);var o=e(137);var s=String.fromCharCode;var i=String.fromCodePoint;n(n.S+n.F*(!!i&&i.length!=1),"String",{fromCodePoint:function e(t){var r=[];var n=arguments.length;var i=0;var a;while(n>i){a=+arguments[i++];if(o(a,1114111)!==a)throw RangeError(a+" is not a valid code point");r.push(a<65536?s(a):s(((a-=65536)>>10)+55296,a%1024+56320))}return r.join("")}})},{137:137,62:62}],266:[function(e,t,r){"use strict";var n=e(62);var i=e(130);var a="includes";n(n.P+n.F*e(63)(a),"String",{includes:function e(t){return!!~i(this,t,a).indexOf(t,arguments.length>1?arguments[1]:undefined)}})},{130:130,62:62,63:63}],267:[function(e,t,r){"use strict";e(131)("italics",function(t){return function e(){return t(this,"i","","")}})},{131:131}],268:[function(e,t,r){"use strict";var n=e(129)(true);e(85)(String,"String",function(e){this._t=String(e);this._i=0},function(){var e=this._t;var t=this._i;var r;if(t>=e.length)return{value:undefined,done:true};r=n(e,t);this._i+=r.length;return{value:r,done:false}})},{129:129,85:85}],269:[function(e,t,r){"use strict";e(131)("link",function(r){return function e(t){return r(this,"a","href",t)}})},{131:131}],270:[function(e,t,r){var n=e(62);var s=e(140);var u=e(141);n(n.S,"String",{raw:function e(t){var r=s(t.raw);var n=u(r.length);var i=arguments.length;var a=[];var o=0;while(n>o){a.push(String(r[o++]));if(o<i)a.push(String(arguments[o]))}return a.join("")}})},{140:140,141:141,62:62}],271:[function(e,t,r){var n=e(62);n(n.P,"String",{repeat:e(133)})},{133:133,62:62}],272:[function(e,t,r){"use strict";e(131)("small",function(t){return function e(){return t(this,"small","","")}})},{131:131}],273:[function(e,t,r){"use strict";var n=e(62);var a=e(141);var o=e(130);var s="startsWith";var u=""[s];n(n.P+n.F*e(63)(s),"String",{startsWith:function e(t){var r=o(this,t,s);var n=a(Math.min(arguments.length>1?arguments[1]:undefined,r.length));var i=String(t);return u?u.call(r,i,n):r.slice(n,n+i.length)===i}})},{130:130,141:141,62:62,63:63}],274:[function(e,t,r){"use strict";e(131)("strike",function(t){return function e(){return t(this,"strike","","")}})},{131:131}],275:[function(e,t,r){"use strict";e(131)("sub",function(t){return function e(){return t(this,"sub","","")}})},{131:131}],276:[function(e,t,r){"use strict";e(131)("sup",function(t){return function e(){return t(this,"sup","","")}})},{131:131}],277:[function(e,t,r){"use strict";e(134)("trim",function(t){return function e(){return t(this,3)}})},{134:134}],278:[function(e,t,r){"use strict";var n=e(70);var s=e(71);var i=e(58);var a=e(62);var o=e(118);var u=e(94).KEY;var l=e(64);var c=e(126);var h=e(124);var f=e(147);var d=e(152);var p=e(151);var v=e(150);var m=e(61);var g=e(79);var y=e(38);var x=e(81);var b=e(142);var w=e(140);var _=e(143);var T=e(116);var E=e(98);var M=e(102);var S=e(101);var A=e(104);var R=e(99);var P=e(107);var C=S.f;var O=R.f;var L=M.f;var I=n.Symbol;var D=n.JSON;var N=D&&D.stringify;var F="prototype";var B=d("_hidden");var U=d("toPrimitive");var k={}.propertyIsEnumerable;var j=c("symbol-registry");var z=c("symbols");var H=c("op-symbols");var G=Object[F];var V=typeof I=="function"&&!!A.f;var W=n.QObject;var q=!W||!W[F]||!W[F].findChild;var X=i&&l(function(){return E(O({},"a",{get:function(){return O(this,"a",{value:7}).a}})).a!=7})?function(e,t,r){var n=C(G,t);if(n)delete G[t];O(e,t,r);if(n&&e!==G)O(G,t,n)}:O;var Y=function(e){var t=z[e]=E(I[F]);t._k=e;return t};var Z=V&&typeof I.iterator=="symbol"?function(e){return typeof e=="symbol"}:function(e){return e instanceof I};var J=function e(t,r,n){if(t===G)J(H,r,n);y(t);r=_(r,true);y(n);if(s(z,r)){if(!n.enumerable){if(!s(t,B))O(t,B,T(1,{}));t[B][r]=true}else{if(s(t,B)&&t[B][r])t[B][r]=false;n=E(n,{enumerable:T(0,false)})}return X(t,r,n)}return O(t,r,n)};var K=function e(t,r){y(t);var n=m(r=w(r));var i=0;var a=n.length;var o;while(a>i)J(t,o=n[i++],r[o]);return t};var Q=function e(t,r){return r===undefined?E(t):K(E(t),r)};var $=function e(t){var r=k.call(this,t=_(t,true));if(this===G&&s(z,t)&&!s(H,t))return false;return r||!s(this,t)||!s(z,t)||s(this,B)&&this[B][t]?r:true};var ee=function e(t,r){t=w(t);r=_(r,true);if(t===G&&s(z,r)&&!s(H,r))return;var n=C(t,r);if(n&&s(z,r)&&!(s(t,B)&&t[B][r]))n.enumerable=true;return n};var te=function e(t){var r=L(w(t));var n=[];var i=0;var a;while(r.length>i){if(!s(z,a=r[i++])&&a!=B&&a!=u)n.push(a)}return n};var re=function e(t){var r=t===G;var n=L(r?H:w(t));var i=[];var a=0;var o;while(n.length>a){if(s(z,o=n[a++])&&(r?s(G,o):true))i.push(z[o])}return i};if(!V){I=function e(){if(this instanceof I)throw TypeError("Symbol is not a constructor!");var t=f(arguments.length>0?arguments[0]:undefined);var r=function(e){if(this===G)r.call(H,e);if(s(this,B)&&s(this[B],t))this[B][t]=false;X(this,t,T(1,e))};if(i&&q)X(G,t,{configurable:true,set:r});return Y(t)};o(I[F],"toString",function e(){return this._k});S.f=ee;R.f=J;e(103).f=M.f=te;e(108).f=$;A.f=re;if(i&&!e(89)){o(G,"propertyIsEnumerable",$,true)}p.f=function(e){return Y(d(e))}}a(a.G+a.W+a.F*!V,{Symbol:I});for(var ne="hasInstance,isConcatSpreadable,iterator,match,replace,search,species,split,toPrimitive,toStringTag,unscopables".split(","),ie=0;ne.length>ie;)d(ne[ie++]);for(var ae=P(d.store),oe=0;ae.length>oe;)v(ae[oe++]);a(a.S+a.F*!V,"Symbol",{for:function(e){return s(j,e+="")?j[e]:j[e]=I(e)},keyFor:function e(t){if(!Z(t))throw TypeError(t+" is not a symbol!");for(var r in j)if(j[r]===t)return r},useSetter:function(){q=true},useSimple:function(){q=false}});a(a.S+a.F*!V,"Object",{create:Q,defineProperty:J,defineProperties:K,getOwnPropertyDescriptor:ee,getOwnPropertyNames:te,getOwnPropertySymbols:re});var se=l(function(){A.f(1)});a(a.S+a.F*se,"Object",{getOwnPropertySymbols:function e(t){return A.f(b(t))}});D&&a(a.S+a.F*(!V||l(function(){var e=I();return N([e])!="[null]"||N({a:e})!="{}"||N(Object(e))!="{}"})),"JSON",{stringify:function e(t){var r=[t];var n=1;var i,a;while(arguments.length>n)r.push(arguments[n++]);a=i=r[1];if(!x(i)&&t===undefined||Z(t))return;if(!g(i))i=function(e,t){if(typeof a=="function")t=a.call(this,e,t);if(!Z(t))return t};r[1]=i;return N.apply(D,r)}});I[F][U]||e(72)(I[F],U,I[F].valueOf);h(I,"Symbol");h(Math,"Math",true);h(n.JSON,"JSON",true)},{101:101,102:102,103:103,104:104,107:107,108:108,116:116,118:118,124:124,126:126,140:140,142:142,143:143,147:147,150:150,151:151,152:152,38:38,58:58,61:61,62:62,64:64,70:70,71:71,72:72,79:79,81:81,89:89,94:94,98:98,99:99}],279:[function(e,t,r){"use strict";var n=e(62);var i=e(146);var a=e(145);var c=e(38);var h=e(137);var f=e(141);var o=e(81);var s=e(70).ArrayBuffer;var d=e(127);var p=a.ArrayBuffer;var v=a.DataView;var u=i.ABV&&s.isView;var m=p.prototype.slice;var l=i.VIEW;var g="ArrayBuffer";n(n.G+n.W+n.F*(s!==p),{ArrayBuffer:p});n(n.S+n.F*!i.CONSTR,g,{isView:function e(t){return u&&u(t)||o(t)&&l in t}});n(n.P+n.U+n.F*e(64)(function(){return!new p(2).slice(1,undefined).byteLength}),g,{slice:function e(t,r){if(m!==undefined&&r===undefined)return m.call(c(this),t);var n=c(this).byteLength;var i=h(t,n);var a=h(r===undefined?n:r,n);var o=new(d(this,p))(f(a-i));var s=new v(this);var u=new v(o);var l=0;while(i<a){u.setUint8(l++,s.getUint8(i++))}return o}});e(123)(g)},{123:123,127:127,137:137,141:141,145:145,146:146,38:38,62:62,64:64,70:70,81:81}],280:[function(e,t,r){var n=e(62);n(n.G+n.W+n.F*!e(146).ABV,{DataView:e(145).DataView})},{145:145,146:146,62:62}],281:[function(e,t,r){e(144)("Float32",4,function(i){return function e(t,r,n){return i(this,t,r,n)}})},{144:144}],282:[function(e,t,r){e(144)("Float64",8,function(i){return function e(t,r,n){return i(this,t,r,n)}})},{144:144}],283:[function(e,t,r){e(144)("Int16",2,function(i){return function e(t,r,n){return i(this,t,r,n)}})},{144:144}],284:[function(e,t,r){e(144)("Int32",4,function(i){return function e(t,r,n){return i(this,t,r,n)}})},{144:144}],285:[function(e,t,r){e(144)("Int8",1,function(i){return function e(t,r,n){return i(this,t,r,n)}})},{144:144}],286:[function(e,t,r){e(144)("Uint16",2,function(i){return function e(t,r,n){return i(this,t,r,n)}})},{144:144}],287:[function(e,t,r){e(144)("Uint32",4,function(i){return function e(t,r,n){return i(this,t,r,n)}})},{144:144}],288:[function(e,t,r){e(144)("Uint8",1,function(i){return function e(t,r,n){return i(this,t,r,n)}})},{144:144}],289:[function(e,t,r){e(144)("Uint8",1,function(i){return function e(t,r,n){return i(this,t,r,n)}},true)},{144:144}],290:[function(e,t,r){"use strict";var n=e(70);var i=e(42)(0);var a=e(118);var o=e(94);var s=e(97);var u=e(50);var l=e(81);var c=e(149);var h=e(149);var f=!n.ActiveXObject&&"ActiveXObject"in n;var d="WeakMap";var p=o.getWeak;var v=Object.isExtensible;var m=u.ufstore;var g;var y=function(t){return function e(){return t(this,arguments.length>0?arguments[0]:undefined)}};var x={get:function e(t){if(l(t)){var r=p(t);if(r===true)return m(c(this,d)).get(t);return r?r[this._i]:undefined}},set:function e(t,r){return u.def(c(this,d),t,r)}};var b=t.exports=e(51)(d,y,x,u,true,true);if(h&&f){g=u.getConstructor(y,d);s(g.prototype,x);o.NEED=true;i(["delete","has","get","set"],function(n){var e=b.prototype;var i=e[n];a(e,n,function(e,t){if(l(e)&&!v(e)){if(!this._f)this._f=new g;var r=this._f[n](e,t);return n=="set"?this:r}return i.call(this,e,t)})})}},{118:118,149:149,42:42,50:50,51:51,70:70,81:81,94:94,97:97}],291:[function(e,t,r){"use strict";var n=e(50);var i=e(149);var a="WeakSet";e(51)(a,function(t){return function e(){return t(this,arguments.length>0?arguments[0]:undefined)}},{add:function e(t){return n.def(i(this,a),t,true)}},n,false,true)},{149:149,50:50,51:51}],292:[function(e,t,r){"use strict";var n=e(62);var a=e(67);var o=e(142);var s=e(141);var u=e(33);var l=e(45);n(n.P,"Array",{flatMap:function e(t){var r=o(this);var n,i;u(t);n=s(r.length);i=l(r,0);a(i,r,r,n,0,1,t,arguments[1]);return i}});e(35)("flatMap")},{141:141,142:142,33:33,35:35,45:45,62:62,67:67}],293:[function(e,t,r){"use strict";var n=e(62);var i=e(41)(true);n(n.P,"Array",{includes:function e(t){return i(this,t,arguments.length>1?arguments[1]:undefined)}});e(35)("includes")},{35:35,41:41,62:62}],294:[function(e,t,r){var n=e(62);var i=e(110)(true);n(n.S,"Object",{entries:function e(t){return i(t)}})},{110:110,62:62}],295:[function(e,t,r){var n=e(62);var l=e(111);var c=e(140);var h=e(101);var f=e(53);n(n.S,"Object",{getOwnPropertyDescriptors:function e(t){var r=c(t);var n=h.f;var i=l(r);var a={};var o=0;var s,u;while(i.length>o){u=n(r,s=i[o++]);if(u!==undefined)f(a,s,u)}return a}})},{101:101,111:111,140:140,53:53,62:62}],296:[function(e,t,r){var n=e(62);var i=e(110)(false);n(n.S,"Object",{values:function e(t){return i(t)}})},{110:110,62:62}],297:[function(e,t,r){"use strict";var n=e(62);var i=e(52);var a=e(70);var o=e(127);var s=e(115);n(n.P+n.R,"Promise",{finally:function(t){var r=o(this,i.Promise||a.Promise);var e=typeof t=="function";return this.then(e?function(e){return s(r,t()).then(function(){return e})}:t,e?function(e){return s(r,t()).then(function(){throw e})}:t)}})},{115:115,127:127,52:52,62:62,70:70}],298:[function(e,t,r){"use strict";var n=e(62);var i=e(132);var a=e(148);var o=/Version\/10\.\d+(\.\d+)?( Mobile\/\w+)? Safari\//.test(a);n(n.P+n.F*o,"String",{padEnd:function e(t){return i(this,t,arguments.length>1?arguments[1]:undefined,false)}})},{132:132,148:148,62:62}],299:[function(e,t,r){"use strict";var n=e(62);var i=e(132);var a=e(148);var o=/Version\/10\.\d+(\.\d+)?( Mobile\/\w+)? Safari\//.test(a);n(n.P+n.F*o,"String",{padStart:function e(t){return i(this,t,arguments.length>1?arguments[1]:undefined,true)}})},{132:132,148:148,62:62}],300:[function(e,t,r){"use strict";e(134)("trimLeft",function(t){return function e(){return t(this,1)}},"trimStart")},{134:134}],301:[function(e,t,r){"use strict";e(134)("trimRight",function(t){return function e(){return t(this,2)}},"trimEnd")},{134:134}],302:[function(e,t,r){e(150)("asyncIterator")},{150:150}],303:[function(e,t,r){var n=e(164);var i=e(107);var a=e(118);var o=e(70);var s=e(72);var u=e(88);var l=e(152);var c=l("iterator");var h=l("toStringTag");var f=u.Array;var d={CSSRuleList:true,CSSStyleDeclaration:false,CSSValueList:false,ClientRectList:false,DOMRectList:false,DOMStringList:false,DOMTokenList:true,DataTransferItemList:false,FileList:false,HTMLAllCollection:false,HTMLCollection:false,HTMLFormElement:false,HTMLSelectElement:false,MediaList:true,MimeTypeArray:false,NamedNodeMap:false,NodeList:true,PaintRequestList:false,Plugin:false,PluginArray:false,SVGLengthList:false,SVGNumberList:false,SVGPathSegList:false,SVGPointList:false,SVGStringList:false,SVGTransformList:false,SourceBufferList:false,StyleSheetList:true,TextTrackCueList:false,TextTrackList:false,TouchList:false};for(var p=i(d),v=0;v<p.length;v++){var m=p[v];var g=d[m];var y=o[m];var x=y&&y.prototype;var b;if(x){if(!x[c])s(x,c,f);if(!x[h])s(x,h,m);u[m]=f;if(g)for(b in n)if(!x[b])a(x,b,n[b],true)}}},{107:107,118:118,152:152,164:164,70:70,72:72,88:88}],304:[function(e,t,r){var n=e(62);var i=e(136);n(n.G+n.B,{setImmediate:i.set,clearImmediate:i.clear})},{136:136,62:62}],305:[function(e,t,r){var n=e(70);var i=e(62);var a=e(148);var o=[].slice;var s=/MSIE .\./.test(a);var u=function(i){return function(e,t){var r=arguments.length>2;var n=r?o.call(arguments,2):false;return i(r?function(){(typeof e=="function"?e:Function(e)).apply(this,n)}:e,t)}};i(i.G+i.B+i.F*s,{setTimeout:u(n.setTimeout),setInterval:u(n.setInterval)})},{148:148,62:62,70:70}],306:[function(e,t,r){e(305);e(304);e(303);t.exports=e(52)},{303:303,304:304,305:305,52:52}],307:[function(e,t,r){var n=function(a){"use strict";var e=Object.prototype;var l=e.hasOwnProperty;var u;var t=typeof Symbol==="function"?Symbol:{};var i=t.iterator||"@@iterator";var r=t.asyncIterator||"@@asyncIterator";var n=t.toStringTag||"@@toStringTag";function o(e,t,r,n){var i=t&&t.prototype instanceof s?t:s;var a=Object.create(i.prototype);var o=new R(n||[]);a._invoke=E(e,r,o);return a}a.wrap=o;function c(e,t,r){try{return{type:"normal",arg:e.call(t,r)}}catch(e){return{type:"throw",arg:e}}}var h="suspendedStart";var f="suspendedYield";var d="executing";var p="completed";var v={};function s(){}function m(){}function g(){}var y={};y[i]=function(){return this};var x=Object.getPrototypeOf;var b=x&&x(x(P([])));if(b&&b!==e&&l.call(b,i)){y=b}var w=g.prototype=s.prototype=Object.create(y);m.prototype=w.constructor=g;g.constructor=m;g[n]=m.displayName="GeneratorFunction";function _(e){["next","throw","return"].forEach(function(t){e[t]=function(e){return this._invoke(t,e)}})}a.isGeneratorFunction=function(e){var t=typeof e==="function"&&e.constructor;return t?t===m||(t.displayName||t.name)==="GeneratorFunction":false};a.mark=function(e){if(Object.setPrototypeOf){Object.setPrototypeOf(e,g)}else{e.__proto__=g;if(!(n in e)){e[n]="GeneratorFunction"}}e.prototype=Object.create(w);return e};a.awrap=function(e){return{__await:e}};function T(s){function u(e,t,r,n){var i=c(s[e],s,t);if(i.type==="throw"){n(i.arg)}else{var a=i.arg;var o=a.value;if(o&&typeof o==="object"&&l.call(o,"__await")){return Promise.resolve(o.__await).then(function(e){u("next",e,r,n)},function(e){u("throw",e,r,n)})}return Promise.resolve(o).then(function(e){a.value=e;r(a)},function(e){return u("throw",e,r,n)})}}var t;function e(r,n){function e(){return new Promise(function(e,t){u(r,n,e,t)})}return t=t?t.then(e,e):e()}this._invoke=e}_(T.prototype);T.prototype[r]=function(){return this};a.AsyncIterator=T;a.async=function(e,t,r,n){var i=new T(o(e,t,r,n));return a.isGeneratorFunction(t)?i:i.next().then(function(e){return e.done?e.value:i.next()})};function E(o,s,u){var l=h;return function e(t,r){if(l===d){throw new Error("Generator is already running")}if(l===p){if(t==="throw"){throw r}return C()}u.method=t;u.arg=r;while(true){var n=u.delegate;if(n){var i=M(n,u);if(i){if(i===v)continue;return i}}if(u.method==="next"){u.sent=u._sent=u.arg}else if(u.method==="throw"){if(l===h){l=p;throw u.arg}u.dispatchException(u.arg)}else if(u.method==="return"){u.abrupt("return",u.arg)}l=d;var a=c(o,s,u);if(a.type==="normal"){l=u.done?p:f;if(a.arg===v){continue}return{value:a.arg,done:u.done}}else if(a.type==="throw"){l=p;u.method="throw";u.arg=a.arg}}}}function M(e,t){var r=e.iterator[t.method];if(r===u){t.delegate=null;if(t.method==="throw"){if(e.iterator["return"]){t.method="return";t.arg=u;M(e,t);if(t.method==="throw"){return v}}t.method="throw";t.arg=new TypeError("The iterator does not provide a 'throw' method")}return v}var n=c(r,e.iterator,t.arg);if(n.type==="throw"){t.method="throw";t.arg=n.arg;t.delegate=null;return v}var i=n.arg;if(!i){t.method="throw";t.arg=new TypeError("iterator result is not an object");t.delegate=null;return v}if(i.done){t[e.resultName]=i.value;t.next=e.nextLoc;if(t.method!=="return"){t.method="next";t.arg=u}}else{return i}t.delegate=null;return v}_(w);w[n]="Generator";w[i]=function(){return this};w.toString=function(){return"[object Generator]"};function S(e){var t={tryLoc:e[0]};if(1 in e){t.catchLoc=e[1]}if(2 in e){t.finallyLoc=e[2];t.afterLoc=e[3]}this.tryEntries.push(t)}function A(e){var t=e.completion||{};t.type="normal";delete t.arg;e.completion=t}function R(e){this.tryEntries=[{tryLoc:"root"}];e.forEach(S,this);this.reset(true)}a.keys=function(r){var n=[];for(var e in r){n.push(e)}n.reverse();return function e(){while(n.length){var t=n.pop();if(t in r){e.value=t;e.done=false;return e}}e.done=true;return e}};function P(t){if(t){var e=t[i];if(e){return e.call(t)}if(typeof t.next==="function"){return t}if(!isNaN(t.length)){var r=-1,n=function e(){while(++r<t.length){if(l.call(t,r)){e.value=t[r];e.done=false;return e}}e.value=u;e.done=true;return e};return n.next=n}}return{next:C}}a.values=P;function C(){return{value:u,done:true}}R.prototype={constructor:R,reset:function(e){this.prev=0;this.next=0;this.sent=this._sent=u;this.done=false;this.delegate=null;this.method="next";this.arg=u;this.tryEntries.forEach(A);if(!e){for(var t in this){if(t.charAt(0)==="t"&&l.call(this,t)&&!isNaN(+t.slice(1))){this[t]=u}}}},stop:function(){this.done=true;var e=this.tryEntries[0];var t=e.completion;if(t.type==="throw"){throw t.arg}return this.rval},dispatchException:function(r){if(this.done){throw r}var n=this;function e(e,t){a.type="throw";a.arg=r;n.next=e;if(t){n.method="next";n.arg=u}return!!t}for(var t=this.tryEntries.length-1;t>=0;--t){var i=this.tryEntries[t];var a=i.completion;if(i.tryLoc==="root"){return e("end")}if(i.tryLoc<=this.prev){var o=l.call(i,"catchLoc");var s=l.call(i,"finallyLoc");if(o&&s){if(this.prev<i.catchLoc){return e(i.catchLoc,true)}else if(this.prev<i.finallyLoc){return e(i.finallyLoc)}}else if(o){if(this.prev<i.catchLoc){return e(i.catchLoc,true)}}else if(s){if(this.prev<i.finallyLoc){return e(i.finallyLoc)}}else{throw new Error("try statement without catch or finally")}}}},abrupt:function(e,t){for(var r=this.tryEntries.length-1;r>=0;--r){var n=this.tryEntries[r];if(n.tryLoc<=this.prev&&l.call(n,"finallyLoc")&&this.prev<n.finallyLoc){var i=n;break}}if(i&&(e==="break"||e==="continue")&&i.tryLoc<=t&&t<=i.finallyLoc){i=null}var a=i?i.completion:{};a.type=e;a.arg=t;if(i){this.method="next";this.next=i.finallyLoc;return v}return this.complete(a)},complete:function(e,t){if(e.type==="throw"){throw e.arg}if(e.type==="break"||e.type==="continue"){this.next=e.arg}else if(e.type==="return"){this.rval=this.arg=e.arg;this.method="return";this.next="end"}else if(e.type==="normal"&&t){this.next=t}return v},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var r=this.tryEntries[t];if(r.finallyLoc===e){this.complete(r.completion,r.afterLoc);A(r);return v}}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var r=this.tryEntries[t];if(r.tryLoc===e){var n=r.completion;if(n.type==="throw"){var i=n.arg;A(r)}return i}}throw new Error("illegal catch attempt")},delegateYield:function(e,t,r){this.delegate={iterator:P(e),resultName:t,nextLoc:r};if(this.method==="next"){this.arg=u}return v}};return a}(typeof t==="object"?t.exports:{});try{regeneratorRuntime=n}catch(e){Function("r","regeneratorRuntime = r")(n)}},{}]},{},[1]);THREE.OBJLoader=function(){var q=/^[og]\s*(.+)?/;var X=/^mtllib /;var Y=/^usemtl /;function Z(){var e={objects:[],object:{},vertices:[],normals:[],colors:[],uvs:[],materialLibraries:[],startObject:function(e,t){if(this.object&&this.object.fromDeclaration===false){this.object.name=e;this.object.fromDeclaration=t!==false;return}var r=this.object&&typeof this.object.currentMaterial==="function"?this.object.currentMaterial():undefined;if(this.object&&typeof this.object._finalize==="function"){this.object._finalize(true)}this.object={name:e||"",fromDeclaration:t!==false,geometry:{vertices:[],normals:[],colors:[],uvs:[]},materials:[],smooth:true,startMaterial:function(e,t){var r=this._finalize(false);if(r&&(r.inherited||r.groupCount<=0)){this.materials.splice(r.index,1)}var n={index:this.materials.length,name:e||"",mtllib:Array.isArray(t)&&t.length>0?t[t.length-1]:"",smooth:r!==undefined?r.smooth:this.smooth,groupStart:r!==undefined?r.groupEnd:0,groupEnd:-1,groupCount:-1,inherited:false,clone:function(e){var t={index:typeof e==="number"?e:this.index,name:this.name,mtllib:this.mtllib,smooth:this.smooth,groupStart:0,groupEnd:-1,groupCount:-1,inherited:false};t.clone=this.clone.bind(t);return t}};this.materials.push(n);return n},currentMaterial:function(){if(this.materials.length>0){return this.materials[this.materials.length-1]}return undefined},_finalize:function(e){var t=this.currentMaterial();if(t&&t.groupEnd===-1){t.groupEnd=this.geometry.vertices.length/3;t.groupCount=t.groupEnd-t.groupStart;t.inherited=false}if(e&&this.materials.length>1){for(var r=this.materials.length-1;r>=0;r--){if(this.materials[r].groupCount<=0){this.materials.splice(r,1)}}}if(e&&this.materials.length===0){this.materials.push({name:"",smooth:this.smooth})}return t}};if(r&&r.name&&typeof r.clone==="function"){var n=r.clone(0);n.inherited=true;this.object.materials.push(n)}this.objects.push(this.object)},finalize:function(){if(this.object&&typeof this.object._finalize==="function"){this.object._finalize(true)}},parseVertexIndex:function(e,t){var r=parseInt(e,10);return(r>=0?r-1:r+t/3)*3},parseNormalIndex:function(e,t){var r=parseInt(e,10);return(r>=0?r-1:r+t/3)*3},parseUVIndex:function(e,t){var r=parseInt(e,10);return(r>=0?r-1:r+t/2)*2},addVertex:function(e,t,r){var n=this.vertices;var i=this.object.geometry.vertices;i.push(n[e+0],n[e+1],n[e+2]);i.push(n[t+0],n[t+1],n[t+2]);i.push(n[r+0],n[r+1],n[r+2])},addVertexPoint:function(e){var t=this.vertices;var r=this.object.geometry.vertices;r.push(t[e+0],t[e+1],t[e+2])},addVertexLine:function(e){var t=this.vertices;var r=this.object.geometry.vertices;r.push(t[e+0],t[e+1],t[e+2])},addNormal:function(e,t,r){var n=this.normals;var i=this.object.geometry.normals;i.push(n[e+0],n[e+1],n[e+2]);i.push(n[t+0],n[t+1],n[t+2]);i.push(n[r+0],n[r+1],n[r+2])},addColor:function(e,t,r){var n=this.colors;var i=this.object.geometry.colors;i.push(n[e+0],n[e+1],n[e+2]);i.push(n[t+0],n[t+1],n[t+2]);i.push(n[r+0],n[r+1],n[r+2])},addUV:function(e,t,r){var n=this.uvs;var i=this.object.geometry.uvs;i.push(n[e+0],n[e+1]);i.push(n[t+0],n[t+1]);i.push(n[r+0],n[r+1])},addUVLine:function(e){var t=this.uvs;var r=this.object.geometry.uvs;r.push(t[e+0],t[e+1])},addFace:function(e,t,r,n,i,a,o,s,u){var l=this.vertices.length;var c=this.parseVertexIndex(e,l);var h=this.parseVertexIndex(t,l);var f=this.parseVertexIndex(r,l);this.addVertex(c,h,f);if(n!==undefined&&n!==""){var d=this.uvs.length;c=this.parseUVIndex(n,d);h=this.parseUVIndex(i,d);f=this.parseUVIndex(a,d);this.addUV(c,h,f)}if(o!==undefined&&o!==""){var p=this.normals.length;c=this.parseNormalIndex(o,p);h=o===s?c:this.parseNormalIndex(s,p);f=o===u?c:this.parseNormalIndex(u,p);this.addNormal(c,h,f)}if(this.colors.length>0){this.addColor(c,h,f)}},addPointGeometry:function(e){this.object.geometry.type="Points";var t=this.vertices.length;for(var r=0,n=e.length;r<n;r++){this.addVertexPoint(this.parseVertexIndex(e[r],t))}},addLineGeometry:function(e,t){this.object.geometry.type="Line";var r=this.vertices.length;var n=this.uvs.length;for(var i=0,a=e.length;i<a;i++){this.addVertexLine(this.parseVertexIndex(e[i],r))}for(var o=0,a=t.length;o<a;o++){this.addUVLine(this.parseUVIndex(t[o],n))}}};e.startObject("",false);return e}function e(e){this.manager=e!==undefined?e:THREE.DefaultLoadingManager;this.materials=null}e.prototype={constructor:e,load:function(e,t,r,n){var i=this;var a=new THREE.FileLoader(i.manager);a.setPath(this.path);a.load(e,function(e){t(i.parse(e))},r,n)},setPath:function(e){this.path=e;return this},setMaterials:function(e){this.materials=e;return this},parse:function(e){console.time("OBJLoader");var t=new Z;if(e.indexOf("\r\n")!==-1){e=e.replace(/\r\n/g,"\n")}if(e.indexOf("\\\n")!==-1){e=e.replace(/\\\n/g,"")}var r=e.split("\n");var n="",i="";var a=0;var o=[];var s=typeof"".trimLeft==="function";for(var u=0,l=r.length;u<l;u++){n=r[u];n=s?n.trimLeft():n.trim();a=n.length;if(a===0)continue;i=n.charAt(0);if(i==="#")continue;if(i==="v"){var c=n.split(/\s+/);switch(c[0]){case"v":t.vertices.push(parseFloat(c[1]),parseFloat(c[2]),parseFloat(c[3]));if(c.length===8){t.colors.push(parseFloat(c[4]),parseFloat(c[5]),parseFloat(c[6]))}break;case"vn":t.normals.push(parseFloat(c[1]),parseFloat(c[2]),parseFloat(c[3]));break;case"vt":t.uvs.push(parseFloat(c[1]),parseFloat(c[2]));break}}else if(i==="f"){var h=n.substr(1).trim();var f=h.split(/\s+/);var d=[];for(var p=0,v=f.length;p<v;p++){var m=f[p];if(m.length>0){var g=m.split("/");d.push(g)}}var y=d[0];for(var p=1,v=d.length-1;p<v;p++){var x=d[p];var b=d[p+1];t.addFace(y[0],x[0],b[0],y[1],x[1],b[1],y[2],x[2],b[2])}}else if(i==="l"){var w=n.substring(1).trim().split(" ");var _=[],T=[];if(n.indexOf("/")===-1){_=w}else{for(var E=0,M=w.length;E<M;E++){var S=w[E].split("/");if(S[0]!=="")_.push(S[0]);if(S[1]!=="")T.push(S[1])}}t.addLineGeometry(_,T)}else if(i==="p"){var h=n.substr(1).trim();var A=h.split(" ");t.addPointGeometry(A)}else if((o=q.exec(n))!==null){var R=(" "+o[0].substr(1).trim()).substr(1);t.startObject(R)}else if(Y.test(n)){t.object.startMaterial(n.substring(7).trim(),t.materialLibraries)}else if(X.test(n)){t.materialLibraries.push(n.substring(7).trim())}else if(i==="s"){o=n.split(" ");if(o.length>1){var P=o[1].trim().toLowerCase();t.object.smooth=P!=="0"&&P!=="off"}else{t.object.smooth=true}var C=t.object.currentMaterial();if(C)C.smooth=t.object.smooth}else{if(n==="\0")continue;throw new Error('THREE.OBJLoader: Unexpected line: "'+n+'"')}}t.finalize();var O=new THREE.Group;O.materialLibraries=[].concat(t.materialLibraries);for(var u=0,l=t.objects.length;u<l;u++){var L=t.objects[u];var I=L.geometry;var D=L.materials;var N=I.type==="Line";var F=I.type==="Points";var B=false;if(I.vertices.length===0)continue;var U=new THREE.BufferGeometry;U.addAttribute("position",new THREE.Float32BufferAttribute(I.vertices,3));if(I.normals.length>0){U.addAttribute("normal",new THREE.Float32BufferAttribute(I.normals,3))}else{U.computeVertexNormals()}if(I.colors.length>0){B=true;U.addAttribute("color",new THREE.Float32BufferAttribute(I.colors,3))}if(I.uvs.length>0){U.addAttribute("uv",new THREE.Float32BufferAttribute(I.uvs,2))}var k=[];for(var j=0,z=D.length;j<z;j++){var H=D[j];var C=undefined;if(this.materials!==null){C=this.materials.create(H.name);if(N&&C&&!(C instanceof THREE.LineBasicMaterial)){var G=new THREE.LineBasicMaterial;G.copy(C);G.lights=false;C=G}else if(F&&C&&!(C instanceof THREE.PointsMaterial)){var V=new THREE.PointsMaterial({size:10,sizeAttenuation:false});G.copy(C);C=V}}if(!C){if(N){C=new THREE.LineBasicMaterial}else if(F){C=new THREE.PointsMaterial({size:1,sizeAttenuation:false})}else{C=new THREE.MeshPhongMaterial}C.name=H.name}C.flatShading=H.smooth?false:true;C.vertexColors=B?THREE.VertexColors:THREE.NoColors;k.push(C)}var W;if(k.length>1){for(var j=0,z=D.length;j<z;j++){var H=D[j];U.addGroup(H.groupStart,H.groupCount,j)}if(N){W=new THREE.LineSegments(U,k)}else if(F){W=new THREE.Points(U,k)}else{W=new THREE.Mesh(U,k)}}else{if(N){W=new THREE.LineSegments(U,k[0])}else if(F){W=new THREE.Points(U,k[0])}else{W=new THREE.Mesh(U,k[0])}}W.name=L.name;O.add(W)}console.timeEnd("OBJLoader");return O}};return e}();THREE.FBXLoader=function(){var h;var f;var d;function e(e){this.manager=e!==undefined?e:THREE.DefaultLoadingManager}e.prototype={constructor:e,crossOrigin:"anonymous",load:function(t,r,e,n){var i=this;var a=i.path===undefined?THREE.LoaderUtils.extractUrlBase(t):i.path;var o=new THREE.FileLoader(this.manager);o.setResponseType("arraybuffer");o.load(t,function(e){try{r(i.parse(e,a))}catch(e){setTimeout(function(){if(n)n(e);i.manager.itemError(t)},0)}},e,n)},setPath:function(e){this.path=e;return this},setResourcePath:function(e){this.resourcePath=e;return this},setCrossOrigin:function(e){this.crossOrigin=e;return this},parse:function(e,t){if(p(e)){h=(new u).parse(e)}else{var r=T(e);if(!v(r)){throw new Error("THREE.FBXLoader: Unknown format.")}if(m(r)<7e3){throw new Error("THREE.FBXLoader: FBX version not supported, FileVersion: "+m(r))}h=(new o).parse(r)}var n=new THREE.TextureLoader(this.manager).setPath(this.resourcePath||t).setCrossOrigin(this.crossOrigin);return new i(n).parse(h)}};function i(e){this.textureLoader=e}i.prototype={constructor:i,parse:function(){f=this.parseConnections();var e=this.parseImages();var t=this.parseTextures(e);var r=this.parseMaterials(t);var n=this.parseDeformers();var i=(new a).parse(n);this.parseScene(n,i,r);return d},parseConnections:function(){var o=new Map;if("Connections"in h){var e=h.Connections.connections;e.forEach(function(e){var t=e[0];var r=e[1];var n=e[2];if(!o.has(t)){o.set(t,{parents:[],children:[]})}var i={ID:r,relationship:n};o.get(t).parents.push(i);if(!o.has(r)){o.set(r,{parents:[],children:[]})}var a={ID:t,relationship:n};o.get(r).children.push(a)})}return o},parseImages:function(){var e={};var t={};if("Video"in h.Objects){var r=h.Objects.Video;for(var n in r){var i=r[n];var a=parseInt(n);e[a]=i.RelativeFilename||i.Filename;if("Content"in i){var o=i.Content instanceof ArrayBuffer&&i.Content.byteLength>0;var s=typeof i.Content==="string"&&i.Content!=="";if(o||s){var u=this.parseImage(r[n]);t[i.RelativeFilename||i.Filename]=u}}}}for(var a in e){var l=e[a];if(t[l]!==undefined)e[a]=t[l];else e[a]=e[a].split("\\").pop()}return e},parseImage:function(e){var t=e.Content;var r=e.RelativeFilename||e.Filename;var n=r.slice(r.lastIndexOf(".")+1).toLowerCase();var i;switch(n){case"bmp":i="image/bmp";break;case"jpg":case"jpeg":i="image/jpeg";break;case"png":i="image/png";break;case"tif":i="image/tiff";break;case"tga":if(typeof THREE.TGALoader!=="function"){console.warn("FBXLoader: THREE.TGALoader is required to load TGA textures");return}else{if(THREE.Loader.Handlers.get(".tga")===null){var a=new THREE.TGALoader;a.setPath(this.textureLoader.path);THREE.Loader.Handlers.add(/\.tga$/i,a)}i="image/tga";break}default:console.warn('FBXLoader: Image type "'+n+'" is not supported.');return}if(typeof t==="string"){return"data:"+i+";base64,"+t}else{var o=new Uint8Array(t);return window.URL.createObjectURL(new Blob([o],{type:i}))}},parseTextures:function(e){var t=new Map;if("Texture"in h.Objects){var r=h.Objects.Texture;for(var n in r){var i=this.parseTexture(r[n],e);t.set(parseInt(n),i)}}return t},parseTexture:function(e,t){var r=this.loadTexture(e,t);r.ID=e.id;r.name=e.attrName;var n=e.WrapModeU;var i=e.WrapModeV;var a=n!==undefined?n.value:0;var o=i!==undefined?i.value:0;r.wrapS=a===0?THREE.RepeatWrapping:THREE.ClampToEdgeWrapping;r.wrapT=o===0?THREE.RepeatWrapping:THREE.ClampToEdgeWrapping;if("Scaling"in e){var s=e.Scaling.value;r.repeat.x=s[0];r.repeat.y=s[1]}return r},loadTexture:function(e,t){var r;var n=this.textureLoader.path;var i=f.get(e.id).children;if(i!==undefined&&i.length>0&&t[i[0].ID]!==undefined){r=t[i[0].ID];if(r.indexOf("blob:")===0||r.indexOf("data:")===0){this.textureLoader.setPath(undefined)}}var a;var o=e.FileName.slice(-3).toLowerCase();if(o==="tga"){var s=THREE.Loader.Handlers.get(".tga");if(s===null){console.warn("FBXLoader: TGALoader not found, creating empty placeholder texture for",r);a=new THREE.Texture}else{a=s.load(r)}}else if(o==="psd"){console.warn("FBXLoader: PSD textures are not supported, creating empty placeholder texture for",r);a=new THREE.Texture}else{a=this.textureLoader.load(r)}this.textureLoader.setPath(n);return a},parseMaterials:function(e){var t=new Map;if("Material"in h.Objects){var r=h.Objects.Material;for(var n in r){var i=this.parseMaterial(r[n],e);if(i!==null)t.set(parseInt(n),i)}}return t},parseMaterial:function(e,t){var r=e.id;var n=e.attrName;var i=e.ShadingModel;if(typeof i==="object"){i=i.value}if(!f.has(r))return null;var a=this.parseParameters(e,t,r);var o;switch(i.toLowerCase()){case"phong":o=new THREE.MeshPhongMaterial;break;case"lambert":o=new THREE.MeshLambertMaterial;break;default:console.warn('THREE.FBXLoader: unknown material type "%s". Defaulting to MeshPhongMaterial.',i);o=new THREE.MeshPhongMaterial({color:3342591});break}o.setValues(a);o.name=n;return o},parseParameters:function(e,r,t){var n={};if(e.BumpFactor){n.bumpScale=e.BumpFactor.value}if(e.Diffuse){n.color=(new THREE.Color).fromArray(e.Diffuse.value)}else if(e.DiffuseColor&&e.DiffuseColor.type==="Color"){n.color=(new THREE.Color).fromArray(e.DiffuseColor.value)}if(e.DisplacementFactor){n.displacementScale=e.DisplacementFactor.value}if(e.Emissive){n.emissive=(new THREE.Color).fromArray(e.Emissive.value)}else if(e.EmissiveColor&&e.EmissiveColor.type==="Color"){n.emissive=(new THREE.Color).fromArray(e.EmissiveColor.value)}if(e.EmissiveFactor){n.emissiveIntensity=parseFloat(e.EmissiveFactor.value)}if(e.Opacity){n.opacity=parseFloat(e.Opacity.value)}if(n.opacity<1){n.transparent=true}if(e.ReflectionFactor){n.reflectivity=e.ReflectionFactor.value}if(e.Shininess){n.shininess=e.Shininess.value}if(e.Specular){n.specular=(new THREE.Color).fromArray(e.Specular.value)}else if(e.SpecularColor&&e.SpecularColor.type==="Color"){n.specular=(new THREE.Color).fromArray(e.SpecularColor.value)}var i=this;f.get(t).children.forEach(function(e){var t=e.relationship;switch(t){case"Bump":n.bumpMap=i.getTexture(r,e.ID);break;case"DiffuseColor":n.map=i.getTexture(r,e.ID);break;case"DisplacementColor":n.displacementMap=i.getTexture(r,e.ID);break;case"EmissiveColor":n.emissiveMap=i.getTexture(r,e.ID);break;case"NormalMap":n.normalMap=i.getTexture(r,e.ID);break;case"ReflectionColor":n.envMap=i.getTexture(r,e.ID);n.envMap.mapping=THREE.EquirectangularReflectionMapping;break;case"SpecularColor":n.specularMap=i.getTexture(r,e.ID);break;case"TransparentColor":n.alphaMap=i.getTexture(r,e.ID);n.transparent=true;break;case"AmbientColor":case"ShininessExponent":case"SpecularFactor":case"VectorDisplacementColor":default:console.warn("THREE.FBXLoader: %s map is not supported in three.js, skipping texture.",t);break}});return n},getTexture:function(e,t){if("LayeredTexture"in h.Objects&&t in h.Objects.LayeredTexture){console.warn("THREE.FBXLoader: layered textures are not supported in three.js. Discarding all but first layer.");t=f.get(t).children[0].ID}return e.get(t)},parseDeformers:function(){var e={};var t={};if("Deformer"in h.Objects){var r=h.Objects.Deformer;for(var n in r){var i=r[n];var a=f.get(parseInt(n));if(i.attrType==="Skin"){var o=this.parseSkeleton(a,r);o.ID=n;if(a.parents.length>1)console.warn("THREE.FBXLoader: skeleton attached to more than one geometry is not supported.");o.geometryID=a.parents[0].ID;e[n]=o}else if(i.attrType==="BlendShape"){var s={id:n};s.rawTargets=this.parseMorphTargets(a,r);s.id=n;if(a.parents.length>1)console.warn("THREE.FBXLoader: morph target attached to more than one geometry is not supported.");t[n]=s}}}return{skeletons:e,morphTargets:t}},parseSkeleton:function(e,n){var i=[];e.children.forEach(function(e){var t=n[e.ID];if(t.attrType!=="Cluster")return;var r={ID:e.ID,indices:[],weights:[],transformLink:(new THREE.Matrix4).fromArray(t.TransformLink.a)};if("Indexes"in t){r.indices=t.Indexes.a;r.weights=t.Weights.a}i.push(r)});return{rawBones:i,bones:[]}},parseMorphTargets:function(e,t){var r=[];for(var n=0;n<e.children.length;n++){var i=e.children[n];var a=t[i.ID];var o={name:a.attrName,initialWeight:a.DeformPercent,id:a.id,fullWeights:a.FullWeights.a};if(a.attrType!=="BlendShapeChannel")return;o.geoID=f.get(parseInt(i.ID)).children.filter(function(e){return e.relationship===undefined})[0].ID;r.push(o)}return r},parseScene:function(e,t,r){d=new THREE.Group;var n=this.parseModels(e.skeletons,t,r);var i=h.Objects.Model;var a=this;n.forEach(function(r){var e=i[r.ID];a.setLookAtProperties(r,e);var t=f.get(r.ID).parents;t.forEach(function(e){var t=n.get(e.ID);if(t!==undefined)t.add(r)});if(r.parent===null){d.add(r)}});this.bindSkeleton(e.skeletons,t,n);this.createAmbientLight();this.setupMorphMaterials();d.traverse(function(e){if(e.userData.transformData){if(e.parent)e.userData.transformData.parentMatrixWorld=e.parent.matrix;var t=x(e.userData.transformData);e.applyMatrix(t)}});var o=(new s).parse();if(d.children.length===1&&d.children[0].isGroup){d.children[0].animations=o;d=d.children[0]}d.animations=o},parseModels:function(e,t,r){var n=new Map;var i=h.Objects.Model;for(var a in i){var o=parseInt(a);var s=i[a];var u=f.get(o);var l=this.buildSkeleton(u,e,o,s.attrName);if(!l){switch(s.attrType){case"Camera":l=this.createCamera(u);break;case"Light":l=this.createLight(u);break;case"Mesh":l=this.createMesh(u,t,r);break;case"NurbsCurve":l=this.createCurve(u,t);break;case"LimbNode":case"Root":l=new THREE.Bone;break;case"Null":default:l=new THREE.Group;break}l.name=THREE.PropertyBinding.sanitizeNodeName(s.attrName);l.ID=o}this.getTransformData(l,s);n.set(o,l)}return n},buildSkeleton:function(e,t,a,o){var s=null;e.parents.forEach(function(n){for(var e in t){var i=t[e];i.rawBones.forEach(function(e,t){if(e.ID===n.ID){var r=s;s=new THREE.Bone;s.matrixWorld.copy(e.transformLink);s.name=THREE.PropertyBinding.sanitizeNodeName(o);s.ID=a;i.bones[t]=s;if(r!==null){s.add(r)}}})}});return s},createCamera:function(e){var t;var r;e.children.forEach(function(e){var t=h.Objects.NodeAttribute[e.ID];if(t!==undefined){r=t}});if(r===undefined){t=new THREE.Object3D}else{var n=0;if(r.CameraProjectionType!==undefined&&r.CameraProjectionType.value===1){n=1}var i=1;if(r.NearPlane!==undefined){i=r.NearPlane.value/1e3}var a=1e3;if(r.FarPlane!==undefined){a=r.FarPlane.value/1e3}var o=window.innerWidth;var s=window.innerHeight;if(r.AspectWidth!==undefined&&r.AspectHeight!==undefined){o=r.AspectWidth.value;s=r.AspectHeight.value}var u=o/s;var l=45;if(r.FieldOfView!==undefined){l=r.FieldOfView.value}var c=r.FocalLength?r.FocalLength.value:null;switch(n){case 0:t=new THREE.PerspectiveCamera(l,u,i,a);if(c!==null)t.setFocalLength(c);break;case 1:t=new THREE.OrthographicCamera(-o/2,o/2,s/2,-s/2,i,a);break;default:console.warn("THREE.FBXLoader: Unknown camera type "+n+".");t=new THREE.Object3D;break}}return t},createLight:function(e){var t;var r;e.children.forEach(function(e){var t=h.Objects.NodeAttribute[e.ID];if(t!==undefined){r=t}});if(r===undefined){t=new THREE.Object3D}else{var n;if(r.LightType===undefined){n=0}else{n=r.LightType.value}var i=16777215;if(r.Color!==undefined){i=(new THREE.Color).fromArray(r.Color.value)}var a=r.Intensity===undefined?1:r.Intensity.value/100;if(r.CastLightOnObject!==undefined&&r.CastLightOnObject.value===0){a=0}var o=0;if(r.FarAttenuationEnd!==undefined){if(r.EnableFarAttenuation!==undefined&&r.EnableFarAttenuation.value===0){o=0}else{o=r.FarAttenuationEnd.value}}var s=1;switch(n){case 0:t=new THREE.PointLight(i,a,o,s);break;case 1:t=new THREE.DirectionalLight(i,a);break;case 2:var u=Math.PI/3;if(r.InnerAngle!==undefined){u=THREE.Math.degToRad(r.InnerAngle.value)}var l=0;if(r.OuterAngle!==undefined){l=THREE.Math.degToRad(r.OuterAngle.value);l=Math.max(l,1)}t=new THREE.SpotLight(i,a,o,u,l,s);break;default:console.warn("THREE.FBXLoader: Unknown light type "+r.LightType.value+", defaulting to a THREE.PointLight.");t=new THREE.PointLight(i,a);break}if(r.CastShadows!==undefined&&r.CastShadows.value===1){t.castShadow=true}}return t},createMesh:function(e,t,r){var n;var i=null;var a=null;var o=[];e.children.forEach(function(e){if(t.has(e.ID)){i=t.get(e.ID)}if(r.has(e.ID)){o.push(r.get(e.ID))}});if(o.length>1){a=o}else if(o.length>0){a=o[0]}else{a=new THREE.MeshPhongMaterial({color:13421772});o.push(a)}if("color"in i.attributes){o.forEach(function(e){e.vertexColors=THREE.VertexColors})}if(i.FBX_Deformer){o.forEach(function(e){e.skinning=true});n=new THREE.SkinnedMesh(i,a)}else{n=new THREE.Mesh(i,a)}return n},createCurve:function(e,r){var t=e.children.reduce(function(e,t){if(r.has(t.ID))e=r.get(t.ID);return e},null);var n=new THREE.LineBasicMaterial({color:3342591,linewidth:1});return new THREE.Line(t,n)},getTransformData:function(e,t){var r={};if("InheritType"in t)r.inheritType=parseInt(t.InheritType.value);if("RotationOrder"in t)r.eulerOrder=b(t.RotationOrder.value);else r.eulerOrder="ZYX";if("Lcl_Translation"in t)r.translation=t.Lcl_Translation.value;if("PreRotation"in t)r.preRotation=t.PreRotation.value;if("Lcl_Rotation"in t)r.rotation=t.Lcl_Rotation.value;if("PostRotation"in t)r.postRotation=t.PostRotation.value;if("Lcl_Scaling"in t)r.scale=t.Lcl_Scaling.value;if("ScalingOffset"in t)r.scalingOffset=t.ScalingOffset.value;if("ScalingPivot"in t)r.scalingPivot=t.ScalingPivot.value;if("RotationOffset"in t)r.rotationOffset=t.RotationOffset.value;if("RotationPivot"in t)r.rotationPivot=t.RotationPivot.value;e.userData.transformData=r},setLookAtProperties:function(n,e){if("LookAtProperty"in e){var t=f.get(n.ID).children;t.forEach(function(e){if(e.relationship==="LookAtProperty"){var t=h.Objects.Model[e.ID];if("Lcl_Translation"in t){var r=t.Lcl_Translation.value;if(n.target!==undefined){n.target.position.fromArray(r);d.add(n.target)}else{n.lookAt((new THREE.Vector3).fromArray(r))}}}})}},bindSkeleton:function(e,n,i){var a=this.parsePoseNodes();for(var t in e){var o=e[t];var r=f.get(parseInt(o.ID)).parents;r.forEach(function(e){if(n.has(e.ID)){var t=e.ID;var r=f.get(t);r.parents.forEach(function(e){if(i.has(e.ID)){var t=i.get(e.ID);t.bind(new THREE.Skeleton(o.bones),a[e.ID])}})}})}},parsePoseNodes:function(){var t={};if("Pose"in h.Objects){var e=h.Objects.Pose;for(var r in e){if(e[r].attrType==="BindPose"){var n=e[r].PoseNode;if(Array.isArray(n)){n.forEach(function(e){t[e.Node]=(new THREE.Matrix4).fromArray(e.Matrix.a)})}else{t[n.Node]=(new THREE.Matrix4).fromArray(n.Matrix.a)}}}}return t},createAmbientLight:function(){if("GlobalSettings"in h&&"AmbientColor"in h.GlobalSettings){var e=h.GlobalSettings.AmbientColor.value;var t=e[0];var r=e[1];var n=e[2];if(t!==0||r!==0||n!==0){var i=new THREE.Color(t,r,n);d.add(new THREE.AmbientLight(i,1))}}},setupMorphMaterials:function(){var n=this;d.traverse(function(r){if(r.isMesh){if(r.geometry.morphAttributes.position&&r.geometry.morphAttributes.position.length){if(Array.isArray(r.material)){r.material.forEach(function(e,t){n.setupMorphMaterial(r,e,t)})}else{n.setupMorphMaterial(r,r.material)}}}})},setupMorphMaterial:function(e,t,r){var n=e.uuid;var i=t.uuid;var a=false;d.traverse(function(t){if(t.isMesh){if(Array.isArray(t.material)){t.material.forEach(function(e){if(e.uuid===i&&t.uuid!==n)a=true})}else if(t.material.uuid===i&&t.uuid!==n)a=true}});if(a===true){var o=t.clone();o.morphTargets=true;if(r===undefined)e.material=o;else e.material[r]=o}else t.morphTargets=true}};function a(){}a.prototype={constructor:a,parse:function(e){var t=new Map;if("Geometry"in h.Objects){var r=h.Objects.Geometry;for(var n in r){var i=f.get(parseInt(n));var a=this.parseGeometry(i,r[n],e);t.set(parseInt(n),a)}}return t},parseGeometry:function(e,t,r){switch(t.attrType){case"Mesh":return this.parseMeshGeometry(e,t,r);break;case"NurbsCurve":return this.parseNurbsGeometry(t);break}},parseMeshGeometry:function(e,t,r){var n=r.skeletons;var i=r.morphTargets;var a=e.parents.map(function(e){return h.Objects.Model[e.ID]});if(a.length===0)return;var o=e.children.reduce(function(e,t){if(n[t.ID]!==undefined)e=n[t.ID];return e},null);var s=e.children.reduce(function(e,t){if(i[t.ID]!==undefined)e=i[t.ID];return e},null);var u=a[0];var l={};if("RotationOrder"in u)l.eulerOrder=b(u.RotationOrder.value);if("InheritType"in u)l.inheritType=parseInt(u.InheritType.value);if("GeometricTranslation"in u)l.translation=u.GeometricTranslation.value;if("GeometricRotation"in u)l.rotation=u.GeometricRotation.value;if("GeometricScaling"in u)l.scale=u.GeometricScaling.value;var c=x(l);return this.genGeometry(t,o,s,c)},genGeometry:function(e,t,r,n){var i=new THREE.BufferGeometry;if(e.attrName)i.name=e.attrName;var a=this.parseGeoNode(e,t);var o=this.genBuffers(a);var s=new THREE.Float32BufferAttribute(o.vertex,3);n.applyToBufferAttribute(s);i.addAttribute("position",s);if(o.colors.length>0){i.addAttribute("color",new THREE.Float32BufferAttribute(o.colors,3))}if(t){i.addAttribute("skinIndex",new THREE.Uint16BufferAttribute(o.weightsIndices,4));i.addAttribute("skinWeight",new THREE.Float32BufferAttribute(o.vertexWeights,4));i.FBX_Deformer=t}if(o.normal.length>0){var u=new THREE.Float32BufferAttribute(o.normal,3);var l=(new THREE.Matrix3).getNormalMatrix(n);l.applyToBufferAttribute(u);i.addAttribute("normal",u)}o.uvs.forEach(function(e,t){var r="uv"+(t+1).toString();if(t===0){r="uv"}i.addAttribute(r,new THREE.Float32BufferAttribute(o.uvs[t],2))});if(a.material&&a.material.mappingType!=="AllSame"){var c=o.materialIndex[0];var h=0;o.materialIndex.forEach(function(e,t){if(e!==c){i.addGroup(h,t-h,c);c=e;h=t}});if(i.groups.length>0){var f=i.groups[i.groups.length-1];var d=f.start+f.count;if(d!==o.materialIndex.length){i.addGroup(d,o.materialIndex.length-d,c)}}if(i.groups.length===0){i.addGroup(0,o.materialIndex.length,o.materialIndex[0])}}this.addMorphTargets(i,e,r,n);return i},parseGeoNode:function(e,t){var i={};i.vertexPositions=e.Vertices!==undefined?e.Vertices.a:[];i.vertexIndices=e.PolygonVertexIndex!==undefined?e.PolygonVertexIndex.a:[];if(e.LayerElementColor){i.color=this.parseVertexColors(e.LayerElementColor[0])}if(e.LayerElementMaterial){i.material=this.parseMaterialIndices(e.LayerElementMaterial[0])}if(e.LayerElementNormal){i.normal=this.parseNormals(e.LayerElementNormal[0])}if(e.LayerElementUV){i.uv=[];var r=0;while(e.LayerElementUV[r]){i.uv.push(this.parseUVs(e.LayerElementUV[r]));r++}}i.weightTable={};if(t!==null){i.skeleton=t;t.rawBones.forEach(function(r,n){r.indices.forEach(function(e,t){if(i.weightTable[e]===undefined)i.weightTable[e]=[];i.weightTable[e].push({id:n,weight:r.weights[t]})})})}return i},genBuffers:function(c){var h={vertex:[],normal:[],colors:[],uvs:[],materialIndex:[],vertexWeights:[],weightsIndices:[]};var f=0;var d=0;var p=false;var v=[];var m=[];var g=[];var y=[];var x=[];var b=[];var w=this;c.vertexIndices.forEach(function(n,i){var e=false;if(n<0){n=n^-1;e=true}var r=[];var t=[];v.push(n*3,n*3+1,n*3+2);if(c.color){var a=_(i,f,n,c.color);g.push(a[0],a[1],a[2])}if(c.skeleton){if(c.weightTable[n]!==undefined){c.weightTable[n].forEach(function(e){t.push(e.weight);r.push(e.id)})}if(t.length>4){if(!p){console.warn("THREE.FBXLoader: Vertex has more than 4 skinning weights assigned to vertex. Deleting additional weights.");p=true}var o=[0,0,0,0];var s=[0,0,0,0];t.forEach(function(e,t){var i=e;var a=r[t];s.forEach(function(e,t,r){if(i>e){r[t]=i;i=e;var n=o[t];o[t]=a;a=n}})});r=o;t=s}while(t.length<4){t.push(0);r.push(0)}for(var u=0;u<4;++u){x.push(t[u]);b.push(r[u])}}if(c.normal){var a=_(i,f,n,c.normal);m.push(a[0],a[1],a[2])}if(c.material&&c.material.mappingType!=="AllSame"){var l=_(i,f,n,c.material)[0]}if(c.uv){c.uv.forEach(function(e,t){var r=_(i,f,n,e);if(y[t]===undefined){y[t]=[]}y[t].push(r[0]);y[t].push(r[1])})}d++;if(e){w.genFace(h,c,v,l,m,g,y,x,b,d);f++;d=0;v=[];m=[];g=[];y=[];x=[];b=[]}});return h},genFace:function(r,e,t,n,i,a,o,s,u,l){for(var c=2;c<l;c++){r.vertex.push(e.vertexPositions[t[0]]);r.vertex.push(e.vertexPositions[t[1]]);r.vertex.push(e.vertexPositions[t[2]]);r.vertex.push(e.vertexPositions[t[(c-1)*3]]);r.vertex.push(e.vertexPositions[t[(c-1)*3+1]]);r.vertex.push(e.vertexPositions[t[(c-1)*3+2]]);r.vertex.push(e.vertexPositions[t[c*3]]);r.vertex.push(e.vertexPositions[t[c*3+1]]);r.vertex.push(e.vertexPositions[t[c*3+2]]);if(e.skeleton){r.vertexWeights.push(s[0]);r.vertexWeights.push(s[1]);r.vertexWeights.push(s[2]);r.vertexWeights.push(s[3]);r.vertexWeights.push(s[(c-1)*4]);r.vertexWeights.push(s[(c-1)*4+1]);r.vertexWeights.push(s[(c-1)*4+2]);r.vertexWeights.push(s[(c-1)*4+3]);r.vertexWeights.push(s[c*4]);r.vertexWeights.push(s[c*4+1]);r.vertexWeights.push(s[c*4+2]);r.vertexWeights.push(s[c*4+3]);r.weightsIndices.push(u[0]);r.weightsIndices.push(u[1]);r.weightsIndices.push(u[2]);r.weightsIndices.push(u[3]);r.weightsIndices.push(u[(c-1)*4]);r.weightsIndices.push(u[(c-1)*4+1]);r.weightsIndices.push(u[(c-1)*4+2]);r.weightsIndices.push(u[(c-1)*4+3]);r.weightsIndices.push(u[c*4]);r.weightsIndices.push(u[c*4+1]);r.weightsIndices.push(u[c*4+2]);r.weightsIndices.push(u[c*4+3])}if(e.color){r.colors.push(a[0]);r.colors.push(a[1]);r.colors.push(a[2]);r.colors.push(a[(c-1)*3]);r.colors.push(a[(c-1)*3+1]);r.colors.push(a[(c-1)*3+2]);r.colors.push(a[c*3]);r.colors.push(a[c*3+1]);r.colors.push(a[c*3+2])}if(e.material&&e.material.mappingType!=="AllSame"){r.materialIndex.push(n);r.materialIndex.push(n);r.materialIndex.push(n)}if(e.normal){r.normal.push(i[0]);r.normal.push(i[1]);r.normal.push(i[2]);r.normal.push(i[(c-1)*3]);r.normal.push(i[(c-1)*3+1]);r.normal.push(i[(c-1)*3+2]);r.normal.push(i[c*3]);r.normal.push(i[c*3+1]);r.normal.push(i[c*3+2])}if(e.uv){e.uv.forEach(function(e,t){if(r.uvs[t]===undefined)r.uvs[t]=[];r.uvs[t].push(o[t][0]);r.uvs[t].push(o[t][1]);r.uvs[t].push(o[t][(c-1)*2]);r.uvs[t].push(o[t][(c-1)*2+1]);r.uvs[t].push(o[t][c*2]);r.uvs[t].push(o[t][c*2+1])})}}},addMorphTargets:function(r,n,e,i){if(e===null)return;r.morphAttributes.position=[];var a=this;e.rawTargets.forEach(function(e){var t=h.Objects.Geometry[e.geoID];if(t!==undefined){a.genMorphGeometry(r,n,t,i,e.name)}})},genMorphGeometry:function(e,t,r,n,i){var a=new THREE.BufferGeometry;if(r.attrName)a.name=r.attrName;var o=t.PolygonVertexIndex!==undefined?t.PolygonVertexIndex.a:[];var s=t.Vertices!==undefined?t.Vertices.a.slice():[];var u=r.Vertices!==undefined?r.Vertices.a:[];var l=r.Indexes!==undefined?r.Indexes.a:[];for(var c=0;c<l.length;c++){var h=l[c]*3;s[h]+=u[c*3];s[h+1]+=u[c*3+1];s[h+2]+=u[c*3+2]}var f={vertexIndices:o,vertexPositions:s};var d=this.genBuffers(f);var p=new THREE.Float32BufferAttribute(d.vertex,3);p.name=i||r.attrName;n.applyToBufferAttribute(p);e.morphAttributes.position.push(p)},parseNormals:function(e){var t=e.MappingInformationType;var r=e.ReferenceInformationType;var n=e.Normals.a;var i=[];if(r==="IndexToDirect"){if("NormalIndex"in e){i=e.NormalIndex.a}else if("NormalsIndex"in e){i=e.NormalsIndex.a}}return{dataSize:3,buffer:n,indices:i,mappingType:t,referenceType:r}},parseUVs:function(e){var t=e.MappingInformationType;var r=e.ReferenceInformationType;var n=e.UV.a;var i=[];if(r==="IndexToDirect"){i=e.UVIndex.a}return{dataSize:2,buffer:n,indices:i,mappingType:t,referenceType:r}},parseVertexColors:function(e){var t=e.MappingInformationType;var r=e.ReferenceInformationType;var n=e.Colors.a;var i=[];if(r==="IndexToDirect"){i=e.ColorIndex.a}return{dataSize:4,buffer:n,indices:i,mappingType:t,referenceType:r}},parseMaterialIndices:function(e){var t=e.MappingInformationType;var r=e.ReferenceInformationType;if(t==="NoMappingInformation"){return{dataSize:1,buffer:[0],indices:[0],mappingType:"AllSame",referenceType:r}}var n=e.Materials.a;var i=[];for(var a=0;a<n.length;++a){i.push(a)}return{dataSize:1,buffer:n,indices:i,mappingType:t,referenceType:r}},parseNurbsGeometry:function(e){if(THREE.NURBSCurve===undefined){console.error("THREE.FBXLoader: The loader relies on THREE.NURBSCurve for any nurbs present in the model. Nurbs will show up as empty geometry.");return new THREE.BufferGeometry}var t=parseInt(e.Order);if(isNaN(t)){console.error("THREE.FBXLoader: Invalid Order %s given for geometry ID: %s",e.Order,e.id);return new THREE.BufferGeometry}var r=t-1;var n=e.KnotVector.a;var i=[];var a=e.Points.a;for(var o=0,s=a.length;o<s;o+=4){i.push((new THREE.Vector4).fromArray(a,o))}var u,l;if(e.Form==="Closed"){i.push(i[0])}else if(e.Form==="Periodic"){u=r;l=n.length-1-u;for(var o=0;o<r;++o){i.push(i[o])}}var c=new THREE.NURBSCurve(r,n,i,u,l);var h=c.getPoints(i.length*7);var f=new Float32Array(h.length*3);h.forEach(function(e,t){e.toArray(f,t*3)});var d=new THREE.BufferGeometry;d.addAttribute("position",new THREE.BufferAttribute(f,3));return d}};function s(){}s.prototype={constructor:s,parse:function(){var e=[];var t=this.parseClips();if(t===undefined)return;for(var r in t){var n=t[r];var i=this.addClip(n);e.push(i)}return e},parseClips:function(){if(h.Objects.AnimationCurve===undefined)return undefined;var e=this.parseAnimationCurveNodes();this.parseAnimationCurves(e);var t=this.parseAnimationLayers(e);var r=this.parseAnimStacks(t);return r},parseAnimationCurveNodes:function(){var e=h.Objects.AnimationCurveNode;var t=new Map;for(var r in e){var n=e[r];if(n.attrName.match(/S|R|T|DeformPercent/)!==null){var i={id:n.id,attr:n.attrName,curves:{}};t.set(i.id,i)}}return t},parseAnimationCurves:function(e){var t=h.Objects.AnimationCurve;for(var r in t){var n={id:t[r].id,times:t[r].KeyTime.a.map(g),values:t[r].KeyValueFloat.a};var i=f.get(n.id);if(i!==undefined){var a=i.parents[0].ID;var o=i.parents[0].relationship;if(o.match(/X/)){e.get(a).curves["x"]=n}else if(o.match(/Y/)){e.get(a).curves["y"]=n}else if(o.match(/Z/)){e.get(a).curves["z"]=n}else if(o.match(/d|DeformPercent/)&&e.has(a)){e.get(a).curves["morph"]=n}}}},parseAnimationLayers:function(l){var e=h.Objects.AnimationLayer;var t=new Map;for(var r in e){var c=[];var n=f.get(parseInt(r));if(n!==undefined){var i=n.children;i.forEach(function(e,t){if(l.has(e.ID)){var r=l.get(e.ID);if(r.curves.x!==undefined||r.curves.y!==undefined||r.curves.z!==undefined){if(c[t]===undefined){var n=f.get(e.ID).parents.filter(function(e){return e.relationship!==undefined})[0].ID;if(n!==undefined){var i=h.Objects.Model[n.toString()];var a={modelName:THREE.PropertyBinding.sanitizeNodeName(i.attrName),ID:i.id,initialPosition:[0,0,0],initialRotation:[0,0,0],initialScale:[1,1,1]};d.traverse(function(e){if(e.ID=i.id){a.transform=e.matrix;if(e.userData.transformData)a.eulerOrder=e.userData.transformData.eulerOrder}});if(!a.transform)a.transform=new THREE.Matrix4;if("PreRotation"in i)a.preRotation=i.PreRotation.value;if("PostRotation"in i)a.postRotation=i.PostRotation.value;c[t]=a}}if(c[t])c[t][r.attr]=r}else if(r.curves.morph!==undefined){if(c[t]===undefined){var o=f.get(e.ID).parents.filter(function(e){return e.relationship!==undefined})[0].ID;var s=f.get(o).parents[0].ID;var u=f.get(s).parents[0].ID;var n=f.get(u).parents[0].ID;var i=h.Objects.Model[n];var a={modelName:THREE.PropertyBinding.sanitizeNodeName(i.attrName),morphName:h.Objects.Deformer[o].attrName};c[t]=a}c[t][r.attr]=r}}});t.set(parseInt(r),c)}}return t},parseAnimStacks:function(e){var t=h.Objects.AnimationStack;var r={};for(var n in t){var i=f.get(parseInt(n)).children;if(i.length>1){console.warn("THREE.FBXLoader: Encountered an animation stack with multiple layers, this is currently not supported. Ignoring subsequent layers.")}var a=e.get(i[0].ID);r[n]={name:t[n].attrName,layer:a}}return r},addClip:function(e){var t=[];var r=this;e.layer.forEach(function(e){t=t.concat(r.generateTracks(e))});return new THREE.AnimationClip(e.name,-1,t)},generateTracks:function(e){var t=[];var r=new THREE.Vector3;var n=new THREE.Quaternion;var i=new THREE.Vector3;if(e.transform)e.transform.decompose(r,n,i);r=r.toArray();n=(new THREE.Euler).setFromQuaternion(n,e.eulerOrder).toArray();i=i.toArray();if(e.T!==undefined&&Object.keys(e.T.curves).length>0){var a=this.generateVectorTrack(e.modelName,e.T.curves,r,"position");if(a!==undefined)t.push(a)}if(e.R!==undefined&&Object.keys(e.R.curves).length>0){var o=this.generateRotationTrack(e.modelName,e.R.curves,n,e.preRotation,e.postRotation,e.eulerOrder);if(o!==undefined)t.push(o)}if(e.S!==undefined&&Object.keys(e.S.curves).length>0){var s=this.generateVectorTrack(e.modelName,e.S.curves,i,"scale");if(s!==undefined)t.push(s)}if(e.DeformPercent!==undefined){var u=this.generateMorphTrack(e);if(u!==undefined)t.push(u)}return t},generateVectorTrack:function(e,t,r,n){var i=this.getTimesForAllAxes(t);var a=this.getKeyframeTrackValues(i,t,r);return new THREE.VectorKeyframeTrack(e+"."+n,i,a)},generateRotationTrack:function(e,t,r,n,i,a){if(t.x!==undefined){this.interpolateRotations(t.x);t.x.values=t.x.values.map(THREE.Math.degToRad)}if(t.y!==undefined){this.interpolateRotations(t.y);t.y.values=t.y.values.map(THREE.Math.degToRad)}if(t.z!==undefined){this.interpolateRotations(t.z);t.z.values=t.z.values.map(THREE.Math.degToRad)}var o=this.getTimesForAllAxes(t);var s=this.getKeyframeTrackValues(o,t,r);if(n!==undefined){n=n.map(THREE.Math.degToRad);n.push(a);n=(new THREE.Euler).fromArray(n);n=(new THREE.Quaternion).setFromEuler(n)}if(i!==undefined){i=i.map(THREE.Math.degToRad);i.push(a);i=(new THREE.Euler).fromArray(i);i=(new THREE.Quaternion).setFromEuler(i).inverse()}var u=new THREE.Quaternion;var l=new THREE.Euler;var c=[];for(var h=0;h<s.length;h+=3){l.set(s[h],s[h+1],s[h+2],a);u.setFromEuler(l);if(n!==undefined)u.premultiply(n);if(i!==undefined)u.multiply(i);u.toArray(c,h/3*4)}return new THREE.QuaternionKeyframeTrack(e+".quaternion",o,c)},generateMorphTrack:function(e){var t=e.DeformPercent.curves.morph;var r=t.values.map(function(e){return e/100});var n=d.getObjectByName(e.modelName).morphTargetDictionary[e.morphName];return new THREE.NumberKeyframeTrack(e.modelName+".morphTargetInfluences["+n+"]",t.times,r)},getTimesForAllAxes:function(e){var t=[];if(e.x!==undefined)t=t.concat(e.x.times);if(e.y!==undefined)t=t.concat(e.y.times);if(e.z!==undefined)t=t.concat(e.z.times);t=t.sort(function(e,t){return e-t}).filter(function(e,t,r){return r.indexOf(e)==t});return t},getKeyframeTrackValues:function(e,i,t){var a=t;var o=[];var s=-1;var u=-1;var l=-1;e.forEach(function(e){if(i.x)s=i.x.times.indexOf(e);if(i.y)u=i.y.times.indexOf(e);if(i.z)l=i.z.times.indexOf(e);if(s!==-1){var t=i.x.values[s];o.push(t);a[0]=t}else{o.push(a[0])}if(u!==-1){var r=i.y.values[u];o.push(r);a[1]=r}else{o.push(a[1])}if(l!==-1){var n=i.z.values[l];o.push(n);a[2]=n}else{o.push(a[2])}});return o},interpolateRotations:function(e){for(var t=1;t<e.values.length;t++){var r=e.values[t-1];var n=e.values[t]-r;var i=Math.abs(n);if(i>=180){var a=i/180;var o=n/a;var s=r+o;var u=e.times[t-1];var l=e.times[t]-u;var c=l/a;var h=u+c;var f=[];var d=[];while(h<e.times[t]){f.push(h);h+=c;d.push(s);s+=o}e.times=R(e.times,t,f);e.values=R(e.values,t,d)}}}};function o(){}o.prototype={constructor:o,getPrevNode:function(){return this.nodeStack[this.currentIndent-2]},getCurrentNode:function(){return this.nodeStack[this.currentIndent-1]},getCurrentProp:function(){return this.currentProp},pushStack:function(e){this.nodeStack.push(e);this.currentIndent+=1},popStack:function(){this.nodeStack.pop();this.currentIndent-=1},setCurrentProp:function(e,t){this.currentProp=e;this.currentPropName=t},parse:function(e){this.currentIndent=0;this.allNodes=new c;this.nodeStack=[];this.currentProp=[];this.currentPropName="";var s=this;var u=e.split(/[\r\n]+/);u.forEach(function(e,t){var r=e.match(/^[\s\t]*;/);var n=e.match(/^[\s\t]*$/);if(r||n)return;var i=e.match("^\\t{"+s.currentIndent+"}(\\w+):(.*){","");var a=e.match("^\\t{"+s.currentIndent+"}(\\w+):[\\s\\t\\r\\n](.*)");var o=e.match("^\\t{"+(s.currentIndent-1)+"}}");if(i){s.parseNodeBegin(e,i)}else if(a){s.parseNodeProperty(e,a,u[++t])}else if(o){s.popStack()}else if(e.match(/^[^\s\t}]/)){s.parseNodePropertyContinued(e)}});return this.allNodes},parseNodeBegin:function(e,t){var r=t[1].trim().replace(/^"/,"").replace(/"$/,"");var n=t[2].split(",").map(function(e){return e.trim().replace(/^"/,"").replace(/"$/,"")});var i={name:r};var a=this.parseNodeAttr(n);var o=this.getCurrentNode();if(this.currentIndent===0){this.allNodes.add(r,i)}else{if(r in o){if(r==="PoseNode"){o.PoseNode.push(i)}else if(o[r].id!==undefined){o[r]={};o[r][o[r].id]=o[r]}if(a.id!=="")o[r][a.id]=i}else if(typeof a.id==="number"){o[r]={};o[r][a.id]=i}else if(r!=="Properties70"){if(r==="PoseNode")o[r]=[i];else o[r]=i}}if(typeof a.id==="number")i.id=a.id;if(a.name!=="")i.attrName=a.name;if(a.type!=="")i.attrType=a.type;this.pushStack(i)},parseNodeAttr:function(e){var t=e[0];if(e[0]!==""){t=parseInt(e[0]);if(isNaN(t)){t=e[0]}}var r="",n="";if(e.length>1){r=e[1].replace(/^(\w+)::/,"");n=e[2]}return{id:t,name:r,type:n}},parseNodeProperty:function(e,t,r){var n=t[1].replace(/^"/,"").replace(/"$/,"").trim();var i=t[2].replace(/^"/,"").replace(/"$/,"").trim();if(n==="Content"&&i===","){i=r.replace(/"/g,"").replace(/,$/,"").trim()}var a=this.getCurrentNode();var o=a.name;if(o==="Properties70"){this.parseNodeSpecialProperty(e,n,i);return}if(n==="C"){var s=i.split(",").slice(1);var u=parseInt(s[0]);var l=parseInt(s[1]);var c=i.split(",").slice(3);c=c.map(function(e){return e.trim().replace(/^"/,"")});n="connections";i=[u,l];E(i,c);if(a[n]===undefined){a[n]=[]}}if(n==="Node")a.id=i;if(n in a&&Array.isArray(a[n])){a[n].push(i)}else{if(n!=="a")a[n]=i;else a.a=i}this.setCurrentProp(a,n);if(n==="a"&&i.slice(-1)!==","){a.a=w(i)}},parseNodePropertyContinued:function(e){var t=this.getCurrentNode();t.a+=e;if(e.slice(-1)!==","){t.a=w(t.a)}},parseNodeSpecialProperty:function(e,t,r){var n=r.split('",').map(function(e){return e.trim().replace(/^\"/,"").replace(/\s/,"_")});var i=n[0];var a=n[1];var o=n[2];var s=n[3];var u=n[4];switch(a){case"int":case"enum":case"bool":case"ULongLong":case"double":case"Number":case"FieldOfView":u=parseFloat(u);break;case"Color":case"ColorRGB":case"Vector3D":case"Lcl_Translation":case"Lcl_Rotation":case"Lcl_Scaling":u=w(u);break}this.getPrevNode()[i]={type:a,type2:o,flag:s,value:u};this.setCurrentProp(this.getPrevNode(),i)}};function u(){}u.prototype={constructor:u,parse:function(e){var t=new l(e);t.skip(23);var r=t.getUint32();console.log("THREE.FBXLoader: FBX binary version: "+r);var n=new c;while(!this.endOfContent(t)){var i=this.parseNode(t,r);if(i!==null)n.add(i.name,i)}return n},endOfContent:function(e){if(e.size()%16===0){return(e.getOffset()+160+16&~15)>=e.size()}else{return e.getOffset()+160+16>=e.size()}},parseNode:function(e,t){var r={};var n=t>=7500?e.getUint64():e.getUint32();var i=t>=7500?e.getUint64():e.getUint32();var a=t>=7500?e.getUint64():e.getUint32();var o=e.getUint8();var s=e.getString(o);if(n===0)return null;var u=[];for(var l=0;l<i;l++){u.push(this.parseProperty(e))}var c=u.length>0?u[0]:"";var h=u.length>1?u[1]:"";var f=u.length>2?u[2]:"";r.singleProperty=i===1&&e.getOffset()===n?true:false;while(n>e.getOffset()){var d=this.parseNode(e,t);if(d!==null)this.parseSubNode(s,r,d)}r.propertyList=u;if(typeof c==="number")r.id=c;if(h!=="")r.attrName=h;if(f!=="")r.attrType=f;if(s!=="")r.name=s;return r},parseSubNode:function(e,t,r){if(r.singleProperty===true){var n=r.propertyList[0];if(Array.isArray(n)){t[r.name]=r;r.a=n}else{t[r.name]=n}}else if(e==="Connections"&&r.name==="C"){var i=[];r.propertyList.forEach(function(e,t){if(t!==0)i.push(e)});if(t.connections===undefined){t.connections=[]}t.connections.push(i)}else if(r.name==="Properties70"){var a=Object.keys(r);a.forEach(function(e){t[e]=r[e]})}else if(e==="Properties70"&&r.name==="P"){var o=r.propertyList[0];var s=r.propertyList[1];var u=r.propertyList[2];var l=r.propertyList[3];var c;if(o.indexOf("Lcl ")===0)o=o.replace("Lcl ","Lcl_");if(s.indexOf("Lcl ")===0)s=s.replace("Lcl ","Lcl_");if(s==="Color"||s==="ColorRGB"||s==="Vector"||s==="Vector3D"||s.indexOf("Lcl_")===0){c=[r.propertyList[4],r.propertyList[5],r.propertyList[6]]}else{c=r.propertyList[4]}t[o]={type:s,type2:u,flag:l,value:c}}else if(t[r.name]===undefined){if(typeof r.id==="number"){t[r.name]={};t[r.name][r.id]=r}else{t[r.name]=r}}else{if(r.name==="PoseNode"){if(!Array.isArray(t[r.name])){t[r.name]=[t[r.name]]}t[r.name].push(r)}else if(t[r.name][r.id]===undefined){t[r.name][r.id]=r}}},parseProperty:function(e){var t=e.getString(1);switch(t){case"C":return e.getBoolean();case"D":return e.getFloat64();case"F":return e.getFloat32();case"I":return e.getInt32();case"L":return e.getInt64();case"R":var r=e.getUint32();return e.getArrayBuffer(r);case"S":var r=e.getUint32();return e.getString(r);case"Y":return e.getInt16();case"b":case"c":case"d":case"f":case"i":case"l":var n=e.getUint32();var i=e.getUint32();var a=e.getUint32();if(i===0){switch(t){case"b":case"c":return e.getBooleanArray(n);case"d":return e.getFloat64Array(n);case"f":return e.getFloat32Array(n);case"i":return e.getInt32Array(n);case"l":return e.getInt64Array(n)}}if(typeof Zlib==="undefined"){console.error("THREE.FBXLoader: External library Inflate.min.js required, obtain or import from https://github.com/imaya/zlib.js")}var o=new Zlib.Inflate(new Uint8Array(e.getArrayBuffer(a)));var s=new l(o.decompress().buffer);switch(t){case"b":case"c":return s.getBooleanArray(n);case"d":return s.getFloat64Array(n);case"f":return s.getFloat32Array(n);case"i":return s.getInt32Array(n);case"l":return s.getInt64Array(n)}default:throw new Error("THREE.FBXLoader: Unknown property type "+t)}}};function l(e,t){this.dv=new DataView(e);this.offset=0;this.littleEndian=t!==undefined?t:true}l.prototype={constructor:l,getOffset:function(){return this.offset},size:function(){return this.dv.buffer.byteLength},skip:function(e){this.offset+=e},getBoolean:function(){return(this.getUint8()&1)===1},getBooleanArray:function(e){var t=[];for(var r=0;r<e;r++){t.push(this.getBoolean())}return t},getUint8:function(){var e=this.dv.getUint8(this.offset);this.offset+=1;return e},getInt16:function(){var e=this.dv.getInt16(this.offset,this.littleEndian);this.offset+=2;return e},getInt32:function(){var e=this.dv.getInt32(this.offset,this.littleEndian);this.offset+=4;return e},getInt32Array:function(e){var t=[];for(var r=0;r<e;r++){t.push(this.getInt32())}return t},getUint32:function(){var e=this.dv.getUint32(this.offset,this.littleEndian);this.offset+=4;return e},getInt64:function(){var e,t;if(this.littleEndian){e=this.getUint32();t=this.getUint32()}else{t=this.getUint32();e=this.getUint32()}if(t&2147483648){t=~t&4294967295;e=~e&4294967295;if(e===4294967295)t=t+1&4294967295;e=e+1&4294967295;return-(t*4294967296+e)}return t*4294967296+e},getInt64Array:function(e){var t=[];for(var r=0;r<e;r++){t.push(this.getInt64())}return t},getUint64:function(){var e,t;if(this.littleEndian){e=this.getUint32();t=this.getUint32()}else{t=this.getUint32();e=this.getUint32()}return t*4294967296+e},getFloat32:function(){var e=this.dv.getFloat32(this.offset,this.littleEndian);this.offset+=4;return e},getFloat32Array:function(e){var t=[];for(var r=0;r<e;r++){t.push(this.getFloat32())}return t},getFloat64:function(){var e=this.dv.getFloat64(this.offset,this.littleEndian);this.offset+=8;return e},getFloat64Array:function(e){var t=[];for(var r=0;r<e;r++){t.push(this.getFloat64())}return t},getArrayBuffer:function(e){var t=this.dv.buffer.slice(this.offset,this.offset+e);this.offset+=e;return t},getString:function(e){var t=[];for(var r=0;r<e;r++){t[r]=this.getUint8()}var n=t.indexOf(0);if(n>=0)t=t.slice(0,n);return THREE.LoaderUtils.decodeText(new Uint8Array(t))}};function c(){}c.prototype={constructor:c,add:function(e,t){this[e]=t}};function p(e){var t="Kaydara FBX Binary  \0";return e.byteLength>=t.length&&t===T(e,0,t.length)}function v(r){var e=["K","a","y","d","a","r","a","\\","F","B","X","\\","B","i","n","a","r","y","\\","\\"];var n=0;function t(e){var t=r[e-1];r=r.slice(n+e);n++;return t}for(var i=0;i<e.length;++i){var a=t(1);if(a===e[i]){return false}}return true}function m(e){var t=/FBXVersion: (\d+)/;var r=e.match(t);if(r){var n=parseInt(r[1]);return n}throw new Error("THREE.FBXLoader: Cannot find the version number for the file given.")}function g(e){return e/46186158e3}var y=[];function _(e,t,r,n){var i;switch(n.mappingType){case"ByPolygonVertex":i=e;break;case"ByPolygon":i=t;break;case"ByVertice":i=r;break;case"AllSame":i=n.indices[0];break;default:console.warn("THREE.FBXLoader: unknown attribute mapping type "+n.mappingType)}if(n.referenceType==="IndexToDirect")i=n.indices[i];var a=i*n.dataSize;var o=a+n.dataSize;return M(y,n.buffer,a,o)}var S=new THREE.Euler;var A=new THREE.Vector3;function x(e){var t=new THREE.Matrix4;var r=new THREE.Matrix4;var n=new THREE.Matrix4;var i=new THREE.Matrix4;var a=new THREE.Matrix4;var o=new THREE.Matrix4;var s=new THREE.Matrix4;var u=new THREE.Matrix4;var l=new THREE.Matrix4;var c=new THREE.Matrix4;var h=new THREE.Matrix4;var f=e.inheritType?e.inheritType:0;if(e.translation)t.setPosition(A.fromArray(e.translation));if(e.preRotation){var d=e.preRotation.map(THREE.Math.degToRad);d.push(e.eulerOrder);r.makeRotationFromEuler(S.fromArray(d))}if(e.rotation){var d=e.rotation.map(THREE.Math.degToRad);d.push(e.eulerOrder);n.makeRotationFromEuler(S.fromArray(d))}if(e.postRotation){var d=e.postRotation.map(THREE.Math.degToRad);d.push(e.eulerOrder);i.makeRotationFromEuler(S.fromArray(d))}if(e.scale)a.scale(A.fromArray(e.scale));if(e.scalingOffset)s.setPosition(A.fromArray(e.scalingOffset));if(e.scalingPivot)o.setPosition(A.fromArray(e.scalingPivot));if(e.rotationOffset)u.setPosition(A.fromArray(e.rotationOffset));if(e.rotationPivot)l.setPosition(A.fromArray(e.rotationPivot));if(e.parentMatrixWorld)c=e.parentMatrixWorld;var p=r.multiply(n).multiply(i);var v=new THREE.Matrix4;c.extractRotation(v);var m=new THREE.Matrix4;var g;var y;var x;m.copyPosition(c);x=m.getInverse(m).multiply(c);y=v.getInverse(v).multiply(x);g=a;var b;if(f===0){b=v.multiply(p).multiply(y).multiply(g)}else if(f===1){b=v.multiply(y).multiply(p).multiply(g)}else{var w=(new THREE.Matrix4).copy(a);var _=y.multiply(w.getInverse(w));b=v.multiply(p).multiply(_).multiply(g)}var T=t.multiply(u).multiply(l).multiply(r).multiply(n).multiply(i).multiply(l.getInverse(l)).multiply(s).multiply(o).multiply(a).multiply(o.getInverse(o));var E=(new THREE.Matrix4).copyPosition(T);var M=c.multiply(E);h.copyPosition(M);T=h.multiply(b);return T}function b(e){e=e||0;var t=["ZYX","YZX","XZY","ZXY","YXZ","XYZ"];if(e===6){console.warn("THREE.FBXLoader: unsupported Euler Order: Spherical XYZ. Animations and rotations may be incorrect.");return t[0]}return t[e]}function w(e){var t=e.split(",").map(function(e){return parseFloat(e)});return t}function T(e,t,r){if(t===undefined)t=0;if(r===undefined)r=e.byteLength;return THREE.LoaderUtils.decodeText(new Uint8Array(e,t,r))}function E(e,t){for(var r=0,n=e.length,i=t.length;r<i;r++,n++){e[n]=t[r]}}function M(e,t,r,n){for(var i=r,a=0;i<n;i++,a++){e[a]=t[i]}return e}function R(e,t,r){return e.slice(0,t).concat(r).concat(e.slice(t))}return e}();(function(){"use strict";var T=void 0,a=this;function e(e,t){var r=e.split("."),n=a;!(r[0]in n)&&n.execScript&&n.execScript("var "+r[0]);for(var i;r.length&&(i=r.shift());)!r.length&&t!==T?n[i]=t:n=n[i]?n[i]:n[i]={}}var E="undefined"!==typeof Uint8Array&&"undefined"!==typeof Uint16Array&&"undefined"!==typeof Uint32Array&&"undefined"!==typeof DataView;function M(e){var t=e.length,r=0,n=Number.POSITIVE_INFINITY,i,a,o,s,u,l,c,h,f,d;for(h=0;h<t;++h)e[h]>r&&(r=e[h]),e[h]<n&&(n=e[h]);i=1<<r;a=new(E?Uint32Array:Array)(i);o=1;s=0;for(u=2;o<=r;){for(h=0;h<t;++h)if(e[h]===o){l=0;c=s;for(f=0;f<o;++f)l=l<<1|c&1,c>>=1;d=o<<16|h;for(f=l;f<i;f+=u)a[f]=d;++s}++o;s<<=1;u<<=1}return[a,r,n]}function i(e,t){this.g=[];this.h=32768;this.d=this.f=this.a=this.l=0;this.input=E?new Uint8Array(e):e;this.m=!1;this.i=A;this.r=!1;if(t||!(t={}))t.index&&(this.a=t.index),t.bufferSize&&(this.h=t.bufferSize),t.bufferType&&(this.i=t.bufferType),t.resize&&(this.r=t.resize);switch(this.i){case S:this.b=32768;this.c=new(E?Uint8Array:Array)(32768+this.h+258);break;case A:this.b=0;this.c=new(E?Uint8Array:Array)(this.h);this.e=this.z;this.n=this.v;this.j=this.w;break;default:throw Error("invalid inflate mode")}}var S=0,A=1,t={t:S,s:A};i.prototype.k=function(){for(;!this.m;){var e=O(this,3);e&1&&(this.m=!0);e>>>=1;switch(e){case 0:var t=this.input,r=this.a,n=this.c,i=this.b,a=t.length,o=T,s=T,u=n.length,l=T;this.d=this.f=0;if(r+1>=a)throw Error("invalid uncompressed block header: LEN");o=t[r++]|t[r++]<<8;if(r+1>=a)throw Error("invalid uncompressed block header: NLEN");s=t[r++]|t[r++]<<8;if(o===~s)throw Error("invalid uncompressed block header: length verify");if(r+o>t.length)throw Error("input buffer is broken");switch(this.i){case S:for(;i+o>n.length;){l=u-i;o-=l;if(E)n.set(t.subarray(r,r+l),i),i+=l,r+=l;else for(;l--;)n[i++]=t[r++];this.b=i;n=this.e();i=this.b}break;case A:for(;i+o>n.length;)n=this.e({p:2});break;default:throw Error("invalid inflate mode")}if(E)n.set(t.subarray(r,r+o),i),i+=o,r+=o;else for(;o--;)n[i++]=t[r++];this.a=r;this.b=i;this.c=n;break;case 1:this.j(P,C);break;case 2:for(var c=O(this,5)+257,h=O(this,5)+1,f=O(this,4)+4,d=new(E?Uint8Array:Array)(R.length),p=T,v=T,m=T,g=T,y=T,x=T,b=T,w=T,_=T,w=0;w<f;++w)d[R[w]]=O(this,3);if(!E){w=f;for(f=d.length;w<f;++w)d[R[w]]=0}p=M(d);g=new(E?Uint8Array:Array)(c+h);w=0;for(_=c+h;w<_;)switch(y=L(this,p),y){case 16:for(b=3+O(this,2);b--;)g[w++]=x;break;case 17:for(b=3+O(this,3);b--;)g[w++]=0;x=0;break;case 18:for(b=11+O(this,7);b--;)g[w++]=0;x=0;break;default:x=g[w++]=y}v=E?M(g.subarray(0,c)):M(g.slice(0,c));m=E?M(g.subarray(c)):M(g.slice(c));this.j(v,m);break;default:throw Error("unknown BTYPE: "+e)}}return this.n()};var r=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],R=E?new Uint16Array(r):r,n=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,258,258],l=E?new Uint16Array(n):n,o=[0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0,0,0],c=E?new Uint8Array(o):o,s=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577],h=E?new Uint16Array(s):s,u=[0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13],f=E?new Uint8Array(u):u,d=new(E?Uint8Array:Array)(288),p,v;p=0;for(v=d.length;p<v;++p)d[p]=143>=p?8:255>=p?9:279>=p?7:8;var P=M(d),m=new(E?Uint8Array:Array)(30),g,y;g=0;for(y=m.length;g<y;++g)m[g]=5;var C=M(m);function O(e,t){for(var r=e.f,n=e.d,i=e.input,a=e.a,o=i.length,s;n<t;){if(a>=o)throw Error("input buffer is broken");r|=i[a++]<<n;n+=8}s=r&(1<<t)-1;e.f=r>>>t;e.d=n-t;e.a=a;return s}function L(e,t){for(var r=e.f,n=e.d,i=e.input,a=e.a,o=i.length,s=t[0],u=t[1],l,c;n<u&&!(a>=o);)r|=i[a++]<<n,n+=8;l=s[r&(1<<u)-1];c=l>>>16;if(c>n)throw Error("invalid code length: "+c);e.f=r>>c;e.d=n-c;e.a=a;return l&65535}i.prototype.j=function(e,t){var r=this.c,n=this.b;this.o=e;for(var i=r.length-258,a,o,s,u;256!==(a=L(this,e));)if(256>a)n>=i&&(this.b=n,r=this.e(),n=this.b),r[n++]=a;else{o=a-257;u=l[o];0<c[o]&&(u+=O(this,c[o]));a=L(this,t);s=h[a];0<f[a]&&(s+=O(this,f[a]));n>=i&&(this.b=n,r=this.e(),n=this.b);for(;u--;)r[n]=r[n++-s]}for(;8<=this.d;)this.d-=8,this.a--;this.b=n};i.prototype.w=function(e,t){var r=this.c,n=this.b;this.o=e;for(var i=r.length,a,o,s,u;256!==(a=L(this,e));)if(256>a)n>=i&&(r=this.e(),i=r.length),r[n++]=a;else{o=a-257;u=l[o];0<c[o]&&(u+=O(this,c[o]));a=L(this,t);s=h[a];0<f[a]&&(s+=O(this,f[a]));n+u>i&&(r=this.e(),i=r.length);for(;u--;)r[n]=r[n++-s]}for(;8<=this.d;)this.d-=8,this.a--;this.b=n};i.prototype.e=function(){var e=new(E?Uint8Array:Array)(this.b-32768),t=this.b-32768,r,n,i=this.c;if(E)e.set(i.subarray(32768,e.length));else{r=0;for(n=e.length;r<n;++r)e[r]=i[r+32768]}this.g.push(e);this.l+=e.length;if(E)i.set(i.subarray(t,t+32768));else for(r=0;32768>r;++r)i[r]=i[t+r];this.b=32768;return i};i.prototype.z=function(e){var t,r=this.input.length/this.a+1|0,n,i,a,o=this.input,s=this.c;e&&("number"===typeof e.p&&(r=e.p),"number"===typeof e.u&&(r+=e.u));2>r?(n=(o.length-this.a)/this.o[2],a=258*(n/2)|0,i=a<s.length?s.length+a:s.length<<1):i=s.length*r;E?(t=new Uint8Array(i),t.set(s)):t=s;return this.c=t};i.prototype.n=function(){var e=0,t=this.c,r=this.g,n,i=new(E?Uint8Array:Array)(this.l+(this.b-32768)),a,o,s,u;if(0===r.length)return E?this.c.subarray(32768,this.b):this.c.slice(32768,this.b);a=0;for(o=r.length;a<o;++a){n=r[a];s=0;for(u=n.length;s<u;++s)i[e++]=n[s]}a=32768;for(o=this.b;a<o;++a)i[e++]=t[a];this.g=[];return this.buffer=i};i.prototype.v=function(){var e,t=this.b;E?this.r?(e=new Uint8Array(t),e.set(this.c.subarray(0,t))):e=this.c.subarray(0,t):(this.c.length>t&&(this.c.length=t),e=this.c);return this.buffer=e};function x(e,t){var r,n;this.input=e;this.a=0;if(t||!(t={}))t.index&&(this.a=t.index),t.verify&&(this.A=t.verify);r=e[this.a++];n=e[this.a++];switch(r&15){case b:this.method=b;break;default:throw Error("unsupported compression method")}if(0!==((r<<8)+n)%31)throw Error("invalid fcheck flag:"+((r<<8)+n)%31);if(n&32)throw Error("fdict flag is not supported");this.q=new i(e,{index:this.a,bufferSize:t.bufferSize,bufferType:t.bufferType,resize:t.resize})}x.prototype.k=function(){var e=this.input,t,r;t=this.q.k();this.a=this.q.a;if(this.A){r=(e[this.a++]<<24|e[this.a++]<<16|e[this.a++]<<8|e[this.a++])>>>0;var n=t;if("string"===typeof n){var i=n.split(""),a,o;a=0;for(o=i.length;a<o;a++)i[a]=(i[a].charCodeAt(0)&255)>>>0;n=i}for(var s=1,u=0,l=n.length,c,h=0;0<l;){c=1024<l?1024:l;l-=c;do{s+=n[h++],u+=s}while(--c);s%=65521;u%=65521}if(r!==(u<<16|s)>>>0)throw Error("invalid adler-32 checksum")}return t};var b=8;e("Zlib.Inflate",x);e("Zlib.Inflate.prototype.decompress",x.prototype.k);var w={ADAPTIVE:t.s,BLOCK:t.t},_,I,D,N;if(Object.keys)_=Object.keys(w);else for(I in _=[],D=0,w)_[D++]=I;D=0;for(N=_.length;D<N;++D)I=_[D],e("Zlib.Inflate.BufferType."+I,w[I])}).call(this);!function(e){if("object"==typeof exports&&"undefined"!=typeof module)module.exports=e();else if("function"==typeof define&&false)define([],e);else{var t;"undefined"!=typeof window?t=window:"undefined"!=typeof global?t=global:"undefined"!=typeof self&&(t=self),t.CANNON=e()}}(function(){var e,t,r;return function i(a,o,s){function u(r,e){if(!o[r]){if(!a[r]){var t=typeof require=="function"&&require;if(!e&&t)return t(r,!0);if(l)return l(r,!0);throw new Error("Cannot find module '"+r+"'")}var n=o[r]={exports:{}};a[r][0].call(n.exports,function(e){var t=a[r][1][e];return u(t?t:e)},n,n.exports,i,a,o,s)}return o[r].exports}var l=typeof require=="function"&&require;for(var e=0;e<s.length;e++)u(s[e]);return u}({1:[function(e,t,r){t.exports={name:"cannon",version:"0.6.2",description:"A lightweight 3D physics engine written in JavaScript.",homepage:"https://github.com/schteppe/cannon.js",author:"Stefan Hedman <schteppe@gmail.com> (http://steffe.se)",keywords:["cannon.js","cannon","physics","engine","3d"],main:"./build/cannon.js",engines:{node:"*"},repository:{type:"git",url:"https://github.com/schteppe/cannon.js.git"},bugs:{url:"https://github.com/schteppe/cannon.js/issues"},licenses:[{type:"MIT"}],devDependencies:{jshint:"latest","uglify-js":"latest",nodeunit:"^0.9.0",grunt:"~0.4.0","grunt-contrib-jshint":"~0.1.1","grunt-contrib-nodeunit":"^0.4.1","grunt-contrib-concat":"~0.1.3","grunt-contrib-uglify":"^0.5.1","grunt-browserify":"^2.1.4","grunt-contrib-yuidoc":"^0.5.2",browserify:"*"},dependencies:{}}},{}],2:[function(e,t,r){t.exports={version:e("../package.json").version,AABB:e("./collision/AABB"),ArrayCollisionMatrix:e("./collision/ArrayCollisionMatrix"),Body:e("./objects/Body"),Box:e("./shapes/Box"),Broadphase:e("./collision/Broadphase"),Constraint:e("./constraints/Constraint"),ContactEquation:e("./equations/ContactEquation"),Narrowphase:e("./world/Narrowphase"),ConeTwistConstraint:e("./constraints/ConeTwistConstraint"),ContactMaterial:e("./material/ContactMaterial"),ConvexPolyhedron:e("./shapes/ConvexPolyhedron"),Cylinder:e("./shapes/Cylinder"),DistanceConstraint:e("./constraints/DistanceConstraint"),Equation:e("./equations/Equation"),EventTarget:e("./utils/EventTarget"),FrictionEquation:e("./equations/FrictionEquation"),GSSolver:e("./solver/GSSolver"),GridBroadphase:e("./collision/GridBroadphase"),Heightfield:e("./shapes/Heightfield"),HingeConstraint:e("./constraints/HingeConstraint"),LockConstraint:e("./constraints/LockConstraint"),Mat3:e("./math/Mat3"),Material:e("./material/Material"),NaiveBroadphase:e("./collision/NaiveBroadphase"),ObjectCollisionMatrix:e("./collision/ObjectCollisionMatrix"),Pool:e("./utils/Pool"),Particle:e("./shapes/Particle"),Plane:e("./shapes/Plane"),PointToPointConstraint:e("./constraints/PointToPointConstraint"),Quaternion:e("./math/Quaternion"),Ray:e("./collision/Ray"),RaycastVehicle:e("./objects/RaycastVehicle"),RaycastResult:e("./collision/RaycastResult"),RigidVehicle:e("./objects/RigidVehicle"),RotationalEquation:e("./equations/RotationalEquation"),RotationalMotorEquation:e("./equations/RotationalMotorEquation"),SAPBroadphase:e("./collision/SAPBroadphase"),SPHSystem:e("./objects/SPHSystem"),Shape:e("./shapes/Shape"),Solver:e("./solver/Solver"),Sphere:e("./shapes/Sphere"),SplitSolver:e("./solver/SplitSolver"),Spring:e("./objects/Spring"),Trimesh:e("./shapes/Trimesh"),Vec3:e("./math/Vec3"),Vec3Pool:e("./utils/Vec3Pool"),World:e("./world/World")}},{"../package.json":1,"./collision/AABB":3,"./collision/ArrayCollisionMatrix":4,"./collision/Broadphase":5,"./collision/GridBroadphase":6,"./collision/NaiveBroadphase":7,"./collision/ObjectCollisionMatrix":8,"./collision/Ray":9,"./collision/RaycastResult":10,"./collision/SAPBroadphase":11,"./constraints/ConeTwistConstraint":12,"./constraints/Constraint":13,"./constraints/DistanceConstraint":14,"./constraints/HingeConstraint":15,"./constraints/LockConstraint":16,"./constraints/PointToPointConstraint":17,"./equations/ContactEquation":19,"./equations/Equation":20,"./equations/FrictionEquation":21,"./equations/RotationalEquation":22,"./equations/RotationalMotorEquation":23,"./material/ContactMaterial":24,"./material/Material":25,"./math/Mat3":27,"./math/Quaternion":28,"./math/Vec3":30,"./objects/Body":31,"./objects/RaycastVehicle":32,"./objects/RigidVehicle":33,"./objects/SPHSystem":34,"./objects/Spring":35,"./shapes/Box":37,"./shapes/ConvexPolyhedron":38,"./shapes/Cylinder":39,"./shapes/Heightfield":40,"./shapes/Particle":41,"./shapes/Plane":42,"./shapes/Shape":43,"./shapes/Sphere":44,"./shapes/Trimesh":45,"./solver/GSSolver":46,"./solver/Solver":47,"./solver/SplitSolver":48,"./utils/EventTarget":49,"./utils/Pool":51,"./utils/Vec3Pool":54,"./world/Narrowphase":55,"./world/World":56}],3:[function(e,t,r){var n=e("../math/Vec3");var i=e("../utils/Utils");t.exports=a;function a(e){e=e||{};this.lowerBound=new n;if(e.lowerBound){this.lowerBound.copy(e.lowerBound)}this.upperBound=new n;if(e.upperBound){this.upperBound.copy(e.upperBound)}}var l=new n;a.prototype.setFromPoints=function(e,t,r,n){var i=this.lowerBound,a=this.upperBound,o=r;i.copy(e[0]);if(o){o.vmult(i,i)}a.copy(i);for(var s=1;s<e.length;s++){var u=e[s];if(o){o.vmult(u,l);u=l}if(u.x>a.x){a.x=u.x}if(u.x<i.x){i.x=u.x}if(u.y>a.y){a.y=u.y}if(u.y<i.y){i.y=u.y}if(u.z>a.z){a.z=u.z}if(u.z<i.z){i.z=u.z}}if(t){t.vadd(i,i);t.vadd(a,a)}if(n){i.x-=n;i.y-=n;i.z-=n;a.x+=n;a.y+=n;a.z+=n}return this};a.prototype.copy=function(e){this.lowerBound.copy(e.lowerBound);this.upperBound.copy(e.upperBound);return this};a.prototype.clone=function(){return(new a).copy(this)};a.prototype.extend=function(e){var t=e.lowerBound.x;if(this.lowerBound.x>t){this.lowerBound.x=t}var r=e.upperBound.x;if(this.upperBound.x<r){this.upperBound.x=r}var t=e.lowerBound.y;if(this.lowerBound.y>t){this.lowerBound.y=t}var r=e.upperBound.y;if(this.upperBound.y<r){this.upperBound.y=r}var t=e.lowerBound.z;if(this.lowerBound.z>t){this.lowerBound.z=t}var r=e.upperBound.z;if(this.upperBound.z<r){this.upperBound.z=r}};a.prototype.overlaps=function(e){var t=this.lowerBound,r=this.upperBound,n=e.lowerBound,i=e.upperBound;return(n.x<=r.x&&r.x<=i.x||t.x<=i.x&&i.x<=r.x)&&(n.y<=r.y&&r.y<=i.y||t.y<=i.y&&i.y<=r.y)&&(n.z<=r.z&&r.z<=i.z||t.z<=i.z&&i.z<=r.z)};a.prototype.contains=function(e){var t=this.lowerBound,r=this.upperBound,n=e.lowerBound,i=e.upperBound;return t.x<=n.x&&r.x>=i.x&&(t.y<=n.y&&r.y>=i.y)&&(t.z<=n.z&&r.z>=i.z)};a.prototype.getCorners=function(e,t,r,n,i,a,o,s){var u=this.lowerBound,l=this.upperBound;e.copy(u);t.set(l.x,u.y,u.z);r.set(l.x,l.y,u.z);n.set(u.x,l.y,l.z);i.set(l.x,u.y,u.z);a.set(u.x,l.y,u.z);o.set(u.x,u.y,l.z);s.copy(l)};var d=[new n,new n,new n,new n,new n,new n,new n,new n];a.prototype.toLocalFrame=function(e,t){var r=d;var n=r[0];var i=r[1];var a=r[2];var o=r[3];var s=r[4];var u=r[5];var l=r[6];var c=r[7];this.getCorners(n,i,a,o,s,u,l,c);for(var h=0;h!==8;h++){var f=r[h];e.pointToLocal(f,f)}return t.setFromPoints(r)};a.prototype.toWorldFrame=function(e,t){var r=d;var n=r[0];var i=r[1];var a=r[2];var o=r[3];var s=r[4];var u=r[5];var l=r[6];var c=r[7];this.getCorners(n,i,a,o,s,u,l,c);for(var h=0;h!==8;h++){var f=r[h];e.pointToWorld(f,f)}return t.setFromPoints(r)}},{"../math/Vec3":30,"../utils/Utils":53}],4:[function(e,t,r){t.exports=n;function n(){this.matrix=[]}n.prototype.get=function(e,t){e=e.index;t=t.index;if(t>e){var r=t;t=e;e=r}return this.matrix[(e*(e+1)>>1)+t-1]};n.prototype.set=function(e,t,r){e=e.index;t=t.index;if(t>e){var n=t;t=e;e=n}this.matrix[(e*(e+1)>>1)+t-1]=r?1:0};n.prototype.reset=function(){for(var e=0,t=this.matrix.length;e!==t;e++){this.matrix[e]=0}};n.prototype.setNumObjects=function(e){this.matrix.length=e*(e-1)>>1}},{}],5:[function(e,t,r){var n=e("../objects/Body");var i=e("../math/Vec3");var a=e("../math/Quaternion");var o=e("../shapes/Shape");var s=e("../shapes/Plane");t.exports=u;function u(){this.world=null;this.useBoundingBoxes=false;this.dirty=true}u.prototype.collisionPairs=function(e,t,r){throw new Error("collisionPairs not implemented for this BroadPhase class!")};var l=n.STATIC|n.KINEMATIC;u.prototype.needBroadphaseCollision=function(e,t){if((e.collisionFilterGroup&t.collisionFilterMask)===0||(t.collisionFilterGroup&e.collisionFilterMask)===0){return false}if(((e.type&l)!==0||e.sleepState===n.SLEEPING)&&((t.type&l)!==0||t.sleepState===n.SLEEPING)){return false}return true};u.prototype.intersectionTest=function(e,t,r,n){if(this.useBoundingBoxes){this.doBoundingBoxBroadphase(e,t,r,n)}else{this.doBoundingSphereBroadphase(e,t,r,n)}};var c=new i,h=new i,f=new a,d=new i;u.prototype.doBoundingSphereBroadphase=function(e,t,r,n){var i=c;t.position.vsub(e.position,i);var a=Math.pow(e.boundingRadius+t.boundingRadius,2);var o=i.norm2();if(o<a){r.push(e);n.push(t)}};u.prototype.doBoundingBoxBroadphase=function(e,t,r,n){if(e.aabbNeedsUpdate){e.computeAABB()}if(t.aabbNeedsUpdate){t.computeAABB()}if(e.aabb.overlaps(t.aabb)){r.push(e);n.push(t)}};var p={keys:[]},v=[],m=[];u.prototype.makePairsUnique=function(e,t){var r=p,n=v,i=m,a=e.length;for(var o=0;o!==a;o++){n[o]=e[o];i[o]=t[o]}e.length=0;t.length=0;for(var o=0;o!==a;o++){var s=n[o].id,u=i[o].id;var l=s<u?s+","+u:u+","+s;r[l]=o;r.keys.push(l)}for(var o=0;o!==r.keys.length;o++){var l=r.keys.pop(),c=r[l];e.push(n[c]);t.push(i[c]);delete r[l]}};u.prototype.setWorld=function(e){};var g=new i;u.boundingSphereCheck=function(e,t){var r=g;e.position.vsub(t.position,r);return Math.pow(e.shape.boundingSphereRadius+t.shape.boundingSphereRadius,2)>r.norm2()};u.prototype.aabbQuery=function(e,t,r){console.warn(".aabbQuery is not implemented in this Broadphase subclass.");return[]}},{"../math/Quaternion":28,"../math/Vec3":30,"../objects/Body":31,"../shapes/Plane":42,"../shapes/Shape":43}],6:[function(e,t,r){t.exports=n;var s=e("./Broadphase");var u=e("../math/Vec3");var ae=e("../shapes/Shape");function n(e,t,r,n,i){s.apply(this);this.nx=r||10;this.ny=n||10;this.nz=i||10;this.aabbMin=e||new u(100,100,100);this.aabbMax=t||new u(-100,-100,-100);var a=this.nx*this.ny*this.nz;if(a<=0){throw"GridBroadphase: Each dimension's n must be >0"}this.bins=[];this.binLengths=[];this.bins.length=a;this.binLengths.length=a;for(var o=0;o<a;o++){this.bins[o]=[];this.binLengths[o]=0}}n.prototype=new s;n.prototype.constructor=n;var oe=new u;var i=new u;n.prototype.collisionPairs=function(e,t,r){var n=e.numObjects(),i=e.bodies;var a=this.aabbMax,o=this.aabbMin,g=this.nx,y=this.ny,x=this.nz;var b=y*x;var w=x;var _=1;var s=a.x,u=a.y,l=a.z,T=o.x,E=o.y,M=o.z;var S=g/(s-T),A=y/(u-E),R=x/(l-M);var c=(s-T)/g,h=(u-E)/y,f=(l-M)/x;var d=Math.sqrt(c*c+h*h+f*f)*.5;var p=ae.types;var v=p.SPHERE,m=p.PLANE,P=p.BOX,C=p.COMPOUND,O=p.CONVEXPOLYHEDRON;var L=this.bins,I=this.binLengths,D=this.bins.length;for(var N=0;N!==D;N++){I[N]=0}var F=Math.ceil;var o=Math.min;var a=Math.max;function B(e,t,r,n,i,a,o){var s=(e-T)*S|0,u=(t-E)*A|0,l=(r-M)*R|0,c=F((n-T)*S),h=F((i-E)*A),f=F((a-M)*R);if(s<0){s=0}else if(s>=g){s=g-1}if(u<0){u=0}else if(u>=y){u=y-1}if(l<0){l=0}else if(l>=x){l=x-1}if(c<0){c=0}else if(c>=g){c=g-1}if(h<0){h=0}else if(h>=y){h=y-1}if(f<0){f=0}else if(f>=x){f=x-1}s*=b;u*=w;l*=_;c*=b;h*=w;f*=_;for(var d=s;d<=c;d+=b){for(var p=u;p<=h;p+=w){for(var v=l;v<=f;v+=_){var m=d+p+v;L[m][I[m]++]=o}}}}for(var N=0;N!==n;N++){var U=i[N];var k=U.shape;switch(k.type){case v:var j=U.position.x,z=U.position.y,H=U.position.z;var G=k.radius;B(j-G,z-G,H-G,j+G,z+G,H+G,U);break;case m:if(k.worldNormalNeedsUpdate){k.computeWorldNormal(U.quaternion)}var V=k.worldNormal;var W=T+c*.5-U.position.x,q=E+h*.5-U.position.y,X=M+f*.5-U.position.z;var Y=oe;Y.set(W,q,X);for(var Z=0,J=0;Z!==g;Z++,J+=b,Y.y=q,Y.x+=c){for(var K=0,Q=0;K!==y;K++,Q+=w,Y.z=X,Y.y+=h){for(var $=0,ee=0;$!==x;$++,ee+=_,Y.z+=f){if(Y.dot(V)<d){var te=J+Q+ee;L[te][I[te]++]=U}}}}break;default:if(U.aabbNeedsUpdate){U.computeAABB()}B(U.aabb.lowerBound.x,U.aabb.lowerBound.y,U.aabb.lowerBound.z,U.aabb.upperBound.x,U.aabb.upperBound.y,U.aabb.upperBound.z,U);break}}for(var N=0;N!==D;N++){var re=I[N];if(re>1){var ne=L[N];for(var Z=0;Z!==re;Z++){var U=ne[Z];for(var K=0;K!==Z;K++){var ie=ne[K];if(this.needBroadphaseCollision(U,ie)){this.intersectionTest(U,ie,t,r)}}}}}this.makePairsUnique(t,r)}},{"../math/Vec3":30,"../shapes/Shape":43,"./Broadphase":5}],7:[function(e,t,r){t.exports=a;var n=e("./Broadphase");var i=e("./AABB");function a(){n.apply(this)}a.prototype=new n;a.prototype.constructor=a;a.prototype.collisionPairs=function(e,t,r){var n=e.bodies,i=n.length,a,o,s,u;for(a=0;a!==i;a++){for(o=0;o!==a;o++){s=n[a];u=n[o];if(!this.needBroadphaseCollision(s,u)){continue}this.intersectionTest(s,u,t,r)}}};var o=new i;a.prototype.aabbQuery=function(e,t,r){r=r||[];for(var n=0;n<e.bodies.length;n++){var i=e.bodies[n];if(i.aabbNeedsUpdate){i.computeAABB()}if(i.aabb.overlaps(t)){r.push(i)}}return r}},{"./AABB":3,"./Broadphase":5}],8:[function(e,t,r){t.exports=n;function n(){this.matrix={}}n.prototype.get=function(e,t){e=e.id;t=t.id;if(t>e){var r=t;t=e;e=r}return e+"-"+t in this.matrix};n.prototype.set=function(e,t,r){e=e.id;t=t.id;if(t>e){var n=t;t=e;e=n}if(r){this.matrix[e+"-"+t]=true}else{delete this.matrix[e+"-"+t]}};n.prototype.reset=function(){this.matrix={}};n.prototype.setNumObjects=function(e){}},{}],9:[function(e,t,r){t.exports=b;var x=e("../math/Vec3");var n=e("../math/Quaternion");var I=e("../math/Transform");var i=e("../shapes/ConvexPolyhedron");var a=e("../shapes/Box");var o=e("../collision/RaycastResult");var s=e("../shapes/Shape");var u=e("../collision/AABB");function b(e,t){this.from=e?e.clone():new x;this.to=t?t.clone():new x;this._direction=new x;this.precision=1e-4;this.checkCollisionResponse=true;this.skipBackfaces=false;this.collisionFilterMask=-1;this.collisionFilterGroup=-1;this.mode=b.ANY;this.result=new o;this.hasHit=false;this.callback=function(e){}}b.prototype.constructor=b;b.CLOSEST=1;b.ANY=2;b.ALL=4;var l=new u;var c=[];b.prototype.intersectWorld=function(e,t){this.mode=t.mode||b.ANY;this.result=t.result||new o;this.skipBackfaces=!!t.skipBackfaces;this.collisionFilterMask=typeof t.collisionFilterMask!=="undefined"?t.collisionFilterMask:-1;this.collisionFilterGroup=typeof t.collisionFilterGroup!=="undefined"?t.collisionFilterGroup:-1;if(t.from){this.from.copy(t.from)}if(t.to){this.to.copy(t.to)}this.callback=t.callback||function(){};this.hasHit=false;this.result.reset();this._updateDirection();this.getAABB(l);c.length=0;e.broadphase.aabbQuery(e,l,c);this.intersectBodies(c);return this.hasHit};var h=new x,f=new x;b.pointInTriangle=D;function D(e,t,r,n){n.vsub(t,E);r.vsub(t,h);e.vsub(t,f);var i=E.dot(E);var a=E.dot(h);var o=E.dot(f);var s=h.dot(h);var u=h.dot(f);var l,c;return(l=s*o-a*u)>=0&&(c=i*u-a*o)>=0&&l+c<i*s-a*a}var d=new x;var p=new n;b.prototype.intersectBody=function(e,t){if(t){this.result=t;this._updateDirection()}var r=this.checkCollisionResponse;if(r&&!e.collisionResponse){return}if((this.collisionFilterGroup&e.collisionFilterMask)===0||(e.collisionFilterGroup&this.collisionFilterMask)===0){return}var n=d;var i=p;for(var a=0,o=e.shapes.length;a<o;a++){var s=e.shapes[a];if(r&&!s.collisionResponse){continue}e.quaternion.mult(e.shapeOrientations[a],i);e.quaternion.vmult(e.shapeOffsets[a],n);n.vadd(e.position,n);this.intersectShape(s,i,n,e);if(this.result._shouldStop){break}}};b.prototype.intersectBodies=function(e,t){if(t){this.result=t;this._updateDirection()}for(var r=0,n=e.length;!this.result._shouldStop&&r<n;r++){this.intersectBody(e[r])}};b.prototype._updateDirection=function(){this.to.vsub(this.from,this._direction);this._direction.normalize()};b.prototype.intersectShape=function(e,t,r,n){var i=this.from;var a=S(i,this._direction,r);if(a>e.boundingSphereRadius){return}var o=this[e.type];if(o){o.call(this,e,t,r,n)}};var v=new x;var m=new x;var N=new x;var F=new x;var B=new x;var U=new x;var g=new x;var y=new o;b.prototype.intersectBox=function(e,t,r,n){return this.intersectConvex(e.convexPolyhedronRepresentation,t,r,n)};b.prototype[s.types.BOX]=b.prototype.intersectBox;b.prototype.intersectPlane=function(e,t,r,n){var i=this.from;var a=this.to;var o=this._direction;var s=new x(0,0,1);t.vmult(s,s);var u=new x;i.vsub(r,u);var l=u.dot(s);a.vsub(r,u);var c=u.dot(s);if(l*c>0){return}if(i.distanceTo(a)<l){return}var h=s.dot(o);if(Math.abs(h)<this.precision){return}var f=new x;var d=new x;var p=new x;i.vsub(r,f);var v=-s.dot(f)/h;o.scale(v,d);i.vadd(d,p);this.reportIntersection(s,p,e,n,-1)};b.prototype[s.types.PLANE]=b.prototype.intersectPlane;b.prototype.getAABB=function(e){var t=this.to;var r=this.from;e.lowerBound.x=Math.min(t.x,r.x);e.lowerBound.y=Math.min(t.y,r.y);e.lowerBound.z=Math.min(t.z,r.z);e.upperBound.x=Math.max(t.x,r.x);e.upperBound.y=Math.max(t.y,r.y);e.upperBound.z=Math.max(t.z,r.z)};var w={faceList:[0]};b.prototype.intersectHeightfield=function(e,t,r,n){var i=e.data,a=e.elementSize,o=new x;var s=new b(this.from,this.to);I.pointToLocalFrame(r,t,s.from,s.from);I.pointToLocalFrame(r,t,s.to,s.to);var u=[];var l=null;var c=null;var h=null;var f=null;var d=e.getIndexOfPosition(s.from.x,s.from.y,u,false);if(d){l=u[0];c=u[1];h=u[0];f=u[1]}d=e.getIndexOfPosition(s.to.x,s.to.y,u,false);if(d){if(l===null||u[0]<l){l=u[0]}if(h===null||u[0]>h){h=u[0]}if(c===null||u[1]<c){c=u[1]}if(f===null||u[1]>f){f=u[1]}}if(l===null){return}var p=[];e.getRectMinMax(l,c,h,f,p);var v=p[0];var m=p[1];for(var g=l;g<=h;g++){for(var y=c;y<=f;y++){if(this.result._shouldStop){return}e.getConvexTrianglePillar(g,y,false);I.pointToWorldFrame(r,t,e.pillarOffset,o);this.intersectConvex(e.pillarConvex,t,o,n,w);if(this.result._shouldStop){return}e.getConvexTrianglePillar(g,y,true);I.pointToWorldFrame(r,t,e.pillarOffset,o);this.intersectConvex(e.pillarConvex,t,o,n,w)}}};b.prototype[s.types.HEIGHTFIELD]=b.prototype.intersectHeightfield;var _=new x;var T=new x;b.prototype.intersectSphere=function(e,t,r,n){var i=this.from,a=this.to,o=e.radius;var s=Math.pow(a.x-i.x,2)+Math.pow(a.y-i.y,2)+Math.pow(a.z-i.z,2);var u=2*((a.x-i.x)*(i.x-r.x)+(a.y-i.y)*(i.y-r.y)+(a.z-i.z)*(i.z-r.z));var l=Math.pow(i.x-r.x,2)+Math.pow(i.y-r.y,2)+Math.pow(i.z-r.z,2)-Math.pow(o,2);var c=Math.pow(u,2)-4*s*l;var h=_;var f=T;if(c<0){return}else if(c===0){i.lerp(a,c,h);h.vsub(r,f);f.normalize();this.reportIntersection(f,h,e,n,-1)}else{var d=(-u-Math.sqrt(c))/(2*s);var p=(-u+Math.sqrt(c))/(2*s);if(d>=0&&d<=1){i.lerp(a,d,h);h.vsub(r,f);f.normalize();this.reportIntersection(f,h,e,n,-1)}if(this.result._shouldStop){return}if(p>=0&&p<=1){i.lerp(a,p,h);h.vsub(r,f);f.normalize();this.reportIntersection(f,h,e,n,-1)}}};b.prototype[s.types.SPHERE]=b.prototype.intersectSphere;var O=new x;var k=new x;var j=new x;var z=new x;b.prototype.intersectConvex=function e(t,r,n,i,a){var o=k;var s=O;var u=z;var l=j;var c=a&&a.faceList||null;var h=t.faces,f=t.vertices,d=t.faceNormals;var p=this._direction;var v=this.from;var m=this.to;var g=v.distanceTo(m);var y=-1;var x=c?c.length:h.length;var b=this.result;for(var w=0;!b._shouldStop&&w<x;w++){var _=c?c[w]:w;var T=h[_];var E=d[_];var M=r;var S=n;u.copy(f[T[0]]);M.vmult(u,u);u.vadd(S,u);u.vsub(v,u);M.vmult(E,s);var A=p.dot(s);if(Math.abs(A)<this.precision){continue}var R=s.dot(u)/A;if(R<0){continue}p.mult(R,N);N.vadd(v,N);F.copy(f[T[0]]);M.vmult(F,F);S.vadd(F,F);for(var P=1;!b._shouldStop&&P<T.length-1;P++){B.copy(f[T[P]]);U.copy(f[T[P+1]]);M.vmult(B,B);M.vmult(U,U);S.vadd(B,B);S.vadd(U,U);var C=N.distanceTo(v);if(!(D(N,F,B,U)||D(N,B,F,U))||C>g){continue}this.reportIntersection(s,N,t,i,_)}}};b.prototype[s.types.CONVEXPOLYHEDRON]=b.prototype.intersectConvex;var H=new x;var G=new x;var V=new x;var W=new x;var q=new x;var X=new x;var Y=new u;var Z=[];var J=new I;b.prototype.intersectTrimesh=function e(t,r,n,i,a){var o=H;var s=Z;var u=J;var l=k;var c=z;var h=j;var f=Y;var d=G;var p=V;var v=W;var m=X;var g=q;var y=a&&a.faceList||null;var x=t.indices,b=t.vertices,w=t.faceNormals;var _=this.from;var T=this.to;var E=this._direction;var M=-1;u.position.copy(n);u.quaternion.copy(r);I.vectorToLocalFrame(n,r,E,d);I.pointToLocalFrame(n,r,_,p);I.pointToLocalFrame(n,r,T,v);var S=p.distanceSquared(v);t.tree.rayQuery(this,u,s);for(var A=0,R=s.length;!this.result._shouldStop&&A!==R;A++){var P=s[A];t.getNormal(P,o);t.getVertex(x[P*3],F);F.vsub(p,c);var C=d.dot(o);var O=o.dot(c)/C;if(O<0){continue}d.scale(O,N);N.vadd(p,N);t.getVertex(x[P*3+1],B);t.getVertex(x[P*3+2],U);var L=N.distanceSquared(p);if(!(D(N,B,F,U)||D(N,F,B,U))||L>S){continue}I.vectorToWorldFrame(r,o,g);I.pointToWorldFrame(n,r,N,m);this.reportIntersection(g,m,t,i,P)}s.length=0};b.prototype[s.types.TRIMESH]=b.prototype.intersectTrimesh;b.prototype.reportIntersection=function(e,t,r,n,i){var a=this.from;var o=this.to;var s=a.distanceTo(t);var u=this.result;if(this.skipBackfaces&&e.dot(this._direction)>0){return}u.hitFaceIndex=typeof i!=="undefined"?i:-1;switch(this.mode){case b.ALL:this.hasHit=true;u.set(a,o,e,t,r,n,s);u.hasHit=true;this.callback(u);break;case b.CLOSEST:if(s<u.distance||!u.hasHit){this.hasHit=true;u.hasHit=true;u.set(a,o,e,t,r,n,s)}break;case b.ANY:this.hasHit=true;u.hasHit=true;u.set(a,o,e,t,r,n,s);u._shouldStop=true;break}};var E=new x,M=new x;function S(e,t,r){r.vsub(e,E);var n=E.dot(t);t.mult(n,M);M.vadd(e,M);var i=r.distanceTo(M);return i}},{"../collision/AABB":3,"../collision/RaycastResult":10,"../math/Quaternion":28,"../math/Transform":29,"../math/Vec3":30,"../shapes/Box":37,"../shapes/ConvexPolyhedron":38,"../shapes/Shape":43}],10:[function(e,t,r){var n=e("../math/Vec3");t.exports=i;function i(){this.rayFromWorld=new n;this.rayToWorld=new n;this.hitNormalWorld=new n;this.hitPointWorld=new n;this.hasHit=false;this.shape=null;this.body=null;this.hitFaceIndex=-1;this.distance=-1;this._shouldStop=false}i.prototype.reset=function(){this.rayFromWorld.setZero();this.rayToWorld.setZero();this.hitNormalWorld.setZero();this.hitPointWorld.setZero();this.hasHit=false;this.shape=null;this.body=null;this.hitFaceIndex=-1;this.distance=-1;this._shouldStop=false};i.prototype.abort=function(){this._shouldStop=true};i.prototype.set=function(e,t,r,n,i,a,o){this.rayFromWorld.copy(e);this.rayToWorld.copy(t);this.hitNormalWorld.copy(r);this.hitPointWorld.copy(n);this.shape=i;this.body=a;this.distance=o}},{"../math/Vec3":30}],11:[function(e,t,r){var n=e("../shapes/Shape");var i=e("../collision/Broadphase");t.exports=c;function c(e){i.apply(this);this.axisList=[];this.world=null;this.axisIndex=0;var r=this.axisList;this._addBodyHandler=function(e){r.push(e.body)};this._removeBodyHandler=function(e){var t=r.indexOf(e.body);if(t!==-1){r.splice(t,1)}};if(e){this.setWorld(e)}}c.prototype=new i;c.prototype.setWorld=function(e){this.axisList.length=0;for(var t=0;t<e.bodies.length;t++){this.axisList.push(e.bodies[t])}e.removeEventListener("addBody",this._addBodyHandler);e.removeEventListener("removeBody",this._removeBodyHandler);e.addEventListener("addBody",this._addBodyHandler);e.addEventListener("removeBody",this._removeBodyHandler);this.world=e;this.dirty=true};c.insertionSortX=function(e){for(var t=1,r=e.length;t<r;t++){var n=e[t];for(var i=t-1;i>=0;i--){if(e[i].aabb.lowerBound.x<=n.aabb.lowerBound.x){break}e[i+1]=e[i]}e[i+1]=n}return e};c.insertionSortY=function(e){for(var t=1,r=e.length;t<r;t++){var n=e[t];for(var i=t-1;i>=0;i--){if(e[i].aabb.lowerBound.y<=n.aabb.lowerBound.y){break}e[i+1]=e[i]}e[i+1]=n}return e};c.insertionSortZ=function(e){for(var t=1,r=e.length;t<r;t++){var n=e[t];for(var i=t-1;i>=0;i--){if(e[i].aabb.lowerBound.z<=n.aabb.lowerBound.z){break}e[i+1]=e[i]}e[i+1]=n}return e};c.prototype.collisionPairs=function(e,t,r){var n=this.axisList,i=n.length,a=this.axisIndex,o,s;if(this.dirty){this.sortList();this.dirty=false}for(o=0;o!==i;o++){var u=n[o];for(s=o+1;s<i;s++){var l=n[s];if(!this.needBroadphaseCollision(u,l)){continue}if(!c.checkBounds(u,l,a)){break}this.intersectionTest(u,l,t,r)}}};c.prototype.sortList=function(){var e=this.axisList;var t=this.axisIndex;var r=e.length;for(var n=0;n!==r;n++){var i=e[n];if(i.aabbNeedsUpdate){i.computeAABB()}}if(t===0){c.insertionSortX(e)}else if(t===1){c.insertionSortY(e)}else if(t===2){c.insertionSortZ(e)}};c.checkBounds=function(e,t,r){var n;var i;if(r===0){n=e.position.x;i=t.position.x}else if(r===1){n=e.position.y;i=t.position.y}else if(r===2){n=e.position.z;i=t.position.z}var a=e.boundingRadius,o=t.boundingRadius,s=n-a,u=n+a,l=i-o,c=i+o;return l<u};c.prototype.autoDetectAxis=function(){var e=0,t=0,r=0,n=0,i=0,a=0,o=this.axisList,s=o.length,u=1/s;for(var l=0;l!==s;l++){var c=o[l];var h=c.position.x;e+=h;t+=h*h;var f=c.position.y;r+=f;n+=f*f;var d=c.position.z;i+=d;a+=d*d}var p=t-e*e*u,v=n-r*r*u,m=a-i*i*u;if(p>v){if(p>m){this.axisIndex=0}else{this.axisIndex=2}}else if(v>m){this.axisIndex=1}else{this.axisIndex=2}};c.prototype.aabbQuery=function(e,t,r){r=r||[];if(this.dirty){this.sortList();this.dirty=false}var n=this.axisIndex,i="x";if(n===1){i="y"}if(n===2){i="z"}var a=this.axisList;var o=t.lowerBound[i];var s=t.upperBound[i];for(var u=0;u<a.length;u++){var l=a[u];if(l.aabbNeedsUpdate){l.computeAABB()}if(l.aabb.overlaps(t)){r.push(l)}}return r}},{"../collision/Broadphase":5,"../shapes/Shape":43}],12:[function(e,t,r){t.exports=a;var n=e("./Constraint");var u=e("./PointToPointConstraint");var l=e("../equations/ConeEquation");var c=e("../equations/RotationalEquation");var i=e("../equations/ContactEquation");var h=e("../math/Vec3");function a(e,t,r){r=r||{};var n=typeof r.maxForce!=="undefined"?r.maxForce:1e6;var i=r.pivotA?r.pivotA.clone():new h;var a=r.pivotB?r.pivotB.clone():new h;this.axisA=r.axisA?r.axisA.clone():new h;this.axisB=r.axisB?r.axisB.clone():new h;u.call(this,e,i,t,a,n);this.collideConnected=!!r.collideConnected;this.angle=typeof r.angle!=="undefined"?r.angle:0;var o=this.coneEquation=new l(e,t,r);var s=this.twistEquation=new c(e,t,r);this.twistAngle=typeof r.twistAngle!=="undefined"?r.twistAngle:0;o.maxForce=0;o.minForce=-n;s.maxForce=0;s.minForce=-n;this.equations.push(o,s)}a.prototype=new u;a.constructor=a;var o=new h;var s=new h;a.prototype.update=function(){var e=this.bodyA,t=this.bodyB,r=this.coneEquation,n=this.twistEquation;u.prototype.update.call(this);e.vectorToWorldFrame(this.axisA,r.axisA);t.vectorToWorldFrame(this.axisB,r.axisB);this.axisA.tangents(n.axisA,n.axisA);e.vectorToWorldFrame(n.axisA,n.axisA);this.axisB.tangents(n.axisB,n.axisB);t.vectorToWorldFrame(n.axisB,n.axisB);r.angle=this.angle;n.maxAngle=this.twistAngle}},{"../equations/ConeEquation":18,"../equations/ContactEquation":19,"../equations/RotationalEquation":22,"../math/Vec3":30,"./Constraint":13,"./PointToPointConstraint":17}],13:[function(e,t,r){t.exports=i;var n=e("../utils/Utils");function i(e,t,r){r=n.defaults(r,{collideConnected:true,wakeUpBodies:true});this.equations=[];this.bodyA=e;this.bodyB=t;this.id=i.idCounter++;this.collideConnected=r.collideConnected;if(r.wakeUpBodies){if(e){e.wakeUp()}if(t){t.wakeUp()}}}i.prototype.update=function(){throw new Error("method update() not implmemented in this Constraint subclass!")};i.prototype.enable=function(){var e=this.equations;for(var t=0;t<e.length;t++){e[t].enabled=true}};i.prototype.disable=function(){var e=this.equations;for(var t=0;t<e.length;t++){e[t].enabled=false}};i.idCounter=0},{"../utils/Utils":53}],14:[function(e,t,r){t.exports=n;var a=e("./Constraint");var o=e("../equations/ContactEquation");function n(e,t,r,n){a.call(this,e,t);if(typeof r==="undefined"){r=e.position.distanceTo(t.position)}if(typeof n==="undefined"){n=1e6}this.distance=r;var i=this.distanceEquation=new o(e,t);this.equations.push(i);i.minForce=-n;i.maxForce=n}n.prototype=new a;n.prototype.update=function(){var e=this.bodyA;var t=this.bodyB;var r=this.distanceEquation;var n=this.distance*.5;var i=r.ni;t.position.vsub(e.position,i);i.normalize();i.mult(n,r.ri);i.mult(-n,r.rj)}},{"../equations/ContactEquation":19,"./Constraint":13}],15:[function(e,t,r){t.exports=a;var n=e("./Constraint");var h=e("./PointToPointConstraint");var f=e("../equations/RotationalEquation");var d=e("../equations/RotationalMotorEquation");var i=e("../equations/ContactEquation");var p=e("../math/Vec3");function a(e,t,r){r=r||{};var n=typeof r.maxForce!=="undefined"?r.maxForce:1e6;var i=r.pivotA?r.pivotA.clone():new p;var a=r.pivotB?r.pivotB.clone():new p;h.call(this,e,i,t,a,n);var o=this.axisA=r.axisA?r.axisA.clone():new p(1,0,0);o.normalize();var s=this.axisB=r.axisB?r.axisB.clone():new p(1,0,0);s.normalize();var u=this.rotationalEquation1=new f(e,t,r);var l=this.rotationalEquation2=new f(e,t,r);var c=this.motorEquation=new d(e,t,n);c.enabled=false;this.equations.push(u,l,c)}a.prototype=new h;a.constructor=a;a.prototype.enableMotor=function(){this.motorEquation.enabled=true};a.prototype.disableMotor=function(){this.motorEquation.enabled=false};a.prototype.setMotorSpeed=function(e){this.motorEquation.targetVelocity=e};a.prototype.setMotorMaxForce=function(e){this.motorEquation.maxForce=e;this.motorEquation.minForce=-e};var l=new p;var c=new p;a.prototype.update=function(){var e=this.bodyA,t=this.bodyB,r=this.motorEquation,n=this.rotationalEquation1,i=this.rotationalEquation2,a=l,o=c;var s=this.axisA;var u=this.axisB;h.prototype.update.call(this);e.quaternion.vmult(s,a);t.quaternion.vmult(u,o);a.tangents(n.axisA,i.axisA);n.axisB.copy(o);i.axisB.copy(o);if(this.motorEquation.enabled){e.quaternion.vmult(this.axisA,r.axisA);t.quaternion.vmult(this.axisB,r.axisB)}}},{"../equations/ContactEquation":19,"../equations/RotationalEquation":22,"../equations/RotationalMotorEquation":23,"../math/Vec3":30,"./Constraint":13,"./PointToPointConstraint":17}],16:[function(e,t,r){t.exports=o;var n=e("./Constraint");var c=e("./PointToPointConstraint");var h=e("../equations/RotationalEquation");var i=e("../equations/RotationalMotorEquation");var a=e("../equations/ContactEquation");var f=e("../math/Vec3");function o(e,t,r){r=r||{};var n=typeof r.maxForce!=="undefined"?r.maxForce:1e6;var i=new f;var a=new f;var o=new f;e.position.vadd(t.position,o);o.scale(.5,o);t.pointToLocalFrame(o,a);e.pointToLocalFrame(o,i);c.call(this,e,i,t,a,n);var s=this.rotationalEquation1=new h(e,t,r);var u=this.rotationalEquation2=new h(e,t,r);var l=this.rotationalEquation3=new h(e,t,r);this.equations.push(s,u,l)}o.prototype=new c;o.constructor=o;var u=new f;var l=new f;o.prototype.update=function(){var e=this.bodyA,t=this.bodyB,r=this.motorEquation,n=this.rotationalEquation1,i=this.rotationalEquation2,a=this.rotationalEquation3,o=u,s=l;c.prototype.update.call(this);e.vectorToWorldFrame(f.UNIT_X,n.axisA);t.vectorToWorldFrame(f.UNIT_Y,n.axisB);e.vectorToWorldFrame(f.UNIT_Y,i.axisA);t.vectorToWorldFrame(f.UNIT_Z,i.axisB);e.vectorToWorldFrame(f.UNIT_Z,a.axisA);t.vectorToWorldFrame(f.UNIT_X,a.axisB)}},{"../equations/ContactEquation":19,"../equations/RotationalEquation":22,"../equations/RotationalMotorEquation":23,"../math/Vec3":30,"./Constraint":13,"./PointToPointConstraint":17}],17:[function(e,t,r){t.exports=n;var u=e("./Constraint");var l=e("../equations/ContactEquation");var c=e("../math/Vec3");function n(e,t,r,n,i){u.call(this,e,r);i=typeof i!=="undefined"?i:1e6;this.pivotA=t?t.clone():new c;this.pivotB=n?n.clone():new c;var a=this.equationX=new l(e,r);var o=this.equationY=new l(e,r);var s=this.equationZ=new l(e,r);this.equations.push(a,o,s);a.minForce=o.minForce=s.minForce=-i;a.maxForce=o.maxForce=s.maxForce=i;a.ni.set(1,0,0);o.ni.set(0,1,0);s.ni.set(0,0,1)}n.prototype=new u;n.prototype.update=function(){var e=this.bodyA;var t=this.bodyB;var r=this.equationX;var n=this.equationY;var i=this.equationZ;e.quaternion.vmult(this.pivotA,r.ri);t.quaternion.vmult(this.pivotB,r.rj);n.ri.copy(r.ri);n.rj.copy(r.rj);i.ri.copy(r.ri);i.rj.copy(r.rj)}},{"../equations/ContactEquation":19,"../math/Vec3":30,"./Constraint":13}],18:[function(e,t,r){t.exports=o;var i=e("../math/Vec3");var n=e("../math/Mat3");var a=e("./Equation");function o(e,t,r){r=r||{};var n=typeof r.maxForce!=="undefined"?r.maxForce:1e6;a.call(this,e,t,-n,n);this.axisA=r.axisA?r.axisA.clone():new i(1,0,0);this.axisB=r.axisB?r.axisB.clone():new i(0,1,0);this.angle=typeof r.angle!=="undefined"?r.angle:0}o.prototype=new a;o.prototype.constructor=o;var d=new i;var p=new i;o.prototype.computeB=function(e){var t=this.a,r=this.b,n=this.axisA,i=this.axisB,a=d,o=p,s=this.jacobianElementA,u=this.jacobianElementB;n.cross(i,a);i.cross(n,o);s.rotational.copy(o);u.rotational.copy(a);var l=Math.cos(this.angle)-n.dot(i),c=this.computeGW(),h=this.computeGiMf();var f=-l*t-c*r-e*h;return f}},{"../math/Mat3":27,"../math/Vec3":30,"./Equation":20}],19:[function(e,t,r){t.exports=o;var n=e("./Equation");var i=e("../math/Vec3");var a=e("../math/Mat3");function o(e,t,r){r=typeof r!=="undefined"?r:1e6;n.call(this,e,t,0,r);this.restitution=0;this.ri=new i;this.rj=new i;this.ni=new i}o.prototype=new n;o.prototype.constructor=o;var S=new i;var A=new i;var R=new i;o.prototype.computeB=function(e){var t=this.a,r=this.b,n=this.bi,i=this.bj,a=this.ri,o=this.rj,s=S,u=A,l=n.velocity,c=n.angularVelocity,h=n.force,f=n.torque,d=i.velocity,p=i.angularVelocity,v=i.force,m=i.torque,g=R,y=this.jacobianElementA,x=this.jacobianElementB,b=this.ni;a.cross(b,s);o.cross(b,u);b.negate(y.spatial);s.negate(y.rotational);x.spatial.copy(b);x.rotational.copy(u);g.copy(i.position);g.vadd(o,g);g.vsub(n.position,g);g.vsub(a,g);var w=b.dot(g);var _=this.restitution+1;var T=_*d.dot(b)-_*l.dot(b)+p.dot(u)-c.dot(s);var E=this.computeGiMf();var M=-w*t-T*r-e*E;return M};var s=new i;var u=new i;var l=new i;var c=new i;var h=new i;o.prototype.getImpactVelocityAlongNormal=function(){var e=s;var t=u;var r=l;var n=c;var i=h;this.bi.position.vadd(this.ri,r);this.bj.position.vadd(this.rj,n);this.bi.getVelocityAtWorldPoint(r,e);this.bj.getVelocityAtWorldPoint(n,t);e.vsub(t,i);return this.ni.dot(i)}},{"../math/Mat3":27,"../math/Vec3":30,"./Equation":20}],20:[function(e,t,r){t.exports=a;var i=e("../math/JacobianElement"),n=e("../math/Vec3");function a(e,t,r,n){this.id=a.id++;this.minForce=typeof r==="undefined"?-1e6:r;this.maxForce=typeof n==="undefined"?1e6:n;this.bi=e;this.bj=t;this.a=0;this.b=0;this.eps=0;this.jacobianElementA=new i;this.jacobianElementB=new i;this.enabled=true;this.setSpookParams(1e7,4,1/60)}a.prototype.constructor=a;a.id=0;a.prototype.setSpookParams=function(e,t,r){var n=t,i=e,a=r;this.a=4/(a*(1+4*n));this.b=4*n/(1+4*n);this.eps=4/(a*a*i*(1+4*n))};a.prototype.computeB=function(e,t,r){var n=this.computeGW(),i=this.computeGq(),a=this.computeGiMf();return-i*e-n*t-a*r};a.prototype.computeGq=function(){var e=this.jacobianElementA,t=this.jacobianElementB,r=this.bi,n=this.bj,i=r.position,a=n.position;return e.spatial.dot(i)+t.spatial.dot(a)};var u=new n;a.prototype.computeGW=function(){var e=this.jacobianElementA,t=this.jacobianElementB,r=this.bi,n=this.bj,i=r.velocity,a=n.velocity,o=r.angularVelocity||u,s=n.angularVelocity||u;return e.multiplyVectors(i,o)+t.multiplyVectors(a,s)};a.prototype.computeGWlambda=function(){var e=this.jacobianElementA,t=this.jacobianElementB,r=this.bi,n=this.bj,i=r.vlambda,a=n.vlambda,o=r.wlambda||u,s=n.wlambda||u;return e.multiplyVectors(i,o)+t.multiplyVectors(a,s)};var c=new n,h=new n,f=new n,d=new n;a.prototype.computeGiMf=function(){var e=this.jacobianElementA,t=this.jacobianElementB,r=this.bi,n=this.bj,i=r.force,a=r.torque,o=n.force,s=n.torque,u=r.invMassSolve,l=n.invMassSolve;if(r.invInertiaWorldSolve){r.invInertiaWorldSolve.vmult(a,f)}else{f.set(0,0,0)}if(n.invInertiaWorldSolve){n.invInertiaWorldSolve.vmult(s,d)}else{d.set(0,0,0)}i.mult(u,c);o.mult(l,h);return e.multiplyVectors(c,f)+t.multiplyVectors(h,d)};var l=new n;a.prototype.computeGiMGt=function(){var e=this.jacobianElementA,t=this.jacobianElementB,r=this.bi,n=this.bj,i=r.invMassSolve,a=n.invMassSolve,o=r.invInertiaWorldSolve,s=n.invInertiaWorldSolve,u=i+a;if(o){o.vmult(e.rotational,l);u+=l.dot(e.rotational)}if(s){s.vmult(t.rotational,l);u+=l.dot(t.rotational)}return u};var o=new n,s=new n,p=new n,v=new n,m=new n,g=new n;a.prototype.addToWlambda=function(e){var t=this.jacobianElementA,r=this.jacobianElementB,n=this.bi,i=this.bj,a=o;t.spatial.mult(n.invMassSolve*e,a);n.vlambda.vadd(a,n.vlambda);r.spatial.mult(i.invMassSolve*e,a);i.vlambda.vadd(a,i.vlambda);if(n.invInertiaWorldSolve){n.invInertiaWorldSolve.vmult(t.rotational,a);a.mult(e,a);n.wlambda.vadd(a,n.wlambda)}if(i.invInertiaWorldSolve){i.invInertiaWorldSolve.vmult(r.rotational,a);a.mult(e,a);i.wlambda.vadd(a,i.wlambda)}};a.prototype.computeC=function(){return this.computeGiMGt()+this.eps}},{"../math/JacobianElement":26,"../math/Vec3":30}],21:[function(e,t,r){t.exports=o;var n=e("./Equation");var i=e("../math/Vec3");var a=e("../math/Mat3");function o(e,t,r){n.call(this,e,t,-r,r);this.ri=new i;this.rj=new i;this.t=new i}o.prototype=new n;o.prototype.constructor=o;var v=new i;var m=new i;o.prototype.computeB=function(e){var t=this.a,r=this.b,n=this.bi,i=this.bj,a=this.ri,o=this.rj,s=v,u=m,l=this.t;a.cross(l,s);o.cross(l,u);var c=this.jacobianElementA,h=this.jacobianElementB;l.negate(c.spatial);s.negate(c.rotational);h.spatial.copy(l);h.rotational.copy(u);var f=this.computeGW();var d=this.computeGiMf();var p=-f*r-e*d;return p}},{"../math/Mat3":27,"../math/Vec3":30,"./Equation":20}],22:[function(e,t,r){t.exports=o;var i=e("../math/Vec3");var n=e("../math/Mat3");var a=e("./Equation");function o(e,t,r){r=r||{};var n=typeof r.maxForce!=="undefined"?r.maxForce:1e6;a.call(this,e,t,-n,n);this.axisA=r.axisA?r.axisA.clone():new i(1,0,0);this.axisB=r.axisB?r.axisB.clone():new i(0,1,0);this.maxAngle=Math.PI/2}o.prototype=new a;o.prototype.constructor=o;var d=new i;var p=new i;o.prototype.computeB=function(e){var t=this.a,r=this.b,n=this.axisA,i=this.axisB,a=d,o=p,s=this.jacobianElementA,u=this.jacobianElementB;n.cross(i,a);i.cross(n,o);s.rotational.copy(o);u.rotational.copy(a);var l=Math.cos(this.maxAngle)-n.dot(i),c=this.computeGW(),h=this.computeGiMf();var f=-l*t-c*r-e*h;return f}},{"../math/Mat3":27,"../math/Vec3":30,"./Equation":20}],23:[function(e,t,r){t.exports=o;var n=e("../math/Vec3");var i=e("../math/Mat3");var a=e("./Equation");function o(e,t,r){r=typeof r!=="undefined"?r:1e6;a.call(this,e,t,-r,r);this.axisA=new n;this.axisB=new n;this.targetVelocity=0}o.prototype=new a;o.prototype.constructor=o;o.prototype.computeB=function(e){var t=this.a,r=this.b,n=this.bi,i=this.bj,a=this.axisA,o=this.axisB,s=this.jacobianElementA,u=this.jacobianElementB;s.rotational.copy(a);o.negate(u.rotational);var l=this.computeGW()-this.targetVelocity,c=this.computeGiMf();var h=-l*r-e*c;return h}},{"../math/Mat3":27,"../math/Vec3":30,"./Equation":20}],24:[function(e,t,r){var n=e("../utils/Utils");t.exports=i;function i(e,t,r){r=n.defaults(r,{friction:.3,restitution:.3,contactEquationStiffness:1e7,contactEquationRelaxation:3,frictionEquationStiffness:1e7,frictionEquationRelaxation:3});this.id=i.idCounter++;this.materials=[e,t];this.friction=r.friction;this.restitution=r.restitution;this.contactEquationStiffness=r.contactEquationStiffness;this.contactEquationRelaxation=r.contactEquationRelaxation;this.frictionEquationStiffness=r.frictionEquationStiffness;this.frictionEquationRelaxation=r.frictionEquationRelaxation}i.idCounter=0},{"../utils/Utils":53}],25:[function(e,t,r){t.exports=n;function n(e){var t="";e=e||{};if(typeof e==="string"){t=e;e={}}else if(typeof e==="object"){t=""}this.name=t;this.id=n.idCounter++;this.friction=typeof e.friction!=="undefined"?e.friction:-1;this.restitution=typeof e.restitution!=="undefined"?e.restitution:-1}n.idCounter=0},{}],26:[function(e,t,r){t.exports=i;var n=e("./Vec3");function i(){this.spatial=new n;this.rotational=new n}i.prototype.multiplyElement=function(e){return e.spatial.dot(this.spatial)+e.rotational.dot(this.rotational)};i.prototype.multiplyVectors=function(e,t){return e.dot(this.spatial)+t.dot(this.rotational)}},{"./Vec3":30}],27:[function(e,t,r){t.exports=f;var p=e("./Vec3");function f(e){if(e){this.elements=e}else{this.elements=[0,0,0,0,0,0,0,0,0]}}f.prototype.identity=function(){var e=this.elements;e[0]=1;e[1]=0;e[2]=0;e[3]=0;e[4]=1;e[5]=0;e[6]=0;e[7]=0;e[8]=1};f.prototype.setZero=function(){var e=this.elements;e[0]=0;e[1]=0;e[2]=0;e[3]=0;e[4]=0;e[5]=0;e[6]=0;e[7]=0;e[8]=0};f.prototype.setTrace=function(e){var t=this.elements;t[0]=e.x;t[4]=e.y;t[8]=e.z};f.prototype.getTrace=function(e){var e=e||new p;var t=this.elements;e.x=t[0];e.y=t[4];e.z=t[8]};f.prototype.vmult=function(e,t){t=t||new p;var r=this.elements,n=e.x,i=e.y,a=e.z;t.x=r[0]*n+r[1]*i+r[2]*a;t.y=r[3]*n+r[4]*i+r[5]*a;t.z=r[6]*n+r[7]*i+r[8]*a;return t};f.prototype.smult=function(e){for(var t=0;t<this.elements.length;t++){this.elements[t]*=e}};f.prototype.mmult=function(e,t){var r=t||new f;for(var n=0;n<3;n++){for(var i=0;i<3;i++){var a=0;for(var o=0;o<3;o++){a+=e.elements[n+o*3]*this.elements[o+i*3]}r.elements[n+i*3]=a}}return r};f.prototype.scale=function(e,t){t=t||new f;var r=this.elements,n=t.elements;for(var i=0;i!==3;i++){n[3*i+0]=e.x*r[3*i+0];n[3*i+1]=e.y*r[3*i+1];n[3*i+2]=e.z*r[3*i+2]}return t};f.prototype.solve=function(e,t){t=t||new p;var r=3;var n=4;var i=[];for(var a=0;a<r*n;a++){i.push(0)}var a,o;for(a=0;a<3;a++){for(o=0;o<3;o++){i[a+n*o]=this.elements[a+3*o]}}i[3+4*0]=e.x;i[3+4*1]=e.y;i[3+4*2]=e.z;var s=3,u=s,l;var c=4;var h,f;do{a=u-s;if(i[a+n*a]===0){for(o=a+1;o<u;o++){if(i[a+n*o]!==0){l=c;do{h=c-l;i[h+n*a]+=i[h+n*o]}while(--l);break}}}if(i[a+n*a]!==0){for(o=a+1;o<u;o++){var d=i[a+n*o]/i[a+n*a];l=c;do{h=c-l;i[h+n*o]=h<=a?0:i[h+n*o]-i[h+n*a]*d}while(--l)}}}while(--s);t.z=i[2*n+3]/i[2*n+2];t.y=(i[1*n+3]-i[1*n+2]*t.z)/i[1*n+1];t.x=(i[0*n+3]-i[0*n+2]*t.z-i[0*n+1]*t.y)/i[0*n+0];if(isNaN(t.x)||isNaN(t.y)||isNaN(t.z)||t.x===Infinity||t.y===Infinity||t.z===Infinity){throw"Could not solve equation! Got x=["+t.toString()+"], b=["+e.toString()+"], A=["+this.toString()+"]"}return t};f.prototype.e=function(e,t,r){if(r===undefined){return this.elements[t+3*e]}else{this.elements[t+3*e]=r}};f.prototype.copy=function(e){for(var t=0;t<e.elements.length;t++){this.elements[t]=e.elements[t]}return this};f.prototype.toString=function(){var e="";var t=",";for(var r=0;r<9;r++){e+=this.elements[r]+t}return e};f.prototype.reverse=function(e){e=e||new f;var t=3;var r=6;var n=[];for(var i=0;i<t*r;i++){n.push(0)}var i,a;for(i=0;i<3;i++){for(a=0;a<3;a++){n[i+r*a]=this.elements[i+3*a]}}n[3+6*0]=1;n[3+6*1]=0;n[3+6*2]=0;n[4+6*0]=0;n[4+6*1]=1;n[4+6*2]=0;n[5+6*0]=0;n[5+6*1]=0;n[5+6*2]=1;var o=3,s=o,u;var l=r;var c;do{i=s-o;if(n[i+r*i]===0){for(a=i+1;a<s;a++){if(n[i+r*a]!==0){u=l;do{c=l-u;n[c+r*i]+=n[c+r*a]}while(--u);break}}}if(n[i+r*i]!==0){for(a=i+1;a<s;a++){var h=n[i+r*a]/n[i+r*i];u=l;do{c=l-u;n[c+r*a]=c<=i?0:n[c+r*a]-n[c+r*i]*h}while(--u)}}}while(--o);i=2;do{a=i-1;do{var h=n[i+r*a]/n[i+r*i];u=r;do{c=r-u;n[c+r*a]=n[c+r*a]-n[c+r*i]*h}while(--u)}while(a--)}while(--i);i=2;do{var h=1/n[i+r*i];u=r;do{c=r-u;n[c+r*i]=n[c+r*i]*h}while(--u)}while(i--);i=2;do{a=2;do{c=n[t+a+r*i];if(isNaN(c)||c===Infinity){throw"Could not reverse! A=["+this.toString()+"]"}e.e(i,a,c)}while(a--)}while(i--);return e};f.prototype.setRotationFromQuaternion=function(e){var t=e.x,r=e.y,n=e.z,i=e.w,a=t+t,o=r+r,s=n+n,u=t*a,l=t*o,c=t*s,h=r*o,f=r*s,d=n*s,p=i*a,v=i*o,m=i*s,g=this.elements;g[3*0+0]=1-(h+d);g[3*0+1]=l-m;g[3*0+2]=c+v;g[3*1+0]=l+m;g[3*1+1]=1-(u+d);g[3*1+2]=f-p;g[3*2+0]=c-v;g[3*2+1]=f+p;g[3*2+2]=1-(u+h);return this};f.prototype.transpose=function(e){e=e||new f;var t=e.elements,r=this.elements;for(var n=0;n!==3;n++){for(var i=0;i!==3;i++){t[3*n+i]=r[3*i+n]}}return e}},{"./Vec3":30}],28:[function(e,t,r){t.exports=o;var d=e("./Vec3");function o(e,t,r,n){this.x=e!==undefined?e:0;this.y=t!==undefined?t:0;this.z=r!==undefined?r:0;this.w=n!==undefined?n:1}o.prototype.set=function(e,t,r,n){this.x=e;this.y=t;this.z=r;this.w=n};o.prototype.toString=function(){return this.x+","+this.y+","+this.z+","+this.w};o.prototype.toArray=function(){return[this.x,this.y,this.z,this.w]};o.prototype.setFromAxisAngle=function(e,t){var r=Math.sin(t*.5);this.x=e.x*r;this.y=e.y*r;this.z=e.z*r;this.w=Math.cos(t*.5)};o.prototype.toAxisAngle=function(e){e=e||new d;this.normalize();var t=2*Math.acos(this.w);var r=Math.sqrt(1-this.w*this.w);if(r<.001){e.x=this.x;e.y=this.y;e.z=this.z}else{e.x=this.x/r;e.y=this.y/r;e.z=this.z/r}return[e,t]};var a=new d,s=new d;o.prototype.setFromVectors=function(e,t){if(e.isAntiparallelTo(t)){var r=a;var n=s;e.tangents(r,n);this.setFromAxisAngle(r,Math.PI)}else{var i=e.cross(t);this.x=i.x;this.y=i.y;this.z=i.z;this.w=Math.sqrt(Math.pow(e.norm(),2)*Math.pow(t.norm(),2))+e.dot(t);this.normalize()}};var u=new d;var l=new d;var c=new d;o.prototype.mult=function(e,t){t=t||new o;var r=this.w,n=u,i=l,a=c;n.set(this.x,this.y,this.z);i.set(e.x,e.y,e.z);t.w=r*e.w-n.dot(i);n.cross(i,a);t.x=r*i.x+e.w*n.x+a.x;t.y=r*i.y+e.w*n.y+a.y;t.z=r*i.z+e.w*n.z+a.z;return t};o.prototype.inverse=function(e){var t=this.x,r=this.y,n=this.z,i=this.w;e=e||new o;this.conjugate(e);var a=1/(t*t+r*r+n*n+i*i);e.x*=a;e.y*=a;e.z*=a;e.w*=a;return e};o.prototype.conjugate=function(e){e=e||new o;e.x=-this.x;e.y=-this.y;e.z=-this.z;e.w=this.w;return e};o.prototype.normalize=function(){var e=Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w);if(e===0){this.x=0;this.y=0;this.z=0;this.w=0}else{e=1/e;this.x*=e;this.y*=e;this.z*=e;this.w*=e}};o.prototype.normalizeFast=function(){var e=(3-(this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w))/2;if(e===0){this.x=0;this.y=0;this.z=0;this.w=0}else{this.x*=e;this.y*=e;this.z*=e;this.w*=e}};o.prototype.vmult=function(e,t){t=t||new d;var r=e.x,n=e.y,i=e.z;var a=this.x,o=this.y,s=this.z,u=this.w;var l=u*r+o*i-s*n,c=u*n+s*r-a*i,h=u*i+a*n-o*r,f=-a*r-o*n-s*i;t.x=l*u+f*-a+c*-s-h*-o;t.y=c*u+f*-o+h*-a-l*-s;t.z=h*u+f*-s+l*-o-c*-a;return t};o.prototype.copy=function(e){this.x=e.x;this.y=e.y;this.z=e.z;this.w=e.w;return this};o.prototype.toEuler=function(e,t){t=t||"YZX";var r,n,i;var a=this.x,o=this.y,s=this.z,u=this.w;switch(t){case"YZX":var l=a*o+s*u;if(l>.499){r=2*Math.atan2(a,u);n=Math.PI/2;i=0}if(l<-.499){r=-2*Math.atan2(a,u);n=-Math.PI/2;i=0}if(isNaN(r)){var c=a*a;var h=o*o;var f=s*s;r=Math.atan2(2*o*u-2*a*s,1-2*h-2*f);n=Math.asin(2*l);i=Math.atan2(2*a*u-2*o*s,1-2*c-2*f)}break;default:throw new Error("Euler order "+t+" not supported yet.")}e.y=r;e.z=n;e.x=i};o.prototype.setFromEuler=function(e,t,r,n){n=n||"XYZ";var i=Math.cos(e/2);var a=Math.cos(t/2);var o=Math.cos(r/2);var s=Math.sin(e/2);var u=Math.sin(t/2);var l=Math.sin(r/2);if(n==="XYZ"){this.x=s*a*o+i*u*l;this.y=i*u*o-s*a*l;this.z=i*a*l+s*u*o;this.w=i*a*o-s*u*l}else if(n==="YXZ"){this.x=s*a*o+i*u*l;this.y=i*u*o-s*a*l;this.z=i*a*l-s*u*o;this.w=i*a*o+s*u*l}else if(n==="ZXY"){this.x=s*a*o-i*u*l;this.y=i*u*o+s*a*l;this.z=i*a*l+s*u*o;this.w=i*a*o-s*u*l}else if(n==="ZYX"){this.x=s*a*o-i*u*l;this.y=i*u*o+s*a*l;this.z=i*a*l-s*u*o;this.w=i*a*o+s*u*l}else if(n==="YZX"){this.x=s*a*o+i*u*l;this.y=i*u*o+s*a*l;this.z=i*a*l-s*u*o;this.w=i*a*o-s*u*l}else if(n==="XZY"){this.x=s*a*o-i*u*l;this.y=i*u*o-s*a*l;this.z=i*a*l+s*u*o;this.w=i*a*o+s*u*l}return this};o.prototype.clone=function(){return new o(this.x,this.y,this.z,this.w)}},{"./Vec3":30}],29:[function(e,t,r){var i=e("./Vec3");var n=e("./Quaternion");t.exports=a;function a(e){e=e||{};this.position=new i;if(e.position){this.position.copy(e.position)}this.quaternion=new n;if(e.quaternion){this.quaternion.copy(e.quaternion)}}var o=new n;a.pointToLocalFrame=function(e,t,r,n){var n=n||new i;r.vsub(e,n);t.conjugate(o);o.vmult(n,n);return n};a.prototype.pointToLocal=function(e,t){return a.pointToLocalFrame(this.position,this.quaternion,e,t)};a.pointToWorldFrame=function(e,t,r,n){var n=n||new i;t.vmult(r,n);n.vadd(e,n);return n};a.prototype.pointToWorld=function(e,t){return a.pointToWorldFrame(this.position,this.quaternion,e,t)};a.prototype.vectorToWorldFrame=function(e,t){var t=t||new i;this.quaternion.vmult(e,t);return t};a.vectorToWorldFrame=function(e,t,r){e.vmult(t,r);return r};a.vectorToLocalFrame=function(e,t,r,n){var n=n||new i;t.w*=-1;t.vmult(r,n);t.w*=-1;return n}},{"./Quaternion":28,"./Vec3":30}],30:[function(e,t,r){t.exports=u;var n=e("./Mat3");function u(e,t,r){this.x=e||0;this.y=t||0;this.z=r||0}u.ZERO=new u(0,0,0);u.UNIT_X=new u(1,0,0);u.UNIT_Y=new u(0,1,0);u.UNIT_Z=new u(0,0,1);u.prototype.cross=function(e,t){var r=e.x,n=e.y,i=e.z,a=this.x,o=this.y,s=this.z;t=t||new u;t.x=o*i-s*n;t.y=s*r-a*i;t.z=a*n-o*r;return t};u.prototype.set=function(e,t,r){this.x=e;this.y=t;this.z=r;return this};u.prototype.setZero=function(){this.x=this.y=this.z=0};u.prototype.vadd=function(e,t){if(t){t.x=e.x+this.x;t.y=e.y+this.y;t.z=e.z+this.z}else{return new u(this.x+e.x,this.y+e.y,this.z+e.z)}};u.prototype.vsub=function(e,t){if(t){t.x=this.x-e.x;t.y=this.y-e.y;t.z=this.z-e.z}else{return new u(this.x-e.x,this.y-e.y,this.z-e.z)}};u.prototype.crossmat=function(){return new n([0,-this.z,this.y,this.z,0,-this.x,-this.y,this.x,0])};u.prototype.normalize=function(){var e=this.x,t=this.y,r=this.z;var n=Math.sqrt(e*e+t*t+r*r);if(n>0){var i=1/n;this.x*=i;this.y*=i;this.z*=i}else{this.x=0;this.y=0;this.z=0}return n};u.prototype.unit=function(e){e=e||new u;var t=this.x,r=this.y,n=this.z;var i=Math.sqrt(t*t+r*r+n*n);if(i>0){i=1/i;e.x=t*i;e.y=r*i;e.z=n*i}else{e.x=1;e.y=0;e.z=0}return e};u.prototype.norm=function(){var e=this.x,t=this.y,r=this.z;return Math.sqrt(e*e+t*t+r*r)};u.prototype.length=u.prototype.norm;u.prototype.norm2=function(){return this.dot(this)};u.prototype.lengthSquared=u.prototype.norm2;u.prototype.distanceTo=function(e){var t=this.x,r=this.y,n=this.z;var i=e.x,a=e.y,o=e.z;return Math.sqrt((i-t)*(i-t)+(a-r)*(a-r)+(o-n)*(o-n))};u.prototype.distanceSquared=function(e){var t=this.x,r=this.y,n=this.z;var i=e.x,a=e.y,o=e.z;return(i-t)*(i-t)+(a-r)*(a-r)+(o-n)*(o-n)};u.prototype.mult=function(e,t){t=t||new u;var r=this.x,n=this.y,i=this.z;t.x=e*r;t.y=e*n;t.z=e*i;return t};u.prototype.scale=u.prototype.mult;u.prototype.dot=function(e){return this.x*e.x+this.y*e.y+this.z*e.z};u.prototype.isZero=function(){return this.x===0&&this.y===0&&this.z===0};u.prototype.negate=function(e){e=e||new u;e.x=-this.x;e.y=-this.y;e.z=-this.z;return e};var o=new u;var s=new u;u.prototype.tangents=function(e,t){var r=this.norm();if(r>0){var n=o;var i=1/r;n.set(this.x*i,this.y*i,this.z*i);var a=s;if(Math.abs(n.x)<.9){a.set(1,0,0);n.cross(a,e)}else{a.set(0,1,0);n.cross(a,e)}n.cross(e,t)}else{e.set(1,0,0);t.set(0,1,0)}};u.prototype.toString=function(){return this.x+","+this.y+","+this.z};u.prototype.toArray=function(){return[this.x,this.y,this.z]};u.prototype.copy=function(e){this.x=e.x;this.y=e.y;this.z=e.z;return this};u.prototype.lerp=function(e,t,r){var n=this.x,i=this.y,a=this.z;r.x=n+(e.x-n)*t;r.y=i+(e.y-i)*t;r.z=a+(e.z-a)*t};u.prototype.almostEquals=function(e,t){if(t===undefined){t=1e-6}if(Math.abs(this.x-e.x)>t||Math.abs(this.y-e.y)>t||Math.abs(this.z-e.z)>t){return false}return true};u.prototype.almostZero=function(e){if(e===undefined){e=1e-6}if(Math.abs(this.x)>e||Math.abs(this.y)>e||Math.abs(this.z)>e){return false}return true};var i=new u;u.prototype.isAntiparallelTo=function(e,t){this.negate(i);return i.almostEquals(e,t)};u.prototype.clone=function(){return new u(this.x,this.y,this.z)}},{"./Mat3":27}],31:[function(e,t,r){t.exports=h;var n=e("../utils/EventTarget");var i=e("../shapes/Shape");var a=e("../math/Vec3");var o=e("../math/Mat3");var s=e("../math/Quaternion");var u=e("../material/Material");var l=e("../collision/AABB");var c=e("../shapes/Box");function h(e){e=e||{};n.apply(this);this.id=h.idCounter++;this.world=null;this.preStep=null;this.postStep=null;this.vlambda=new a;this.collisionFilterGroup=typeof e.collisionFilterGroup==="number"?e.collisionFilterGroup:1;this.collisionFilterMask=typeof e.collisionFilterMask==="number"?e.collisionFilterMask:1;this.collisionResponse=true;this.position=new a;if(e.position){this.position.copy(e.position)}this.previousPosition=new a;this.initPosition=new a;this.velocity=new a;if(e.velocity){this.velocity.copy(e.velocity)}this.initVelocity=new a;this.force=new a;var t=typeof e.mass==="number"?e.mass:0;this.mass=t;this.invMass=t>0?1/t:0;this.material=e.material||null;this.linearDamping=typeof e.linearDamping==="number"?e.linearDamping:.01;this.type=t<=0?h.STATIC:h.DYNAMIC;if(typeof e.type===typeof h.STATIC){this.type=e.type}this.allowSleep=typeof e.allowSleep!=="undefined"?e.allowSleep:true;this.sleepState=0;this.sleepSpeedLimit=typeof e.sleepSpeedLimit!=="undefined"?e.sleepSpeedLimit:.1;this.sleepTimeLimit=typeof e.sleepTimeLimit!=="undefined"?e.sleepTimeLimit:1;this.timeLastSleepy=0;this._wakeUpAfterNarrowphase=false;this.torque=new a;this.quaternion=new s;if(e.quaternion){this.quaternion.copy(e.quaternion)}this.initQuaternion=new s;this.angularVelocity=new a;if(e.angularVelocity){this.angularVelocity.copy(e.angularVelocity)}this.initAngularVelocity=new a;this.interpolatedPosition=new a;this.interpolatedQuaternion=new s;this.shapes=[];this.shapeOffsets=[];this.shapeOrientations=[];this.inertia=new a;this.invInertia=new a;this.invInertiaWorld=new o;this.invMassSolve=0;this.invInertiaSolve=new a;this.invInertiaWorldSolve=new o;this.fixedRotation=typeof e.fixedRotation!=="undefined"?e.fixedRotation:false;this.angularDamping=typeof e.angularDamping!=="undefined"?e.angularDamping:.01;this.aabb=new l;this.aabbNeedsUpdate=true;this.wlambda=new a;if(e.shape){this.addShape(e.shape)}this.updateMassProperties()}h.prototype=new n;h.prototype.constructor=h;h.DYNAMIC=1;h.STATIC=2;h.KINEMATIC=4;h.AWAKE=0;h.SLEEPY=1;h.SLEEPING=2;h.idCounter=0;h.prototype.wakeUp=function(){var e=this.sleepState;this.sleepState=0;if(e===h.SLEEPING){this.dispatchEvent({type:"wakeup"})}};h.prototype.sleep=function(){this.sleepState=h.SLEEPING;this.velocity.set(0,0,0);this.angularVelocity.set(0,0,0)};h.sleepyEvent={type:"sleepy"};h.sleepEvent={type:"sleep"};h.prototype.sleepTick=function(e){if(this.allowSleep){var t=this.sleepState;var r=this.velocity.norm2()+this.angularVelocity.norm2();var n=Math.pow(this.sleepSpeedLimit,2);if(t===h.AWAKE&&r<n){this.sleepState=h.SLEEPY;this.timeLastSleepy=e;this.dispatchEvent(h.sleepyEvent)}else if(t===h.SLEEPY&&r>n){this.wakeUp()}else if(t===h.SLEEPY&&e-this.timeLastSleepy>this.sleepTimeLimit){this.sleep();this.dispatchEvent(h.sleepEvent)}}};h.prototype.updateSolveMassProperties=function(){if(this.sleepState===h.SLEEPING||this.type===h.KINEMATIC){this.invMassSolve=0;this.invInertiaSolve.setZero();this.invInertiaWorldSolve.setZero()}else{this.invMassSolve=this.invMass;this.invInertiaSolve.copy(this.invInertia);this.invInertiaWorldSolve.copy(this.invInertiaWorld)}};h.prototype.pointToLocalFrame=function(e,t){var t=t||new a;e.vsub(this.position,t);this.quaternion.conjugate().vmult(t,t);return t};h.prototype.vectorToLocalFrame=function(e,t){var t=t||new a;this.quaternion.conjugate().vmult(e,t);return t};h.prototype.pointToWorldFrame=function(e,t){var t=t||new a;this.quaternion.vmult(e,t);t.vadd(this.position,t);return t};h.prototype.vectorToWorldFrame=function(e,t){var t=t||new a;this.quaternion.vmult(e,t);return t};var f=new a;var d=new s;h.prototype.addShape=function(e,t,r){var n=new a;var i=new s;if(t){n.copy(t)}if(r){i.copy(r)}this.shapes.push(e);this.shapeOffsets.push(n);this.shapeOrientations.push(i);this.updateMassProperties();this.updateBoundingRadius();this.aabbNeedsUpdate=true;return this};h.prototype.updateBoundingRadius=function(){var e=this.shapes,t=this.shapeOffsets,r=e.length,n=0;for(var i=0;i!==r;i++){var a=e[i];a.updateBoundingSphereRadius();var o=t[i].norm(),s=a.boundingSphereRadius;if(o+s>n){n=o+s}}this.boundingRadius=n};var p=new l;h.prototype.computeAABB=function(){var e=this.shapes,t=this.shapeOffsets,r=this.shapeOrientations,n=e.length,i=f,a=d,o=this.quaternion,s=this.aabb,u=p;for(var l=0;l!==n;l++){var c=e[l];r[l].mult(o,a);a.vmult(t[l],i);i.vadd(this.position,i);c.calculateWorldAABB(i,a,u.lowerBound,u.upperBound);if(l===0){s.copy(u)}else{s.extend(u)}}this.aabbNeedsUpdate=false};var v=new o,m=new o,g=new o;h.prototype.updateInertiaWorld=function(e){var t=this.invInertia;if(t.x===t.y&&t.y===t.z&&!e){}else{var r=v,n=m,i=g;r.setRotationFromQuaternion(this.quaternion);r.transpose(n);r.scale(t,r);r.mmult(n,this.invInertiaWorld)}};var y=new a;var x=new a;h.prototype.applyForce=function(e,t){if(this.type!==h.DYNAMIC){return}var r=y;t.vsub(this.position,r);var n=x;r.cross(e,n);this.force.vadd(e,this.force);this.torque.vadd(n,this.torque)};var b=new a;var w=new a;h.prototype.applyLocalForce=function(e,t){if(this.type!==h.DYNAMIC){return}var r=b;var n=w;this.vectorToWorldFrame(e,r);this.pointToWorldFrame(t,n);this.applyForce(r,n)};var _=new a;var T=new a;var E=new a;h.prototype.applyImpulse=function(e,t){if(this.type!==h.DYNAMIC){return}var r=_;t.vsub(this.position,r);var n=T;n.copy(e);n.mult(this.invMass,n);this.velocity.vadd(n,this.velocity);var i=E;r.cross(e,i);this.invInertiaWorld.vmult(i,i);this.angularVelocity.vadd(i,this.angularVelocity)};var M=new a;var S=new a;h.prototype.applyLocalImpulse=function(e,t){if(this.type!==h.DYNAMIC){return}var r=M;var n=S;this.vectorToWorldFrame(e,r);this.pointToWorldFrame(t,n);this.applyImpulse(r,n)};var A=new a;h.prototype.updateMassProperties=function(){var e=A;this.invMass=this.mass>0?1/this.mass:0;var t=this.inertia;var r=this.fixedRotation;this.computeAABB();e.set((this.aabb.upperBound.x-this.aabb.lowerBound.x)/2,(this.aabb.upperBound.y-this.aabb.lowerBound.y)/2,(this.aabb.upperBound.z-this.aabb.lowerBound.z)/2);c.calculateInertia(e,this.mass,t);this.invInertia.set(t.x>0&&!r?1/t.x:0,t.y>0&&!r?1/t.y:0,t.z>0&&!r?1/t.z:0);this.updateInertiaWorld(true)};h.prototype.getVelocityAtWorldPoint=function(e,t){var r=new a;e.vsub(this.position,r);this.angularVelocity.cross(r,t);this.velocity.vadd(t,t);return t}},{"../collision/AABB":3,"../material/Material":25,"../math/Mat3":27,"../math/Quaternion":28,"../math/Vec3":30,"../shapes/Box":37,"../shapes/Shape":43,"../utils/EventTarget":49}],32:[function(e,t,r){var n=e("./Body");var O=e("../math/Vec3");var c=e("../math/Quaternion");var i=e("../collision/RaycastResult");var a=e("../collision/Ray");var o=e("../objects/WheelInfo");t.exports=s;function s(e){this.chassisBody=e.chassisBody;this.wheelInfos=[];this.sliding=false;this.world=null;this.indexRightAxis=typeof e.indexRightAxis!=="undefined"?e.indexRightAxis:1;this.indexForwardAxis=typeof e.indexForwardAxis!=="undefined"?e.indexForwardAxis:0;this.indexUpAxis=typeof e.indexUpAxis!=="undefined"?e.indexUpAxis:2}var u=new O;var l=new O;var h=new O;var f=new O;var d=new O;var p=new O;var v=new a;s.prototype.addWheel=function(e){e=e||{};var t=new o(e);var r=this.wheelInfos.length;this.wheelInfos.push(t);return r};s.prototype.setSteeringValue=function(e,t){var r=this.wheelInfos[t];r.steering=e};var m=new O;s.prototype.applyEngineForce=function(e,t){this.wheelInfos[t].engineForce=e};s.prototype.setBrake=function(e,t){this.wheelInfos[t].brake=e};s.prototype.addToWorld=function(e){var t=this.constraints;e.add(this.chassisBody);var r=this;this.preStepCallback=function(){r.updateVehicle(e.dt)};e.addEventListener("preStep",this.preStepCallback);this.world=e};s.prototype.getVehicleAxisWorld=function(e,t){t.set(e===0?1:0,e===1?1:0,e===2?1:0);this.chassisBody.vectorToWorldFrame(t,t)};s.prototype.updateVehicle=function(e){var t=this.wheelInfos;var r=t.length;var n=this.chassisBody;for(var i=0;i<r;i++){this.updateWheelTransform(i)}this.currentVehicleSpeedKmHour=3.6*n.velocity.norm();var a=new O;this.getVehicleAxisWorld(this.indexForwardAxis,a);if(a.dot(n.velocity)<0){this.currentVehicleSpeedKmHour*=-1}for(var i=0;i<r;i++){this.castRay(t[i])}this.updateSuspension(e);var o=new O;var s=new O;for(var i=0;i<r;i++){var u=t[i];var l=u.suspensionForce;if(l>u.maxSuspensionForce){l=u.maxSuspensionForce}u.raycastResult.hitNormalWorld.scale(l*e,o);u.raycastResult.hitPointWorld.vsub(n.position,s);n.applyImpulse(o,u.raycastResult.hitPointWorld)}this.updateFriction(e);var c=new O;var h=new O;var f=new O;for(i=0;i<r;i++){var u=t[i];n.getVelocityAtWorldPoint(u.chassisConnectionPointWorld,f);var d=1;switch(this.indexUpAxis){case 1:d=-1;break}if(u.isInContact){this.getVehicleAxisWorld(this.indexForwardAxis,h);var p=h.dot(u.raycastResult.hitNormalWorld);u.raycastResult.hitNormalWorld.scale(p,c);h.vsub(c,h);var v=h.dot(f);u.deltaRotation=d*v*e/u.radius}if((u.sliding||!u.isInContact)&&u.engineForce!==0&&u.useCustomSlidingRotationalSpeed){u.deltaRotation=(u.engineForce>0?1:-1)*u.customSlidingRotationalSpeed*e}if(Math.abs(u.brake)>Math.abs(u.engineForce)){u.deltaRotation=0}u.rotation+=u.deltaRotation;u.deltaRotation*=.99}};s.prototype.updateSuspension=function(e){var t=this.chassisBody;var r=t.mass;var n=this.wheelInfos;var i=n.length;for(var a=0;a<i;a++){var o=n[a];if(o.isInContact){var s;var u=o.suspensionRestLength;var l=o.suspensionLength;var c=u-l;s=o.suspensionStiffness*c*o.clippedInvContactDotSuspension;var h=o.suspensionRelativeVelocity;var f;if(h<0){f=o.dampingCompression}else{f=o.dampingRelaxation}s-=f*h;o.suspensionForce=s*r;if(o.suspensionForce<0){o.suspensionForce=0}}else{o.suspensionForce=0}}};s.prototype.removeFromWorld=function(e){var t=this.constraints;e.remove(this.chassisBody);e.removeEventListener("preStep",this.preStepCallback);this.world=null};var y=new O;var x=new O;s.prototype.castRay=function(e){var t=y;var r=x;this.updateWheelTransformWorld(e);var n=this.chassisBody;var i=-1;var a=e.suspensionRestLength+e.radius;e.directionWorld.scale(a,t);var o=e.chassisConnectionPointWorld;o.vadd(t,r);var s=e.raycastResult;var u=0;s.reset();var l=n.collisionResponse;n.collisionResponse=false;this.world.rayTest(o,r,s);n.collisionResponse=l;var c=s.body;e.raycastResult.groundObject=0;if(c){i=s.distance;e.raycastResult.hitNormalWorld=s.hitNormalWorld;e.isInContact=true;var h=s.distance;e.suspensionLength=h-e.radius;var f=e.suspensionRestLength-e.maxSuspensionTravel;var d=e.suspensionRestLength+e.maxSuspensionTravel;if(e.suspensionLength<f){e.suspensionLength=f}if(e.suspensionLength>d){e.suspensionLength=d;e.raycastResult.reset()}var p=e.raycastResult.hitNormalWorld.dot(e.directionWorld);var v=new O;n.getVelocityAtWorldPoint(e.raycastResult.hitPointWorld,v);var m=e.raycastResult.hitNormalWorld.dot(v);if(p>=-.1){e.suspensionRelativeVelocity=0;e.clippedInvContactDotSuspension=1/.1}else{var g=-1/p;e.suspensionRelativeVelocity=m*g;e.clippedInvContactDotSuspension=g}}else{e.suspensionLength=e.suspensionRestLength+0*e.maxSuspensionTravel;e.suspensionRelativeVelocity=0;e.directionWorld.scale(-1,e.raycastResult.hitNormalWorld);e.clippedInvContactDotSuspension=1}return i};s.prototype.updateWheelTransformWorld=function(e){e.isInContact=false;var t=this.chassisBody;t.pointToWorldFrame(e.chassisConnectionPointLocal,e.chassisConnectionPointWorld);t.vectorToWorldFrame(e.directionLocal,e.directionWorld);t.vectorToWorldFrame(e.axleLocal,e.axleWorld)};s.prototype.updateWheelTransform=function(e){var t=f;var r=d;var n=p;var i=this.wheelInfos[e];this.updateWheelTransformWorld(i);i.directionLocal.scale(-1,t);r.copy(i.axleLocal);t.cross(r,n);n.normalize();r.normalize();var a=i.steering;var o=new c;o.setFromAxisAngle(t,a);var s=new c;s.setFromAxisAngle(r,i.rotation);var u=i.worldTransform.quaternion;this.chassisBody.quaternion.mult(o,u);u.mult(s,u);u.normalize();var l=i.worldTransform.position;l.copy(i.directionWorld);l.scale(i.suspensionLength,l);l.vadd(i.chassisConnectionPointWorld,l)};var L=[new O(1,0,0),new O(0,1,0),new O(0,0,1)];s.prototype.getWheelTransformWorld=function(e){return this.wheelInfos[e].worldTransform};var I=new O;var D=[];var N=[];var F=1;s.prototype.updateFriction=function(e){var t=I;var r=this.wheelInfos;var n=r.length;var i=this.chassisBody;var a=N;var o=D;var s=0;for(var u=0;u<n;u++){var l=r[u];var c=l.raycastResult.body;if(c){s++}l.sideImpulse=0;l.forwardImpulse=0;if(!a[u]){a[u]=new O}if(!o[u]){o[u]=new O}}for(var u=0;u<n;u++){var l=r[u];var c=l.raycastResult.body;if(c){var h=o[u];var f=this.getWheelTransformWorld(u);f.vectorToWorldFrame(L[this.indexRightAxis],h);var d=l.raycastResult.hitNormalWorld;var p=h.dot(d);d.scale(p,t);h.vsub(t,h);h.normalize();d.cross(h,a[u]);a[u].normalize();l.sideImpulse=U(i,l.raycastResult.hitPointWorld,c,l.raycastResult.hitPointWorld,h);l.sideImpulse*=F}}var v=1;var m=.5;this.sliding=false;for(var u=0;u<n;u++){var l=r[u];var c=l.raycastResult.body;var g=0;l.slipInfo=1;if(c){var y=0;var x=l.brake?l.brake:y;g=B(i,c,l.raycastResult.hitPointWorld,a[u],x);g+=l.engineForce*e;var b=x/g;l.slipInfo*=b}l.forwardImpulse=0;l.skidInfo=1;if(c){l.skidInfo=1;var w=l.suspensionForce*e*l.frictionSlip;var _=w;var T=w*_;l.forwardImpulse=g;var E=l.forwardImpulse*m;var M=l.sideImpulse*v;var S=E*E+M*M;l.sliding=false;if(S>T){this.sliding=true;l.sliding=true;var b=w/Math.sqrt(S);l.skidInfo*=b}}}if(this.sliding){for(var u=0;u<n;u++){var l=r[u];if(l.sideImpulse!==0){if(l.skidInfo<1){l.forwardImpulse*=l.skidInfo;l.sideImpulse*=l.skidInfo}}}}for(var u=0;u<n;u++){var l=r[u];var A=new O;A.copy(l.raycastResult.hitPointWorld);if(l.forwardImpulse!==0){var R=new O;a[u].scale(l.forwardImpulse,R);i.applyImpulse(R,A)}if(l.sideImpulse!==0){var c=l.raycastResult.body;var P=new O;P.copy(l.raycastResult.hitPointWorld);var C=new O;o[u].scale(l.sideImpulse,C);i.pointToLocalFrame(A,A);A["xyz"[this.indexUpAxis]]*=l.rollInfluence;i.pointToWorldFrame(A,A);i.applyImpulse(C,A);C.scale(-1,C);c.applyImpulse(C,P)}}};var g=new O;var b=new O;var w=new O;function B(e,t,r,n,i){var a=0;var o=r;var s=g;var u=b;var l=w;e.getVelocityAtWorldPoint(o,s);t.getVelocityAtWorldPoint(o,u);s.vsub(u,l);var c=n.dot(l);var h=S(e,r,n);var f=S(t,r,n);var d=1;var p=d/(h+f);a=-c*p;if(i<a){a=i}if(a<-i){a=-i}return a}var _=new O;var T=new O;var E=new O;var M=new O;function S(e,t,r){var n=_;var i=T;var a=E;var o=M;t.vsub(e.position,n);n.cross(r,i);e.invInertiaWorld.vmult(i,o);o.cross(n,a);return e.invMass+r.dot(a)}var A=new O;var R=new O;var P=new O;function U(e,t,r,n,i,a){var o=i.norm2();if(o>1.1){return 0}var s=A;var u=R;var l=P;e.getVelocityAtWorldPoint(t,s);r.getVelocityAtWorldPoint(n,u);s.vsub(u,l);var c=i.dot(l);var h=.2;var f=1/(e.invMass+r.invMass);var a=-h*c*f;return a}},{"../collision/Ray":9,"../collision/RaycastResult":10,"../math/Quaternion":28,"../math/Vec3":30,"../objects/WheelInfo":36,"./Body":31}],33:[function(e,t,r){var s=e("./Body");var u=e("../shapes/Sphere");var n=e("../shapes/Box");var l=e("../math/Vec3");var c=e("../constraints/HingeConstraint");t.exports=i;function i(e){this.wheelBodies=[];this.coordinateSystem=typeof e.coordinateSystem==="undefined"?new l(1,2,3):e.coordinateSystem.clone();this.chassisBody=e.chassisBody;if(!this.chassisBody){var t=new n(new l(5,2,.5));this.chassisBody=new s(1,t)}this.constraints=[];this.wheelAxes=[];this.wheelForces=[]}i.prototype.addWheel=function(e){e=e||{};var t=e.body;if(!t){t=new s(1,new u(1.2))}this.wheelBodies.push(t);this.wheelForces.push(0);var r=new l;var n=typeof e.position!=="undefined"?e.position.clone():new l;var i=new l;this.chassisBody.pointToWorldFrame(n,i);t.position.set(i.x,i.y,i.z);var a=typeof e.axis!=="undefined"?e.axis.clone():new l(0,1,0);this.wheelAxes.push(a);var o=new c(this.chassisBody,t,{pivotA:n,axisA:a,pivotB:l.ZERO,axisB:a,collideConnected:false});this.constraints.push(o);return this.wheelBodies.length-1};i.prototype.setSteeringValue=function(e,t){var r=this.wheelAxes[t];var n=Math.cos(e),i=Math.sin(e),a=r.x,o=r.y;this.constraints[t].axisA.set(n*a-i*o,i*a+n*o,0)};i.prototype.setMotorSpeed=function(e,t){var r=this.constraints[t];r.enableMotor();r.motorTargetVelocity=e};i.prototype.disableMotor=function(e){var t=this.constraints[e];t.disableMotor()};var a=new l;i.prototype.setWheelForce=function(e,t){this.wheelForces[t]=e};i.prototype.applyWheelForce=function(e,t){var r=this.wheelAxes[t];var n=this.wheelBodies[t];var i=n.torque;r.scale(e,a);n.vectorToWorldFrame(a,a);i.vadd(a,i)};i.prototype.addToWorld=function(e){var t=this.constraints;var r=this.wheelBodies.concat([this.chassisBody]);for(var n=0;n<r.length;n++){e.add(r[n])}for(var n=0;n<t.length;n++){e.addConstraint(t[n])}e.addEventListener("preStep",this._update.bind(this))};i.prototype._update=function(){var e=this.wheelForces;for(var t=0;t<e.length;t++){this.applyWheelForce(e[t],t)}};i.prototype.removeFromWorld=function(e){var t=this.constraints;var r=this.wheelBodies.concat([this.chassisBody]);for(var n=0;n<r.length;n++){e.remove(r[n])}for(var n=0;n<t.length;n++){e.removeConstraint(t[n])}};var o=new l;i.prototype.getWheelSpeed=function(e){var t=this.wheelAxes[e];var r=this.wheelBodies[e];var n=r.angularVelocity;this.chassisBody.vectorToWorldFrame(t,o);return n.dot(o)}},{"../constraints/HingeConstraint":15,"../math/Vec3":30,"../shapes/Box":37,"../shapes/Sphere":44,"./Body":31}],34:[function(e,t,r){t.exports=l;var n=e("../shapes/Shape");var i=e("../math/Vec3");var a=e("../math/Quaternion");var o=e("../shapes/Particle");var s=e("../objects/Body");var u=e("../material/Material");function l(){this.particles=[];this.density=1;this.smoothingRadius=1;this.speedOfSound=1;this.viscosity=.01;this.eps=1e-6;this.pressures=[];this.densities=[];this.neighbors=[]}l.prototype.add=function(e){this.particles.push(e);if(this.neighbors.length<this.particles.length){this.neighbors.push([])}};l.prototype.remove=function(e){var t=this.particles.indexOf(e);if(t!==-1){this.particles.splice(t,1);if(this.neighbors.length>this.particles.length){this.neighbors.pop()}}};var c=new i;l.prototype.getNeighbors=function(e,t){var r=this.particles.length,n=e.id,i=this.smoothingRadius*this.smoothingRadius,a=c;for(var o=0;o!==r;o++){var s=this.particles[o];s.position.vsub(e.position,a);if(n!==s.id&&a.norm2()<i){t.push(s)}}};var T=new i,E=new i,M=new i,S=new i,A=new i,R=new i;l.prototype.update=function(){var e=this.particles.length,t=T,r=this.speedOfSound,n=this.eps;for(var i=0;i!==e;i++){var a=this.particles[i];var o=this.neighbors[i];o.length=0;this.getNeighbors(a,o);o.push(this.particles[i]);var s=o.length;var u=0;for(var l=0;l!==s;l++){a.position.vsub(o[l].position,t);var c=t.norm();var h=this.w(c);u+=o[l].mass*h}this.densities[i]=u;this.pressures[i]=r*r*(this.densities[i]-this.density)}var f=E;var d=M;var p=S;var v=A;var m=R;for(var i=0;i!==e;i++){var g=this.particles[i];f.set(0,0,0);d.set(0,0,0);var y;var x;var b;var o=this.neighbors[i];var s=o.length;for(var l=0;l!==s;l++){var w=o[l];g.position.vsub(w.position,v);var _=v.norm();y=-w.mass*(this.pressures[i]/(this.densities[i]*this.densities[i]+n)+this.pressures[l]/(this.densities[l]*this.densities[l]+n));this.gradw(v,p);p.mult(y,p);f.vadd(p,f);w.velocity.vsub(g.velocity,m);m.mult(1/(1e-4+this.densities[i]*this.densities[l])*this.viscosity*w.mass,m);x=this.nablaw(_);m.mult(x,m);d.vadd(m,d)}d.mult(g.mass,d);f.mult(g.mass,f);g.force.vadd(d,g.force);g.force.vadd(f,g.force)}};l.prototype.w=function(e){var t=this.smoothingRadius;return 315/(64*Math.PI*Math.pow(t,9))*Math.pow(t*t-e*e,3)};l.prototype.gradw=function(e,t){var r=e.norm(),n=this.smoothingRadius;e.mult(945/(32*Math.PI*Math.pow(n,9))*Math.pow(n*n-r*r,2),t)};l.prototype.nablaw=function(e){var t=this.smoothingRadius;var r=945/(32*Math.PI*Math.pow(t,9))*(t*t-e*e)*(7*e*e-3*t*t);return r}},{"../material/Material":25,"../math/Quaternion":28,"../math/Vec3":30,"../objects/Body":31,"../shapes/Particle":41,"../shapes/Shape":43}],35:[function(e,t,r){var n=e("../math/Vec3");t.exports=i;function i(e,t,r){r=r||{};this.restLength=typeof r.restLength==="number"?r.restLength:1;this.stiffness=r.stiffness||100;this.damping=r.damping||1;this.bodyA=e;this.bodyB=t;this.localAnchorA=new n;this.localAnchorB=new n;if(r.localAnchorA){this.localAnchorA.copy(r.localAnchorA)}if(r.localAnchorB){this.localAnchorB.copy(r.localAnchorB)}if(r.worldAnchorA){this.setWorldAnchorA(r.worldAnchorA)}if(r.worldAnchorB){this.setWorldAnchorB(r.worldAnchorB)}}i.prototype.setWorldAnchorA=function(e){this.bodyA.pointToLocalFrame(e,this.localAnchorA)};i.prototype.setWorldAnchorB=function(e){this.bodyB.pointToLocalFrame(e,this.localAnchorB)};i.prototype.getWorldAnchorA=function(e){this.bodyA.pointToWorldFrame(this.localAnchorA,e)};i.prototype.getWorldAnchorB=function(e){this.bodyB.pointToWorldFrame(this.localAnchorB,e)};var g=new n,y=new n,x=new n,b=new n,w=new n,_=new n,T=new n,E=new n,M=new n,S=new n,A=new n;i.prototype.applyForce=function(){var e=this.stiffness,t=this.damping,r=this.restLength,n=this.bodyA,i=this.bodyB,a=g,o=y,s=x,u=b,l=A;var c=w,h=_,f=T,d=E,p=M,v=S;this.getWorldAnchorA(c);this.getWorldAnchorB(h);c.vsub(n.position,f);h.vsub(i.position,d);h.vsub(c,a);var m=a.norm();o.copy(a);o.normalize();i.velocity.vsub(n.velocity,s);i.angularVelocity.cross(d,l);s.vadd(l,s);n.angularVelocity.cross(f,l);s.vsub(l,s);o.mult(-e*(m-r)-t*s.dot(o),u);n.force.vsub(u,n.force);i.force.vadd(u,i.force);f.cross(u,p);d.cross(u,v);n.torque.vsub(p,n.torque);i.torque.vadd(v,i.torque)}},{"../math/Vec3":30}],36:[function(e,t,r){var n=e("../math/Vec3");var i=e("../math/Transform");var a=e("../collision/RaycastResult");var o=e("../utils/Utils");t.exports=s;function s(e){e=o.defaults(e,{chassisConnectionPointLocal:new n,chassisConnectionPointWorld:new n,directionLocal:new n,directionWorld:new n,axleLocal:new n,axleWorld:new n,suspensionRestLength:1,suspensionMaxLength:2,radius:1,suspensionStiffness:100,dampingCompression:10,dampingRelaxation:10,frictionSlip:1e4,steering:0,rotation:0,deltaRotation:0,rollInfluence:.01,maxSuspensionForce:Number.MAX_VALUE,isFrontWheel:true,clippedInvContactDotSuspension:1,suspensionRelativeVelocity:0,suspensionForce:0,skidInfo:0,suspensionLength:0,maxSuspensionTravel:1,useCustomSlidingRotationalSpeed:false,customSlidingRotationalSpeed:-.1});this.maxSuspensionTravel=e.maxSuspensionTravel;this.customSlidingRotationalSpeed=e.customSlidingRotationalSpeed;this.useCustomSlidingRotationalSpeed=e.useCustomSlidingRotationalSpeed;this.sliding=false;this.chassisConnectionPointLocal=e.chassisConnectionPointLocal.clone();this.chassisConnectionPointWorld=e.chassisConnectionPointWorld.clone();this.directionLocal=e.directionLocal.clone();this.directionWorld=e.directionWorld.clone();this.axleLocal=e.axleLocal.clone();this.axleWorld=e.axleWorld.clone();this.suspensionRestLength=e.suspensionRestLength;this.suspensionMaxLength=e.suspensionMaxLength;this.radius=e.radius;this.suspensionStiffness=e.suspensionStiffness;this.dampingCompression=e.dampingCompression;this.dampingRelaxation=e.dampingRelaxation;this.frictionSlip=e.frictionSlip;this.steering=0;this.rotation=0;this.deltaRotation=0;this.rollInfluence=e.rollInfluence;this.maxSuspensionForce=e.maxSuspensionForce;this.engineForce=0;this.brake=0;this.isFrontWheel=e.isFrontWheel;this.clippedInvContactDotSuspension=1;this.suspensionRelativeVelocity=0;this.suspensionForce=0;this.skidInfo=0;this.suspensionLength=0;this.sideImpulse=0;this.forwardImpulse=0;this.raycastResult=new a;this.worldTransform=new i;this.isInContact=false}var u=new n;var l=new n;var u=new n;s.prototype.updateWheel=function(e){var t=this.raycastResult;if(this.isInContact){var r=t.hitNormalWorld.dot(t.directionWorld);t.hitPointWorld.vsub(e.position,l);e.getVelocityAtWorldPoint(l,u);var n=t.hitNormalWorld.dot(u);if(r>=-.1){this.suspensionRelativeVelocity=0;this.clippedInvContactDotSuspension=1/.1}else{var i=-1/r;this.suspensionRelativeVelocity=n*i;this.clippedInvContactDotSuspension=i}}else{t.suspensionLength=this.suspensionRestLength;this.suspensionRelativeVelocity=0;t.directionWorld.scale(-1,t.hitNormalWorld);this.clippedInvContactDotSuspension=1}}},{"../collision/RaycastResult":10,"../math/Transform":29,"../math/Vec3":30,"../utils/Utils":53}],37:[function(e,t,r){t.exports=i;var n=e("./Shape");var u=e("../math/Vec3");var l=e("./ConvexPolyhedron");function i(e){n.call(this);this.type=n.types.BOX;this.halfExtents=e;this.convexPolyhedronRepresentation=null;this.updateConvexPolyhedronRepresentation();this.updateBoundingSphereRadius()}i.prototype=new n;i.prototype.constructor=i;i.prototype.updateConvexPolyhedronRepresentation=function(){var e=this.halfExtents.x;var t=this.halfExtents.y;var r=this.halfExtents.z;var n=u;var i=[new n(-e,-t,-r),new n(e,-t,-r),new n(e,t,-r),new n(-e,t,-r),new n(-e,-t,r),new n(e,-t,r),new n(e,t,r),new n(-e,t,r)];var a=[[3,2,1,0],[4,5,6,7],[5,4,0,1],[2,3,7,6],[0,4,7,3],[1,2,6,5]];var o=[new n(0,0,1),new n(0,1,0),new n(1,0,0)];var s=new l(i,a);this.convexPolyhedronRepresentation=s;s.material=this.material};i.prototype.calculateLocalInertia=function(e,t){t=t||new u;i.calculateInertia(this.halfExtents,e,t);return t};i.calculateInertia=function(e,t,r){var n=e;r.x=1/12*t*(2*n.y*2*n.y+2*n.z*2*n.z);r.y=1/12*t*(2*n.x*2*n.x+2*n.z*2*n.z);r.z=1/12*t*(2*n.y*2*n.y+2*n.x*2*n.x)};i.prototype.getSideNormals=function(e,t){var r=e;var n=this.halfExtents;r[0].set(n.x,0,0);r[1].set(0,n.y,0);r[2].set(0,0,n.z);r[3].set(-n.x,0,0);r[4].set(0,-n.y,0);r[5].set(0,0,-n.z);if(t!==undefined){for(var i=0;i!==r.length;i++){t.vmult(r[i],r[i])}}return r};i.prototype.volume=function(){return 8*this.halfExtents.x*this.halfExtents.y*this.halfExtents.z};i.prototype.updateBoundingSphereRadius=function(){this.boundingSphereRadius=this.halfExtents.norm()};var o=new u;var a=new u;i.prototype.forEachWorldCorner=function(e,t,r){var n=this.halfExtents;var i=[[n.x,n.y,n.z],[-n.x,n.y,n.z],[-n.x,-n.y,n.z],[-n.x,-n.y,-n.z],[n.x,-n.y,-n.z],[n.x,n.y,-n.z],[-n.x,n.y,-n.z],[n.x,-n.y,n.z]];for(var a=0;a<i.length;a++){o.set(i[a][0],i[a][1],i[a][2]);t.vmult(o,o);e.vadd(o,o);r(o.x,o.y,o.z)}};var c=[new u,new u,new u,new u,new u,new u,new u,new u];i.prototype.calculateWorldAABB=function(e,t,r,n){var i=this.halfExtents;c[0].set(i.x,i.y,i.z);c[1].set(-i.x,i.y,i.z);c[2].set(-i.x,-i.y,i.z);c[3].set(-i.x,-i.y,-i.z);c[4].set(i.x,-i.y,-i.z);c[5].set(i.x,i.y,-i.z);c[6].set(-i.x,i.y,-i.z);c[7].set(i.x,-i.y,i.z);var a=c[0];t.vmult(a,a);e.vadd(a,a);n.copy(a);r.copy(a);for(var o=1;o<8;o++){var a=c[o];t.vmult(a,a);e.vadd(a,a);var s=a.x;var u=a.y;var l=a.z;if(s>n.x){n.x=s}if(u>n.y){n.y=u}if(l>n.z){n.z=l}if(s<r.x){r.x=s}if(u<r.y){r.y=u}if(l<r.z){r.z=l}}}},{"../math/Vec3":30,"./ConvexPolyhedron":38,"./Shape":43}],38:[function(e,t,r){t.exports=p;var i=e("./Shape");var _=e("../math/Vec3");var n=e("../math/Quaternion");var m=e("../math/Transform");function p(e,t,r){var n=this;i.call(this);this.type=i.types.CONVEXPOLYHEDRON;this.vertices=e||[];this.worldVertices=[];this.worldVerticesNeedsUpdate=true;this.faces=t||[];this.faceNormals=[];this.computeNormals();this.worldFaceNormalsNeedsUpdate=true;this.worldFaceNormals=[];this.uniqueEdges=[];this.uniqueAxes=r?r.slice():null;this.computeEdges();this.updateBoundingSphereRadius()}p.prototype=new i;p.prototype.constructor=p;var f=new _;p.prototype.computeEdges=function(){var e=this.faces;var t=this.vertices;var r=t.length;var n=this.uniqueEdges;n.length=0;var i=f;for(var a=0;a!==e.length;a++){var o=e[a];var s=o.length;for(var u=0;u!==s;u++){var l=(u+1)%s;t[o[u]].vsub(t[o[l]],i);i.normalize();var c=false;for(var h=0;h!==n.length;h++){if(n[h].almostEquals(i)||n[h].almostEquals(i)){c=true;break}}if(!c){n.push(i.clone())}}}};p.prototype.computeNormals=function(){this.faceNormals.length=this.faces.length;for(var e=0;e<this.faces.length;e++){for(var t=0;t<this.faces[e].length;t++){if(!this.vertices[this.faces[e][t]]){throw new Error("Vertex "+this.faces[e][t]+" not found!")}}var r=this.faceNormals[e]||new _;this.getFaceNormal(e,r);r.negate(r);this.faceNormals[e]=r;var n=this.vertices[this.faces[e][0]];if(r.dot(n)<0){console.error(".faceNormals["+e+"] = Vec3("+r.toString()+") looks like it points into the shape? The vertices follow. Make sure they are ordered CCW around the normal, using the right hand rule.");for(var t=0;t<this.faces[e].length;t++){console.warn(".vertices["+this.faces[e][t]+"] = Vec3("+this.vertices[this.faces[e][t]].toString()+")")}}}};var a=new _;var o=new _;p.computeNormal=function(e,t,r,n){t.vsub(e,o);r.vsub(t,a);a.cross(o,n);if(!n.isZero()){n.normalize()}};p.prototype.getFaceNormal=function(e,t){var r=this.faces[e];var n=this.vertices[r[0]];var i=this.vertices[r[1]];var a=this.vertices[r[2]];return p.computeNormal(n,i,a,t)};var T=new _;p.prototype.clipAgainstHull=function(e,t,r,n,i,a,o,s,u){var l=T;var c=this;var h=s;var f=-1;var d=-Number.MAX_VALUE;for(var p=0;p<r.faces.length;p++){l.copy(r.faceNormals[p]);i.vmult(l,l);var v=l.dot(a);if(v>d){d=v;f=p}}var m=[];var g=r.faces[f];var y=g.length;for(var x=0;x<y;x++){var b=r.vertices[g[x]];var w=new _;w.copy(b);i.vmult(w,w);n.vadd(w,w);m.push(w)}if(f>=0){this.clipFaceAgainstHull(a,e,t,m,o,s,u)}};var M=new _,S=new _,A=new _,R=new _,P=new _,C=new _;p.prototype.findSeparatingAxis=function(e,t,r,n,i,a,o,s){var u=M,l=S,c=A,h=R,f=P,d=C;var p=Number.MAX_VALUE;var v=this;var m=0;if(!v.uniqueAxes){var g=o?o.length:v.faces.length;for(var y=0;y<g;y++){var x=o?o[y]:y;u.copy(v.faceNormals[x]);r.vmult(u,u);var b=v.testSepAxis(u,e,t,r,n,i);if(b===false){return false}if(b<p){p=b;a.copy(u)}}}else{for(var y=0;y!==v.uniqueAxes.length;y++){r.vmult(v.uniqueAxes[y],u);var b=v.testSepAxis(u,e,t,r,n,i);if(b===false){return false}if(b<p){p=b;a.copy(u)}}}if(!e.uniqueAxes){var w=s?s.length:e.faces.length;for(var y=0;y<w;y++){var x=s?s[y]:y;l.copy(e.faceNormals[x]);i.vmult(l,l);m++;var b=v.testSepAxis(l,e,t,r,n,i);if(b===false){return false}if(b<p){p=b;a.copy(l)}}}else{for(var y=0;y!==e.uniqueAxes.length;y++){i.vmult(e.uniqueAxes[y],l);m++;var b=v.testSepAxis(l,e,t,r,n,i);if(b===false){return false}if(b<p){p=b;a.copy(l)}}}for(var _=0;_!==v.uniqueEdges.length;_++){r.vmult(v.uniqueEdges[_],h);for(var T=0;T!==e.uniqueEdges.length;T++){i.vmult(e.uniqueEdges[T],f);h.cross(f,d);if(!d.almostZero()){d.normalize();var E=v.testSepAxis(d,e,t,r,n,i);if(E===false){return false}if(E<p){p=E;a.copy(d)}}}}n.vsub(t,c);if(c.dot(a)>0){a.negate(a)}return true};var v=[],g=[];p.prototype.testSepAxis=function(e,t,r,n,i,a){var o=this;p.project(o,e,r,n,v);p.project(t,e,i,a,g);var s=v[0];var u=v[1];var l=g[0];var c=g[1];if(s<c||l<u){return false}var h=s-c;var f=l-u;var d=h<f?h:f;return d};var s=new _,u=new _;p.prototype.calculateLocalInertia=function(e,t){this.computeLocalAABB(s,u);var r=u.x-s.x,n=u.y-s.y,i=u.z-s.z;t.x=1/12*e*(2*n*2*n+2*i*2*i);t.y=1/12*e*(2*r*2*r+2*i*2*i);t.z=1/12*e*(2*n*2*n+2*r*2*r)};p.prototype.getPlaneConstantOfFace=function(e){var t=this.faces[e];var r=this.faceNormals[e];var n=this.vertices[t[0]];var i=-r.dot(n);return i};var k=new _,j=new _,z=new _,H=new _,G=new _,V=new _,W=new _,q=new _;p.prototype.clipFaceAgainstHull=function(e,t,r,n,i,a,o){var s=k,u=j,l=z,c=H,h=G,f=V,d=W,p=q;var v=this;var m=[];var g=n;var y=m;var x=-1;var b=Number.MAX_VALUE;for(var w=0;w<v.faces.length;w++){s.copy(v.faceNormals[w]);r.vmult(s,s);var _=s.dot(e);if(_<b){b=_;x=w}}if(x<0){return}var T=v.faces[x];T.connectedFaces=[];for(var E=0;E<v.faces.length;E++){for(var M=0;M<v.faces[E].length;M++){if(T.indexOf(v.faces[E][M])!==-1&&E!==x&&T.connectedFaces.indexOf(E)===-1){T.connectedFaces.push(E)}}}var S=g.length;var A=T.length;var R=[];for(var P=0;P<A;P++){var C=v.vertices[T[P]];var O=v.vertices[T[(P+1)%A]];C.vsub(O,u);l.copy(u);r.vmult(l,l);t.vadd(l,l);c.copy(this.faceNormals[x]);r.vmult(c,c);t.vadd(c,c);l.cross(c,h);h.negate(h);f.copy(C);r.vmult(f,f);t.vadd(f,f);var L=-f.dot(h);var I;if(true){var D=T.connectedFaces[P];d.copy(this.faceNormals[D]);var N=this.getPlaneConstantOfFace(D);p.copy(d);r.vmult(p,p);var I=N-p.dot(t)}else{p.copy(h);I=L}this.clipFaceAgainstPlane(g,y,p,I);while(g.length){g.shift()}while(y.length){g.push(y.shift())}}d.copy(this.faceNormals[x]);var N=this.getPlaneConstantOfFace(x);p.copy(d);r.vmult(p,p);var I=N-p.dot(t);for(var E=0;E<g.length;E++){var F=p.dot(g[E])+I;if(F<=i){console.log("clamped: depth="+F+" to minDist="+(i+""));F=i}if(F<=a){var B=g[E];if(F<=0){var U={point:B,normal:p,depth:F};o.push(U)}}}};p.prototype.clipFaceAgainstPlane=function(e,t,r,n){var i,a;var o=e.length;if(o<2){return t}var s=e[e.length-1],u=e[0];i=r.dot(s)+n;for(var l=0;l<o;l++){u=e[l];a=r.dot(u)+n;if(i<0){if(a<0){var c=new _;c.copy(u);t.push(c)}else{var c=new _;s.lerp(u,i/(i-a),c);t.push(c)}}else{if(a<0){var c=new _;s.lerp(u,i/(i-a),c);t.push(c);t.push(u)}}s=u;i=a}return t};p.prototype.computeWorldVertices=function(e,t){var r=this.vertices.length;while(this.worldVertices.length<r){this.worldVertices.push(new _)}var n=this.vertices,i=this.worldVertices;for(var a=0;a!==r;a++){t.vmult(n[a],i[a]);e.vadd(i[a],i[a])}this.worldVerticesNeedsUpdate=false};var l=new _;p.prototype.computeLocalAABB=function(e,t){var r=this.vertices.length,n=this.vertices,i=l;e.set(Number.MAX_VALUE,Number.MAX_VALUE,Number.MAX_VALUE);t.set(-Number.MAX_VALUE,-Number.MAX_VALUE,-Number.MAX_VALUE);for(var a=0;a<r;a++){var o=n[a];if(o.x<e.x){e.x=o.x}else if(o.x>t.x){t.x=o.x}if(o.y<e.y){e.y=o.y}else if(o.y>t.y){t.y=o.y}if(o.z<e.z){e.z=o.z}else if(o.z>t.z){t.z=o.z}}};p.prototype.computeWorldFaceNormals=function(e){var t=this.faceNormals.length;while(this.worldFaceNormals.length<t){this.worldFaceNormals.push(new _)}var r=this.faceNormals,n=this.worldFaceNormals;for(var i=0;i!==t;i++){e.vmult(r[i],n[i])}this.worldFaceNormalsNeedsUpdate=false};p.prototype.updateBoundingSphereRadius=function(){var e=0;var t=this.vertices;for(var r=0,n=t.length;r!==n;r++){var i=t[r].norm2();if(i>e){e=i}}this.boundingSphereRadius=Math.sqrt(e)};var y=new _;p.prototype.calculateWorldAABB=function(e,t,r,n){var i=this.vertices.length,a=this.vertices;var o,s,u,l,c,h;for(var f=0;f<i;f++){y.copy(a[f]);t.vmult(y,y);e.vadd(y,y);var d=y;if(d.x<o||o===undefined){o=d.x}else if(d.x>l||l===undefined){l=d.x}if(d.y<s||s===undefined){s=d.y}else if(d.y>c||c===undefined){c=d.y}if(d.z<u||u===undefined){u=d.z}else if(d.z>h||h===undefined){h=d.z}}r.set(o,s,u);n.set(l,c,h)};p.prototype.volume=function(){return 4*Math.PI*this.boundingSphereRadius/3};p.prototype.getAveragePointLocal=function(e){e=e||new _;var t=this.vertices.length,r=this.vertices;for(var n=0;n<t;n++){e.vadd(r[n],e)}e.mult(1/t,e);return e};p.prototype.transformAllPoints=function(e,t){var r=this.vertices.length,n=this.vertices;if(t){for(var i=0;i<r;i++){var a=n[i];t.vmult(a,a)}for(var i=0;i<this.faceNormals.length;i++){var a=this.faceNormals[i];t.vmult(a,a)}}if(e){for(var i=0;i<r;i++){var a=n[i];a.vadd(e,a)}}};var x=new _;var b=new _;var w=new _;p.prototype.pointIsInside=function(e){var t=this.vertices.length,r=this.vertices,n=this.faces,i=this.faceNormals;var a=null;var o=this.faces.length;var s=x;this.getAveragePointLocal(s);for(var u=0;u<o;u++){var l=this.faces[u].length;var t=i[u];var c=r[n[u][0]];var h=b;e.vsub(c,h);var f=t.dot(h);var d=w;s.vsub(c,d);var p=t.dot(d);if(f<0&&p>0||f>0&&p<0){return false}else{}}return a?1:-1};var E=new _;var O=new _;var L=new _;p.project=function(e,t,r,n,i){var a=e.vertices.length,o=E,s=O,u=0,l=0,c=L,h=e.vertices;c.setZero();m.vectorToLocalFrame(r,n,t,s);m.pointToLocalFrame(r,n,c,c);var f=c.dot(s);l=u=h[0].dot(s);for(var d=1;d<a;d++){var p=h[d].dot(s);if(p>u){u=p}if(p<l){l=p}}l-=f;u-=f;if(l>u){var v=l;l=u;u=v}i[0]=u;i[1]=l}},{"../math/Quaternion":28,"../math/Transform":29,"../math/Vec3":30,"./Shape":43}],39:[function(e,t,r){t.exports=i;var m=e("./Shape");var g=e("../math/Vec3");var n=e("../math/Quaternion");var y=e("./ConvexPolyhedron");function i(e,t,r,n){var i=n,a=[],o=[],s=[],u=[],l=[],c=Math.cos,h=Math.sin;a.push(new g(t*c(0),t*h(0),-r*.5));u.push(0);a.push(new g(e*c(0),e*h(0),r*.5));l.push(1);for(var f=0;f<i;f++){var d=2*Math.PI/i*(f+1);var p=2*Math.PI/i*(f+.5);if(f<i-1){a.push(new g(t*c(d),t*h(d),-r*.5));u.push(2*f+2);a.push(new g(e*c(d),e*h(d),r*.5));l.push(2*f+3);s.push([2*f+2,2*f+3,2*f+1,2*f])}else{s.push([0,1,2*f+1,2*f])}if(i%2===1||f<i/2){o.push(new g(c(p),h(p),0))}}s.push(l);o.push(new g(0,0,1));var v=[];for(var f=0;f<u.length;f++){v.push(u[u.length-f-1])}s.push(v);this.type=m.types.CONVEXPOLYHEDRON;y.call(this,a,s,o)}i.prototype=new y},{"../math/Quaternion":28,"../math/Vec3":30,"./ConvexPolyhedron":38,"./Shape":43}],40:[function(e,t,r){var n=e("./Shape");var h=e("./ConvexPolyhedron");var f=e("../math/Vec3");var i=e("../utils/Utils");t.exports=a;function a(e,t){t=i.defaults(t,{maxValue:null,minValue:null,elementSize:1});this.data=e;this.maxValue=t.maxValue;this.minValue=t.minValue;this.elementSize=t.elementSize;if(t.minValue===null){this.updateMinValue()}if(t.maxValue===null){this.updateMaxValue()}this.cacheEnabled=true;n.call(this);this.pillarConvex=new h;this.pillarOffset=new f;this.type=n.types.HEIGHTFIELD;this.updateBoundingSphereRadius();this._cachedPillars={}}a.prototype=new n;a.prototype.update=function(){this._cachedPillars={}};a.prototype.updateMinValue=function(){var e=this.data;var t=e[0][0];for(var r=0;r!==e.length;r++){for(var n=0;n!==e[r].length;n++){var i=e[r][n];if(i<t){t=i}}}this.minValue=t};a.prototype.updateMaxValue=function(){var e=this.data;var t=e[0][0];for(var r=0;r!==e.length;r++){for(var n=0;n!==e[r].length;n++){var i=e[r][n];if(i>t){t=i}}}this.maxValue=t};a.prototype.setHeightValueAtIndex=function(e,t,r){var n=this.data;n[e][t]=r;this.clearCachedConvexTrianglePillar(e,t,false);if(e>0){this.clearCachedConvexTrianglePillar(e-1,t,true);this.clearCachedConvexTrianglePillar(e-1,t,false)}if(t>0){this.clearCachedConvexTrianglePillar(e,t-1,true);this.clearCachedConvexTrianglePillar(e,t-1,false)}if(t>0&&e>0){this.clearCachedConvexTrianglePillar(e-1,t-1,true)}};a.prototype.getRectMinMax=function(e,t,r,n,i){i=i||[];var a=this.data,o=this.minValue;for(var s=e;s<=r;s++){for(var u=t;u<=n;u++){var l=a[s][u];if(l>o){o=l}}}i[0]=this.minValue;i[1]=o};a.prototype.getIndexOfPosition=function(e,t,r,n){var i=this.elementSize;var a=this.data;var o=Math.floor(e/i);var s=Math.floor(t/i);r[0]=o;r[1]=s;if(n){if(o<0){o=0}if(s<0){s=0}if(o>=a.length-1){o=a.length-1}if(s>=a[0].length-1){s=a[0].length-1}}if(o<0||s<0||o>=a.length-1||s>=a[0].length-1){return false}return true};a.prototype.getHeightAt=function(e,t,r){var n=[];this.getIndexOfPosition(e,t,n,r);var i=[];this.getRectMinMax(n[0],n[1]+1,n[0],n[1]+1,i);return(i[0]+i[1])/2};a.prototype.getCacheConvexTrianglePillarKey=function(e,t,r){return e+"_"+t+"_"+(r?1:0)};a.prototype.getCachedConvexTrianglePillar=function(e,t,r){return this._cachedPillars[this.getCacheConvexTrianglePillarKey(e,t,r)]};a.prototype.setCachedConvexTrianglePillar=function(e,t,r,n,i){this._cachedPillars[this.getCacheConvexTrianglePillarKey(e,t,r)]={convex:n,offset:i}};a.prototype.clearCachedConvexTrianglePillar=function(e,t,r){delete this._cachedPillars[this.getCacheConvexTrianglePillarKey(e,t,r)]};a.prototype.getConvexTrianglePillar=function(e,t,r){var n=this.pillarConvex;var i=this.pillarOffset;if(this.cacheEnabled){var a=this.getCachedConvexTrianglePillar(e,t,r);if(a){this.pillarConvex=a.convex;this.pillarOffset=a.offset;return}n=new h;i=new f;this.pillarConvex=n;this.pillarOffset=i}var a=this.data;var o=this.elementSize;var s=n.faces;n.vertices.length=6;for(var u=0;u<6;u++){if(!n.vertices[u]){n.vertices[u]=new f}}s.length=5;for(var u=0;u<5;u++){if(!s[u]){s[u]=[]}}var l=n.vertices;var c=(Math.min(a[e][t],a[e+1][t],a[e][t+1],a[e+1][t+1])-this.minValue)/2+this.minValue;if(!r){i.set((e+.25)*o,(t+.25)*o,c);l[0].set(-.25*o,-.25*o,a[e][t]-c);l[1].set(.75*o,-.25*o,a[e+1][t]-c);l[2].set(-.25*o,.75*o,a[e][t+1]-c);l[3].set(-.25*o,-.25*o,-c-1);l[4].set(.75*o,-.25*o,-c-1);l[5].set(-.25*o,.75*o,-c-1);s[0][0]=0;s[0][1]=1;s[0][2]=2;s[1][0]=5;s[1][1]=4;s[1][2]=3;s[2][0]=0;s[2][1]=2;s[2][2]=5;s[2][3]=3;s[3][0]=1;s[3][1]=0;s[3][2]=3;s[3][3]=4;s[4][0]=4;s[4][1]=5;s[4][2]=2;s[4][3]=1}else{i.set((e+.75)*o,(t+.75)*o,c);l[0].set(.25*o,.25*o,a[e+1][t+1]-c);l[1].set(-.75*o,.25*o,a[e][t+1]-c);l[2].set(.25*o,-.75*o,a[e+1][t]-c);l[3].set(.25*o,.25*o,-c-1);l[4].set(-.75*o,.25*o,-c-1);l[5].set(.25*o,-.75*o,-c-1);s[0][0]=0;s[0][1]=1;s[0][2]=2;s[1][0]=5;s[1][1]=4;s[1][2]=3;s[2][0]=2;s[2][1]=5;s[2][2]=3;s[2][3]=0;s[3][0]=3;s[3][1]=4;s[3][2]=1;s[3][3]=0;s[4][0]=1;s[4][1]=4;s[4][2]=5;s[4][3]=2}n.computeNormals();n.computeEdges();n.updateBoundingSphereRadius();this.setCachedConvexTrianglePillar(e,t,r,n,i)};a.prototype.calculateLocalInertia=function(e,t){t=t||new f;t.set(0,0,0);return t};a.prototype.volume=function(){return Number.MAX_VALUE};a.prototype.calculateWorldAABB=function(e,t,r,n){r.set(-Number.MAX_VALUE,-Number.MAX_VALUE,-Number.MAX_VALUE);n.set(Number.MAX_VALUE,Number.MAX_VALUE,Number.MAX_VALUE)};a.prototype.updateBoundingSphereRadius=function(){var e=this.data,t=this.elementSize;this.boundingSphereRadius=new f(e.length*t,e[0].length*t,Math.max(Math.abs(this.maxValue),Math.abs(this.minValue))).norm()}},{"../math/Vec3":30,"../utils/Utils":53,"./ConvexPolyhedron":38,"./Shape":43}],41:[function(e,t,r){t.exports=a;var n=e("./Shape");var i=e("../math/Vec3");function a(){n.call(this);this.type=n.types.PARTICLE}a.prototype=new n;a.prototype.constructor=a;a.prototype.calculateLocalInertia=function(e,t){t=t||new i;t.set(0,0,0);return t};a.prototype.volume=function(){return 0};a.prototype.updateBoundingSphereRadius=function(){this.boundingSphereRadius=0};a.prototype.calculateWorldAABB=function(e,t,r,n){r.copy(e);n.copy(e)}},{"../math/Vec3":30,"./Shape":43}],42:[function(e,t,r){t.exports=a;var n=e("./Shape");var i=e("../math/Vec3");function a(){n.call(this);this.type=n.types.PLANE;this.worldNormal=new i;this.worldNormalNeedsUpdate=true;this.boundingSphereRadius=Number.MAX_VALUE}a.prototype=new n;a.prototype.constructor=a;a.prototype.computeWorldNormal=function(e){var t=this.worldNormal;t.set(0,0,1);e.vmult(t,t);this.worldNormalNeedsUpdate=false};a.prototype.calculateLocalInertia=function(e,t){t=t||new i;return t};a.prototype.volume=function(){return Number.MAX_VALUE};var o=new i;a.prototype.calculateWorldAABB=function(e,t,r,n){o.set(0,0,1);t.vmult(o,o);var i=Number.MAX_VALUE;r.set(-i,-i,-i);n.set(i,i,i);if(o.x===1){n.x=e.x}if(o.y===1){n.y=e.y}if(o.z===1){n.z=e.z}if(o.x===-1){r.x=e.x}if(o.y===-1){r.y=e.y}if(o.z===-1){r.z=e.z}};a.prototype.updateBoundingSphereRadius=function(){this.boundingSphereRadius=Number.MAX_VALUE}},{"../math/Vec3":30,"./Shape":43}],43:[function(e,t,r){t.exports=n;var n=e("./Shape");var i=e("../math/Vec3");var a=e("../math/Quaternion");var o=e("../material/Material");function n(){this.id=n.idCounter++;this.type=0;this.boundingSphereRadius=0;this.collisionResponse=true;this.material=null}n.prototype.constructor=n;n.prototype.updateBoundingSphereRadius=function(){throw"computeBoundingSphereRadius() not implemented for shape type "+this.type};n.prototype.volume=function(){throw"volume() not implemented for shape type "+this.type};n.prototype.calculateLocalInertia=function(e,t){throw"calculateLocalInertia() not implemented for shape type "+this.type};n.idCounter=0;n.types={SPHERE:1,PLANE:2,BOX:4,COMPOUND:8,CONVEXPOLYHEDRON:16,HEIGHTFIELD:32,PARTICLE:64,CYLINDER:128,TRIMESH:256}},{"../material/Material":25,"../math/Quaternion":28,"../math/Vec3":30,"./Shape":43}],44:[function(e,t,r){t.exports=a;var n=e("./Shape");var i=e("../math/Vec3");function a(e){n.call(this);this.radius=e!==undefined?Number(e):1;this.type=n.types.SPHERE;if(this.radius<0){throw new Error("The sphere radius cannot be negative.")}this.updateBoundingSphereRadius()}a.prototype=new n;a.prototype.constructor=a;a.prototype.calculateLocalInertia=function(e,t){t=t||new i;var r=2*e*this.radius*this.radius/5;t.x=r;t.y=r;t.z=r;return t};a.prototype.volume=function(){return 4*Math.PI*this.radius/3};a.prototype.updateBoundingSphereRadius=function(){this.boundingSphereRadius=this.radius};a.prototype.calculateWorldAABB=function(e,t,r,n){var i=this.radius;var a=["x","y","z"];for(var o=0;o<a.length;o++){var s=a[o];r[s]=e[s]-i;n[s]=e[s]+i}}},{"../math/Vec3":30,"./Shape":43}],45:[function(e,t,r){t.exports=y;var n=e("./Shape");var l=e("../math/Vec3");var i=e("../math/Quaternion");var a=e("../math/Transform");var c=e("../collision/AABB");var o=e("../utils/Octree");function y(e,t){n.call(this);this.type=n.types.TRIMESH;this.vertices=new Float32Array(e);this.indices=new Int16Array(t);this.normals=new Float32Array(t.length);this.aabb=new c;this.edges=null;this.scale=new l(1,1,1);this.tree=new o;this.updateEdges();this.updateNormals();this.updateAABB();this.updateBoundingSphereRadius();this.updateTree()}y.prototype=new n;y.prototype.constructor=y;var s=new l;y.prototype.updateTree=function(){var e=this.tree;e.reset();e.aabb.copy(this.aabb);var t=this.scale;e.aabb.lowerBound.x*=1/t.x;e.aabb.lowerBound.y*=1/t.y;e.aabb.lowerBound.z*=1/t.z;e.aabb.upperBound.x*=1/t.x;e.aabb.upperBound.y*=1/t.y;e.aabb.upperBound.z*=1/t.z;var r=new c;var n=new l;var i=new l;var a=new l;var o=[n,i,a];for(var s=0;s<this.indices.length/3;s++){var u=s*3;this._getUnscaledVertex(this.indices[u],n);this._getUnscaledVertex(this.indices[u+1],i);this._getUnscaledVertex(this.indices[u+2],a);r.setFromPoints(o);e.insert(r,s)}e.removeEmptyNodes()};var u=new c;y.prototype.getTrianglesInAABB=function(e,t){u.copy(e);var r=this.scale;var n=r.x;var i=r.y;var a=r.z;var o=u.lowerBound;var s=u.upperBound;o.x/=n;o.y/=i;o.z/=a;s.x/=n;s.y/=i;s.z/=a;return this.tree.aabbQuery(u,t)};y.prototype.setScale=function(e){var t=this.scale.x===this.scale.y===this.scale.z;var r=e.x===e.y===e.z;if(!(t&&r)){this.updateNormals()}this.scale.copy(e);this.updateAABB();this.updateBoundingSphereRadius()};y.prototype.updateNormals=function(){var e=s;var t=this.normals;for(var r=0;r<this.indices.length/3;r++){var n=r*3;var i=this.indices[n],a=this.indices[n+1],o=this.indices[n+2];this.getVertex(i,v);this.getVertex(a,m);this.getVertex(o,g);y.computeNormal(m,v,g,e);t[n]=e.x;t[n+1]=e.y;t[n+2]=e.z}};y.prototype.updateEdges=function(){var n={};var e=function(e,t){var r=i<a?i+"_"+a:a+"_"+i;n[r]=true};for(var t=0;t<this.indices.length/3;t++){var r=t*3;var i=this.indices[r],a=this.indices[r+1],o=this.indices[r+2];e(i,a);e(a,o);e(o,i)}var s=Object.keys(n);this.edges=new Int16Array(s.length*2);for(var t=0;t<s.length;t++){var u=s[t].split("_");this.edges[2*t]=parseInt(u[0],10);this.edges[2*t+1]=parseInt(u[1],10)}};y.prototype.getEdgeVertex=function(e,t,r){var n=this.edges[e*2+(t?1:0)];this.getVertex(n,r)};var h=new l;var f=new l;y.prototype.getEdgeVector=function(e,t){var r=h;var n=f;this.getEdgeVertex(e,0,r);this.getEdgeVertex(e,1,n);n.vsub(r,t)};var d=new l;var p=new l;y.computeNormal=function(e,t,r,n){t.vsub(e,p);r.vsub(t,d);d.cross(p,n);if(!n.isZero()){n.normalize()}};var v=new l;var m=new l;var g=new l;y.prototype.getVertex=function(e,t){var r=this.scale;this._getUnscaledVertex(e,t);t.x*=r.x;t.y*=r.y;t.z*=r.z;return t};y.prototype._getUnscaledVertex=function(e,t){var r=e*3;var n=this.vertices;return t.set(n[r],n[r+1],n[r+2])};y.prototype.getWorldVertex=function(e,t,r,n){this.getVertex(e,n);a.pointToWorldFrame(t,r,n,n);return n};y.prototype.getTriangleVertices=function(e,t,r,n){var i=e*3;this.getVertex(this.indices[i],t);this.getVertex(this.indices[i+1],r);this.getVertex(this.indices[i+2],n)};y.prototype.getNormal=function(e,t){var r=e*3;return t.set(this.normals[r],this.normals[r+1],this.normals[r+2])};var x=new c;y.prototype.calculateLocalInertia=function(e,t){this.computeLocalAABB(x);var r=x.upperBound.x-x.lowerBound.x,n=x.upperBound.y-x.lowerBound.y,i=x.upperBound.z-x.lowerBound.z;return t.set(1/12*e*(2*n*2*n+2*i*2*i),1/12*e*(2*r*2*r+2*i*2*i),1/12*e*(2*n*2*n+2*r*2*r))};var b=new l;y.prototype.computeLocalAABB=function(e){var t=e.lowerBound,r=e.upperBound,n=this.vertices.length,i=this.vertices,a=b;this.getVertex(0,a);t.copy(a);r.copy(a);for(var o=0;o!==n;o++){this.getVertex(o,a);if(a.x<t.x){t.x=a.x}else if(a.x>r.x){r.x=a.x}if(a.y<t.y){t.y=a.y}else if(a.y>r.y){r.y=a.y}if(a.z<t.z){t.z=a.z}else if(a.z>r.z){r.z=a.z}}};y.prototype.updateAABB=function(){this.computeLocalAABB(this.aabb)};y.prototype.updateBoundingSphereRadius=function(){var e=0;var t=this.vertices;var r=new l;for(var n=0,i=t.length/3;n!==i;n++){this.getVertex(n,r);var a=r.norm2();if(a>e){e=a}}this.boundingSphereRadius=Math.sqrt(e)};var w=new l;var _=new a;var T=new c;y.prototype.calculateWorldAABB=function(e,t,r,n){var i=_;var a=T;i.position=e;i.quaternion=t;this.aabb.toWorldFrame(i,a);r.copy(a.lowerBound);n.copy(a.upperBound)};y.prototype.volume=function(){return 4*Math.PI*this.boundingSphereRadius/3};y.createTorus=function(e,t,r,n,i){e=e||1;t=t||.5;r=r||8;n=n||6;i=i||Math.PI*2;var a=[];var o=[];for(var s=0;s<=r;s++){for(var u=0;u<=n;u++){var l=u/n*i;var c=s/r*Math.PI*2;var h=(e+t*Math.cos(c))*Math.cos(l);var f=(e+t*Math.cos(c))*Math.sin(l);var d=t*Math.sin(c);a.push(h,f,d)}}for(var s=1;s<=r;s++){for(var u=1;u<=n;u++){var p=(n+1)*s+u-1;var v=(n+1)*(s-1)+u-1;var m=(n+1)*(s-1)+u;var g=(n+1)*s+u;o.push(p,v,g);o.push(v,m,g)}}return new y(a,o)}},{"../collision/AABB":3,"../math/Quaternion":28,"../math/Transform":29,"../math/Vec3":30,"../utils/Octree":50,"./Shape":43}],46:[function(e,t,r){t.exports=o;var n=e("../math/Vec3");var i=e("../math/Quaternion");var a=e("./Solver");function o(){a.call(this);this.iterations=10;this.tolerance=1e-7}o.prototype=new a;var R=[];var P=[];var C=[];o.prototype.solve=function(e,t){var r=0,n=this.iterations,i=this.tolerance*this.tolerance,a=this.equations,o=a.length,s=t.bodies,u=s.length,l=e,c,h,f,d,p,v,m;if(o!==0){for(var g=0;g!==u;g++){s[g].updateSolveMassProperties()}}var y=P,x=C,b=R;y.length=o;x.length=o;b.length=o;for(var g=0;g!==o;g++){var w=a[g];b[g]=0;x[g]=w.computeB(l);y[g]=1/w.computeC()}if(o!==0){for(var g=0;g!==u;g++){var _=s[g],T=_.vlambda,E=_.wlambda;T.set(0,0,0);if(E){E.set(0,0,0)}}for(r=0;r!==n;r++){p=0;for(var M=0;M!==o;M++){var w=a[M];h=x[M];f=y[M];m=b[M];v=w.computeGWlambda();d=f*(h-v-w.eps*m);if(m+d<w.minForce){d=w.minForce-m}else if(m+d>w.maxForce){d=w.maxForce-m}b[M]+=d;p+=d>0?d:-d;w.addToWlambda(d)}if(p*p<i){break}}for(var g=0;g!==u;g++){var _=s[g],S=_.velocity,A=_.angularVelocity;S.vadd(_.vlambda,S);if(A){A.vadd(_.wlambda,A)}}}return r}},{"../math/Quaternion":28,"../math/Vec3":30,"./Solver":47}],47:[function(e,t,r){t.exports=n;function n(){this.equations=[]}n.prototype.solve=function(e,t){return 0};n.prototype.addEquation=function(e){if(e.enabled){this.equations.push(e)}};n.prototype.removeEquation=function(e){var t=this.equations;var r=t.indexOf(e);if(r!==-1){t.splice(r,1)}};n.prototype.removeAllEquations=function(){this.equations.length=0}},{}],48:[function(e,t,r){t.exports=s;var n=e("../math/Vec3");var i=e("../math/Quaternion");var a=e("./Solver");var o=e("../objects/Body");function s(e){a.call(this);this.iterations=10;this.tolerance=1e-7;this.subsolver=e;this.nodes=[];this.nodePool=[];while(this.nodePool.length<128){this.nodePool.push(this.createNode())}}s.prototype=new a;var _=[];var u=[];var T=[];var l=[];var E={bodies:[]};var c=o.STATIC;function M(e){var t=e.length;for(var r=0;r!==t;r++){var n=e[r];if(!n.visited&&!(n.body.type&c)){return n}}return false}var h=[];function S(e,t,r,n){h.push(e);e.visited=true;t(e,r,n);while(h.length){var i=h.pop();var a;while(a=M(i.children)){a.visited=true;t(a,r,n);h.push(a)}}}function A(e,t,r){t.push(e.body);var n=e.eqs.length;for(var i=0;i!==n;i++){var a=e.eqs[i];if(r.indexOf(a)===-1){r.push(a)}}}s.prototype.createNode=function(){return{body:null,children:[],eqs:[],visited:false}};s.prototype.solve=function(e,t){var r=_,n=this.nodePool,i=t.bodies,a=this.equations,o=a.length,s=i.length,u=this.subsolver;while(n.length<s){n.push(this.createNode())}r.length=s;for(var l=0;l<s;l++){r[l]=n[l]}for(var l=0;l!==s;l++){var c=r[l];c.body=i[l];c.children.length=0;c.eqs.length=0;c.visited=false}for(var h=0;h!==o;h++){var f=a[h],l=i.indexOf(f.bi),d=i.indexOf(f.bj),p=r[l],v=r[d];p.children.push(v);p.eqs.push(f);v.children.push(p);v.eqs.push(f)}var m,g=0,y=T;u.tolerance=this.tolerance;u.iterations=this.iterations;var x=E;while(m=M(r)){y.length=0;x.bodies.length=0;S(m,A,x.bodies,y);var b=y.length;y=y.sort(R);for(var l=0;l!==b;l++){u.addEquation(y[l])}var w=u.solve(e,x);u.removeAllEquations();g++}return g};function R(e,t){return t.id-e.id}},{"../math/Quaternion":28,"../math/Vec3":30,"../objects/Body":31,"./Solver":47}],49:[function(e,t,r){var n=function(){};t.exports=n;n.prototype={constructor:n,addEventListener:function(e,t){if(this._listeners===undefined){this._listeners={}}var r=this._listeners;if(r[e]===undefined){r[e]=[]}if(r[e].indexOf(t)===-1){r[e].push(t)}return this},hasEventListener:function(e,t){if(this._listeners===undefined){return false}var r=this._listeners;if(r[e]!==undefined&&r[e].indexOf(t)!==-1){return true}return false},removeEventListener:function(e,t){if(this._listeners===undefined){return this}var r=this._listeners;if(r[e]===undefined){return this}var n=r[e].indexOf(t);if(n!==-1){r[e].splice(n,1)}return this},dispatchEvent:function(e){if(this._listeners===undefined){return this}var t=this._listeners;var r=t[e.type];if(r!==undefined){e.target=this;for(var n=0,i=r.length;n<i;n++){r[n].call(this,e)}}return this}}},{}],50:[function(e,t,r){var u=e("../collision/AABB");var l=e("../math/Vec3");t.exports=n;function c(e){e=e||{};this.root=e.root||null;this.aabb=e.aabb?e.aabb.clone():new u;this.data=[];this.children=[]}function n(e,t){t=t||{};t.root=null;t.aabb=e;c.call(this,t);this.maxDepth=typeof t.maxDepth!=="undefined"?t.maxDepth:8}n.prototype=new c;c.prototype.reset=function(e,t){this.children.length=this.data.length=0};c.prototype.insert=function(e,t,r){var n=this.data;r=r||0;if(!this.aabb.contains(e)){return false}var i=this.children;if(r<(this.maxDepth||this.root.maxDepth)){var a=false;if(!i.length){this.subdivide();a=true}for(var o=0;o!==8;o++){if(i[o].insert(e,t,r+1)){return true}}if(a){i.length=0}}n.push(t);return true};var h=new l;c.prototype.subdivide=function(){var e=this.aabb;var t=e.lowerBound;var r=e.upperBound;var n=this.children;n.push(new c({aabb:new u({lowerBound:new l(0,0,0)})}),new c({aabb:new u({lowerBound:new l(1,0,0)})}),new c({aabb:new u({lowerBound:new l(1,1,0)})}),new c({aabb:new u({lowerBound:new l(1,1,1)})}),new c({aabb:new u({lowerBound:new l(0,1,1)})}),new c({aabb:new u({lowerBound:new l(0,0,1)})}),new c({aabb:new u({lowerBound:new l(1,0,1)})}),new c({aabb:new u({lowerBound:new l(0,1,0)})}));r.vsub(t,h);h.scale(.5,h);var i=this.root||this;for(var a=0;a!==8;a++){var o=n[a];o.root=i;var s=o.aabb.lowerBound;s.x*=h.x;s.y*=h.y;s.z*=h.z;s.vadd(t,s);s.vadd(h,o.aabb.upperBound)}};c.prototype.aabbQuery=function(e,t){var r=this.data;var n=this.children;var i=[this];while(i.length){var a=i.pop();if(a.aabb.overlaps(e)){Array.prototype.push.apply(t,a.data)}Array.prototype.push.apply(i,a.children)}return t};var i=new u;c.prototype.rayQuery=function(e,t,r){e.getAABB(i);i.toLocalFrame(t,i);this.aabbQuery(i,r);return r};c.prototype.removeEmptyNodes=function(){var e=[this];while(e.length){var t=e.pop();for(var r=t.children.length-1;r>=0;r--){if(!t.children[r].data.length){t.children.splice(r,1)}}Array.prototype.push.apply(e,t.children)}}},{"../collision/AABB":3,"../math/Vec3":30}],51:[function(e,t,r){t.exports=n;function n(){this.objects=[];this.type=Object}n.prototype.release=function(){var e=arguments.length;for(var t=0;t!==e;t++){this.objects.push(arguments[t])}};n.prototype.get=function(){if(this.objects.length===0){return this.constructObject()}else{return this.objects.pop()}};n.prototype.constructObject=function(){throw new Error("constructObject() not implemented in this Pool subclass yet!")}},{}],52:[function(e,t,r){t.exports=n;function n(){this.data={keys:[]}}n.prototype.get=function(e,t){if(e>t){var r=t;t=e;e=r}return this.data[e+"-"+t]};n.prototype.set=function(e,t,r){if(e>t){var n=t;t=e;e=n}var i=e+"-"+t;if(!this.get(e,t)){this.data.keys.push(i)}this.data[i]=r};n.prototype.reset=function(){var e=this.data,t=e.keys;while(t.length>0){var r=t.pop();delete e[r]}}},{}],53:[function(e,t,r){function n(){}t.exports=n;n.defaults=function(e,t){e=e||{};for(var r in t){if(!(r in e)){e[r]=t[r]}}return e}},{}],54:[function(e,t,r){t.exports=a;var n=e("../math/Vec3");var i=e("./Pool");function a(){i.call(this);this.type=n}a.prototype=new i;a.prototype.constructObject=function(){return new n}},{"../math/Vec3":30,"./Pool":51}],55:[function(e,t,r){t.exports=l;var n=e("../collision/AABB");var i=e("../shapes/Shape");var L=e("../collision/Ray");var m=e("../math/Vec3");var I=e("../math/Transform");var a=e("../shapes/ConvexPolyhedron");var o=e("../math/Quaternion");var s=e("../solver/Solver");var u=e("../utils/Vec3Pool");var c=e("../equations/ContactEquation");var g=e("../equations/FrictionEquation");function l(e){this.contactPointPool=[];this.frictionEquationPool=[];this.result=[];this.frictionResult=[];this.v3pool=new u;this.world=e;this.currentContactMaterial=null;this.enableFrictionReduction=false}l.prototype.createContactEquation=function(e,t,r,n,i,a){var o;if(this.contactPointPool.length){o=this.contactPointPool.pop();o.bi=e;o.bj=t}else{o=new c(e,t)}o.enabled=e.collisionResponse&&t.collisionResponse&&r.collisionResponse&&n.collisionResponse;var s=this.currentContactMaterial;o.restitution=s.restitution;o.setSpookParams(s.contactEquationStiffness,s.contactEquationRelaxation,this.world.dt);var u=r.material||e.material;var l=n.material||t.material;if(u&&l&&u.restitution>=0&&l.restitution>=0){o.restitution=u.restitution*l.restitution}o.si=i||r;o.sj=a||n;return o};l.prototype.createFrictionEquationsFromContact=function(e,t){var r=e.bi;var n=e.bj;var i=e.si;var a=e.sj;var o=this.world;var s=this.currentContactMaterial;var u=s.friction;var l=i.material||r.material;var c=a.material||n.material;if(l&&c&&l.friction>=0&&c.friction>=0){u=l.friction*c.friction}if(u>0){var h=u*o.gravity.length();var f=r.invMass+n.invMass;if(f>0){f=1/f}var d=this.frictionEquationPool;var p=d.length?d.pop():new g(r,n,h*f);var v=d.length?d.pop():new g(r,n,h*f);p.bi=v.bi=r;p.bj=v.bj=n;p.minForce=v.minForce=-h*f;p.maxForce=v.maxForce=h*f;p.ri.copy(e.ri);p.rj.copy(e.rj);v.ri.copy(e.ri);v.rj.copy(e.rj);e.ni.tangents(p.t,v.t);p.setSpookParams(s.frictionEquationStiffness,s.frictionEquationRelaxation,o.dt);v.setSpookParams(s.frictionEquationStiffness,s.frictionEquationRelaxation,o.dt);p.enabled=v.enabled=e.enabled;t.push(p,v);return true}return false};var h=new m;var f=new m;var d=new m;l.prototype.createFrictionFromAverage=function(e){var t=this.result[this.result.length-1];if(!this.createFrictionEquationsFromContact(t,this.frictionResult)||e===1){return}var r=this.frictionResult[this.frictionResult.length-2];var n=this.frictionResult[this.frictionResult.length-1];h.setZero();f.setZero();d.setZero();var i=t.bi;var a=t.bj;for(var o=0;o!==e;o++){t=this.result[this.result.length-1-o];if(t.bodyA!==i){h.vadd(t.ni,h);f.vadd(t.ri,f);d.vadd(t.rj,d)}else{h.vsub(t.ni,h);f.vadd(t.rj,f);d.vadd(t.ri,d)}}var s=1/e;f.scale(s,r.ri);d.scale(s,r.rj);n.ri.copy(r.ri);n.rj.copy(r.rj);h.normalize();h.tangents(r.t,n.t)};var _=new m;var T=new m;var E=new o;var M=new o;l.prototype.getContacts=function(e,t,r,n,i,a,o){this.contactPointPool=i;this.frictionEquationPool=o;this.result=n;this.frictionResult=a;var s=E;var u=M;var l=_;var c=T;for(var h=0,f=e.length;h!==f;h++){var d=e[h],p=t[h];var v=null;if(d.material&&p.material){v=r.getContactMaterial(d.material,p.material)||null}for(var m=0;m<d.shapes.length;m++){d.quaternion.mult(d.shapeOrientations[m],s);d.quaternion.vmult(d.shapeOffsets[m],l);l.vadd(d.position,l);var g=d.shapes[m];for(var y=0;y<p.shapes.length;y++){p.quaternion.mult(p.shapeOrientations[y],u);p.quaternion.vmult(p.shapeOffsets[y],c);c.vadd(p.position,c);var x=p.shapes[y];if(l.distanceTo(c)>g.boundingSphereRadius+x.boundingSphereRadius){continue}var b=null;if(g.material&&x.material){b=r.getContactMaterial(g.material,x.material)||null}this.currentContactMaterial=b||v||r.defaultContactMaterial;var w=this[g.type|x.type];if(w){if(g.type<x.type){w.call(this,g,x,l,c,s,u,d,p,g,x)}else{w.call(this,x,g,c,l,u,s,p,d,g,x)}}}}}};var p=0;var v=10;function y(e){if(p>v){return}p++;console.warn(e)}l.prototype[i.types.BOX|i.types.BOX]=l.prototype.boxBox=function(e,t,r,n,i,a,o,s){e.convexPolyhedronRepresentation.material=e.material;t.convexPolyhedronRepresentation.material=t.material;e.convexPolyhedronRepresentation.collisionResponse=e.collisionResponse;t.convexPolyhedronRepresentation.collisionResponse=t.collisionResponse;this.convexConvex(e.convexPolyhedronRepresentation,t.convexPolyhedronRepresentation,r,n,i,a,o,s,e,t)};l.prototype[i.types.BOX|i.types.CONVEXPOLYHEDRON]=l.prototype.boxConvex=function(e,t,r,n,i,a,o,s){e.convexPolyhedronRepresentation.material=e.material;e.convexPolyhedronRepresentation.collisionResponse=e.collisionResponse;this.convexConvex(e.convexPolyhedronRepresentation,t,r,n,i,a,o,s,e,t)};l.prototype[i.types.BOX|i.types.PARTICLE]=l.prototype.boxParticle=function(e,t,r,n,i,a,o,s){e.convexPolyhedronRepresentation.material=e.material;e.convexPolyhedronRepresentation.collisionResponse=e.collisionResponse;this.convexParticle(e.convexPolyhedronRepresentation,t,r,n,i,a,o,s,e,t)};l.prototype[i.types.SPHERE]=l.prototype.sphereSphere=function(e,t,r,n,i,a,o,s){var u=this.createContactEquation(o,s,e,t);n.vsub(r,u.ni);u.ni.normalize();u.ri.copy(u.ni);u.rj.copy(u.ni);u.ri.mult(e.radius,u.ri);u.rj.mult(-t.radius,u.rj);u.ri.vadd(r,u.ri);u.ri.vsub(o.position,u.ri);u.rj.vadd(n,u.rj);u.rj.vsub(s.position,u.rj);this.result.push(u);this.createFrictionEquationsFromContact(u,this.frictionResult)};var x=new m;var b=new m;var w=new m;l.prototype[i.types.PLANE|i.types.TRIMESH]=l.prototype.planeTrimesh=function(e,t,r,n,i,a,o,s){var u=new m;var l=x;l.set(0,0,1);i.vmult(l,l);for(var c=0;c<t.vertices.length/3;c++){t.getVertex(c,u);var h=new m;h.copy(u);I.pointToWorldFrame(n,a,h,u);var f=b;u.vsub(r,f);var d=l.dot(f);if(d<=0){var p=this.createContactEquation(o,s,e,t);p.ni.copy(l);var v=w;l.scale(f.dot(l),v);u.vsub(v,v);p.ri.copy(v);p.ri.vsub(o.position,p.ri);p.rj.copy(u);p.rj.vsub(s.position,p.rj);this.result.push(p);this.createFrictionEquationsFromContact(p,this.frictionResult)}}};var D=new m;var N=new m;var S=new m;var F=new m;var B=new m;var U=new m;var k=new m;var j=new m;var z=new m;var H=new m;var G=new m;var V=new m;var W=new m;var q=new m;var X=new n;var Y=[];l.prototype[i.types.SPHERE|i.types.TRIMESH]=l.prototype.sphereTrimesh=function(e,t,r,n,i,a,o,s){var u=U;var l=k;var c=j;var h=z;var f=H;var d=G;var p=X;var v=B;var m=N;var g=Y;I.pointToLocalFrame(n,a,r,f);var y=e.radius;p.lowerBound.set(f.x-y,f.y-y,f.z-y);p.upperBound.set(f.x+y,f.y+y,f.z+y);t.getTrianglesInAABB(p,g);var x=F;var b=e.radius*e.radius;for(var w=0;w<g.length;w++){for(var _=0;_<3;_++){t.getVertex(t.indices[g[w]*3+_],x);x.vsub(f,m);if(m.norm2()<=b){v.copy(x);I.pointToWorldFrame(n,a,v,x);x.vsub(r,m);var T=this.createContactEquation(o,s,e,t);T.ni.copy(m);T.ni.normalize();T.ri.copy(T.ni);T.ri.scale(e.radius,T.ri);T.ri.vadd(r,T.ri);T.ri.vsub(o.position,T.ri);T.rj.copy(x);T.rj.vsub(s.position,T.rj);this.result.push(T);this.createFrictionEquationsFromContact(T,this.frictionResult)}}}for(var w=0;w<g.length;w++){for(var _=0;_<3;_++){t.getVertex(t.indices[g[w]*3+_],u);t.getVertex(t.indices[g[w]*3+(_+1)%3],l);l.vsub(u,c);f.vsub(l,d);var E=d.dot(c);f.vsub(u,d);var M=d.dot(c);if(M>0&&E<0){f.vsub(u,d);h.copy(c);h.normalize();M=d.dot(h);h.scale(M,d);d.vadd(u,d);var S=d.distanceTo(f);if(S<e.radius){var T=this.createContactEquation(o,s,e,t);d.vsub(f,T.ni);T.ni.normalize();T.ni.scale(e.radius,T.ri);I.pointToWorldFrame(n,a,d,d);d.vsub(s.position,T.rj);I.vectorToWorldFrame(a,T.ni,T.ni);I.vectorToWorldFrame(a,T.ri,T.ri);this.result.push(T);this.createFrictionEquationsFromContact(T,this.frictionResult)}}}}var A=V;var R=W;var P=q;var C=D;for(var w=0,O=g.length;w!==O;w++){t.getTriangleVertices(g[w],A,R,P);t.getNormal(g[w],C);f.vsub(A,d);var S=d.dot(C);C.scale(S,d);f.vsub(d,d);S=d.distanceTo(f);if(L.pointInTriangle(d,A,R,P)&&S<e.radius){var T=this.createContactEquation(o,s,e,t);d.vsub(f,T.ni);T.ni.normalize();T.ni.scale(e.radius,T.ri);I.pointToWorldFrame(n,a,d,d);d.vsub(s.position,T.rj);I.vectorToWorldFrame(a,T.ni,T.ni);I.vectorToWorldFrame(a,T.ri,T.ri);this.result.push(T);this.createFrictionEquationsFromContact(T,this.frictionResult)}}g.length=0};var A=new m;var R=new m;l.prototype[i.types.SPHERE|i.types.PLANE]=l.prototype.spherePlane=function(e,t,r,n,i,a,o,s){var u=this.createContactEquation(o,s,e,t);u.ni.set(0,0,1);a.vmult(u.ni,u.ni);u.ni.negate(u.ni);u.ni.normalize();u.ni.mult(e.radius,u.ri);r.vsub(n,A);u.ni.mult(u.ni.dot(A),R);A.vsub(R,u.rj);if(-A.dot(u.ni)<=e.radius){var l=u.ri;var c=u.rj;l.vadd(r,l);l.vsub(o.position,l);c.vadd(n,c);c.vsub(s.position,c);this.result.push(u);this.createFrictionEquationsFromContact(u,this.frictionResult)}};var P=new m;var C=new m;var O=new m;function Z(e,t,r){var n=null;var i=e.length;for(var a=0;a!==i;a++){var o=e[a];var s=P;e[(a+1)%i].vsub(o,s);var u=C;s.cross(t,u);var l=O;r.vsub(o,l);var c=u.dot(l);if(n===null||c>0&&n===true||c<=0&&n===false){if(n===null){n=c>0}continue}else{return false}}return true}var J=new m;var K=new m;var Q=new m;var $=new m;var ee=[new m,new m,new m,new m,new m,new m];var te=new m;var re=new m;var ne=new m;var ie=new m;l.prototype[i.types.SPHERE|i.types.BOX]=l.prototype.sphereBox=function(e,t,r,n,i,a,o,s){var u=this.v3pool;var l=ee;r.vsub(n,J);t.getSideNormals(l,a);var c=e.radius;var h=[];var f=false;var d=re;var p=ne;var v=ie;var m=null;var g=0;var y=0;var x=0;var b=null;for(var w=0,_=l.length;w!==_&&f===false;w++){var T=K;T.copy(l[w]);var E=T.norm();T.normalize();var M=J.dot(T);if(M<E+c&&M>0){var S=Q;var A=$;S.copy(l[(w+1)%3]);A.copy(l[(w+2)%3]);var R=S.norm();var P=A.norm();S.normalize();A.normalize();var C=J.dot(S);var O=J.dot(A);if(C<R&&C>-R&&O<P&&O>-P){var L=Math.abs(M-E-c);if(b===null||L<b){b=L;y=C;x=O;m=E;d.copy(T);p.copy(S);v.copy(A);g++}}}}if(g){f=true;var I=this.createContactEquation(o,s,e,t);d.mult(-c,I.ri);I.ni.copy(d);I.ni.negate(I.ni);d.mult(m,d);p.mult(y,p);d.vadd(p,d);v.mult(x,v);d.vadd(v,I.rj);I.ri.vadd(r,I.ri);I.ri.vsub(o.position,I.ri);I.rj.vadd(n,I.rj);I.rj.vsub(s.position,I.rj);this.result.push(I);this.createFrictionEquationsFromContact(I,this.frictionResult)}var D=u.get();var N=te;for(var F=0;F!==2&&!f;F++){for(var B=0;B!==2&&!f;B++){for(var U=0;U!==2&&!f;U++){D.set(0,0,0);if(F){D.vadd(l[0],D)}else{D.vsub(l[0],D)}if(B){D.vadd(l[1],D)}else{D.vsub(l[1],D)}if(U){D.vadd(l[2],D)}else{D.vsub(l[2],D)}n.vadd(D,N);N.vsub(r,N);if(N.norm2()<c*c){f=true;var I=this.createContactEquation(o,s,e,t);I.ri.copy(N);I.ri.normalize();I.ni.copy(I.ri);I.ri.mult(c,I.ri);I.rj.copy(D);I.ri.vadd(r,I.ri);I.ri.vsub(o.position,I.ri);I.rj.vadd(n,I.rj);I.rj.vsub(s.position,I.rj);this.result.push(I);this.createFrictionEquationsFromContact(I,this.frictionResult)}}}}u.release(D);D=null;var k=u.get();var j=u.get();var I=u.get();var z=u.get();var L=u.get();var H=l.length;for(var F=0;F!==H&&!f;F++){for(var B=0;B!==H&&!f;B++){if(F%3!==B%3){l[B].cross(l[F],k);k.normalize();l[F].vadd(l[B],j);I.copy(r);I.vsub(j,I);I.vsub(n,I);var G=I.dot(k);k.mult(G,z);var U=0;while(U===F%3||U===B%3){U++}L.copy(r);L.vsub(z,L);L.vsub(j,L);L.vsub(n,L);var V=Math.abs(G);var W=L.norm();if(V<l[U].norm()&&W<c){f=true;var q=this.createContactEquation(o,s,e,t);j.vadd(z,q.rj);q.rj.copy(q.rj);L.negate(q.ni);q.ni.normalize();q.ri.copy(q.rj);q.ri.vadd(n,q.ri);q.ri.vsub(r,q.ri);q.ri.normalize();q.ri.mult(c,q.ri);q.ri.vadd(r,q.ri);q.ri.vsub(o.position,q.ri);q.rj.vadd(n,q.rj);q.rj.vsub(s.position,q.rj);this.result.push(q);this.createFrictionEquationsFromContact(q,this.frictionResult)}}}}u.release(k,j,I,z,L)};var ae=new m;var oe=new m;var se=new m;var ue=new m;var le=new m;var ce=new m;var he=new m;var fe=new m;var de=new m;var pe=new m;l.prototype[i.types.SPHERE|i.types.CONVEXPOLYHEDRON]=l.prototype.sphereConvex=function(e,t,r,n,i,a,o,s){var u=this.v3pool;r.vsub(n,ae);var l=t.faceNormals;var c=t.faces;var h=t.vertices;var f=e.radius;var d=[];for(var p=0;p!==h.length;p++){var v=h[p];var m=le;a.vmult(v,m);n.vadd(m,m);var g=ue;m.vsub(r,g);if(g.norm2()<f*f){x=true;var y=this.createContactEquation(o,s,e,t);y.ri.copy(g);y.ri.normalize();y.ni.copy(y.ri);y.ri.mult(f,y.ri);m.vsub(n,y.rj);y.ri.vadd(r,y.ri);y.ri.vsub(o.position,y.ri);y.rj.vadd(n,y.rj);y.rj.vsub(s.position,y.rj);this.result.push(y);this.createFrictionEquationsFromContact(y,this.frictionResult);return}}var x=false;for(var p=0,b=c.length;p!==b&&x===false;p++){var w=l[p];var _=c[p];var T=ce;a.vmult(w,T);var E=he;a.vmult(h[_[0]],E);E.vadd(n,E);var M=fe;T.mult(-f,M);r.vadd(M,M);var S=de;M.vsub(E,S);var A=S.dot(T);var R=pe;r.vsub(E,R);if(A<0&&R.dot(T)>0){var P=[];for(var C=0,O=_.length;C!==O;C++){var L=u.get();a.vmult(h[_[C]],L);n.vadd(L,L);P.push(L)}if(Z(P,T,r)){x=true;var y=this.createContactEquation(o,s,e,t);T.mult(-f,y.ri);T.negate(y.ni);var I=u.get();T.mult(-A,I);var D=u.get();T.mult(-f,D);r.vsub(n,y.rj);y.rj.vadd(D,y.rj);y.rj.vadd(I,y.rj);y.rj.vadd(n,y.rj);y.rj.vsub(s.position,y.rj);y.ri.vadd(r,y.ri);y.ri.vsub(o.position,y.ri);u.release(I);u.release(D);this.result.push(y);this.createFrictionEquationsFromContact(y,this.frictionResult);for(var C=0,N=P.length;C!==N;C++){u.release(P[C])}return}else{for(var C=0;C!==_.length;C++){var F=u.get();var B=u.get();a.vmult(h[_[(C+1)%_.length]],F);a.vmult(h[_[(C+2)%_.length]],B);n.vadd(F,F);n.vadd(B,B);var U=oe;B.vsub(F,U);var k=se;U.unit(k);var j=u.get();var z=u.get();r.vsub(F,z);var H=z.dot(k);k.mult(H,j);j.vadd(F,j);var G=u.get();j.vsub(r,G);if(H>0&&H*H<U.norm2()&&G.norm2()<f*f){var y=this.createContactEquation(o,s,e,t);j.vsub(n,y.rj);j.vsub(r,y.ni);y.ni.normalize();y.ni.mult(f,y.ri);y.rj.vadd(n,y.rj);y.rj.vsub(s.position,y.rj);y.ri.vadd(r,y.ri);y.ri.vsub(o.position,y.ri);this.result.push(y);this.createFrictionEquationsFromContact(y,this.frictionResult);for(var C=0,N=P.length;C!==N;C++){u.release(P[C])}u.release(F);u.release(B);u.release(j);u.release(G);u.release(z);return}u.release(F);u.release(B);u.release(j);u.release(G);u.release(z)}}for(var C=0,N=P.length;C!==N;C++){u.release(P[C])}}}};var ve=new m;var me=new m;l.prototype[i.types.PLANE|i.types.BOX]=l.prototype.planeBox=function(e,t,r,n,i,a,o,s){t.convexPolyhedronRepresentation.material=t.material;t.convexPolyhedronRepresentation.collisionResponse=t.collisionResponse;this.planeConvex(e,t.convexPolyhedronRepresentation,r,n,i,a,o,s)};var ge=new m;var ye=new m;var xe=new m;var be=new m;l.prototype[i.types.PLANE|i.types.CONVEXPOLYHEDRON]=l.prototype.planeConvex=function(e,t,r,n,i,a,o,s){var u=ge,l=ye;l.set(0,0,1);i.vmult(l,l);var c=0;var h=xe;for(var f=0;f!==t.vertices.length;f++){u.copy(t.vertices[f]);a.vmult(u,u);n.vadd(u,u);u.vsub(r,h);var d=l.dot(h);if(d<=0){var p=this.createContactEquation(o,s,e,t);var v=be;l.mult(l.dot(h),v);u.vsub(v,v);v.vsub(r,p.ri);p.ni.copy(l);u.vsub(n,p.rj);p.ri.vadd(r,p.ri);p.ri.vsub(o.position,p.ri);p.rj.vadd(n,p.rj);p.rj.vsub(s.position,p.rj);this.result.push(p);c++;if(!this.enableFrictionReduction){this.createFrictionEquationsFromContact(p,this.frictionResult)}}}if(this.enableFrictionReduction&&c){this.createFrictionFromAverage(c)}};var we=new m;var _e=new m;l.prototype[i.types.CONVEXPOLYHEDRON]=l.prototype.convexConvex=function(e,t,r,n,i,a,o,s,u,l,c,h){var f=we;if(r.distanceTo(n)>e.boundingSphereRadius+t.boundingSphereRadius){return}if(e.findSeparatingAxis(t,r,i,n,a,f,c,h)){var d=[];var p=_e;e.clipAgainstHull(r,i,t,n,a,f,-100,100,d);var v=0;for(var m=0;m!==d.length;m++){var g=this.createContactEquation(o,s,e,t,u,l),y=g.ri,x=g.rj;f.negate(g.ni);d[m].normal.negate(p);p.mult(d[m].depth,p);d[m].point.vadd(p,y);x.copy(d[m].point);y.vsub(r,y);x.vsub(n,x);y.vadd(r,y);y.vsub(o.position,y);x.vadd(n,x);x.vsub(s.position,x);this.result.push(g);v++;if(!this.enableFrictionReduction){this.createFrictionEquationsFromContact(g,this.frictionResult)}}if(this.enableFrictionReduction&&v){this.createFrictionFromAverage(v)}}};var Te=new m;var Ee=new m;var Me=new m;l.prototype[i.types.PLANE|i.types.PARTICLE]=l.prototype.planeParticle=function(e,t,r,n,i,a,o,s){var u=Te;u.set(0,0,1);o.quaternion.vmult(u,u);var l=Ee;n.vsub(o.position,l);var c=u.dot(l);if(c<=0){var h=this.createContactEquation(s,o,t,e);h.ni.copy(u);h.ni.negate(h.ni);h.ri.set(0,0,0);var f=Me;u.mult(u.dot(n),f);n.vsub(f,f);h.rj.copy(f);this.result.push(h);this.createFrictionEquationsFromContact(h,this.frictionResult)}};var Se=new m;l.prototype[i.types.PARTICLE|i.types.SPHERE]=l.prototype.sphereParticle=function(e,t,r,n,i,a,o,s){var u=Se;u.set(0,0,1);n.vsub(r,u);var l=u.norm2();if(l<=e.radius*e.radius){var c=this.createContactEquation(s,o,t,e);u.normalize();c.rj.copy(u);c.rj.mult(e.radius,c.rj);c.ni.copy(u);c.ni.negate(c.ni);c.ri.set(0,0,0);this.result.push(c);this.createFrictionEquationsFromContact(c,this.frictionResult)}};var Ae=new o;var Re=new m;var Pe=new m;var Ce=new m;var Oe=new m;var Le=new m;l.prototype[i.types.PARTICLE|i.types.CONVEXPOLYHEDRON]=l.prototype.convexParticle=function(e,t,r,n,i,a,o,s){var u=-1;var l=Ce;var c=Le;var h=null;var f=0;var d=Re;d.copy(n);d.vsub(r,d);i.conjugate(Ae);Ae.vmult(d,d);if(e.pointIsInside(d)){if(e.worldVerticesNeedsUpdate){e.computeWorldVertices(r,i)}if(e.worldFaceNormalsNeedsUpdate){e.computeWorldFaceNormals(i)}for(var p=0,v=e.faces.length;p!==v;p++){var m=[e.worldVertices[e.faces[p][0]]];var g=e.worldFaceNormals[p];n.vsub(m[0],Oe);var y=-g.dot(Oe);if(h===null||Math.abs(y)<Math.abs(h)){h=y;u=p;l.copy(g);f++}}if(u!==-1){var x=this.createContactEquation(s,o,t,e);l.mult(h,c);c.vadd(n,c);c.vsub(r,c);x.rj.copy(c);l.negate(x.ni);x.ri.set(0,0,0);var b=x.ri,w=x.rj;b.vadd(n,b);b.vsub(s.position,b);w.vadd(r,w);w.vsub(o.position,w);this.result.push(x);this.createFrictionEquationsFromContact(x,this.frictionResult)}else{console.warn("Point found inside convex, but did not find penetrating face!")}}};l.prototype[i.types.BOX|i.types.HEIGHTFIELD]=l.prototype.boxHeightfield=function(e,t,r,n,i,a,o,s){e.convexPolyhedronRepresentation.material=e.material;e.convexPolyhedronRepresentation.collisionResponse=e.collisionResponse;this.convexHeightfield(e.convexPolyhedronRepresentation,t,r,n,i,a,o,s)};var Ie=new m;var De=new m;var Ne=[0];l.prototype[i.types.CONVEXPOLYHEDRON|i.types.HEIGHTFIELD]=l.prototype.convexHeightfield=function(e,t,r,n,i,a,o,s){var u=t.data,l=t.elementSize,c=e.boundingSphereRadius,h=De,f=Ne;var d=Ie;I.pointToLocalFrame(n,a,r,d);var p=Math.floor((d.x-c)/l)-1,v=Math.ceil((d.x+c)/l)+1,m=Math.floor((d.y-c)/l)-1,g=Math.ceil((d.y+c)/l)+1;if(v<0||g<0||p>u.length||m>u[0].length){return}if(p<0){p=0}if(v<0){v=0}if(m<0){m=0}if(g<0){g=0}if(p>=u.length){p=u.length-1}if(v>=u.length){v=u.length-1}if(g>=u[0].length){g=u[0].length-1}if(m>=u[0].length){m=u[0].length-1}var y=[];t.getRectMinMax(p,m,v,g,y);var x=y[0];var b=y[1];if(d.z-c>b||d.z+c<x){return}for(var w=p;w<v;w++){for(var _=m;_<g;_++){t.getConvexTrianglePillar(w,_,false);I.pointToWorldFrame(n,a,t.pillarOffset,h);if(r.distanceTo(h)<t.pillarConvex.boundingSphereRadius+e.boundingSphereRadius){this.convexConvex(e,t.pillarConvex,r,h,i,a,o,s,null,null,f,null)}t.getConvexTrianglePillar(w,_,true);I.pointToWorldFrame(n,a,t.pillarOffset,h);if(r.distanceTo(h)<t.pillarConvex.boundingSphereRadius+e.boundingSphereRadius){this.convexConvex(e,t.pillarConvex,r,h,i,a,o,s,null,null,f,null)}}}};var Fe=new m;var Be=new m;l.prototype[i.types.SPHERE|i.types.HEIGHTFIELD]=l.prototype.sphereHeightfield=function(e,t,r,n,i,a,o,s){var u=t.data,l=e.radius,c=t.elementSize,h=Be;var f=Fe;I.pointToLocalFrame(n,a,r,f);var d=Math.floor((f.x-l)/c)-1,p=Math.ceil((f.x+l)/c)+1,v=Math.floor((f.y-l)/c)-1,m=Math.ceil((f.y+l)/c)+1;if(p<0||m<0||d>u.length||m>u[0].length){return}if(d<0){d=0}if(p<0){p=0}if(v<0){v=0}if(m<0){m=0}if(d>=u.length){d=u.length-1}if(p>=u.length){p=u.length-1}if(m>=u[0].length){m=u[0].length-1}if(v>=u[0].length){v=u[0].length-1}var g=[];t.getRectMinMax(d,v,p,m,g);var y=g[0];var x=g[1];if(f.z-l>x||f.z+l<y){return}var b=this.result;for(var w=d;w<p;w++){for(var _=v;_<m;_++){var T=b.length;t.getConvexTrianglePillar(w,_,false);I.pointToWorldFrame(n,a,t.pillarOffset,h);if(r.distanceTo(h)<t.pillarConvex.boundingSphereRadius+e.boundingSphereRadius){this.sphereConvex(e,t.pillarConvex,r,h,i,a,o,s)}t.getConvexTrianglePillar(w,_,true);I.pointToWorldFrame(n,a,t.pillarOffset,h);if(r.distanceTo(h)<t.pillarConvex.boundingSphereRadius+e.boundingSphereRadius){this.sphereConvex(e,t.pillarConvex,r,h,i,a,o,s)}var E=b.length-T;if(E>2){return}}}}},{"../collision/AABB":3,"../collision/Ray":9,"../equations/ContactEquation":19,"../equations/FrictionEquation":21,"../math/Quaternion":28,"../math/Transform":29,"../math/Vec3":30,"../shapes/ConvexPolyhedron":38,"../shapes/Shape":43,"../solver/Solver":47,"../utils/Vec3Pool":54}],56:[function(e,t,r){t.exports=x;var ve=e("../shapes/Shape");var n=e("../math/Vec3");var i=e("../math/Quaternion");var a=e("../solver/GSSolver");var o=e("../utils/Vec3Pool");var s=e("../equations/ContactEquation");var u=e("../equations/FrictionEquation");var l=e("./Narrowphase");var c=e("../utils/EventTarget");var h=e("../collision/ArrayCollisionMatrix");var f=e("../material/Material");var d=e("../material/ContactMaterial");var me=e("../objects/Body");var p=e("../utils/TupleDictionary");var v=e("../collision/RaycastResult");var m=e("../collision/AABB");var g=e("../collision/Ray");var y=e("../collision/NaiveBroadphase");function x(){c.apply(this);this.dt=-1;this.allowSleep=false;this.contacts=[];this.frictionEquations=[];this.quatNormalizeSkip=0;this.quatNormalizeFast=false;this.time=0;this.stepnumber=0;this.default_dt=1/60;this.nextId=0;this.gravity=new n;this.broadphase=new y;this.bodies=[];this.solver=new a;this.constraints=[];this.narrowphase=new l(this);this.collisionMatrix=new h;this.collisionMatrixPrevious=new h;this.materials=[];this.contactmaterials=[];this.contactMaterialTable=new p;this.defaultMaterial=new f("default");this.defaultContactMaterial=new d(this.defaultMaterial,this.defaultMaterial,{friction:.3,restitution:0});this.doProfiling=false;this.profile={solve:0,makeContactConstraints:0,broadphase:0,integrate:0,narrowphase:0};this.subsystems=[];this.addBodyEvent={type:"addBody",body:null};this.removeBodyEvent={type:"removeBody",body:null}}x.prototype=new c;var b=new m;var w=[];var _=new g;x.prototype.getContactMaterial=function(e,t){return this.contactMaterialTable.get(e.id,t.id)};x.prototype.numObjects=function(){return this.bodies.length};x.prototype.collisionMatrixTick=function(){var e=this.collisionMatrixPrevious;this.collisionMatrixPrevious=this.collisionMatrix;this.collisionMatrix=e;this.collisionMatrix.reset()};x.prototype.add=x.prototype.addBody=function(e){if(this.bodies.indexOf(e)!==-1){return}e.index=this.bodies.length;this.bodies.push(e);e.world=this;e.initPosition.copy(e.position);e.initVelocity.copy(e.velocity);e.timeLastSleepy=this.time;if(e instanceof me){e.initAngularVelocity.copy(e.angularVelocity);e.initQuaternion.copy(e.quaternion)}this.collisionMatrix.setNumObjects(this.bodies.length);this.addBodyEvent.body=e;this.dispatchEvent(this.addBodyEvent)};x.prototype.addConstraint=function(e){this.constraints.push(e)};x.prototype.removeConstraint=function(e){var t=this.constraints.indexOf(e);if(t!==-1){this.constraints.splice(t,1)}};x.prototype.rayTest=function(e,t,r){if(r instanceof v){this.raycastClosest(e,t,{skipBackfaces:true},r)}else{this.raycastAll(e,t,{skipBackfaces:true},r)}};x.prototype.raycastAll=function(e,t,r,n){r.mode=g.ALL;r.from=e;r.to=t;r.callback=n;return _.intersectWorld(this,r)};x.prototype.raycastAny=function(e,t,r,n){r.mode=g.ANY;r.from=e;r.to=t;r.result=n;return _.intersectWorld(this,r)};x.prototype.raycastClosest=function(e,t,r,n){r.mode=g.CLOSEST;r.from=e;r.to=t;r.result=n;return _.intersectWorld(this,r)};x.prototype.remove=function(e){e.world=null;var t=this.bodies.length-1,r=this.bodies,n=r.indexOf(e);if(n!==-1){r.splice(n,1);for(var i=0;i!==r.length;i++){r[i].index=i}this.collisionMatrix.setNumObjects(t);this.removeBodyEvent.body=e;this.dispatchEvent(this.removeBodyEvent)}};x.prototype.removeBody=x.prototype.remove;x.prototype.addMaterial=function(e){this.materials.push(e)};x.prototype.addContactMaterial=function(e){this.contactmaterials.push(e);this.contactMaterialTable.set(e.materials[0].id,e.materials[1].id,e)};if(typeof performance==="undefined"){performance={}}if(!performance.now){var T=Date.now();if(performance.timing&&performance.timing.navigationStart){T=performance.timing.navigationStart}performance.now=function(){return Date.now()-T}}var E=new n;x.prototype.step=function(e,t,r){r=r||10;t=t||0;if(t===0){this.internalStep(e);this.time+=e}else{var n=Math.floor((this.time+t)/e)-Math.floor(this.time/e);n=Math.min(n,r);var i=performance.now();for(var a=0;a!==n;a++){this.internalStep(e);if(performance.now()-i>e*1e3){break}}this.time+=t;var o=this.time%e;var s=o/e;var u=E;var l=this.bodies;for(var c=0;c!==l.length;c++){var h=l[c];if(h.type!==me.STATIC&&h.sleepState!==me.SLEEPING){h.position.vsub(h.previousPosition,u);u.scale(s,u);h.position.vadd(u,h.interpolatedPosition)}else{h.interpolatedPosition.copy(h.position);h.interpolatedQuaternion.copy(h.quaternion)}}}};var ge={type:"postStep"},ye={type:"preStep"},xe={type:"collide",body:null,contact:null},be=[],we=[],_e=[],Te=[],M=new n,S=new n,A=new n,R=new n,P=new n,C=new n,O=new n,L=new n,I=new n,Ee=new i,Me=new i,Se=new i,Ae=new n;x.prototype.internalStep=function(e){this.dt=e;var t=this,r=this,n=this.contacts,i=_e,a=Te,o=this.numObjects(),s=this.bodies,u=this.solver,l=this.gravity,c=this.doProfiling,h=this.profile,f=me.DYNAMIC,d,p=this.constraints,v=we,m=l.norm(),g=l.x,y=l.y,x=l.z,b=0;if(c){d=performance.now()}for(b=0;b!==o;b++){var w=s[b];if(w.type&f){var _=w.force,T=w.mass;_.x+=T*g;_.y+=T*y;_.z+=T*x}}for(var b=0,E=this.subsystems.length;b!==E;b++){this.subsystems[b].update()}if(c){d=performance.now()}i.length=0;a.length=0;this.broadphase.collisionPairs(this,i,a);if(c){h.broadphase=performance.now()-d}var M=p.length;for(b=0;b!==M;b++){var S=p[b];if(!S.collideConnected){for(var A=i.length-1;A>=0;A-=1){if(S.bodyA===i[A]&&S.bodyB===a[A]||S.bodyB===i[A]&&S.bodyA===a[A]){i.splice(A,1);a.splice(A,1)}}}}this.collisionMatrixTick();if(c){d=performance.now()}var R=be;var P=n.length;for(b=0;b!==P;b++){R.push(n[b])}n.length=0;var C=this.frictionEquations.length;for(b=0;b!==C;b++){v.push(this.frictionEquations[b])}this.frictionEquations.length=0;this.narrowphase.getContacts(i,a,this,n,R,this.frictionEquations,v);if(c){h.narrowphase=performance.now()-d}if(c){d=performance.now()}for(var b=0;b<this.frictionEquations.length;b++){u.addEquation(this.frictionEquations[b])}var O=n.length;for(var L=0;L!==O;L++){var S=n[L];var w=S.bi,I=S.bj,D=S.si,N=S.sj;var F;if(w.material&&I.material){F=this.getContactMaterial(w.material,I.material)||this.defaultContactMaterial}else{F=this.defaultContactMaterial}var B=F.friction;if(w.material&&I.material){if(w.material.friction>=0&&I.material.friction>=0){B=w.material.friction*I.material.friction}if(w.material.restitution>=0&&I.material.restitution>=0){S.restitution=w.material.restitution*I.material.restitution}}u.addEquation(S);if(w.allowSleep&&w.type===me.DYNAMIC&&w.sleepState===me.SLEEPING&&I.sleepState===me.AWAKE&&I.type!==me.STATIC){var U=I.velocity.norm2()+I.angularVelocity.norm2();var k=Math.pow(I.sleepSpeedLimit,2);if(U>=k*2){w._wakeUpAfterNarrowphase=true}}if(I.allowSleep&&I.type===me.DYNAMIC&&I.sleepState===me.SLEEPING&&w.sleepState===me.AWAKE&&w.type!==me.STATIC){var j=w.velocity.norm2()+w.angularVelocity.norm2();var z=Math.pow(w.sleepSpeedLimit,2);if(j>=z*2){I._wakeUpAfterNarrowphase=true}}this.collisionMatrix.set(w,I,true);if(!this.collisionMatrixPrevious.get(w,I)){xe.body=I;xe.contact=S;w.dispatchEvent(xe);xe.body=w;I.dispatchEvent(xe)}}if(c){h.makeContactConstraints=performance.now()-d;d=performance.now()}for(b=0;b!==o;b++){var w=s[b];if(w._wakeUpAfterNarrowphase){w.wakeUp();w._wakeUpAfterNarrowphase=false}}var M=p.length;for(b=0;b!==M;b++){var S=p[b];S.update();for(var A=0,H=S.equations.length;A!==H;A++){var G=S.equations[A];u.addEquation(G)}}u.solve(e,this);if(c){h.solve=performance.now()-d}u.removeAllEquations();var V=Math.pow;for(b=0;b!==o;b++){var w=s[b];if(w.type&f){var W=V(1-w.linearDamping,e);var q=w.velocity;q.mult(W,q);var X=w.angularVelocity;if(X){var Y=V(1-w.angularDamping,e);X.mult(Y,X)}}}this.dispatchEvent(ye);for(b=0;b!==o;b++){var w=s[b];if(w.preStep){w.preStep.call(w)}}if(c){d=performance.now()}var Z=Ee;var J=Me;var K=Se;var Q=this.stepnumber;var $=me.DYNAMIC|me.KINEMATIC;var ee=Q%(this.quatNormalizeSkip+1)===0;var te=this.quatNormalizeFast;var re=e*.5;var ne=ve.types.PLANE,ie=ve.types.CONVEXPOLYHEDRON;for(b=0;b!==o;b++){var ae=s[b],oe=ae.force,se=ae.torque;if(ae.type&$&&ae.sleepState!==me.SLEEPING){var ue=ae.velocity,le=ae.angularVelocity,ce=ae.position,he=ae.quaternion,fe=ae.invMass,de=ae.invInertiaWorld;ue.x+=oe.x*fe*e;ue.y+=oe.y*fe*e;ue.z+=oe.z*fe*e;if(ae.angularVelocity){de.vmult(se,Ae);Ae.mult(e,Ae);Ae.vadd(le,le)}ce.x+=ue.x*e;ce.y+=ue.y*e;ce.z+=ue.z*e;if(ae.angularVelocity){J.set(le.x,le.y,le.z,0);J.mult(he,K);he.x+=re*K.x;he.y+=re*K.y;he.z+=re*K.z;he.w+=re*K.w;if(ee){if(te){he.normalizeFast()}else{he.normalize()}}}if(ae.aabb){ae.aabbNeedsUpdate=true}if(ae.updateInertiaWorld){ae.updateInertiaWorld()}}}this.clearForces();this.broadphase.dirty=true;if(c){h.integrate=performance.now()-d}this.time+=e;this.stepnumber+=1;this.dispatchEvent(ge);for(b=0;b!==o;b++){var w=s[b];var pe=w.postStep;if(pe){pe.call(w)}}if(this.allowSleep){for(b=0;b!==o;b++){s[b].sleepTick(this.time)}}};x.prototype.clearForces=function(){var e=this.bodies;var t=e.length;for(var r=0;r!==t;r++){var n=e[r],i=n.force,a=n.torque;n.force.set(0,0,0);n.torque.set(0,0,0)}}},{"../collision/AABB":3,"../collision/ArrayCollisionMatrix":4,"../collision/NaiveBroadphase":7,"../collision/Ray":9,"../collision/RaycastResult":10,"../equations/ContactEquation":19,"../equations/FrictionEquation":21,"../material/ContactMaterial":24,"../material/Material":25,"../math/Quaternion":28,"../math/Vec3":30,"../objects/Body":31,"../shapes/Shape":43,"../solver/GSSolver":46,"../utils/EventTarget":49,"../utils/TupleDictionary":52,"../utils/Vec3Pool":54,"./Narrowphase":55}]},{},[2])(2)});THREE.CannonDebugRenderer=function(e,t,r){r=r||{};this.scene=e;this.world=t;this._meshes=[];this._material=new THREE.MeshBasicMaterial({color:65280,wireframe:true});this._sphereGeometry=new THREE.SphereGeometry(1);this._boxGeometry=new THREE.BoxGeometry(1,1,1);this._planeGeometry=new THREE.PlaneGeometry(10,10,10,10);this._cylinderGeometry=new THREE.CylinderGeometry(1,1,10,10)};THREE.CannonDebugRenderer.prototype={tmpVec0:new CANNON.Vec3,tmpVec1:new CANNON.Vec3,tmpVec2:new CANNON.Vec3,tmpQuat0:new CANNON.Vec3,update:function(){var e=this.world.bodies;var t=this._meshes;var r=this.tmpVec0;var n=this.tmpQuat0;var i=0;for(var a=0;a!==e.length;a++){var o=e[a];for(var s=0;s!==o.shapes.length;s++){var u=o.shapes[s];this._updateMesh(i,o,u);var l=t[i];if(l){o.quaternion.vmult(o.shapeOffsets[s],r);o.position.vadd(r,r);o.quaternion.mult(o.shapeOrientations[s],n);l.position.copy(r);l.quaternion.copy(n)}i++}}for(var a=i;a<t.length;a++){var l=t[a];if(l){this.scene.remove(l)}}t.length=i},_updateMesh:function(e,t,r){var n=this._meshes[e];if(!this._typeMatch(n,r)){if(n){this.scene.remove(n)}n=this._meshes[e]=this._createMesh(r)}this._scaleMesh(n,r)},_typeMatch:function(e,t){if(!e){return false}var r=e.geometry;return r instanceof THREE.SphereGeometry&&t instanceof CANNON.Sphere||r instanceof THREE.BoxGeometry&&t instanceof CANNON.Box||r instanceof THREE.PlaneGeometry&&t instanceof CANNON.Plane||r.id===t.geometryId&&t instanceof CANNON.ConvexPolyhedron||r.id===t.geometryId&&t instanceof CANNON.Trimesh||r.id===t.geometryId&&t instanceof CANNON.Heightfield},_createMesh:function(e){var t;var r=this._material;switch(e.type){case CANNON.Shape.types.SPHERE:t=new THREE.Mesh(this._sphereGeometry,r);break;case CANNON.Shape.types.BOX:t=new THREE.Mesh(this._boxGeometry,r);break;case CANNON.Shape.types.PLANE:t=new THREE.Mesh(this._planeGeometry,r);break;case CANNON.Shape.types.CONVEXPOLYHEDRON:var n=new THREE.Geometry;for(var i=0;i<e.vertices.length;i++){var a=e.vertices[i];n.vertices.push(new THREE.Vector3(a.x,a.y,a.z))}for(var i=0;i<e.faces.length;i++){var o=e.faces[i];var s=o[0];for(var u=1;u<o.length-1;u++){var l=o[u];var c=o[u+1];n.faces.push(new THREE.Face3(s,l,c))}}n.computeBoundingSphere();n.computeFaceNormals();t=new THREE.Mesh(n,r);e.geometryId=n.id;break;case CANNON.Shape.types.TRIMESH:var h=new THREE.Geometry;var f=this.tmpVec0;var d=this.tmpVec1;var p=this.tmpVec2;for(var i=0;i<e.indices.length/3;i++){e.getTriangleVertices(i,f,d,p);h.vertices.push(new THREE.Vector3(f.x,f.y,f.z),new THREE.Vector3(d.x,d.y,d.z),new THREE.Vector3(p.x,p.y,p.z));var u=h.vertices.length-3;h.faces.push(new THREE.Face3(u,u+1,u+2))}h.computeBoundingSphere();h.computeFaceNormals();t=new THREE.Mesh(h,r);e.geometryId=h.id;break;case CANNON.Shape.types.HEIGHTFIELD:var h=new THREE.Geometry;var f=this.tmpVec0;var d=this.tmpVec1;var p=this.tmpVec2;for(var v=0;v<e.data.length-1;v++){for(var m=0;m<e.data[v].length-1;m++){for(var g=0;g<2;g++){e.getConvexTrianglePillar(v,m,g===0);f.copy(e.pillarConvex.vertices[0]);d.copy(e.pillarConvex.vertices[1]);p.copy(e.pillarConvex.vertices[2]);f.vadd(e.pillarOffset,f);d.vadd(e.pillarOffset,d);p.vadd(e.pillarOffset,p);h.vertices.push(new THREE.Vector3(f.x,f.y,f.z),new THREE.Vector3(d.x,d.y,d.z),new THREE.Vector3(p.x,p.y,p.z));var i=h.vertices.length-3;h.faces.push(new THREE.Face3(i,i+1,i+2))}}}h.computeBoundingSphere();h.computeFaceNormals();t=new THREE.Mesh(h,r);e.geometryId=h.id;break}if(t){this.scene.add(t)}return t},_scaleMesh:function(e,t){switch(t.type){case CANNON.Shape.types.SPHERE:var r=t.radius;e.scale.set(r,r,r);break;case CANNON.Shape.types.BOX:e.scale.copy(t.halfExtents);e.scale.multiplyScalar(2);break;case CANNON.Shape.types.CONVEXPOLYHEDRON:e.scale.set(1,1,1);break;case CANNON.Shape.types.TRIMESH:e.scale.copy(t.scale);break;case CANNON.Shape.types.HEIGHTFIELD:e.scale.set(1,1,1);break}}};