(function(){function o(){}window.WebConsole=o;o.nativeConsole=window.console;o.container=null;o.defaultColor="#000";o.errorColor="#910000";o.warnColor="#a87000";o.countLabels=[];o.timeLabels=[];o.buffer=[];o.isReady=function(){return Boolean(o.container)};o.prepare=function(){window.console=o;window.onerror=o.nativeError};o.start=function(){if(o.isReady())return;var t=document.createElement("div");t.style.width="300px";t.style.height="100%";t.style.position="fixed";t.style.right="0px";t.style.top="0px";t.style.bottom="0px";t.style.zIndex=100500;t.style.background="#fff";t.style.borderLeft="1px solid #000";t.style.color="#000";t.style.opacity=.9;t.style.overflowY="auto";t.style.overflowX="hidden";t.style.padding="5px";t.style.fontSize="14px";t.style.fontFamily="monospace sans-serif serif cursive fantasy";t.style.pointerEvents="none";t.style.webkitTransform="translateX(0px)";document.body.appendChild(t);o.container=t;while(o.buffer.length){var e=o.buffer.shift();o.print(e.str,e.color)}};o.stop=function(){window.console=o.nativeConsole;window.onerror=null;window.removeEventListener("load",o.start);if(o.isReady()){document.body.removeChild(o.container);o.container=null}};o.getStack=function(t,e){var i=t.stack.split("\n");if(e)i.splice(0,e);return i};o.nativeError=function(t,e,i,n,r){if(!e)return;e=e.split("/");e=e[e.length-1];o.print(t+" at "+e+":"+i,o.errorColor)};o.prepareVal=function(t){var e=t;if(typeof t=="object"){try{e=JSON.stringify(e)}catch(t){}}return String(e)};o.print=function(t,e){if(!o.isReady()){o.buffer.push({str:t,color:e});return}var i=document.createElement("div");i.innerHTML=t;i.style.margin="0px";i.style.padding="0px";i.style.whiteSpace="pre-wrap";i.style.color=e?e:o.defaultColor;o.container.appendChild(i);o.autoScroll()};o.printStackTrace=function(t,e){for(var i=0;i<t.length;i++){o.print("  "+(t[i].name?t[i].name:t[i]),e)}};o.autoScroll=function(){if(!o.isReady())return;if(o.container.scrollHeight>0){o.container.scrollTop=o.container.scrollHeight-o.container.offsetHeight;o.container.webkitTransform="translateX(1px)";o.container.style.zIndex++}};o.getObjectByLabel=function(t,e){var i=null;for(var n=0;n<t.length;n++){if(t[n].label==e){i=t[n];break}}return i};o.assert=function(t,e){if(t){o.print("Assertion failed: "+o.prepareVal(e),o.errorColor);o.printStackTrace([arguments.callee.trace()[1]],o.errorColor)}};o.clear=function(){if(!o.isReady()){o.buffer=[];return}o.container.innerHTML=""};o.count=function(t){var e=o.getObjectByLabel(o.countLabels,t);if(!e){e={label:t,count:0};o.countLabels.push(e)}e.count++;o.print(e.label+": "+e.count)};o.prepareArguments=function(t){if(!t||!t.length)return[];var e=[];for(var i=0;i<t.length;i++){e.push(t[i])}var n=[];var r=e.shift();if(typeof r=="string"){var a=r.split("%c");if(a.length){r="";if(a[0]){r+=a.shift()}for(i=0;i<a.length;i++){r+='<div style="display: inline-block; white-space: normal;'+e.shift()+'">';r+=a[i].split(" ").join("&nbsp;");r+="</div>"}}}else r=o.prepareVal(r);n.push(r);while(e.length){n.push(o.prepareVal(e.shift()))}return n};o.log=function(){var t=o.prepareArguments(arguments);o.print(t.join(", "))};o.warn=function(){var t=o.prepareArguments(arguments);o.print(t.join(", "),o.warnColor)};o.debug=o.log;o.dir=o.log;o.dirxml=o.log;o.info=o.log;o.error=function(t){o.print(t,o.errorColor);var e=arguments.callee.trace();e.splice(0,1);o.printStackTrace(e,o.errorColor)};o.group=function(){};o.groupCollapsed=function(){};o.groupEnd=function(){};o.profile=function(){};o.profileEnd=function(){};o.timeStamp=function(){};o.time=function(t){var e=o.getObjectByLabel(o.timeLabels,t);if(!e){e={label:t,start:0};o.timeLabels.push(e)}e.start=(new Date).getTime()};o.timeEnd=function(t){var e=o.getObjectByLabel(o.timeLabels,t);if(e)o.print(t+": "+((new Date).getTime()-e.start)+"ms")};o.trace=function(){o.print("trace:");var t=arguments.callee.trace();t.splice(0,1);o.printStackTrace(t)};function t(){var t={};var e=window.location.toString();var i=window.location.toString().indexOf("?");var n,r;if(i>=0){e=e.substr(i+1,e.length);r=e.split("&");for(var a=0;a<r.length;a++){var o=r[a];n=o.split("=");t[n[0]]=n[1]}}return t}var e=t();if(e.webconsole){o.prepare();window.addEventListener("load",o.start)}Function.prototype.trace=function(){var t=[];var e=this;try{while(e){t.push(e.signature());e=e.caller}}catch(t){}return t};Function.prototype.signature=function(){var t={name:this.getName(),params:[],toString:function(){var t=this.params.length>0?"'"+this.params.join("', '")+"'":"";return this.name+"("+t+")"}};if(this.arguments){for(var e=0;e<this.arguments.length;e++)t.params.push(this.arguments[e])}return t};Function.prototype.getName=function(){if(this.name)return this.name;var t=this.toString().split("\n")[0];var e=/^function ([^\s(]+).+/;if(e.test(t))return t.split("\n")[0].replace(e,"$1")||"anonymous";return"anonymous"}})();function I18(t){return I18.f.apply(I18,arguments)}I18.locale="en";I18.strings={};I18.init=function(t,e){if(!t)t="en";if(!e)e={};I18.locale=t;I18.strings=e};I18.getSupportedLocales=function(t){var e=[];if(!t)t=I18.strings;for(var i in t){if(t.hasOwnProperty(i)){var n=t[i];for(var r in n){if(n.hasOwnProperty(r)){if(e.indexOf(r)<0)e.push(r)}}}}return e};I18.getDeviceLang=function(){var t=navigator.userLanguage||navigator.language;if(t)t=t.toLowerCase();return t||"en"};I18.getLocalString=function(t,e){var i=Array.prototype.slice.call(arguments);i.splice(1,1);var n=t;var r=I18.strings[t];if(r){for(var a in r){if(r.hasOwnProperty(a)&&a.toLowerCase()===e.toLowerCase()){n=r[a]}}}i[0]=n;return I18.sprintf.apply(I18,i)};I18.getDeviceString=function(t){var e=Array.prototype.slice.call(arguments);e.splice(1,0,I18.getDeviceLang());return I18.getLocalString.apply(I18,e)};I18.interrogative=function(t){var e=window.getDeviceLang?window.getDeviceLang():I18.locale;e=e.split("-").shift();t=t.trim();if(e==="es"){if(t[0]!=="¿")t="¿"+t;if(t[t.length-1]!=="?")t=t+"?"}else if(e==="ar"){if(t[0]!=="؟")t="؟"+t}else if(e==="fr"){if(t[t.length-2]===" "&&t[t.length-1]==="?")return t;if(t[t.length-1]==="?")t=t.substr(0,t.length-1);if(t[t.length-1]!=="?")t=t+" ?"}else{if(t[t.length-1]!=="?")t=t+"?"}return t};I18.exclamatory=function(t){var e=window.getDeviceLang?window.getDeviceLang():I18.locale;e=e.split("-").shift();t=t.trim();if(e==="es"){if(t[0]!=="¡")t="¡"+t;if(t[t.length-1]!=="!")t=t+"!"}else if(e==="ar"){if(t[0]!=="!")t="!"+t}else if(e==="fr"){if(t[t.length-2]===" "&&t[t.length-1]==="!")return t;if(t[t.length-1]==="!")t=t.substr(0,t.length-1);if(t[t.length-1]!=="!")t=t+" !"}else{if(t[t.length-1]!=="!")t=t+"!"}return t};I18.rleLangs=["ar","az","dv","ff","he","ku","fa","ur"];I18.fixRLE=function(t){var e=window.getDeviceLang?window.getDeviceLang():I18.locale;if(I18.rleLangs.indexOf(e)>=0){t=t.split("\n").join("\n‮")}return t};I18.f=function(t){var e="";if(window.getDynLocCTA){e=window.getDynLocCTA(t);if(e){return I18.fixRLE(e)}}e=t;var i=I18.strings[t];if(i&&i[I18.locale]!==undefined)e=i[I18.locale];var n=Array.prototype.slice.call(arguments);n[0]=e;return I18.fixRLE(I18.sprintf.apply(I18,n))};I18.sprintf=function(){var t=/%%|%(\d+\$)?([-+\'#0 ]*)(\*\d+\$|\*|\d+)?(\.(\*\d+\$|\*|\d+))?([scboxXuideEfFgG])/g;var w=arguments;var T=0;var e=w[T++];var L=function(t,e,i,n){if(!i)i=" ";var r=t.length>=e?"":new Array(1+e-t.length>>>0).join(i);return n?t+r:r+t};var S=function(t,e,i,n,r,a){var o=n-t.length;if(o>0){if(i||!r)t=L(t,n,a,i);else t=t.slice(0,e.length)+L("",o,"0",true)+t.slice(e.length)}return t};var x=function(t,e,i,n,r,a,o){var s=t>>>0;i=i&&s&&{2:"0b",8:"0",16:"0x"}[e]||"";t=i+L(s.toString(e),a||0,"0",false);return S(t,i,n,r,o)};var I=function(t,e,i,n,r,a){if(n)t=t.slice(0,n);return S(t,"",e,i,r,a)};var i=function(t,e,i,n,r,a,o){var s,l,u,h,f;if(t==="%%")return"%";var p=false;var c="";var d=false;var y=false;var m=" ";var g=i.length;for(var v=0;i&&v<g;v++){switch(i.charAt(v)){case" ":c=" ";break;case"+":c="+";break;case"-":p=true;break;case"'":m=i.charAt(v+1);break;case"0":d=true;m="0";break;case"#":y=true;break}}if(!n)n=0;else if(n==="*")n=+w[T++];else if(n.charAt(0)==="*")n=+w[n.slice(1,-1)];else n=+n;if(n<0){n=-n;p=true}if(!isFinite(n)){throw new Error("sprintf: (minimum-)width must be finite")}if(!a)a="fFeE".indexOf(o)>-1?6:o==="d"?0:undefined;else if(a==="*")a=+w[T++];else if(a.charAt(0)==="*")a=+w[a.slice(1,-1)];else a=+a;f=e?w[e.slice(0,-1)]:w[T++];switch(o){case"s":return I(String(f),p,n,a,d,m);case"c":return I(String.fromCharCode(+f),p,n,a,d);case"b":return x(f,2,y,p,n,a,d);case"o":return x(f,8,y,p,n,a,d);case"x":return x(f,16,y,p,n,a,d);case"X":return x(f,16,y,p,n,a,d).toUpperCase();case"u":return x(f,10,y,p,n,a,d);case"i":case"d":s=+f||0;s=Math.round(s-s%1);l=s<0?"-":c;f=l+L(String(Math.abs(s)),a,"0",false);return S(f,l,p,n,d);case"e":case"E":case"f":case"F":case"g":case"G":s=+f;l=s<0?"-":c;u=["toExponential","toFixed","toPrecision"]["efg".indexOf(o.toLowerCase())];h=["toString","toUpperCase"]["eEfFgG".indexOf(o)%2];f=l+Math.abs(s)[u](a);return S(f,l,p,n,d)[h]();default:return t}};return e.replace(t,i)};function AssetsPreloader(t){this.assets=t;this.models={};this.totalItems=0;this.loadedItems=0;this.completeCallback=null;this.progressCallback=null;this.loadModelOBJ=this.loadModelOBJ.bind(this);this.loadModelFBX=this.loadModelFBX.bind(this);this.loadModelGLTF=this.loadModelGLTF.bind(this)}AssetsPreloader.prototype.getLoaderOptions=function(t){var e={};if(!t.match(/^\s*data:(?:([\w-]+)\/([\w+.-]+))?(?:;(charset=[\w-]+|base64))?,(.*)/)){e.crossOrigin="anonymous"}return e};AssetsPreloader.prototype.preload=function(t,e){this.progressCallback=e||null;var i=[];var n=new Promise(function(t){this.preloadImages().then(this.preloadModels.bind(this)).then(t)}.bind(this));i.push(n);i.push(this.preloadFonts());if(this.assets.models){this.totalItems+=Object.keys(this.assets.models).length}return Promise.all(i).then(function(){if(t){t()}}.bind(this))};AssetsPreloader.prototype.handleLoadProgress=function(){this.loadedItems++;var t=Math.floor(this.loadedItems/this.totalItems*100);if(this.progressCallback)this.progressCallback(t)};AssetsPreloader.prototype.preloadImages=function(){var t=false;PIXI.loader.reset();if(this.assets.images&&this.assets.images.length){this.totalItems+=this.assets.images.length;t=true;for(var e=0;e<this.assets.images.length;e++){PIXI.loader.add(this.assets.images[e].name,this.assets.images[e].url,this.getLoaderOptions(this.assets.images[e].url))}}if(this.assets.spine){for(var i in this.assets.spine){var n=i.split(".");var r=n.pop();if(r==="png"||r==="jpg"||r==="jpeg"){t=true;PIXI.loader.add(i,this.assets.spine[i],this.getLoaderOptions(this.assets.spine[i]));this.totalItems++}}}if(this.assets.atlases&&this.assets.atlases.length){this.totalItems+=this.assets.atlases.length;t=true;for(e=0;e<this.assets.atlases.length;e++){PIXI.loader.add("__atlas__"+e,this.assets.atlases[e].meta.image,this.getLoaderOptions(this.assets.atlases[e].meta.image))}}if(!t)return Promise.resolve();var a=function(i,n){return new Promise(function(t){var e=new PIXI.Spritesheet(PIXI.loader.resources[n].texture.baseTexture,i);e.parse(t)})}.bind(this);return new Promise(function(e){var t=function(){var t=[];if(this.assets.atlases){t=this.assets.atlases.map(function(t,e){return a(t,"__atlas__"+e)})}return Promise.all(t).then(function(){PIXI.loader.onProgress.detach(n);e()})}.bind(this);var i=function(){this.handleLoadProgress()}.bind(this);var n=PIXI.loader.onProgress.add(i);PIXI.loader.load(t)}.bind(this))};AssetsPreloader.prototype.preloadModels=function(){return new Promise(function(t){if(!this.assets.models)t();var e=this.assets.models;var i=[];var n=[];for(var r in e){if(r){i.push(r)}}while(i.length){var a=i[0].split(".");var o=a[0];var s=[];var l=a[1];var u=null;i.splice(0,1);if(l==="bin"||l==="mtl")continue;if(l==="gltf"){u=this.loadModelGLTF(o)}if(l==="obj"){this.models[o]=this.loadModelOBJ(o);this.handleLoadProgress();this.handleLoadProgress()}if(l==="fbx"){u=this.loadModelFBX(o)}if(u){n.push(new Promise(function(t){u.then(function(){this.handleLoadProgress();t()}.bind(this))}.bind(this)))}}Promise.all(n).then(function(){t()}.bind(this))}.bind(this))};AssetsPreloader.prototype.preloadFonts=function(){if(!this.assets.fonts||!this.assets.fonts.length){return Promise.resolve()}this.totalItems+=this.assets.fonts.length;var t=document.getElementsByTagName("head")[0];var e=[];for(var i=0;i<this.assets.fonts.length;i++){var n=this.assets.fonts[i];var r=document.createElement("style");r.type="text/css";r.appendChild(document.createTextNode("@font-face {font-family: "+n.name+"; src: url("+n.url+");"+"}"));t.appendChild(r);e.push(new Promise(function(t){new FontFaceObserver(n.name).load().then(function(){this.handleLoadProgress();t()}.bind(this))}.bind(this)))}return Promise.all(e)};AssetsPreloader.prototype.loadModelOBJ=function(t){var e=this.assets.models;var i=null;var n=null;for(var r in e){if(r===t+".mtl")n=e[r];if(r===t+".obj")i=e[r]}if(!i){throw Error("No model obj",t)}var a=new THREE.OBJLoader;if(n){var o=new THREE.MTLLoader;var s=o.parse(n);s.preload();a.setMaterials(s)}return a.parse(i)};AssetsPreloader.prototype.loadModelFBX=function(r){return new Promise(function(e){var t=this.assets.models;var i=new THREE.LoadingManager;var n=new THREE.FBXLoader(i);n.load(t[r+".fbx"],function(t){Game.preloader.models[r]=t;e()},function(t){},function(t){throw Error(t)})}.bind(this))};AssetsPreloader.prototype.loadModelGLTF=function(n){return new Promise(function(i){var t=new THREE.GLTFLoader;t.loadFromPattern(n,"",function(t){var e=t.scene;e.animations=t.animations;Game.preloader.models[n]=e;i()}.bind(this))}.bind(this))};var LayoutManager={};LayoutManager.width=0;LayoutManager.height=0;LayoutManager.scale=1;LayoutManager.aspectRatio=1;LayoutManager.gameWidth=0;LayoutManager.gameHeight=0;LayoutManager.orientation=0;LayoutManager.left=0;LayoutManager.right=0;LayoutManager.top=0;LayoutManager.bottom=0;LayoutManager.LANDSCAPE=1;LayoutManager.PORTRAIT=2;LayoutManager.visibilityListenerAttached=false;LayoutManager.eventEmitter=new PIXI.utils.EventEmitter;LayoutManager.hideAddressBar=function(){window.scrollTo(0,1)};LayoutManager.getVisibilityProps=function(){var t,e;if(typeof document.hidden!=="undefined"){t="hidden";e="visibilitychange"}else if(typeof document.mozHidden!=="undefined"){t="mozHidden";e="mozvisibilitychange"}else if(typeof document.msHidden!=="undefined"){t="msHidden";e="msvisibilitychange"}else if(typeof document.webkitHidden!=="undefined"){t="webkitHidden";e="webkitvisibilitychange"}return{hidden:t,visibilityChange:e}};LayoutManager.handleVisibilityChange=function(){var t=LayoutManager.getVisibilityProps();LayoutManager.eventEmitter.emit("visibilityChange",{hidden:document[t.hidden]})};LayoutManager.isHidden=function(){var t=LayoutManager.getVisibilityProps();return!!document[t.hidden]};LayoutManager.isIOS=function(){return!!((/iPad|iPhone|iPod/.test(navigator.platform)||navigator.platform==="MacIntel"&&navigator.maxTouchPoints>1)&&!window.MSStream)};LayoutManager.fitLayout=function(t,e){if(!LayoutManager.visibilityListenerAttached){var i=LayoutManager.getVisibilityProps();if(i.visibilityChange){document.addEventListener(i.visibilityChange,LayoutManager.handleVisibilityChange);LayoutManager.visibilityListenerAttached=true}}if(typeof t!="number"||typeof e!="number"){t=window.innerWidth;e=window.innerHeight}if(LayoutManager.width===t&&LayoutManager.height===e)return;if(!LayoutManager.isIOS()){document.body.style.width=t+"px";document.body.style.height=e+"px"}LayoutManager.width=t;LayoutManager.height=e;LayoutManager.orientation=t>e?LayoutManager.LANDSCAPE:LayoutManager.PORTRAIT;var n,r;if(LayoutManager.orientation===LayoutManager.LANDSCAPE){r=Game.size.w;n=Math.floor(r*(t/e));if(n<Game.size.h){n=Game.size.h;r=Math.floor(Game.size.h*(e/t))}}else{r=Game.size.h;n=Math.floor(r*(t/e));if(n<Game.size.w){n=Game.size.w;r=Math.floor(Game.size.w*(e/t))}}if(Game.app){Game.app.renderer.resize(n,r);Game.app.view.style.width=t+"px";Game.app.view.style.height=e+"px"}LayoutManager.gameWidth=n;LayoutManager.gameHeight=r;LayoutManager.left=-n/2;LayoutManager.right=n/2;LayoutManager.top=-r/2;LayoutManager.bottom=r/2;LayoutManager.scale=Math.min(t/n,e/r);LayoutManager.aspectRatio=Math.max(n/r,r/n);Game.onResize();LayoutManager.eventEmitter.emit("resize",{width:LayoutManager.gameWidth,height:LayoutManager.gameHeight});setTimeout(LayoutManager.hideAddressBar,100)};LayoutManager.on=function(t,e,i){LayoutManager.eventEmitter.on(t,e,i)};LayoutManager.once=function(t,e,i){LayoutManager.eventEmitter.once(t,e,i)};LayoutManager.off=function(t,e,i){LayoutManager.eventEmitter.off(t,e,i)};LayoutManager.isTablet=function(){return LayoutManager.aspectRatio<1.4};LayoutManager.isIphoneX=function(){return LayoutManager.aspectRatio>2};LayoutManager.isLandscape=function(){return LayoutManager.orientation===LayoutManager.LANDSCAPE};LayoutManager.isPortrait=function(){return LayoutManager.orientation===LayoutManager.PORTRAIT};try{module.exports=LayoutManager}catch(t){}var DomLayout={};DomLayout.LANDSCAPE_SUFFIX="_landscape";DomLayout.PORTRAIT_SUFFIX="_portrait";DomLayout.bind=function(t,e){var i=false;if(CONFIG.domBinds){for(var n=0;n<CONFIG.domBinds.length;n++){if(CONFIG.domBinds[n]===e)i=true}}if(!i)console.error('Please, add "'+e+'" to the CONFIG.domBinds array!');t.domBind=e;var r;r=document.getElementById(e);if(!r){r=document.createElement("div");r.setAttribute("id",e);document.body.appendChild(r)}r=document.getElementById(e+DomLayout.PORTRAIT_SUFFIX);if(!r){r=document.createElement("div");r.setAttribute("id",e+DomLayout.PORTRAIT_SUFFIX);document.body.appendChild(r)}r=document.getElementById(e+DomLayout.LANDSCAPE_SUFFIX);if(!r){r=document.createElement("div");r.setAttribute("id",e+DomLayout.LANDSCAPE_SUFFIX);document.body.appendChild(r)}if(t.parent)DomLayout.onResize()};DomLayout.onResize=function(t){if(!t&&window.Game&&Game.app&&Game.app.stage)t=Game.app.stage;if(!t)return;for(var e=0;e<t.children.length;e++){var i=t.children[e];if(i.domBind){var n=LayoutManager.orientation===LayoutManager.PORTRAIT?DomLayout.PORTRAIT_SUFFIX:DomLayout.LANDSCAPE_SUFFIX;if(!i.defaultStyles)i.defaultStyles={};if(i.defaultStyles&&!i.defaultStyles[n]){i.defaultStyles[n]={};i.defaultStyles[n].scale={};i.defaultStyles[n].scale.x=i.scale.x;i.defaultStyles[n].scale.y=i.scale.y;i.defaultStyles[n].width=i.getBounds().width;i.defaultStyles[n].height=i.getBounds().height}DomLayout.syncObject(i)}DomLayout.onResize(i)}};DomLayout.getAbsoluteScale=function(t){var e=t.scale.x;var i=t.scale.y;var n=t.parent;while(n){e*=n.scale.x;i*=n.scale.y;n=n.parent}return{x:e,y:i}};DomLayout.syncObject=function(t){var e=t.domBind;if(!e||!t.parent)return;var i=document.getElementById(t.domBind);if(!DomLayout.isSetStyles(i)){i=document.getElementById(t.domBind+(LayoutManager.orientation===LayoutManager.PORTRAIT?DomLayout.PORTRAIT_SUFFIX:DomLayout.LANDSCAPE_SUFFIX));if(!DomLayout.isSetStyles(i))return}if(i){var n=DomLayout.getSizes(i,t);var r=DomLayout.getPositions(i,t,n);t.x=r.x;t.y=r.y;t.scale.x=n.scale.x;t.scale.y=n.scale.y}};DomLayout.getPositions=function(t,e,i){var n=t.getBoundingClientRect();var r=n.left/LayoutManager.scale;var a=n.top/LayoutManager.scale;var o=e.parent.toLocal({x:r,y:a});var s=o.x;var l=o.y;var u=e.getLocalBounds().width>0?e.getLocalBounds().width:1;var h=e.getLocalBounds().height>0?e.getLocalBounds().height:1;var f=Math.abs(e.getLocalBounds().x/u);var p=Math.abs(e.getLocalBounds().y/h);s+=i.width*f;l+=i.height*p;s+=e.pivot.x;l+=e.pivot.y;s=Math.round(s);l=Math.round(l);var c=-1e3;var d=Math.round(n.left);var y=Math.round(n.top);if(d>c&&y>c){return{x:s,y:l}}else if(d<=c&&y>c){return{x:e.x,y:l}}else if(d>c&&y<=c){return{x:s,y:e.y}}return{x:e.x,y:e.y}};DomLayout.getSizes=function(t,e){var i=t.offsetWidth;var n=t.offsetHeight;var r=e.getLocalBounds();var a=DomLayout.getAbsoluteScale(e.parent);var o=i/LayoutManager.scale/a.x;var s=n/LayoutManager.scale/a.y;var l,u,h={};if(o>0&&s>0){l=o;u=s;h.x=l/r.width;h.y=u/r.height}else if(o>0&&s<=0){l=o;u=r.height*(o/r.width);h.x=l/r.width;h.y=u/r.height}else if(o<=0&&s>0){l=r.width*(s/r.height);u=s;h.x=l/r.width;h.y=u/r.height}else{var f;if(LayoutManager.orientation===LayoutManager.PORTRAIT)f=DomLayout.PORTRAIT_SUFFIX;else f=DomLayout.LANDSCAPE_SUFFIX;l=e.defaultStyles[f].width;u=e.defaultStyles[f].height;h.x=e.defaultStyles[f].scale.x;h.y=e.defaultStyles[f].scale.y}return{width:l,height:u,scale:h}};DomLayout.isSetStyles=function(t){var e=window.getComputedStyle(t,null).getPropertyValue("position");return e==="absolute"};var Analytics={};Analytics.data={liveTime:0,interactions:0,orientation:0,isEnded:false};Analytics.init=function(){Analytics.data.orientation=LayoutManager.orientation;Game.on("gameEvent",Analytics.handleGameEvent)};Analytics.handleGameEvent=function(t){switch(t.type){case"tick":Analytics.data.liveTime+=t.data;break;case"interaction":Analytics.data.interactions++;break;case"outro":Analytics.data.isEnded=true;break;default:break}};Analytics.gameAnalytics={};Analytics.gameAnalytics.send=function(t,e){if(window.GameAnalytics){GameAnalytics("addDesignEvent",t,e||0)}};Analytics.amplitudeAnalytics={};Analytics.amplitudeAnalytics.send=function(t,e){if(window.amplitude){amplitude.getInstance().logEvent(t,e)}};function Sprite(t){var e=t?PIXI.Texture.from(t):PIXI.Texture.EMPTY;PIXI.extras.AnimatedSprite.call(this,[e]);this.animationSpeed=24/60;this.anchor.set(.5);this.stop()}Sprite.prototype=Object.create(PIXI.extras.AnimatedSprite.prototype);Sprite.prototype.copy=function(t,e){if(t.textures)this.textures=[].concat(t.textures);this.texture=t.texture;if(t.playing){this.gotoAndPlay(t.currentFrame)}else{this.gotoAndStop(t.currentFrame)}this.tint=t.tint;if(e===true){t.updateTransform();this.transform.setFromMatrix(t.localTransform)}return this};Sprite.prototype.clone=function(t){var e=new Sprite;return e.copy(this,t)};Sprite.prototype.on=function(t,e,i){if(Sprite.pointerEvents.indexOf(t)>=0)this.interactive=true;return PIXI.extras.AnimatedSprite.prototype.on.call(this,t,e,i)};Sprite.prototype.once=function(t,e,i){if(Sprite.pointerEvents.indexOf(t)>=0)this.interactive=true;return PIXI.extras.AnimatedSprite.prototype.once.call(this,t,e,i)};Sprite.prototype.removeListener=function(t,e,i,n){PIXI.extras.AnimatedSprite.prototype.removeListener.call(this,t,e,i,n);if(Sprite.pointerEvents.indexOf(t)>=0){var r=false;for(var a=0;a<Sprite.pointerEvents.length;a++){var o=Sprite.pointerEvents[a];if(this.listeners(o).length>0){r=true;break}}this.interactive=r}return this};Sprite.prototype.off=function(t,e,i,n){return this.removeListener(t,e,i,n)};Sprite.prototype.emit=function(t){if(!this._events[t])return false;var e=arguments[1];if(Sprite.pointerEvents.indexOf(t)>=0){if(!e.data)e.data={};e.data.local=e.data.getLocalPosition(this)}if(arguments.length<3)PIXI.extras.AnimatedSprite.prototype.emit.call(this,t,e);if(arguments.length==3)PIXI.extras.AnimatedSprite.prototype.emit.call(this,t,e,arguments[2]);if(arguments.length==4)PIXI.extras.AnimatedSprite.prototype.emit.call(this,t,e,arguments[2],arguments[3]);if(arguments.length>=5)PIXI.extras.AnimatedSprite.prototype.emit.call(this,t,e,arguments[2],arguments[3],arguments[4])};Sprite.prototype.has=function(t,e,i){if(!this._events)return false;var n=this._events[t];if(!n)return false;if(!Array.isArray(n))n=[n];if(e===undefined)return true;for(var r=0;r<n.length;r++){var a=n[r];if(a.fn===e){if(i===undefined||a.context===i)return true}}return false};Sprite.prototype.addTween=function(t,e,i,n,r,a){var o=new TWEEN.Tween(t).to(e,i);if(n)o.easing(n);if(r)o.onComplete(r);if(a)o.onUpdate(a);o.start();return o};Sprite.prototype.moveTo=function(t,e,i,n,r,a){return this.addTween(this.position,{x:t,y:e},i,n,r,a)};Sprite.prototype.moveBy=function(t,e,i,n,r,a){return this.addTween(this.position,{x:this.position.x+t,y:this.position.y+e},i,n,r,a)};Sprite.prototype.fadeTo=function(t,e,i,n,r){return this.addTween(this,{alpha:t},e,i,n,r)};Sprite.prototype.fadeBy=function(t,e,i,n,r){return this.addTween(this,{alpha:this.alpha+t},e,i,n,r)};Sprite.prototype.rotateTo=function(t,e,i,n,r){return this.addTween(this,{rotation:t},e,i,n,r)};Sprite.prototype.rotateBy=function(t,e,i,n,r){return this.addTween(this,{rotation:this.rotation+t},e,i,n,r)};Sprite.prototype.scaleTo=function(t,e,i,n,r,a){return this.addTween(this.scale,{x:t,y:e},i,n,r,a)};Sprite.prototype.scaleBy=function(t,e,i,n,r,a){return this.addTween(this.scale,{x:this.scale.x+t,y:this.scale.y+e},i,n,r,a)};Sprite.create=function(t){return new Sprite(t)};Sprite.clone=function(t,e){return t.clone(e)};Sprite.from=function(t){var e;if(Array.isArray(t)){return Sprite.fromTextures(Sprite.parseSourceArray(t))}if(typeof t==="string"&&!PIXI.utils.TextureCache[t]){return Sprite.fromPattern(t)}e=new Sprite;e.texture=PIXI.Texture.from(t);return e};Sprite.parseSourceArray=function(t){var e,i=[];for(e=0;e<t.length;e++){i.push(PIXI.Texture.from(t[e]))}return i};Sprite.fromFrame=function(t){return new Sprite(t)};Sprite.fromImage=function(t){var e=t?PIXI.Texture.fromFrame(t):PIXI.Texture.EMPTY;var i=new PIXI.extras.AnimatedSprite([e]);i.animationSpeed=24/60;i.anchor.set(.5);i.stop();return i};Sprite.fromPattern=function(t){return Sprite.fromTextures(Sprite.getTexturesFromPattern(t))};Sprite.getTexturesFromPattern=function(t){var e=[];for(var i in PIXI.utils.TextureCache){if(i.substr(0,t.length)===t){var n=PIXI.Texture.fromFrame(i);var r=(i.substr(t.length).match(/[0-9]+/)||"")[0];n._ix=parseInt(r);e.push(n)}}if(e.length){e.sort(Sprite.sortTextures)}else{e=[PIXI.Texture.EMPTY];console.warn("Unknown animation",t)}return e};Sprite.fromTextures=function(t){var e=new Sprite;if(!Array.isArray(t))t=[t];e.textures=t;if(t.length>1)e.gotoAndPlay(0);else e.gotoAndStop(0);return e};Sprite.sortTextures=function(t,e){if(t._ix>e._ix)return 1;if(t._ix<e._ix)return-1;return 0};Sprite.prototype.isOverFilledPixel=function(t){var e=this.texture.orig.width;var i=this.texture.orig.height;var n=-e*this.anchor.x;var r=-i*this.anchor.y;var a=false;if(t.x>=n&&t.x<n+e&&t.y>=r&&t.y<r+i){a=true}if(!a){return false}var o=this.texture;var s=this.texture.baseTexture;var l=s.resolution;if(!s.hitmap){if(!Sprite.genHitmap(s,255)){return true}}var u=s.hitmap;var h=Math.round((t.x-n+o.frame.x)*l);var f=Math.round((t.y-r+o.frame.y)*l);var p=h+f*s.realWidth;var c=p%32;var d=p/32|0;return(u[d]&1<<c)!==0};Sprite.genHitmap=function(t,e){if(e==null)e=255;var i=t.source;if(!i){return false}var n=null;var r=null;if(i.getContext){n=i;r=n.getContext("2d")}else if(i instanceof Image){n=document.createElement("canvas");n.width=i.width;n.height=i.height;r=n.getContext("2d");r.drawImage(i,0,0)}else{return false}var a=n.width,o=n.height;var s=r.getImageData(0,0,a,o);var l=t.hitmap=new Uint32Array(Math.ceil(a*o/32));for(var u=0;u<a*o;u++){var h=u%32;var f=u/32|0;if(s.data[u*4+3]>=e){l[f]=l[f]|1<<h}}return true};Sprite.pointerEvents=["mousedown","mouseup","mousemove","click","touchstart","touchend","touchmove","tap","mouseover","mouseout","mouseupoutside","rightclick","rightdown","rightup","rightupoutside","touchendoutside","pointerdown","pointerup","pointermove","pointerclick","pointerover","pointerout","pointerupoutside","pointertap"];if(typeof module!=="undefined")module.exports=Sprite;if(typeof window!=="undefined")window.Sprite=Sprite;function GameWindow(){Sprite.call(this)}GameWindow.prototype=Object.create(Sprite.prototype);GameWindow.prototype.onShow=function(){};GameWindow.prototype.onHide=function(t){if(t)t()};GameWindow.prototype.onRemove=function(){};GameWindow.prototype.onResize=function(){};GameWindow.prototype.tick=function(t){};function Tween(t,e,i,n){TWEEN.Tween.call(this,t,n&&n.group?n.group:Tween.scope);this._valuesTo={};this._repeatTimes=0;this.eventEmitter=new PIXI.utils.EventEmitter;this.eventsPrepare(n);this._linkedTweens=n&&n.linkedTweens?n.linkedTweens.concat():[];if(e){this.to(e,i,n)}for(var r in n){if(typeof this[r]==="function"){var a=n[r];if(!Array.isArray(a)){a=[a]}this[r].apply(this,a)}}if(e===undefined){return this}if(n&&n.autoStart===false){return this}this.start(Tween._gameTime);return this}Tween.prototype=Object.create(TWEEN.Tween.prototype);Tween.scope=new TWEEN.Group;Tween._gameTime=TWEEN.now();Tween.prototype.start=function(t){var e=Object.create(null);for(var i in this._valuesTo){if(typeof this._valuesTo[i]==="object"&&!(this._valuesTo[i]instanceof Array))continue;e[i]=this._valuesTo[i]}this.repeat(this._repeatTimes);if(this._object){this.ifToStrings(this._object,e)}TWEEN.Tween.prototype.to.call(this,e,this._duration);t=t||Tween._gameTime;for(var n=0;this._linkedTweens&&n<this._linkedTweens.length;n++){this._linkedTweens[n].start(t)}TWEEN.Tween.prototype.start.call(this,t);return this};Tween.prototype.to=function(t,e,i){for(var n in t){if(!this._object[n]){continue}if(Array.isArray(t[n])){continue}if(typeof t[n]==="object"){var r=Object.create(null);if(i){for(var a in i){if(a==="onStart"||a==="onStop"||a==="onComplete"||a==="onUpdate"||a==="linkedTweens"){continue}r[a]=i[a]}}r.autoStart=false;this._linkedTweens.push(new Tween(this._object[n],t[n],e,r));delete t[n]}}if(Object.keys(t).length){this._valuesTo=Object.create(null);for(var n in t){this._valuesTo[n]=t[n]}}return TWEEN.Tween.prototype.to.call(this,t,e)};Tween.prototype.repeat=function(t){this._repeatTimes=t;return TWEEN.Tween.prototype.repeat.call(this,t)};Tween.update=function(t){Tween._gameTime=t>=0?Tween._gameTime+t:TWEEN.now();Tween.scope.update(Tween._gameTime)};Tween.prototype.ifToStrings=function(t,e){if(!t){return}for(var i in e){if(typeof t[i]!=="number"){continue}var n;if(Array.isArray(e[i])){n=t[i];for(var r=0;r<e[i].length;r++){e[i][r]=Tween._strToNum(n,e[i][r]);n=e[i][r]}}else{n=t[i];e[i]=Tween._strToNum(n,e[i])}}};Tween._strToNum=function(t,e){if(typeof e!=="string")return e;t=t||0;if(e.charAt(0)==="+"||e.charAt(0)==="-"){e=t+parseFloat(e)}else{e=parseFloat(e)}return e};Tween.prototype.emit=function(t,e,i,n,r,a){this.eventEmitter.emit(t,e,i,n,r,a);return this};Tween.prototype.on=function(t,e,i){this.eventEmitter.on(t,e,i);return this};Tween.prototype.once=function(t,e,i){this.eventEmitter.once(t,e,i);return this};Tween.prototype.off=function(t,e,i){this.eventEmitter.off(t,e,i);return this};Tween.prototype.eventsPrepare=function(t){t=t||{};if(!t.onStart)this.onStart();if(!t.onStop)this.onStop();if(!t.onUpdate)this.onUpdate();if(!t.onComplete)this.onComplete()};Tween.prototype.cbEventHandler=function(i,n){return function(t){if(n==="stop"){for(var e=0;this._linkedTweens&&e<this._linkedTweens.length;e++){this._linkedTweens[e].stop()}}if(i)i(t);this.eventEmitter.emit(n,t)}};Tween.prototype.onStart=function(t){var e=this.cbEventHandler(t,"start");TWEEN.Tween.prototype.onStart.call(this,e);return this};Tween.prototype.onStop=function(t){var e=this.cbEventHandler(t,"stop");TWEEN.Tween.prototype.onStop.call(this,e);return this};Tween.prototype.onUpdate=function(t){var e=this.cbEventHandler(t,"update");TWEEN.Tween.prototype.onUpdate.call(this,e);return this};Tween.prototype.onComplete=function(t){var e=this.cbEventHandler(t,"complete");TWEEN.Tween.prototype.onComplete.call(this,e);return this};Tween.animator=function(e,i,n){n=n||{};n.autoStart=true;return function(t){t=t||this;return new Tween(t,e,i,n)}};Tween.create=function(t,e,i,n){return new Tween(t,e,i,n)};Tween.E_=Tween.Easing=TWEEN.Easing;Tween.I_=Tween.Interpolation=TWEEN.Interpolation;function Timer(t,e,i,n){PIXI.utils.EventEmitter.call(this);t=t>=0?t:1e3;e=e>0?Math.floor(e):0;i=i>0?i:0;n=typeof n==="boolean"?n:true;this._initialDelay=t;this.delay=0;this.repeat=e;this._repeated=0;this.destroyOnFinish=n;this.running=true;this.finished=false;this.periodDelay=0;this.emitPeriod=i;Timer.pool.unshift(this)}Timer.prototype=Object.create(PIXI.utils.EventEmitter.prototype);Timer.prototype.start=function(){if(this.finished){console.warn("Timer is finished. Use 'restart' method for processing");return}this.emit("start",this);this.running=true;return this};Timer.prototype.stop=function(){this.running=false;this.emit("stop",this);return this};Timer.prototype.finish=function(){if(this.destroyOnFinish){this.destroy()}this.stop();this.finished=true;this.emit("finish",this)};Timer.prototype.restart=function(){this.delay=0;this.periodDelay=0;this._repeated=0;this.running=true;this.finished=false;this.emit("restart",this);return this};Timer.prototype.destroy=function(){var t=Timer.pool.indexOf(this);if(t>=0){this.stop();Timer.pool.splice(t,1)}return this};Timer.prototype.getTotalDelay=function(){if(this.finished){return(this._repeated+1)*this._initialDelay}var t=this._repeated*this._initialDelay+this.delay;return t};Timer.prototype.tick=function(t){if(!this.running)return;this.emit("tick",this);this.emit("update",this);for(var e=0;e<t;e++){if(this.emitPeriod){this.periodDelay++;if(this.periodDelay>=this.emitPeriod){this.periodDelay=0;this.emit("period",this);if(!this.running)return}}this.delay++;if(this.delay>=this._initialDelay){this.delay=0;this.emit("complete",this);if(!this.running)return;if(this.repeat&&this._repeated<this.repeat){this._repeated++;this.emit("repeat",this);if(!this.running)return}else{this.finish();return}}}};Timer.pool=[];Timer.create=function(t,e,i,n){var r=new Timer(t,e,i,n);return r};Timer.destroy=function(t){t.destroy();return t};Timer.update=function(t){for(var e=Timer.pool.length-1;e>=0;e--){Timer.pool[e].tick(t)}};Timer.clear=function(){while(timer=Timer.pool.pop()){timer.destroy()}};function ExtText(t,e,i){PIXI.Text.call(this,t,e,i);this.style.baseFontSize=this.style.fontSize;this.style.baseFontFamily=this.style.fontFamily;this.extendStyleProps();this.chooseFontFamily()}ExtText.prototype=Object.create(PIXI.Text.prototype);ExtText.prototype.extendStyleProps=function(){this.style._autoFit=!!this.style.autoFit;this.style._autoFitPadding=this.style.autoFitPadding||0;this.style._autoFitWidth=this.style.autoFitWidth||0;this.style._autoFitHeight=this.style.autoFitHeight||0;this.style._adjustFontFamily=!!this.style.adjustFontFamily;this.style._adjustFontFamilyRegExp=this.style.adjustFontFamilyRegExp instanceof RegExp?this.style.adjustFontFamilyRegExp:undefined;Object.defineProperty(this.style,"autoFit",{get:function(){return this._autoFit},set:function(t){t=!!t;if(this._autoFit!==t){this._autoFit=t;this.styleID++}}});Object.defineProperty(this.style,"autoFitPadding",{get:function(){return this._autoFitPadding},set:function(t){t=parseFloat(t);if(isNaN(t))t=0;if(this._autoFitPadding!==t){this._autoFitPadding=t;this.styleID++}}});Object.defineProperty(this.style,"fontSize",{get:function(){return this._fontSize},set:function(t){t=parseFloat(t);if(isNaN(t))t=0;if(this._fontSize!==t){this.baseFontSize=t;this._fontSize=t;this.styleID++}}});Object.defineProperty(this.style,"autoFitWidth",{get:function(){return this._autoFitWidth},set:function(t){t=parseFloat(t);if(isNaN(t))t=0;if(this._autoFitWidth!==t){this._autoFitWidth=t;this.styleID++}}});Object.defineProperty(this.style,"autoFitHeight",{get:function(){return this._autoFitHeight},set:function(t){t=parseFloat(t);if(isNaN(t))t=0;if(this._autoFitHeight!==t){this._autoFitHeight=t;this.styleID++}}});Object.defineProperty(this.style,"fontFamily",{get:function(){return this._fontFamily},set:function(t){if(this.fontFamily!==t){this.baseFontFamily=t;this._fontFamily=t;this.styleID++}}});Object.defineProperty(this.style,"adjustFontFamily",{get:function(){return this._adjustFontFamily},set:function(t){t=!!t;if(this._adjustFontFamily!==t){this._adjustFontFamily=t;this.styleID++}}});Object.defineProperty(this,"text",{get:function(){return this._text},set:function(t){t=String(t===""||t===null||t===undefined?" ":t);if(this._text===t){return}this._text=t;this.dirty=true;this.chooseFontFamily()}});Object.defineProperty(this.style,"adjustFontFamilyRegExp",{get:function(){return this._adjustFontFamilyRegExp},set:function(t){if(t instanceof RegExp){if(this._adjustFontFamilyRegExp!==t){this._adjustFontFamilyRegExp=t;this.styleID++}}else{console.warn("adjustFontFamilyRegExp is not an instance of RegExp")}}})};ExtText.prototype.chooseFontFamily=function(){var t=null;var e=null;if(this.style.adjustFontFamily){e=ExtText.ADJUST_FONT_FAMILY_REGEXP;if(this.style.adjustFontFamilyRegExp)e=this.style.adjustFontFamilyRegExp;if(!e.test(this.text)){t=ExtText.SYSTEM_FONT}else{t=this.style.baseFontFamily}}else{t=this.style.baseFontFamily}if(t!==this.style.fontFamily){this.style._fontFamily=t;this.style.styleID++}};ExtText.prototype.fitText=function(){var t=this.style.autoFitWidth;if(!t)t=this.parent.width/this.parent.scale.x;t-=this.style.autoFitPadding*2;var e=this.style.autoFitHeight;if(!e)e=this.parent.height/this.parent.scale.y;e-=this.style.autoFitPadding*2;if(t<2||e<2){this.style.fontSize=1;return}var i=this.style.clone();i.fontSize=this.style.baseFontSize;var n=true;var r=0;while(n){var a=PIXI.TextMetrics.measureText(this.text,i);if(a.width<=t&&a.height<=e){n=false}else{i.fontSize--;if(i.fontSize<=1){n=false}else{r++}}}if(r>20){console.warn("ExtText. Potentially suboptimal use: the number of fit attempts exceeds 20. Current: "+r);console.warn("Base font size: "+this.style.baseFontSize);console.warn("Selected font size: "+i.fontSize);console.warn(this.text)}this.style.fontSize=i.fontSize};ExtText.prototype.updateText=function(t){if(this.localStyleID!==this._style.styleID||this.dirty||!t){if(this.style.autoFit&&this.parent){this.fitText()}else{this.style.fontSize=this.style.baseFontSize}this.chooseFontFamily()}PIXI.Text.prototype.updateText.call(this,t)};ExtText.SYSTEM_FONT="-apple-system,BlinkMacSystemFont,Roboto,Helvetica,Arial,sans-serif";ExtText.ADJUST_FONT_FAMILY_REGEXP=/^[\u0000-\u007f]+$/;